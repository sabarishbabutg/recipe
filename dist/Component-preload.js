/**
* This file was auto-generated by SAP Web IDE build and includes all
* the source files required by SAPUI5 runtime for performance optimization.
* PLEASE DO NOT EDIT THIS FILE!! Changes will be overwritten the next time the build is run.
*/
jQuery.sap.registerPreloadedModules({
	"version": "2.0",
	"name": "MANAGED_RECIPE/Component-preload",
	"modules": {
		"MANAGED_RECIPE/model/models.js": "sap.ui.define([\n\t\"sap/ui/model/json/JSONModel\",\n\t\"sap/ui/Device\"\n], function(JSONModel, Device) {\n\t\"use strict\";\n\n\treturn {\n\n\t\tcreateDeviceModel: function() {\n\t\t\tvar oModel = new JSONModel(Device);\n\t\t\toModel.setDefaultBindingMode(\"OneWay\");\n\t\t\treturn oModel;\n\t\t}\n\n\t};\n});",
		"MANAGED_RECIPE/Fragment/reci_attachment_comments.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\"\n\txmlns:fi=\"sap.ui.unified\">\n\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\">\n\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t<Label text=\"{i18n>Attachments}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t<layoutData>\n\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t</layoutData>\n\t\t\t</HBox>\n\t\t\t<grid:Grid class=\"cl_kd_grid\">\n\t\t\t\t<HBox height=\"1.5rem\">\n\t\t\t\t\t<Label text=\"{i18n>UploadFiles}\" class=\"cl_tableHeaderTxt\"></Label>\n\t\t\t\t\t<Label text=\"{i18n>UploadFielSubtext}\" class=\"sapUiTinyMarginBegin cl_attachement_secondaryTxt\"></Label>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</HBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<uitable:Table id=\"idDynamicUITable\" rows=\"{JM_DocTypeModel>/List}\" visibleRowCount=\"4\" selectionMode=\"None\"\n\t\t\t\t\t\tclass=\"cl_opr_Tbl sapUiTinyMarginTop\">\n\t\t\t\t\t\t<uitable:noData>\n\t\t\t\t\t\t\t<VBox alignItems=\"Center\" justifyContent=\"Center\" class= \"cl_noDataInit\">\n\t\t\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'Nodatafound.gif'}\" tooltip = \"{i18n>NoDatafound}\" width=\"180px\" height=\"180px\"/>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</uitable:noData>\n\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t<uitable:Column width=\"10rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>AttachmentNumber}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_DocTypeModel>AttachmentNo}\" class=\"sapUiSmallMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width=\"20rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Attachments}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<!--press=\"onDownloadAttachment\"-->\n\t\t\t\t\t\t\t\t\t<Link text=\"{JM_DocTypeModel>TagName}\" class=\"cl_table_label cl_TransIdTextColor  sapUiTinyMarginBegin\" press = \"fnDownloadSingleFile\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width=\"8rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>DocumentType}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_DocTypeModel>DocType}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width=\"8rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>FileSize}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_DocTypeModel>Size}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column >\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Delete}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Button  icon=\"{= ${JM_ImageModel>/path} + 'DeleteIconforall.svg'}\" press=\"fnDeleteAttachRow\" class=\"cl_rembtnfocus\" tooltip=\"{i18n>Delete}\" type=\"Transparent\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L9 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<Label text=\"{i18n>DocumentType}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t<ComboBox id=\"id_varients\" width=\"100%\" class=\"cl_combobox\"></ComboBox>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<Label text=\"{i18n>UploadFile}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t<!--accept=\".doc,.docx,.xls,.xlsx,.wdsl,.msg,.eml,.zip,.htm,.pdf\"-->\n\t\t\t\t\t\t\t<Input id=\"fileNameInput\" value=\"{/uploadedFileName}\" class=\"cl_fileUploader\" valueHelpRequest=\"fnUploadButtonpres\" showValueHelp=\"true\"></Input>\n\t\t\t\t\t\t\t<fi:FileUploader id=\"hiddenUploader\" change=\"fnFileSelected\" uploadOnChange=\"false\" fileType=\"doc,docx,xls,xlsx,wdsl,msg,eml,zip,htm,pdf\"\n\t\t\t\t\t\t\t class=\"cl_fileupload\"/>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<Label text=\"{i18n>TagName}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t<Input id=\"id_tagInput\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<HBox justifyContent=\"SpaceBetween\">\n\t\t\t\t\t\t<Button text=\"{i18n>MassDownload}\" id = \"id_massDownloadButton\" icon=\"{= ${JM_ImageModel>/path} + 'Download.svg'}\" enabled=\"{= ${JM_DocTypeModel>/List}.length > 1 }\" class=\"cl_primaryButton\" press=\"fnMassDownload\" width=\"9rem\"></Button>\n\t\t\t\t\t\t<Button text=\"{i18n>AttachFile}\" icon=\"{= ${JM_ImageModel>/path} + 'Attachfile.svg'}\" class=\"cl_primaryButton cl_attachIconWidth\" press=\"fnAttachPress\" width=\"7rem\"></Button>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t</grid:Grid>\n\t\t\t<layoutData>\n\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t</layoutData>\n\t\t</VBox>\n\t</grid:Grid>\n\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\">\n\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t<Label text=\"{i18n>Comments}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t<layoutData>\n\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t</layoutData>\n\t\t\t</HBox>\n\t\t\t<grid:Grid class=\"cl_kd_grid\">\n\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t<TextArea id=\"id_textarea\" rows=\"3\" width=\"100%\" placeholder=\"{i18n>YourCommentsherePh}\" class=\"cl_init_textdatacomments\"></TextArea>\n\t\t\t\t\t<VBox id=\"id_commentbox\"></VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t</grid:Grid>\n\t\t\t<layoutData>\n\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t</layoutData>\n\t\t</VBox>\n\t</grid:Grid>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/ConfirmationExit.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\">\n\t<Dialog title=\"{i18n>ConfirmationDialog}\" showHeader=\"false\" class=\"cl_confirmationDialog sapUiSizeCompact\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{JM_Popup>/title}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<HBox width=\"100%\" justifyContent=\"Center\">\n\t\t\t<Text text=\"{JM_Popup>/text}\" class=\"sapUiSmallMargin cl_confirmationTxt\"></Text>\n\t\t</HBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{JM_Popup>/negativeButton}\" icon=\"{JM_Popup>/negativeIcon}\" class=\"cl_secondaryButton sapUiSmallMarginEnd\"\n\t\t\t\tpress=\"fnConfirmationFragmentClose\"/>\n\t\t\t<Button text=\"{JM_Popup>/positiveButton}\" icon=\"{JM_Popup>/positiveIcon}\" class=\"cl_primaryButton sapUiSmallMarginEnd\"\n\t\t\t\tpress=\"fnSubmitConfirmation\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/F4Help.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\">\n\t<Dialog title=\"{i18n>F4Dialog}\" class=\"cl_f4Help sapUiSizeCompact\" verticalScrolling=\"false\" afterClose=\"fnAfterCloseFragment\">\n\t\t<VBox class=\"sapUiSmallMargin cl_f4searchbox\" width=\"80%\" height=\"3rem\">\n\t\t\t<SearchField liveChange=\"fnValueSearch\" width=\"100%\" placeholder=\"{i18n>SearchHere}\" search=\"fnValueSearch\" class=\"cl_f4searchfield\"/>\n\t\t</VBox>\n\t\t<VBox class=\"cl_f4tableScroll\">\n\t\t\t<Table id=\"idMaterialTable\" items=\"{JM_F4Model>/rows}\" mode=\"None\" inset=\"false\" fixedLayout=\"false\" width=\"100%\"\n\t\t\t\tclass=\"sapUiResponsiveMargin cl_f4table\">\n\t\t\t\t<headerToolbar >\n\t\t\t\t\t<Toolbar visible=\"false\">\n\t\t\t\t\t\t<Title text=\"{i18n>F4Dialog}\" level=\"H2\"/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t</headerToolbar>\n\t\t\t\t<columns>\n\t\t\t\t\t<Column visible=\"{= !!${JM_F4Model>/labels/col1} }\">\n\t\t\t\t\t\t<Text text=\"{JM_F4Model>/labels/col1}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column visible=\"{= !!${JM_F4Model>/labels/col2} }\">\n\t\t\t\t\t\t<Text text=\"{JM_F4Model>/labels/col2}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column visible=\"{= !!${JM_F4Model>/labels/col3} }\">\n\t\t\t\t\t\t<Text text=\"{JM_F4Model>/labels/col3}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column visible=\"{= !!${JM_F4Model>/labels/col4} }\">\n\t\t\t\t\t\t<Text text=\"{JM_F4Model>/labels/col4}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t</columns>\n\t\t\t\t<items>\n\t\t\t\t\t<ColumnListItem type=\"Active\" press=\"fnF4Itempress\">\n\t\t\t\t\t\t<cells>\n\t\t\t\t\t\t\t<Text text=\"{JM_F4Model>col1}\" visible=\"{= !!${JM_F4Model>col1} }\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_F4Model>col2}\" visible=\"{= !!${JM_F4Model>col2} }\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_F4Model>col3}\" visible=\"{= !!${JM_F4Model>col3} }\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_F4Model>col4}\" visible=\"{= !!${JM_F4Model>col4} }\"/>\n\t\t\t\t\t\t</cells>\n\t\t\t\t\t</ColumnListItem>\n\t\t\t\t</items>\n\t\t\t</Table>\n\t\t</VBox>\n\t\t<endButton>\n\t\t\t<Button text=\"{i18n>Cancel}\" class=\"sapUiSizeCompact cl_f4table_change sapUiSmallMarginEnd\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" press=\"fnf4HelpCancel\"/>\n\t\t</endButton>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/ChangeLog.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog title=\"{i18n>ChangeLog}\" showHeader=\"false\" contentWidth=\"1000px\" class=\"cl_customize_Dialog sapUiSizeCompact\"\n\t\tafterClose=\"fnDupMsgFragClose\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>ChangeLogDetails}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<VBox class=\"sapUiSmallMarginBeginEnd sapUiSmallMarginBottom sapUiTinyMarginTop\">\n\t\t\t<uitable:Table rows=\"{JM_ChangeLog>/}\" visibleRowCount=\"7\" selectionMode=\"None\" class=\"cl_opr_Tbl\">\n\t\t\t\t<uitable:columns>\n\t\t\t\t\t<uitable:Column width=\"40%\" filterProperty=\"FieldName\" sortProperty=\"FieldName\">\n\t\t\t\t\t\t<Label text=\"{i18n>Field}\"/>\n\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t<Label text=\"{JM_ChangeLog>FieldName}\" tooltip=\"{JM_ChangeLog>FieldName}\" class=\"cl_table_label sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t<uitable:Column width=\"15%\" filterProperty=\"OldValue\" sortProperty=\"OldValue\">\n\t\t\t\t\t\t<Label text=\"{i18n>OldValue}\"/>\n\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t<Label text=\"{JM_ChangeLog>OldValue}\" tooltip=\"{JM_ChangeLog>FieldName}\" class=\"cl_table_label sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t<uitable:Column width=\"15%\" filterProperty=\"NewValue\" sortProperty=\"NewValue\">\n\t\t\t\t\t\t<Label text=\"{i18n>NewValue}\"/>\n\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t<Label text=\"{JM_ChangeLog>NewValue}\" tooltip=\"{JM_ChangeLog>NewValue}\" class=\"cl_table_label sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t<uitable:Column width=\"18%\" filterProperty=\"ProcessDesc\" sortProperty=\"ProcessDesc\">\n\t\t\t\t\t\t<Label text=\"{i18n>Process}\"/>\n\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t<Label text=\"{JM_ChangeLog>ProcessDesc}\" tooltip=\"{JM_ChangeLog>ProcessDesc}\" class=\"cl_table_label sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t<uitable:Column width=\"15%\" filterProperty=\"ChangedBy\" sortProperty=\"ChangedBy\">\n\t\t\t\t\t\t<Label text=\"{i18n>Changedby}\"/>\n\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t<Label text=\"{JM_ChangeLog>ChangedBy}\" tooltip=\"{JM_ChangeLog>ChangedBy}\" class=\"cl_table_label sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t</uitable:Column>\n\t\t\t\t</uitable:columns>\n\t\t\t</uitable:Table>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{i18n>ChangeDetails}\" icon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\" width=\"8.5rem\" class=\"cl_secondaryButton sapUiSmallMarginEnd\"\n\t\t\t\tpress=\"fnCloseChanLogDialog\"/>\n\t\t\t<Button text=\"{i18n>Proceed}\"  icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\" width=\"6rem\" visible=\"false\" class=\"cl_primaryButton sapUiSmallMarginEnd\"\n\t\t\t\tpress=\"fnCloseChanLogDialog\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/SucessDialog.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\">\n\t<Dialog title=\"Confirmation Dialog\" showHeader=\"false\" class=\"cl_confirmationSuccessDialog sapUiSizeCompact\">\n\t\t<!--<customHeader>-->\n\t\t<!--\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">-->\n\t\t<!--\t\t<Text text=\"Success\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>-->\n\t\t<!--\t</Toolbar>-->\n\t\t<!--</customHeader>-->\n\t\t<VBox width=\"100%\" justifyContent=\"Center\">\n\t\t\t<HBox justifyContent=\"Center\" class=\"sapUiTinyMarginTop\">\n\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Succes1.gif'}\" alt=\"Loading animation\" width=\"80px\" height=\"80px\"/>\n\t\t\t</HBox>\n\t\t\t<Text text=\"{JM_Popup>/text}\" class=\"sapUiSmallMargin cl_confirmationTxt\"></Text>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{JM_Popup>/positiveButton}\" icon=\"{JM_Popup>/positiveIcon}\" class=\"cl_primaryButton sapUiSmallMarginEnd\" press=\"fnRefresh\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/reci_operations.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog title=\"{i18n>OpeartionsDialog}\" showHeader=\"false\" class=\"cl_operation_Dialog sapUiSizeCompact\" afterClose=\"fnDupMsgFragClose\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.7rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>OperationDialogtitle}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<VBox class=\"sapUiSmallMargin\">\n\t\t\t<grid:Grid class=\"cl_search_grid\">\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>RecipeGroup}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t<VBox width=\"40%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_KeydataModel>/Plnnr}\" tooltip=\"{JM_KeydataModel>/Plnnr}\" editable=\"false\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\tmaxLength=\"4\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<VBox width=\"60%\">\n\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/ReciDes}\" tooltip=\"{JM_KeydataModel>/ReciDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<HBox width=\"100%\">\n\t\t\t\t\t<VBox width=\"50%\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t<Label text=\"{i18n>GrpCounter}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_KeydataModel>/Plnal}\" tooltip=\"{JM_KeydataModel>/Plnal}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t<Label text=\"{i18n>ControlKey}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_STEUS_F\" value=\"{JM_ReciOperationsDialog>/Steus}\" tooltip=\"{JM_ReciOperationsDialog>/Steus}\"\n\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= !${JM_ReciOperationsDialog>/Phflg}}\"></Input>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</HBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t<Input value=\"{JM_KeydataModel>/Werks}\" class=\"cl_inputField\" editable=\"false\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>StandardKeyText}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_ReciOperationsDialog>/Ktsch}\" editable=\"false\" maxLength=\"4\"></Input>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<HBox>\n\t\t\t\t\t<VBox width=\"25%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t<Label text=\"{i18n>Activity}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_ReciOperationsDialog>/Vornr}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<VBox width=\"75%\">\n\t\t\t\t\t\t<Label text=\"{i18n>Description}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t<Input class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Ltxa1}\" maxLength=\"40\"></Input>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</HBox>\n\t\t\t\t<HBox>\n\t\t\t\t\t<VBox width=\"50%\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t<Label text=\"{i18n>SupOperation}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t<Input value=\"{JM_ReciOperationsDialog>/Pvznr}\" class=\"cl_inputField\" editable=\"false\" maxLength=\"4\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t<Label text=\"{i18n>Phase}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperationsDialog>/Phflg}\" editable=\"false\" class=\"cl_opr_checkbx cl_checkbox\"></CheckBox>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</HBox>\n\t\t\t</grid:Grid>\n\t\t\t<VBox class=\"sapUiSmallMarginTop cl_item_headerBox\">\n\t\t\t\t<IconTabBar id=\"id_icontabbar\" selectedKey=\"ID_STD_VALUES\" class=\"cl_item_iconTab_Dialog\">\n\t\t\t\t\t<items>\n\t\t\t\t\t\t<IconTabFilter id=\"ID_GEN_VALUES\" text=\"General Data\">\n\t\t\t\t\t\t\t<VBox class=\"sapUiTinyMarginTop cl_item_scrollfrag\">\n\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\"sapUiTinyMarginTop sapUiTinyMarginBottom cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GeneralData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CostRel}\" id=\"ID_OPER_CKSELKZ_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"{JM_ReciOperationsDialog>/Phflg}\" showValueHelp=\"true\" id=\"ID_OPER_CKSELKZ_F\" liveChange=\"fnFragLivechange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Ckselkz}\" valueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" class=\"cl_inputDescField\" value=\"{JM_ReciOperationsDialog>/CkselkzDes}\" id=\"ID_OPER_CKSELKZ_F_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NumberOfTimeTickets}\" id=\"ID_OPER_LOANZ_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnNumberFieldValidationFrag\" id=\"ID_OPER_LOANZ_F\" type=\"Number\" maxLength=\"3\"\n\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Loanz}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Noofempl}\" class=\"cl_inputLabel\" id=\"ID_OPER_ANZMA_F_TXT\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnQuanDataElementValidation2DecFrag\" id=\"ID_OPER_ANZMA_F\" type=\"Number\" maxLength=\"5\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Anzma}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>WageType}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" maxLength=\"4\" value=\"{JM_ReciOperationsDialog>/Loart}\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>WageGroup}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" maxLength=\"3\" value=\"{JM_ReciOperationsDialog>/Logrp}\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NumberOfConfirmation}\" class=\"cl_inputLabel\" id=\"ID_OPER_RSANZ_F_TXT\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnNumberFieldValidationFrag\" id=\"ID_OPER_RSANZ_F\" type=\"Number\" maxLength=\"3\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Rsanz}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BusinessProcess}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" showValueHelp=\"true\" maxLength=\"12\" value=\"{JM_ReciOperationsDialog>/Prz01}\"\n\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" visible=\"{JM_ReciOperationsDialog>/Phflg}\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ExternalProcessing}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>InspectionType}\" id=\"ID_OPER_QPART_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_QPART_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Qpart}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"60%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" class=\"cl_inputDescField\" value=\"{JM_ReciOperationsDialog>/QpartDes}\" id=\"ID_OPER_QPART_F_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PurchasingInfoRec}\" id=\"ID_OPER_INFNR_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_INFNR_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Infnr}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PurchaseOrganization}\" id=\"ID_OPER_EKORG_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_EKORG_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Ekorg}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Subcontracting}\" id=\"ID_OPER_FRDLB_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<CheckBox class=\"cl_checkbox\" id=\"ID_OPER_FRDLB_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Frdlb}\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OutlineAgreement}\" id=\"ID_OPER_EBELN_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_EBELN_F\" liveChange=\"fnFragLivechange\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Ebeln}\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemOnlineAgreement}\" id=\"ID_OPER_EBELP_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"ID_OPER_EBELP_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Ebelp}\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnFragF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ShortTerm}\" class=\"cl_inputLabel\" id=\"ID_OPER_SORTL_F_TXT\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnFragLivechange\" id=\"ID_OPER_SORTL_F\" value=\"{JM_ReciOperationsDialog>/Sortl}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PlannedDeliveryTime}\" class=\"cl_inputLabel\" id=\"ID_OPER_PLIFZ_F_TXT\"></Label>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnFragLivechange\" id=\"ID_OPER_PLIFZ_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Plifz}\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBegin sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"Days\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialGroup}\" id=\"ID_OPER_MATKL_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_MATKL_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Matkl}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"60%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"ID_OPER_MATKL_F_DES\" value=\"{JM_ReciOperationsDialog>/MatklDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PurchasingGroup}\" id=\"ID_OPER_EKGRP_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_EKGRP_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Ekgrp}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"ID_OPER_EKGRP_F_DES\" value=\"{JM_ReciOperationsDialog>/EkgrpDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Vendor}\" id=\"ID_OPER_LIFNR_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" id=\"ID_OPER_LIFNR_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Lifnr}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" valueHelpRequest=\"fnFragF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" class=\"cl_inputDescField\" value=\"{JM_ReciOperationsDialog>/LifnrDes}\" id=\"ID_OPER_LIFNR_F_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PriceUnit}\" class=\"cl_inputLabel\" id=\"ID_OPER_PEINH_F_TXT\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" liveChange=\"fnFragLivechange\" id=\"ID_OPER_PEINH_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Peinh}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CostElement}\" id=\"ID_OPER_SAKTO_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"ID_OPER_SAKTO_F\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Sakto}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" showValueHelp=\"true\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputDescField\" id=\"ID_OPER_SAKTO_F_DES\" value=\"{JM_ReciOperationsDialog>/SaktoDes}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NetPrice}\" id=\"ID_OPER_PREIS_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"ID_OPER_PREIS_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnQuanDataElementValidation2DecFrag\" value=\"{JM_ReciOperationsDialog>/Preis}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Currency}\" id=\"ID_OPER_WAERS_F_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"ID_OPER_WAERS_F\" value=\"{JM_ReciOperationsDialog>/Waers}\" liveChange=\"fnFragLivechange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" showValueHelp=\"true\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputDescField\" id=\"ID_OPER_WAERS_F_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\" sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SetupFamily}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SetupTypeKey}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnFragLivechange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Rasch}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnFragLivechange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Rfgrp}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Key}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnFragLivechange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Rfsch}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\" sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Qulification}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SearchTerm}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_ReciOperationsDialog>/QlSearch}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ReleatedToCapacityCategory}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"ID_OPER_QLKAPAR_F\" value=\"{JM_ReciOperationsDialog>/Qlkapar}\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<RadioButtonGroup select=\"fnDocumentRadiolvl\" id=\"id_radioButton\" columns=\"3\" class=\"sapUiSmallMarginTop cl_radiobutton\">\n\t\t\t\t\t\t\t\t\t\t\t<RadioButton text=\"{i18n>RequirementsProfile}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_radiobutton\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Qsel1}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<RadioButton text=\"{i18n>Job}\" class=\"cl_radiobutton\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Qsel2}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<RadioButton text=\"{i18n>Postion}\" class=\"cl_radiobutton\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Qsel3}\"/>\n\t\t\t\t\t\t\t\t\t\t</RadioButtonGroup>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t\t<IconTabFilter id=\"ID_STD_VALUES\" text=\"Standard Values\">\n\t\t\t\t\t\t\t<VBox class=\"sapUiTinyMarginTop cl_item_scrollfrag\">\n\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\"sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>StandardValues}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BaseQuantity}\" id=\"ID_OPER_BMSCH_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperationsDialog>/Bmsch}\" id=\"ID_OPER_BMSCH_F\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"\n\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_ReciOperationsDialog>/Meinh}\" liveChange=\"fnFragLivechange\" showValueHelp=\"true\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChargeQuantity}\" id=\"ID_OPER_UMREZ_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperationsDialog>/Umrez}\" liveChange=\"fnNumberFieldValidationFrag\" id=\"ID_OPER_UMREZ_F\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\" maxLength=\"5\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_RecipeData>/Plnme}\" width=\"100%\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"20%\" class=\"sapUiSmallMarginBeginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Equalto}\" class=\"sapUiSmallMarginTop cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OperationQuantity}\" id=\"ID_OPER_UMREN_F_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperationsDialog>/Umren}\" id=\"ID_OPER_UMREN_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnNumberFieldValidationFrag\" class=\"cl_inputField\" maxLength=\"5\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_ReciOperationsDialog>/Meinh}\" editable=\"false\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Resource}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_ReciOperationsDialog>/Arbpl}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_KeydataModel>/Werks}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t<ScrollContainer width=\"100%\" height=\"260px\" horizontal=\"true\" vertical=\"false\" visible=\"{JM_ReciOperationsDialog>/Phflg}\" focusable=\"true\">\n\t\t\t\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBeginEnd sapUiTinyMarginTop\" visible=\"{JM_ReciOperationsDialog>/Phflg}\">\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Duration}\" width=\"12rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Unit}\" width=\"12rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" width=\"12rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl1} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl1}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW01_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw01}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Vge01}\" liveChange=\"fnFragLivechange\" showValueHelp=\"true\" id=\"ID_OPER_VGE01_F\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar01}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl2} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl2}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW02_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw02}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Vge02}\" liveChange=\"fnFragLivechange\" showValueHelp=\"true\" id=\"ID_OPER_VGE02_F\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar02}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl3} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl3}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW03_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw03}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_ReciOperationsDialog>/Vge03}\" liveChange=\"fnFragLivechange\" width=\"12rem\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"ID_OPER_VGE03_F\" valueHelpRequest=\"fnFragF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar03}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl4} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl4}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW04_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw04}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_ReciOperationsDialog>/Vge04}\" liveChange=\"fnFragLivechange\" id=\"ID_OPER_VGE04_F\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" width=\"12rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar04}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl5} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl5}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW05_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw05}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnFragLivechange\" value=\"{JM_ReciOperationsDialog>/Vge05}\" id=\"ID_OPER_VGE05_F\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" width=\"12rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar05}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{= !!${JM_ReciOperationsDialog>/Vgtl6} }\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciOperationsDialog>/Vgtl6}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" id=\"ID_OPER_VGW06_F\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ReciOperationsDialog>/Vgw06}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"12\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_ReciOperationsDialog>/Vge06}\" id=\"ID_OPER_VGE06_F\" liveChange=\"fnFragLivechange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnFragF4press\" width=\"12rem\" class=\"cl_inputField\" maxLength=\"4\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"12rem\" value=\"{JM_ReciOperationsDialog>/Lar06}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"FLEX. DURATION\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"12rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox class=\"cl_checkbox\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" selected=\"{JM_ReciOperationsDialog>/Ddehn}\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t</ScrollContainer>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t\t<IconTabFilter text=\"{i18n>UserFields}\">\n\t\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t\t<HBox width=\"100%\" height=\"1.7rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>FieldKey}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox class=\"sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Select id=\"id_userfield\" class=\"cl_s_selectVarient cl_combobox\" selectedKey=\"{JM_ReciOperationsDialog>/Slwid}\" change=\"fnUserFields\"\n\t\t\t\t\t\t\t\t\t\t\titems=\"{JM_UFModel>/}\">\n\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"{JM_UFModel>Key}\" text=\"{JM_UFModel>text}\"/>\n\t\t\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L6 M12 S12\" visible=\"{JM_UFTemplate>/Visible}\">\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginBeginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GeneralFields}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" defaultSpan=\"L12 M12 S12\">\n\t\t\t\t\t\t\t\t\t\t<ScrollContainer width=\"100%\" height=\"130px\" horizontal=\"true\" vertical=\"false\" focusable=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt0} }\" id=\"ID_OPER_SWRT0_F_TXT\" text=\"{JM_UFTextTemplate>/Swrt0}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"sapUiSmallMarginEnd cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt0} }\" value=\"{JM_ReciOperationsDialog>/Usr00}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"26rem\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt1} }\" id=\"ID_OPER_SWRT1_F_TXT\" text=\"{JM_UFTextTemplate>/Swrt1}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"sapUiSmallMarginEnd cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt1} }\" value=\"{JM_ReciOperationsDialog>/Usr01}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"26rem\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt2} }\" id=\"ID_OPER_SWRT2_F_TXT\" text=\"{JM_UFTextTemplate>/Swrt2}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"sapUiSmallMarginEnd cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt2} }\" value=\"{JM_ReciOperationsDialog>/Usr02}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"26rem\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt3} }\" id=\"ID_OPER_SWRT3_F_TXT\" text=\"{JM_UFTextTemplate>/Swrt3}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"sapUiSmallMarginEnd cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt3} }\" value=\"{JM_ReciOperationsDialog>/Usr03}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"26rem\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</ScrollContainer>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginBeginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NumericFields}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" defaultSpan=\"L12 M12 S12\">\n\t\t\t\t\t\t\t\t\t\t<ScrollContainer width=\"100%\" height=\"130px\" horizontal=\"true\" vertical=\"false\" focusable=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt4} }\" id=\"ID_OPER_USTEXT01\" text=\"{JM_UFTextTemplate>/Swrt4}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"19rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt4} }\" id=\"ID_OPER_USR04\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"13\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr04}\" width=\"19rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt4} }\" liveChange=\"fnFragLivechange\" id=\"ID_RECI_USE04\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Use04}\" width=\"7rem\" showValueHelp=\"true\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt5} }\" id=\"ID_OPER_USTEXT02\" text=\"{JM_UFTextTemplate>/Swrt5}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"19rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt5} }\" id=\"ID_OPER_USR05\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"13\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr05}\" width=\"19rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt5} }\" liveChange=\"fnFragLivechange\" id=\"ID_RECI_USE05\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Use05}\" width=\"7rem\" showValueHelp=\"true\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt6} }\" id=\"ID_OPER_USTEXT03\" text=\"{JM_UFTextTemplate>/Swrt6}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"19rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt6} }\" id=\"ID_OPER_USR06\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"13\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr06}\" width=\"19rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt6} }\" liveChange=\"fnFragLivechange\" id=\"ID_RECI_USE06\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Use06}\" width=\"7rem\" showValueHelp=\"true\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt7} }\" id=\"ID_OPER_USTEXT04\" text=\"{JM_UFTextTemplate>/Swrt7}\" width=\"10rem\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"19rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt7} }\" id=\"ID_OPER_USR07\" liveChange=\"fnQuanDataElementValidationFrag\" maxLength=\"13\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr07}\" width=\"19rem\" class=\"cl_inputField\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input visible=\"{= !!${JM_UFTextTemplate>/Swrt7} }\" liveChange=\"fnFragLivechange\" id=\"ID_RECI_USE07\" valueHelpRequest=\"fnFragF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Use07}\" width=\"7rem\" showValueHelp=\"true\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</ScrollContainer>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginBeginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DateTimes}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" defaultSpan=\"L12 M12 S12\">\n\t\t\t\t\t\t\t\t\t\t<ScrollContainer width=\"100%\" height=\"70px\" horizontal=\"true\" vertical=\"false\" focusable=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt8} }\" text=\"{JM_UFTextTemplate>/Swrt8}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--<DatePicker visible=\"{= !!${JM_UFTextTemplate>/Swrt8} }\" value=\"{JM_ReciOperationsDialog>/Usr08}\" width=\"26rem\" placeholder=\" \"-->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" change=\"fnDateRangevalidation\" class=\"cl_inputField\"/>-->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker visible=\"{= !!${JM_UFTextTemplate>/Swrt8} }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr08}\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" width=\"26rem\" placeholder=\" \" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt9} }\" text=\"{JM_UFTextTemplate>/Swrt9}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26rem\" class=\"sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--value=\"{JM_ReciOperationsDialog>/Usr09}\"-->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker visible=\"{= !!${JM_UFTextTemplate>/Swrt9} }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{JM_ReciOperationsDialog>/Usr09}\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" width=\"26rem\" placeholder=\" \" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t class=\"cl_inputField\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</ScrollContainer>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginBeginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CheckBox}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" defaultSpan=\"L12 M12 S12\">\n\t\t\t\t\t\t\t\t\t\t<ScrollContainer width=\"100%\" height=\"70px\" horizontal=\"true\" vertical=\"false\" focusable=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"1.7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt10} }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Usr10}\" class=\"cl_checkbox\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt10} }\" text=\"{JM_UFTextTemplate>/Swrt10}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" alignContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"1.7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" visible=\"{= !!${JM_UFTextTemplate>/Swrt11} }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselected=\"{JM_ReciOperationsDialog>/Usr11}\" class=\"cl_checkbox\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"7rem\" alignContent=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label visible=\"{= !!${JM_UFTextTemplate>/Swrt11} }\" text=\"{JM_UFTextTemplate>/Swrt11}\" width=\"10rem\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</ScrollContainer>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t</items>\n\t\t\t\t</IconTabBar>\n\t\t\t</VBox>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{i18n>Close}\" visible=\"{= ${JM_ContextModel>/Ind} === 'T' }\" icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" width=\"5.7rem\"\n\t\t\t\tclass=\"cl_secondaryButton sapUiSmallMarginEnd\" press=\"fnDialogClose\"/>\n\t\t\t<Button text=\"{i18n>Cancel}\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" width=\"5.7rem\"\n\t\t\t\tclass=\"cl_secondaryButton sapUiSmallMarginEnd\" press=\"fncloseDialog\"/>\n\t\t\t<Button text=\"{i18n>SaveandBack}\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" icon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" width=\"9rem\"\n\t\t\t\tclass=\"cl_primaryButton sapUiSmallMarginEnd\" press=\"fnNavtoOperaHeader\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/viewDetails.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:t=\"sap.ui.table\">\n\t<Dialog title=\"{i18n>MaterialDetails}\" class=\"cl_customize_Dialog sapUiSizeCompact\" stretch=\"false\" horizontalScrolling=\"false\"\n\t\tverticalScrolling=\"true\" contentWidth=\"600px\" contentHeight=\"auto\" draggable=\"false\" resizable=\"false\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>TransactionDetails}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<HBox justifyContent=\"Start\" class=\"sapUiSmallMarginBegin\" width=\"100%\"></HBox>\n\t\t<t:Table id=\"idMatDetailsTable\" rows=\"{oDetailModel>/}\" selectionMode=\"Single\" selectionBehavior=\"Row\" visibleRowCount=\"6\"\n\t\t\tclass=\" sapUiSmallMarginBeginEnd sapUiSmallMarginTopBottom cl_MatDetailTableDB\"></t:Table>\n\t\t<endButton>\n\t\t\t<Button text=\"Close\"   icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" class=\"cl_secondaryButton\" press=\"fnCancelDetails\"/>\n\t\t</endButton>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/OperationList.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\">\n\t<Dialog title=\"F4Dialog\" contentHeight=\"20rem\" class=\"cl_f4Help sapUiSizeCompact\" verticalScrolling=\"false\"\n\t\tafterClose=\"fnAfterCloseFragment\">\n\t\t<VBox class=\"cl_f4tableScroll\">\n\t\t\t<Table id=\"idOperationTable\" items=\"{JM_OperationsData>/NavRecipe_Operation}\" mode=\"None\" inset=\"false\" fixedLayout=\"false\" width=\"100%\"\n\t\t\t\tclass=\"sapUiResponsiveMargin cl_f4table\">\n\t\t\t\t<headerToolbar >\n\t\t\t\t\t<Toolbar visible=\"false\">\n\t\t\t\t\t\t<Title text=\"{i18n>F4Dialog}\" level=\"H2\"/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t</headerToolbar>\n\t\t\t\t<columns>\n\t\t\t\t\t<Column >\n\t\t\t\t\t\t<Text text=\"{i18n>Operation}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column >\n\t\t\t\t\t\t<Text text=\"{i18n>Phase}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column>\n\t\t\t\t\t\t<Text text=\"{i18n>SubOperation}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column >\n\t\t\t\t\t\t<Text text=\"{i18n>Resource}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column >\n\t\t\t\t\t\t<Text text=\"{i18n>Description}\"/>\n\t\t\t\t\t</Column>\n\t\t\t\t</columns>\n\t\t\t\t<items>\n\t\t\t\t\t<ColumnListItem type=\"Active\" press=\"fnOprItempress\">\n\t\t\t\t\t\t<cells>\n\t\t\t\t\t\t\t<Text text=\"{JM_OperationsData>Vornr}\"/>\n\t\t\t\t\t\t\t<CheckBox selected=\"{JM_OperationsData>Phflg}\" editable=\"false\" class=\"cl_opr_checkbx\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_OperationsData>Pvznr}\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_OperationsData>Arbpl}\"/>\n\t\t\t\t\t\t\t<Text text=\"{JM_OperationsData>Ltxa1}\"/>\n\t\t\t\t\t\t</cells>\n\t\t\t\t\t</ColumnListItem>\n\t\t\t\t</items>\n\t\t\t</Table>\n\t\t</VBox>\n\t\t<endButton>\n\t\t\t<Button text=\"{i18n>Cancel}\" class=\"sapUiSizeCompact cl_f4table_change sapUiSmallMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\"\n\t\t\t\tpress=\"fnOperCancel\"/>\n\t\t</endButton>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/SendBack.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:l=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog title=\"Send Back\" class=\"cl_Dup_Sendback_Dialog sapUiSizeCompact\" contentWidth=\"900px\" verticalScrolling=\"false\" horizontalScrolling=\"false\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>SendBack}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<HBox width=\"97%\" justifyContent=\"End\" class=\"sapUiSmallMarginEnd sapUiSmallMarginTop\">\n\t\t\t<Label text=\"{JM_MinApproverModel>/LabelText}\"/>\n\t\t</HBox>\n\t\t<HBox>\n\t\t\t<VBox width=\"25%\">\n\t\t\t\t<uitable:Table id=\"idLevelTable\" rows=\"{JM_LevelModel>/LevelData}\"\n\t\t\t\t\tclass=\"sapUiSmallMarginBottom sapUiSmallMarginBegin sapUiSmallMarginEnd cl_opr_Tbl\" selectionMode=\"Single\"\n\t\t\t\t\trowSelectionChange=\"onLevelSelect\">\n\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t<Label text=\"Level\"/>\n\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t<Text text=\"{ path: 'JM_LevelModel>Level', formatter: 'MANAGED_RECIPE.Formatter.formatter.formatLevelText' }\" class=\"sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t</uitable:columns>\n\t\t\t\t</uitable:Table>\n\t\t\t</VBox>\n\t\t\t<VBox width=\"85%\">\n\t\t\t\t<uitable:Table id=\"idAgentTable\" rows=\"{JM_AgentModel>/Agents}\"\n\t\t\t\t\tclass=\"sapUiSmallMarginBottom sapUiSmallMarginBegin sapUiSmallMarginEnd cl_opr_Tbl\" selectionMode=\"None\">\n\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t<uitable:Column width=\"2%\">\n\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t<Image src=\"{JM_AgentModel>indicator}\" tooltip=\"{i18n>Inidcator}\" class=\"sapUiSmallMarginBegin\" width=\"1.2rem\" height=\"1.2rem\"/>\n\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t<uitable:Column width=\"39%\">\n\t\t\t\t\t\t\t<Label text=\"Agent\"/>\n\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t<Text text=\"{JM_AgentModel>Agent}\" class=\"sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t<uitable:Column width=\"39%\">\n\t\t\t\t\t\t\t<Label text=\"Agent Name\"/>\n\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t<Text text=\"{JM_AgentModel>AgentName}\" class=\"sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t<uitable:Column width=\"20%\">\n\t\t\t\t\t\t\t<Label text=\"CheckBox\"/>\n\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_AgentModel>checkboxstate}\" class=\"sapUiTinyMarginBegin\" enabled=\"{JM_AgentModel>checkboxEditable}\"/>\n\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t</uitable:columns>\n\t\t\t\t</uitable:Table>\n\t\t\t</VBox>\n\t\t</HBox>\n\t\t<buttons>\n\t\t\t<Button text=\"Close\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" class=\"cl_secondaryButton sapUiSmallMarginEnd\" press=\"onSendBackClose\"/>\n\t\t\t<Button text=\"Send Back\"  icon=\"{= ${JM_ImageModel>/path} + 'SendBackW.svg'}\" class=\"cl_primaryButton sapUiSmallMarginEnd\" press=\"fnsendBack\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/reci_keydata.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\" class=\"sapUiTinyMarginTop\">\n\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom\">\n\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t<Label text=\"{i18n>Keydata}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t<layoutData>\n\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t</layoutData>\n\t\t\t</HBox>\n\t\t\t<grid:Grid class=\"cl_kd_grid\">\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>Material}\" id=\"KID_RECI_MATNR_TXT\" required=\"true\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeyData>/Matnr}\" editable=\"{= ${JM_KeyData>/AppId} === 'RX' ? false : true }\"\n\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\" id=\"KID_RECI_MATNR\" showValueHelp=\"true\" maxLength=\"18\"\n\t\t\t\t\t\t\tsubmit=\"fnValidateMaterialPlant\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>MaterialDesc}\" id=\"KID_RECI_MAKTX_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeyData>/Maktx}\" id=\"KID_RECI_MATNR_DES\" editable=\"false\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>Plant}\" required=\"true\" id=\"KID_RECI_WERKS_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_KeyData>/Werks}\" editable=\"{= ${JM_KeyData>/AppId} === 'RX' ? false : true }\"\n\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnPlantF4press\" valueHelpOnly=\"true\" liveChange=\"fnLiveChange\" id=\"KID_RECI_WERKS\" class=\"cl_inputField\" \n\t\t\t\t\t\t\t\tmaxLength=\"4\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t<Input width=\"100%\" id=\"KID_RECI_WERKS_DES\" value=\"{JM_KeyData>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>Profile}\" required=\"true\" id=\"KID_RECI_PROFID_STD_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t<VBox width=\"40%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t<Input valueHelpRequest=\"fnF4press\" value=\"{JM_KeyData>/Profile}\" editable=\"{= ${JM_KeyData>/AppId} === 'RX' ? false : true }\"\n\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" id=\"KID_RECI_PROFID_STD\" class=\"cl_inputField\" maxLength=\"7\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<VBox width=\"60%\">\n\t\t\t\t\t\t\t<Input id=\"KID_RECI_PROFID_STD_DES\" value=\"{JM_KeyData>/ProfileDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>RecipeDesc}\" required=\"true\" id=\"KID_RECI_RECIDES_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t<Input id=\"KID_RECI_RECIDES\" value=\"{JM_KeyData>/ReciDes}\" editable=\"{= ${JM_KeyData>/AppId} === 'RX' ? false : true }\"\n\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" class=\"cl_inputField\" maxLength=\"40\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t</grid:Grid>\n\t\t\t<layoutData>\n\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t</layoutData>\n\t\t</VBox>\n\t</grid:Grid>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/create_varient.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog showHeader=\"false\" title = \"{i18n>CreateVarient}\" class=\"cl_customize_Dialog sapUiSizeCompact\" contentWidth=\"10rem\" \n\t\t\tverticalScrolling=\"false\" contentHeight=\"auto\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>CreateVarient}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<Toolbar class=\"sapUiTinyMargin cl_bordertool\">\n\t\t\t<SearchField placeholder=\"{i18n>SearchHere}\" liveChange=\"fnColumnFilter\" class=\"cl_varsearch\"/>\n\t\t\t<Button  icon=\"{= ${JM_ImageModel>/path} + 'Plus.svg'}\" tooltip=\"{i18n>addRow}\" press=\"fnAddVariant\" class=\"cl_item_Add_Dialog\"/>\n\t\t\t<Button  icon=\"{= ${JM_ImageModel>/path} + 'Delete.svg'}\" tooltip=\"{i18n>deleteRow}\" press=\"fnDeleteVariant\" class=\"cl_item_Delete_Dialog\"/>\n\t\t</Toolbar>\n\t\t<uitable:Table rows=\"{JMVaraint>/}\" id=\"id_variantTab\" visibleRowCountMode=\"Fixed\" visibleRowCount=\"4\" selectionMode=\"Single\"\n\t\t\tclass=\"cl_opr_Tbl sapUiTinyMargin\">\n\t\t\t<uitable:columns>\n\t\t\t\t<uitable:Column tooltip=\"{i18n>VariantName}\">\n\t\t\t\t\t<Text text=\"{i18n>VariantName}\"/>\n\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t<Input liveChange=\"fnVarintComparsion\" editable=\"{JMVaraint>New}\" value=\"{JMVaraint>VarintName}\" class=\"cl_opr_tableInput\" maxLength=\"40\"/>\n\t\t\t\t\t</uitable:template >\n\t\t\t\t</uitable:Column>\n\t\t\t\t<uitable:Column tooltip=\"{i18n>CreatedBy}\">\n\t\t\t\t\t<Text text=\"{i18n>CreatedBy}\"/>\n\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t<Label text =\"{JM_UserModel>/0/Uname}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t</uitable:template>\n\t\t\t\t</uitable:Column>\n\t\t\t</uitable:columns>\n\t\t</uitable:Table>\n\t\t<buttons>\n\t\t\t<Button text=\"Cancel\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" width=\"5rem\" class=\"cl_secondaryButton sapUiSmallMarginEnd\" press=\"fnCancelVariant\"/>\n\t\t\t<Button text=\"Save\" icon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" width=\"4.2rem\" class=\"cl_primaryButton sapUiSmallMarginEnd\" press=\"fnSaveVariant\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/reci_duplicate.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog title=\"{i18n>DuplicateRecipe}\" showHeader=\"false\" class=\"cl_Dup_Sendback_Dialog sapUiSizeCompact\" afterClose=\"fnDupMsgFragClose\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_DialogToolbar\" height=\"2.5rem\">\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{i18n>DuplicateRecipe}\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<VBox class=\"sapUiSmallMarginTop\">\n\t\t\t<grid:Grid>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>MaterialCode}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t<Input class=\"cl_inputField\" value = \"{JM_KeyData>/Matnr}\" editable=\"false\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>MaterialDesc}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t<Input class=\"cl_inputField\" value = \"{JM_KeyData>/Maktx}\" editable=\"false\"></Input>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox>\n\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t<Input value = \"{JM_KeyData>/Werks}\" editable=\"false\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t<Input width=\"100%\" class=\"cl_inputDescField\" value = \"{JM_KeyData>/WerksDes}\" editable=\"false\"></Input>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t\t<VBox class=\"cl_reci_dupDialog_tableBox sapUiTinyMarginTopBottom\">\n\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiSmallMarginBeginEnd sapUiTinyMarginTopBottom \">\n\t\t\t\t\t\t<Label text=\"{i18n>TotalNumberofRecords}\" class=\"sapUiTinyMarginBegin cl_tableHeaderTxt\"></Label>\n\t\t\t\t\t\t<Label text = \"{JM_ReciDuplicate>/length}\" class=\"sapUiTinyMarginBegin cl_tableHeaderCntTxt\"></Label>\n\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<uitable:Table rows=\"{JM_ReciDuplicate>/Duplicate}\" visibleRowCount=\"9\" selectionMode=\"Single\"\n\t\t\t\t\t\tclass=\"cl_opr_Tbl sapUiSmallMarginBeginEnd sapUiSmallMarginBottom sapUiTinyMarginTop\">\n\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t<uitable:Column width = \"5rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Plnnr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"4rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>GrC}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Plnal}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>GroupDescription}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Ktext}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"4rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Status}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Statu}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"4rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Usage}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Verwe}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"4rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Werks}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"7rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>BaseQuantity}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Bmsch}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"6rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ProdVrsn}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Verid}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"6rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>LSizeFrom}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Losvn}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"6rem\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>LSizeTo}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ReciDuplicate>Losbs}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t<uitable:Column width = \"6rem\">\n\t\t\t\t\t\t\t\t<Label  text=\"{i18n>ValidFrom}\"/>\n\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t<Label  text=\"{path: 'JM_ReciDuplicate>Datuv', formatter: '.formatter.fnDateFormater'}\"  class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t</layoutData>\n\t\t\t\t</VBox>\n\t\t\t</grid:Grid>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{i18n>Cancel}\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" width=\"5.5rem\" class=\"cl_secondaryButton sapUiSmallMarginEnd\" press=\"fncloseDialog\"/>\n\t\t\t<Button text=\"{i18n>IgnoreandContinue}\" id = \"id_dupSubmit\" icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\" width=\"11.5rem\" class=\"cl_primaryButton sapUiSmallMarginEnd\" press=\"fnNavInitiator\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/Itemlevel.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<Dialog title=\"Partner Function\" showHeader=\"false\" class=\"cl_bomitem_Dialog sapUiSizeCompact\" afterClose=\"fnDupMsgFragClose\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_item_Toolbar_Dlg\" height=\"2.5rem\">\n\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Previous.svg'}\" alt=\"{i18n>Previous}\" width=\"25px\" tooltip=\"Previous\" press=\"fnPreviousItem\"\n\t\t\t\t\tclass=\"cl_ImageFocusremove\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Text text=\"{JM_CommonModel>/message}\" id=\"id_itemNumber\" class=\"cl_DialogToolbarTitle sapUiTinyMarginTopBottom\"/>\n\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Next.svg'}\" alt=\"{i18n>Next}\" width=\"25px\" tooltip=\"Next\" press=\"fnNextItem\"\n\t\t\t\t\tclass=\"cl_ImageFocusremove\"/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<VBox class=\"sapUiSmallMarginBeginEnd sapUiSmallMarginTop cl_bomitem_headerBox\" height=\"80%\">\n\t\t\t<IconTabBar id=\"id_icontabbar\" headerMode=\"Inline\" select=\"onTabSelect\" class=\"cl_item_iconTab_Dlg cl_item_iconTab_Dialog\">\n\t\t\t\t<items>\n\t\t\t\t\t<IconTabFilter text=\"{i18n>BasicData}\">\n\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>QuantityData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OperationScrap}\" id=\"ID_BOM_AVOAU_TXT\" tooltip=\"{i18n>OperationScrap}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AVOAU\" value=\"{JM_BOMTable>Avoau}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{JM_BOMTable>Avoau}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" type=\"Number\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ComponentScrap}\" id=\"ID_BOM_AUSCH_TXT\" tooltip=\"{i18n>ComponentScrap}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AUSCH\" value=\"{JM_BOMTable>Ausch}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{JM_BOMTable>Ausch}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" type=\"Number\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>FixedQuantity}\" id=\"ID_BOM_FMENG_TXT\" tooltip=\"{i18n>FixedQuantity}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_FMENG\" select=\"fnCheckBoxLiveChange\" selected=\"{JM_BOMTable>Fmeng}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NetIndicator}\" id=\"ID_BOM_NETAU_TXT\" tooltip=\"{i18n>NetIndicator}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_NETAU\" select=\"fnCheckBoxLiveChange\" selected=\"{JM_BOMTable>Netau}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GeneralData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AlternateItemGroup}\" id=\"ID_BOM_ALPGR_TXT\" tooltip=\"{i18n>AlternateItemGroup}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ALPGR\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" value=\"{JM_BOMTable>Alpgr}\"\n\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{JM_BOMTable>Alpgr}\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Referencepoint}\" id=\"ID_BOM_RFPNT_TXT\" tooltip=\"{i18n>Referencepoint}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_RFPNT\" value=\"{JM_BOMTable>Rfpnt}\" class=\"cl_inputField\" showValueHelp=\"true\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" tooltip=\"{JM_BOMTable>Rfpnt}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RecAllowed}\" id=\"ID_BOM_REKRS_TXT\" tooltip=\"{i18n>RecAllowedDes}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_REKRS\" selected=\"{JM_BOMTable>Rekrs}\" select=\"fnCheckBoxLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Recursive}\" id=\"ID_BOM_REKRI_TXT\" tooltip=\"{i18n>Recursive}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_REKRI\" selected=\"{JM_BOMTable>Rekri}\" select=\"fnCheckBoxLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CADIndicator}\" id=\"ID_BOM_CADPO_TXT\" tooltip=\"{i18n>CADIndicator}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_CADPO\" selected=\"{JM_BOMTable>Cadpo}\" select=\"fnCheckBoxLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ALEIndicator}\" id=\"ID_BOM_ALEKZ_TXT\" tooltip=\"{i18n>ALEIndicator}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_ALEKZ\" selected=\"{JM_BOMTable>Alekz}\" select=\"fnCheckBoxLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CoProduct}\" id=\"ID_BOM_KZKUP_TXT\" tooltip=\"{i18n>CoProduct}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_KZKUP\" select=\"fnCheckBoxLiveChange\" selected=\"{JM_BOMTable>Kzkup}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\" sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MRPData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>LeadOffset}\" id=\"ID_BOM_NLFZT_TXT\" tooltip=\"{i18n>LeadOffset}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_NLFZT\" value=\"{JM_BOMTable>Nlfzt}\" tooltip=\"{JM_BOMTable>Nlfzt}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" type=\"Number\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Oproffset}\" id=\"ID_BOM_NLFZV_TXT\" tooltip=\"{i18n>OproffsetDes}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_NLFZV\" value=\"{JM_BOMTable>Nlfzv}\" tooltip=\"{JM_BOMTable>Nlfzv}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" type=\"Number\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_NLFMV\" value=\"{JM_BOMTable>Nlfmv}\" tooltip=\"{JM_BOMTable>Nlfmv}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\" valueHelpRequest=\"fnF4press\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_NLFMV_DES\" class=\"cl_inputDescField\" value=\"{JM_BOMTable>NlfmvDes}\" tooltip=\"{JM_BOMTable>NlfmvDes}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DistributionKey}\" id=\"ID_BOM_VERTI_TXT\" tooltip=\"{i18n>DistributionKey}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_VERTI\" value=\"{JM_BOMTable>Verti}\" tooltip=\"{JM_BOMTable>Verti}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_VERTI_DES\" class=\"cl_inputDescField\" value=\"{JM_BOMTable>VertiDes}\" tooltip=\"{JM_BOMTable>VertiDes}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Explosiontype}\" id=\"ID_BOM_DSPST_TXT\" tooltip=\"{i18n>Explosiontype}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_DSPST\" value=\"{JM_BOMTable>Dspst}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" tooltip=\"{JM_BOMTable>Dspst}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_DSPST_DES\" value=\"{JM_BOMTable>DspstDes}\" tooltip=\"{JM_BOMTable>DspstDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SpecialProcurement}\" id=\"ID_BOM_ITSOB_TXT\" tooltip=\"{i18n>SpecialProcurement}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ITSOB\" value=\"{JM_BOMTable>Itsob}\" tooltip=\"{JM_BOMTable>Itsob}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ITSOB_DES\" value=\"{JM_BOMTable>ItsobDes}\" tooltip=\"{JM_BOMTable>ItsobDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PhantomType}\" id=\"ID_BOM_DUMPS_TXT\" tooltip=\"{i18n>PhantomType}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_DUMPS\" selected=\"{JM_BOMTable>Dumps}\" select=\"fnCheckBoxLiveChange\" editable=\"false\" enabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t<IconTabFilter text=\"{i18n>StatusLongText}\">\n\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemText}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Line1}\" id=\"ID_BOM_POTX1_TXT\" tooltip=\"{i18n>Line1}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_POTX1\" value=\"{JM_BOMTable>Potx1}\" tooltip=\"{JM_BOMTable>Potx1}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Line2}\" id=\"ID_BOM_POTX2_TXT\" tooltip=\"{i18n>Line2}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_POTX2\" value=\"{JM_BOMTable>Potx2}\" tooltip=\"{JM_BOMTable>Potx2}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemStatus}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SparePartIndicator}\" id=\"ID_BOM_ERSKZ_TXT\" tooltip=\"{i18n>SparePartIndicator}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ERSKZ\" value=\"{JM_BOMTable>Erskz}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{JM_BOMTable>Erskz}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ERSKZ_DES\" value=\"{JM_BOMTable>ErskzDes}\" tooltip=\"{JM_BOMTable>ErskzDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>CostingRelevancy}\" id=\"ID_BOM_SANKA_TXT\" tooltip=\"{i18n>CostingRelevancy}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_SANKA\" value=\"{JM_BOMTable>Sanka}\" class=\"cl_inputField\" showValueHelp=\"true\" valueHelpRequest=\"fnF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{JM_BOMTable>Sanka}\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_SANKA_DES\" value=\"{JM_BOMTable>SankaDes}\" tooltip=\"{JM_BOMTable>SankaDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RelevantSales}\" id=\"ID_BOM_RVREL_TXT\" tooltip=\"{i18n>RelevantSales}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_RVREL\" value=\"{JM_BOMTable>Rvrel}\" tooltip=\"{JM_BOMTable>Rvrel}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\teditable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Engineering}\" id=\"ID_BOM_SANKO_TXT\" tooltip=\"{i18n>Engineering}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_SANKO\" selected=\"{JM_BOMTable>Sanko}\" select=\"fnCheckBoxLiveChange\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PlantMaintenance}\" id=\"ID_BOM_SANIN_TXT\" tooltip=\"{i18n>PlantMaintenance}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_SANIN\" selected=\"{JM_BOMTable>Sanin}\" select=\"fnCheckBoxLiveChange\" editable=\"false\" enabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ProductRelevent}\" id=\"ID_BOM_SANFE_TXT\" tooltip=\"{i18n>ProductRelevent}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_SANFE\" selected=\"{JM_BOMTable>Sanfe}\" editable=\"false\" enabled=\"false\" select=\"fnCheckBoxLiveChange\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_checkbx\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AdditionalData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialProvision}\" id=\"ID_BOM_BEIKZ_TXT\" tooltip=\"{i18n>MaterialProvision}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_BEIKZ\" value=\"{JM_BOMTable>Beikz}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" tooltip=\"{JM_BOMTable>Beikz}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_BEIKZ_DES\" value=\"{JM_BOMTable>BeikzDes}\" tooltip=\"{JM_BOMTable>BeikzDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ProductionStorageLoc}\" id=\"ID_BOM_LGORT_TXT\" tooltip=\"{i18n>ProductionStorageLocDes}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LGORT\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" value=\"{JM_BOMTable>Lgort}\" tooltip=\"{JM_BOMTable>Lgort}\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LGORT_DES\" value=\"{JM_BOMTable>LgortDes}\" tooltip=\"{JM_BOMTable>LgortDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SupplyArea}\" id=\"ID_BOM_PRVBE_TXT\" tooltip=\"{i18n>SupplyArea}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_PRVBE\" value=\"{JM_BOMTable>Prvbe}\" tooltip=\"{JM_BOMTable>Prvbe}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_PRVBE_DES\" value=\"{JM_BOMTable>PrvbeDes}\" tooltip=\"{JM_BOMTable>PrvbeDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BulkMaterial}\" id=\"ID_BOM_SCHGT_TXT\" tooltip=\"{i18n>BulkMaterial}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_SCHGT\" selected=\"{JM_BOMTable>Schgt}\" select=\"fnCheckBoxLiveChange\" class=\"cl_opr_checkbx\"\n\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L1 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BlkMatIndMatMst}\" id=\"ID_BOM_SCHKZ_TXT\" tooltip=\"{i18n>BlkMatIndMatMstDes}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_BOM_SCHKZ\" selected=\"{JM_BOMTable>Schkz}\" select=\"fnCheckBoxLiveChange\" class=\"cl_opr_checkbx\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\tenabled=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M6 S6\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t<IconTabFilter text=\"{i18n>Administration}\">\n\t\t\t\t\t\t<grid:Grid class=\"cl_item_gridRemovePadding\">\n\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiTinyMarginBottom sapUiTinyMarginTop cl_subheading\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>AdminstrativeData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeNumber}\" id=\"ID_BOM_AENNR_TXT\" tooltip=\"{i18n>ChangeNumber}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AENNR\" value=\"{JM_BOMTable>Aennr}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ToChangeNumber}\" id=\"ID_BOM_AENRA_TXT\" tooltip=\"{i18n>ToChangeNumber}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AENRA\" value=\"{JM_BOMTable>Aenra}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidFrom}\" tooltip=\"{i18n>ValidFrom}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Datuv',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\" class=\" cl_inputField cl_customDatePicker\"\n\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Datuv',formatter: '.formatter.fnDateFormater' }\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidTo}\" tooltip=\"{i18n>ValidTo}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Datub',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\" class=\"cl_inputField cl_customDatePicker\"\n\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Datub',formatter: '.formatter.fnDateFormater' }\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>CreatedOn}\" tooltip=\"{i18n>CreatedOn}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Andat',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\" class=\"cl_inputField cl_customDatePicker\"\n\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Andat',formatter: '.formatter.fnDateFormater' }\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>CreatedBy}\" tooltip=\"{i18n>CreatedBy}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Annam}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangedOn}\" tooltip=\"{i18n>ChangedOn}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Aedat',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" change=\"fnDateRangevalidation\" class=\"cl_inputField cl_customDatePicker\"\n\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Aedat',formatter: '.formatter.fnDateFormater' }\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangedBy}\" tooltip=\"{i18n>ChangedBy}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Aenam}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t</IconTabFilter>\n\t\t\t\t\t<IconTabFilter text=\"{i18n>DocumentAssignment}\">\n\t\t\t\t\t\t<RadioButtonGroup select=\"fnDocumentRadiolvl\" id=\"id_radioButton\" columns=\"2\"\n\t\t\t\t\t\t\tclass=\"cl_radiobutton sapUiTinyMarginTop sapUiSmallMarginBegin\">\n\t\t\t\t\t\t\t<RadioButton id=\"id_currVersion\" text=\"Current Version\" class=\"cl_radiobutton\"/>\n\t\t\t\t\t\t\t<RadioButton id=\"id_allVersion\" text=\"All Version\" class=\"cl_radiobutton\" selected=\"true\"/>\n\t\t\t\t\t\t</RadioButtonGroup>\n\t\t\t\t\t\t<VBox id=\"id_documentTable\">\n\t\t\t\t\t\t\t<HBox height=\"1.5rem\" class=\"sapUiSmallMarginBeginEnd sapUiTinyMarginBottom \" justifyContent=\"SpaceBetween\">\n\t\t\t\t\t\t\t\t<Label text=\"{i18n>LinkedDocuments}\" class=\"sapUiTinyMarginBegin cl_tableHeaderTxt\"></Label>\n\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t<Image class=\"cl_pv_removeImgFocus cl_imagePos sapUiSmallMarginEnd\" width=\"1.6rem\" press=\"fnAddRow\" tooltip=\"{i18n>Add}\"\n\t\t\t\t\t\t\t\t\t\tsrc=\"{= ${JM_ImageModel>/path} + 'PlusBtn.svg'}\"/>\n\t\t\t\t\t\t\t\t\t<Image class=\"cl_pv_removeImgFocus cl_imagePos sapUiSmallMarginEnd\" width=\"1.6rem\" press=\"fnDeleteRow\" tooltip=\"{i18n>Delete}\"\n\t\t\t\t\t\t\t\t\t\tsrc=\"{= ${JM_ImageModel>/path} + 'DeleteBtn.svg'}\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBeginEnd sapUiSmallMarginBottom sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t<uitable:Table id=\"idDynamicUITable\" rows=\"{JM_DocumentModel>/DocumentList}\" visibleRowCount=\"4\" selectionMode=\"Single\" class=\"cl_opr_Tbl\">\n\t\t\t\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DocumentType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_DocumentModel>DocType}\" showValueHelp=\"true\" class=\"cl_bom_tableInput\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Document}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_DocumentModel>Document}\" showValueHelp=\"true\" class=\"cl_bom_tableInput\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DocumentVersion}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_DocumentModel>Document}\" editable=\"false\" class=\"cl_bom_tableInput\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DocumentPart}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_DocumentModel>Document}\" editable=\"false\" class=\"cl_bom_tableInput\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</IconTabFilter>\n\t\t\t\t</items>\n\t\t\t</IconTabBar>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{i18n>Continue}\" tooltip=\"{i18n>Continue}\" class=\"sapUiSizeCompact cl_primaryButton sapUiSmallMarginEnd\"\n\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Apply.svg'}\" press=\"fnItemSubmit\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/customize_table.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\" xmlns:t=\"sap.ui.table\">\n\t<Dialog showHeader=\"false\" title=\"{i18n>CustomizeTable}\" class=\"cl_customize_Dialog sapUiSizeCompact\" contentWidth=\"10rem\"\n\t\tverticalScrolling=\"false\" contentHeight=\"auto\">\n\t\t<customHeader>\n\t\t\t<Toolbar class=\"cl_customize_Toolbar_Dialog\" height=\"2.5rem\">\n\t\t\t\t<Text text=\"{i18n>CustomizeColumns}\" class=\"sapUiTinyMarginBegin\"/>\n\t\t\t</Toolbar>\n\t\t</customHeader>\n\t\t<Toolbar class=\"sapUiTinyMargin cl_bordertool\">\n\t\t\t<Input placeholder=\"{i18n>SearchHere}\" liveChange=\"fnColumnFilter\" class=\"cl_inputField \"/>\n\t\t</Toolbar>\n\t\t<VBox class=\"cl_customize_dialog_scroll\">\n\t\t\t<Toolbar class=\"cl_bordertool cl_list_col sapUiSmallMarginBegin sapUiTinyMarginEnd\">\n\t\t\t\t<CheckBox id=\"id_checkselect\" class=\"cl_checkboxSel\" select=\"fnCheckSelAll\"/>\n\t\t\t\t<Text text=\"{i18n>SelectAll}\" class=\"cl_columnTextBold\"/>\n\t\t\t</Toolbar>\n\t\t\t<List id=\"id_columnSel\" items=\"{JMColumn>/}\" class=\"sapUiTinyMarginBottom\">\n\t\t\t\t<CustomListItem class=\"cl_list_act sapUiTinyMarginTop sapUiSmallMarginBegin sapUiTinyMarginEnd\">\n\t\t\t\t\t<Toolbar class=\"cl_bordertool cl_list_col \">\n\t\t\t\t\t\t<CheckBox selected=\"{JMColumn>Visible}\" class=\"cl_checkbox\" select=\"fnCheckSel\"/>\n\t\t\t\t\t\t<Text text=\"{JMColumn>CName}\" class=\"cl_columnText\"/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t</CustomListItem>\n\t\t\t</List>\n\t\t</VBox>\n\t\t<buttons>\n\t\t\t<Button text=\"{i18n>Cancel}\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" class=\"sapUiTinyMarginBottomTop cl_secondaryButton\" press=\"fnCancel\"/>\n\t\t\t<Button text=\"{i18n>Apply}\"  icon=\"{= ${JM_ImageModel>/path} + 'Apply.svg'}\" class=\"sapUiTinyMarginBottomTop cl_primaryButton\" press=\"fnApplyCustomizeColumn\"/>\n\t\t</buttons>\n\t</Dialog>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/Fragment/NavigationBar.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:core=\"sap.ui.core\">\n\t<VBox alignContent=\"Center\" height=\"100%\" alignItems=\"Center\" class=\"cl_customSidebar\">\n\t\t<!-- Header Logo -->\n\t\t<Toolbar class=\"cl_logobox\" height=\"2.4rem\">\n\t\t\t<HBox alignContent=\"Center\" alignItems=\"End\" class=\"cl_logoCollapsed\" visible=\"true\">\n\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'MDSLogo.svg'}\" class=\"sapUiTinyMarginTop sapUiTinyMarginBottom\" tooltip=\"{i18n>MDS}\"\n\t\t\t\t\twidth=\"1.9rem\"/>\n\t\t\t</HBox>\n\t\t\t<HBox alignContent=\"Center\" class=\"cl_headLogo_expand\" visible=\"true\">\n\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'MDSLogoBG.svg'}\" width=\"12rem\" tooltip=\"{i18n>MDS}\"\n\t\t\t\t\tclass=\"sapUiTinyMarginTop sapUiTinyMarginBottom\"/>\n\t\t\t</HBox>\n\t\t</Toolbar>\n\t\t<HBox height=\"65%\" class=\"cl_tab cl_list_sm\" width=\"100%\">\n\t\t\t<List mode=\"None\" width=\"100%\" class=\" cl_navbar\">\n\t\t\t\t<CustomListItem selected=\"false\" class=\"cl_customlist\">\n\t\t\t\t\t<!-- Dashboard -->\n\t\t\t\t\t<HBox id=\"id_dashBoard_h\" class=\"sapUiTinyMarginBegin cl_listhighlight sapUiTinyMarginTop cl_sidebarItem\">\n\t\t\t\t\t\t<Toolbar id=\"id_dashboard\" active=\"true\" class=\"sapUiTinyMarginEnd\" press=\"fnNavigateToView\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Dashboard.svg'}\" tooltip=\"{i18n>Dashboard}\"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>Dashboard}\" class=\"cl_list_text sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<!-- Universal Work List -->\n\t\t\t\t\t<HBox id=\"id_uwl_h\" class=\"sapUiTinyMarginBegin cl_list_con sapUiTinyMarginTop cl_sidebarItem\">\n\t\t\t\t\t\t<Toolbar id=\"id_uwl\" active=\"true\" class=\"sapUiTinyMarginEnd\" press=\"fnNavigateToView\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Uwl.svg'}\" tooltip=\"{i18n>Uwl}\"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>Uwl}\" class=\"cl_list_text sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<!-- App List -->\n\t\t\t\t\t<HBox id=\"id_appList_h\" class=\"sapUiTinyMarginBegin sapUiTinyMarginTop cl_list_con cl_sidebarItem\">\n\t\t\t\t\t\t<Toolbar id=\"id_appList\" active=\"true\" class=\"sapUiTinyMarginEnd\" press=\"fnNavExpandList\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Applist.svg'}\" tooltip=\"{i18n>Applist}\"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>Applist}\" class=\"cl_list_text sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'arrowRight.svg'}\" tooltip=\"Expand\" id=\"id_applistArr\" visible=\"true\" class=\"sapUiSmallMarginEnd\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<!-- Sub list for App List -->\n\t\t\t\t\t<VBox width=\"100%\" class=\"sapUiTinyMarginBegin cl_appl_bk \" id=\"id_appList_i\" visible=\"false\">\n\t\t\t\t\t\t<Toolbar id=\"id_material\" active=\"true\" width=\"100%\" class=\"sapUiSmallMarginBegin cl_sub_tbh\" press=\"fnNavigateToView\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Dot.svg'}\" tooltip=\"{i18n>Material}\" class=\"sapUiSmallMarginBegin \"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>Material}\" class=\"cl_list_textsub\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</VBox>\n\t\t\t\t\t<!-- Work Flow -->\n\t\t\t\t\t<HBox class=\"sapUiTinyMarginBegin sapUiTinyMarginTop cl_list_con cl_sidebarItem\">\n\t\t\t\t\t\t<Toolbar id=\"id_workFlow\" active=\"true\" width=\"100%\" class=\"cl_listwidthctrl sapUiTinyMarginEnd\" press=\"fnNavigateToView\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Workflow.svg'}\" tooltip=\"{i18n>Workflow}\"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>Workflow}\" class=\"cl_list_text sapUiTinyMarginBegin\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t<!-- Rules Engine -->\n\t\t\t\t\t<HBox class=\"sapUiTinyMarginBegin sapUiTinyMarginTop cl_list_con cl_sidebarItem\">\n\t\t\t\t\t\t<Toolbar id=\"id_RulesEngine\" active=\"true\" width=\"100%\" class=\"cl_listwidthctrl sapUiTinyMarginEnd\" press=\"fnNavigateToView\">\n\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Rulesengine.svg'}\" tooltip=\"{i18n>RulesEngine}\"/>\n\t\t\t\t\t\t\t<Text text=\"{i18n>RulesEngine}\" class=\"cl_list_text\"/>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t</HBox>\n\t\t\t\t</CustomListItem>\n\t\t\t</List>\n\t\t</HBox>\n\t\t<VBox class=\"sapUiTinyMarginBegin\" alignItems=\"Center\" justifyContent=\"End\" height=\"30%\"/>\n\t\t<HBox class=\"sapUiTinyMarginBegin cl_logoExpanded\" visible=\"true\">\n\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Exalca.svg'}\" tooltip=\"Exalca\" class=\"cl_logo sapUiSmallMarginBeginEnd sapUiTinyMarginBottom \"\n\t\t\t\twidth=\"5rem\"/>\n\t\t</HBox>\n\t\t<HBox class=\"cl_logoCollapsed\">\n\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Elogo.svg'}\" tooltip=\"Exalca\" class=\"cl_logo sapUiSmallMarginBeginEnd sapUiTinyMarginBottom\"\n\t\t\t\twidth=\"1rem\"/>\n\t\t</HBox>\n\t</VBox>\n</core:FragmentDefinition>",
		"MANAGED_RECIPE/controller/reci_search.controller.js": "sap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/export/Spreadsheet\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n], function(Controller, ErrorHandler, FilterOperator, Filter, Spreadsheet, formatter, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tvar i18n;\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.reci_search\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\t// on Intial Load of page/view\r\n\t\tonInit: function() {\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\tthis.f4Cache = {};\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"reci_search\").attachPatternMatched(this.fnRouter, this);\r\n\t\t},\r\n\t\t\r\n\t\t// on Every time load of page/view\r\n\t\tfnRouter: function() {\r\n\t\t\tvar oVisModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tlabelVisible: true\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oVisModel, \"RoadMapUI\");\r\n\t\t\tsap.ui.Device.resize.attachHandler(this._onResize, this);\r\n\t\t\tthis._onResize();\r\n\t\t\t\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").removeStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").addStyleClass(\"cl_list_con\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").addStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").removeStyleClass(\"cl_list_con\");\r\n\r\n\t\t\tbusyDialog.open();\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_UserModel\"); // local model\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t\tvar oEntity = {\r\n\t\t\t\t\"MdmMaster\": \"R\",\r\n\t\t\t\t\"Flag\": \"V\",\r\n\t\t\t\t\"NavSearch_Variant\": []\r\n\t\t\t};\r\n\t\t\toModel.create(\"/Search_VariantSet\", oEntity, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tsap.ui.core.BusyIndicator.hide();\r\n\t\t\t\t\tvar oJsonVariant = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\tvar aResults = oData.NavSearch_Variant.results || [];\r\n\r\n\t\t\t\t\t// Create a new array with a placeholder as the first element\r\n\t\t\t\t\tvar aNewData = [{\r\n\t\t\t\t\t\tVariantName: \"Select Variant\"\r\n\t\t\t\t\t}].concat(aResults);\r\n\r\n\t\t\t\t\t// Set the new array to model\r\n\t\t\t\t\toJsonVariant.setData(aNewData);\r\n\t\t\t\t\tthis.getView().setModel(oJsonVariant, \"JMListVariant\"); // local model for varient set\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t\tthis.fnClearAllfields();\r\n\t\t\tvar oVisibleModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tvisible: true,\r\n\t\t\t\trowCount: 7\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oVisibleModel, \"JM_Visible\"); // local model for visible and rowCount \r\n\t\t},\r\n\t\t\r\n\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for Live Change (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\t// live change function for all input fields\r\n\t\tfnLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oEvent.getSource().getValue().toUpperCase();\r\n\t\t\toInput.setValue(vValue);\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\");\r\n\t\t\tif (id === \"SID_RECI_MATNR\") {\r\n\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase().replace(/^0+/, \"\"), \"P\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase(), \"P\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Read the f4 details in the this.f4Cache\r\n\t\tfnReadf4Cache: function(vId, vValue, f4type) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar match;\r\n\t\t\tvar descriptionField;\r\n\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\tif (f4type === \"P\" || f4type === \"X\") {\r\n\t\t\t\t\t// Default: match Value1/Value2 as usual\r\n\t\t\t\t\tif (that.selectedField === \"SID_RECI_MATNR\") {\r\n\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\treturn item.Value1.replace(/^0+/, \"\") === vValue.toUpperCase();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\treturn item.Value1 === vValue.toUpperCase();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(match.Value2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// get the description of F4 details from backend\r\n\t\tf4descriptionGet: function(vId, value, f4type, fnCallback) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar filter;\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: vId,\r\n\t\t\t\tF4Type: f4type,\r\n\t\t\t\tProcess: \"S\"\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tfilters: filter,\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthat.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for F4 Event (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\t// when F4 press for all fields\r\n\t\tfnF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.bindTextF4model(\"P\", id, \"S\", oEvent);\r\n\t\t},\r\n\r\n\t\t// bind the f4 date for JM_F4model \r\n\t\tbindTextF4model: function(SearchHelp, sitem, process, oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar vLength;\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar that = this;\r\n\t\t\tvar filter = [];\r\n\t\t\tthat.sitem = sitem;\r\n\t\t\t// var ftype = new Filter(\"F4Type\", FilterOperator.EQ, SearchHelp);\r\n\t\t\t// var sitem1 = new Filter(\"FieldId\", FilterOperator.EQ, sitem);\r\n\t\t\t// var process1 = new Filter(\"Process\", FilterOperator.EQ, process);\r\n\t\t\t// filter.push(ftype);\r\n\t\t\t// filter.push(sitem1);\r\n\t\t\t// filter.push(process1);\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tvar omodel1 = that.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tomodel1.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tfilters: filter,\r\n\t\t\t\tsuccess: function(odata, Response) {\r\n\t\t\t\t\tvar aResults = odata.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\t\tif (oFirst && (oFirst.DomvalueL || oFirst.Ddtext)) {\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\toLabels.col1 = \"Key\";\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1) {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.DomvalueL;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Ddtext;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.DomvalueL3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.DomvalueL4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = sap.ui.getCore().byId(that.sitem + \"_TXT\").getText() + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvLength = odata.NavSerchResult.results.length;\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Validate\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1 === \"Material\") {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1 ? item.Value1.replace(/^0+/, \"\") : item.Value1;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tthat.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = that.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t// when F4 dialog item press\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar item = oContext.getProperty(\"col1\"); // Value (e.g., 'IN')\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\"); // Description (e.g., 'India')\r\n\r\n\t\t\tthis.getView().byId(this.selectedField).setValue(item);\r\n\t\t\tthis.getView().byId(this.selectedField + \"_DES\").setValue(item1);\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\t// to open the f4 fragment\r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\t// to close the f4 fragement\r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\t// search field for f4 fragment\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar aFilters = [];\r\n\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t Function for To search table Records (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// to search the record based on search criteria\r\n\t\tfnSearch: function() {\r\n\t\t\tvar oSearchEntity = this.getOwnerComponent().getModel();\r\n\t\t\tvar payLoad = {\r\n\t\t\t\tMatnr: this.getView().byId(\"SID_RECI_MATNR\").getValue(),\r\n\t\t\t\tPlnnr: this.getView().byId(\"SID_RECI_PLNNR\").getValue(),\r\n\t\t\t\tWerks: this.getView().byId(\"SID_RECI_WERKS\").getValue(),\r\n\t\t\t\tAnd: this.getView().byId(\"id_and\").getSelected(),\r\n\t\t\t\tOr: this.getView().byId(\"id_or\").getSelected()\r\n\t\t\t};\r\n\t\t\tpayLoad.NavRecipeSearch = [];\r\n\r\n\t\t\tif (!payLoad.Matnr && !payLoad.Plnnr && !payLoad.Werks) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"searchFieldRequiredError\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tbusyDialog.open();\r\n\t\t\toSearchEntity.create(\"/Recipe_Search_HeaderSet\", payLoad, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar length = oData.NavRecipeSearch.results.length;\r\n\t\t\t\t\tvar vSearchResults = {\r\n\t\t\t\t\t\trecords: oData.NavRecipeSearch.results,\r\n\t\t\t\t\t\ttotal: \"(\" + length + \")\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar oModel = new sap.ui.model.json.JSONModel(vSearchResults);\r\n\t\t\t\t\tthis.getView().setModel(oModel, \"JM_Recidetails\");\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t  Function for To Expand and Collapse the search table (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// expand and collapse the search item table\r\n\t\tfnExpand: function() {\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/visible\", false);\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/rowCount\", 13);\r\n\t\t\tthis.getView().byId(\"id_search_container\").removeStyleClass(\"sapUiLargeMarginTop\");\r\n\t\t\tthis.getView().byId(\"id_searchTableBox\").removeStyleClass(\"cl_border\");\r\n\t\t\tthis.getView().byId(\"id_search_container\").addStyleClass(\"sapUiTinyMarginTop\");\r\n\t\t\tthis.getView().byId(\"id_searchTableBox\").addStyleClass(\"cl_borderSS\");\r\n\t\t},\r\n\r\n\t\tfnCollapse: function() {\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/rowCount\", 7);\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/visible\", true);\r\n\t\t\t// this.getView().byId(\"id_search_container\").addStyleClass(\"sapUiLargeMarginTop\");\r\n\t\t\tthis.getView().byId(\"id_searchTableBox\").addStyleClass(\"cl_border\");\r\n\t\t\tthis.getView().byId(\"id_search_container\").removeStyleClass(\"sapUiTinyMarginTop\");\r\n\t\t\tthis.getView().byId(\"id_searchTableBox\").removeStyleClass(\"cl_borderSS\");\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tFunction for Table Filter functionalities (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// table filter icon press\r\n\t\tfnTableFilter: function(oEvent) {\r\n\t\t\tvar oButton = oEvent.getSource();\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oList = new sap.m.List({\r\n\t\t\t\titems: [\r\n\t\t\t\t\tnew sap.m.StandardListItem({\r\n\t\t\t\t\t\ttitle: i18n.getText(\"Customize\"),\r\n\t\t\t\t\t\ttype: \"Active\",\r\n\t\t\t\t\t\ticon: \"Image/customize.svg\",\r\n\t\t\t\t\t\tpress: that.fnCustomizeTableColumns.bind(that)\r\n\t\t\t\t\t}).addStyleClass(\"cl_uwl_customizefilterlistitem\"),\r\n\r\n\t\t\t\t\tnew sap.m.StandardListItem({\r\n\t\t\t\t\t\ttitle: that.textWrap ? i18n.getText(\"ClipText\") : i18n.getText(\"WrapText\"),\r\n\t\t\t\t\t\ttype: \"Active\",\r\n\t\t\t\t\t\ticon: \"Image/Warptext.svg\",\r\n\t\t\t\t\t\tpress: that.fnWrapText.bind(that)\r\n\t\t\t\t\t}).addStyleClass(\"cl_uwl_wrapfilterlistitem\")\r\n\t\t\t\t]\r\n\t\t\t}).addStyleClass(\"cl_uwl_filterlistitem\");\r\n\r\n\t\t\tvar oClrButton = new sap.m.Button({\r\n\t\t\t\ttext: i18n.getText(\"Clear\"),\r\n\t\t\t\ticon: \"Image/Clearall.svg\",\r\n\t\t\t\tpress: function() {\r\n\t\t\t\t\tvar oTable = that.getView().byId(\"id_UWLtable\");\r\n\t\t\t\t\tvar aColumns = oTable.getColumns();\r\n\t\t\t\t\taColumns.forEach(function(oColumn) {\r\n\t\t\t\t\t\toTable.filter(oColumn, \"\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}).addStyleClass(\"cl_primaryButton\");\r\n\r\n\t\t\tvar oPopover = new sap.m.Popover({\r\n\t\t\t\tplacement: sap.m.PlacementType.Bottom,\r\n\t\t\t\toffsetX: 54,\r\n\t\t\t\tcontent: new sap.m.VBox({\r\n\t\t\t\t\titems: [oList],\r\n\t\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\t\talignItems: \"Center\"\r\n\t\t\t\t}),\r\n\t\t\t\tfooter: new sap.m.Bar({\r\n\t\t\t\t\tcontentMiddle: [oClrButton]\r\n\t\t\t\t})\r\n\t\t\t});\r\n\r\n\t\t\toPopover.addStyleClass(\"cl_uwl_PopOver sapUiSizeCompact\");\r\n\t\t\toPopover.openBy(oButton);\r\n\t\t},\r\n\r\n\t\t// on customize list select\r\n\t\tfnCustomizeTableColumns: function() {\r\n\t\t\tvar vFinalBinding = [];\r\n\t\t\tvar vSelectedIndex = [];\r\n\t\t\tvar vColumnArray = this.getView().byId(\"id_search_table\").getColumns();\r\n\t\t\tfor (var i = 0; i < vColumnArray.length; i++) {\r\n\t\t\t\tvFinalBinding.push({\r\n\t\t\t\t\tCName: vColumnArray[i].getLabel().getText(),\r\n\t\t\t\t\tCId: vColumnArray[i].getId().split(\"--\").pop(),\r\n\t\t\t\t\tVisible: vColumnArray[i].getVisible()\r\n\r\n\t\t\t\t});\r\n\t\t\t\tif (vColumnArray[i].getVisible()) {\r\n\t\t\t\t\tvSelectedIndex.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oVisibleModel = new sap.ui.model.json.JSONModel(vFinalBinding);\r\n\t\t\tthis.getView().setModel(oVisibleModel, \"JMColumn\");\r\n\r\n\t\t\tif (!this.Customzie) {\r\n\t\t\t\tthis.Customzie = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.customize_table\", this);\r\n\t\t\t\tthis.getView().addDependent(this.Customzie);\r\n\t\t\t}\r\n\t\t\tthis.Customzie.open();\r\n\t\t\tvar vItems = sap.ui.getCore().byId(\"id_columnSel\").getItems();\r\n\t\t\tif (vSelectedIndex.length === vItems.length) {\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").setSelected(true);\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\t\t\tfor (i = 0; i < vSelectedIndex.length; i++) {\r\n\t\t\t\tvItems[vSelectedIndex[i]].getContent()[0].getContent()[0].removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\tvItems[vSelectedIndex[i]].getContent()[0].getContent()[0].addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// apply button press in customize dialog\r\n\t\tfnApplyCustomizeColumn: function() {\r\n\t\t\tvar vColumnModel = this.getView().getModel(\"JMColumn\");\r\n\t\t\tvar vColumnArray = [];\r\n\t\t\tif (vColumnModel !== undefined) {\r\n\t\t\t\tvColumnModel.updateBindings(true);\r\n\t\t\t\tvColumnArray = vColumnModel.getData();\r\n\t\t\t}\r\n\t\t\tvar vAllFalse = vColumnArray.every(function(oItem) {\r\n\t\t\t\treturn oItem.Visible === false;\r\n\t\t\t});\r\n\t\t\tif (vAllFalse === true) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"noColumnSelectedError\"), \"Error\", this);\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0; i < vColumnArray.length; i++) {\r\n\t\t\t\t\tthis.getView().byId(\"id_search_table\").getColumns()[i].setVisible(vColumnArray[i].Visible);\r\n\t\t\t\t}\r\n\t\t\t\tthis.fnCancel();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Selection Mode\r\n\t\tfnCheckSel: function(oEvent) {\r\n\t\t\tif (!oEvent.getSource().getSelected()) {\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t} else {\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Select All\r\n\t\tfnCheckSelAll: function(oEvent) {\r\n\t\t\tvar vData = this.getView().getModel(\"JMColumn\").getData();\r\n\t\t\tif (!oEvent.getSource().getSelected()) {\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t} else {\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\t\t\tvData.forEach(function(oItem) {\r\n\t\t\t\toItem.Visible = oEvent.getSource().getSelected();\r\n\t\t\t});\r\n\t\t\tthis.getView().getModel(\"JMColumn\").updateBindings(true);\r\n\t\t\tvar vItems = sap.ui.getCore().byId(\"id_columnSel\").getItems();\r\n\t\t\tfor (var i = 0; i < vData.length; i++) {\r\n\t\t\t\tif (!oEvent.getSource().getSelected()) {\r\n\t\t\t\t\tvItems[i].getContent()[0].getContent()[0].removeStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\t\tvItems[i].getContent()[0].getContent()[0].addStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvItems[i].getContent()[0].getContent()[0].removeStyleClass(\"cl_Customizecheckbox\");\r\n\t\t\t\t\tvItems[i].getContent()[0].getContent()[0].addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Close the popup\r\n\t\tfnCancel: function() {\r\n\t\t\tthis.Customzie.close();\r\n\t\t},\r\n\r\n\t\t// Filter Column Selection\r\n\t\tfnColumnFilter: function(oEvent) {\r\n\t\t\tvar vQuery = oEvent.getParameter(\"newValue\").toLowerCase();\r\n\t\t\t// Get the list\r\n\t\t\tvar vList = sap.ui.getCore().byId(\"id_columnSel\");\r\n\t\t\tvar vBinding = vList.getBinding(\"items\");\r\n\t\t\tif (vQuery) {\r\n\t\t\t\tvar oFilter = new sap.ui.model.Filter({\r\n\t\t\t\t\tpath: \"CName\", // The property in your model to search\r\n\t\t\t\t\toperator: sap.ui.model.FilterOperator.Contains,\r\n\t\t\t\t\tvalue1: vQuery,\r\n\t\t\t\t\tcaseSensitive: false\r\n\t\t\t\t});\r\n\t\t\t\tvBinding.filter([oFilter]);\r\n\t\t\t} else {\r\n\t\t\t\tvBinding.filter([]); // Reset filter\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// on wrap list press\r\n\t\tfnWrapText: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = that.getView().byId(\"id_search_table\");\r\n\t\t\tvar oColumns = oTable.getColumns();\r\n\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar iTransReqColIndex = 3;\r\n\r\n\t\t\tif (!that.textWrap) {\r\n\t\t\t\toItem.setTitle(\"Clip Text\");\r\n\t\t\t\tthat.textWrap = true;\r\n\t\t\t\toColumns[iTransReqColIndex - 2].setWidth(\"10%\");\r\n\t\t\t\toTable.addStyleClass(\"cl_uwl_TransReqWrap\");\r\n\t\t\t} else {\r\n\t\t\t\toItem.setTitle(\"Wrap Text\");\r\n\t\t\t\tthat.textWrap = false;\r\n\t\t\t\toColumns[iTransReqColIndex - 2].setWidth(\"30%\");\r\n\t\t\t\toTable.removeStyleClass(\"cl_uwl_TransReqWrap\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tFunction for Create Varient functionalities (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// open the varient dialog\r\n\t\tfnOpenVariant: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar sVarname = this.getView().byId(\"id_combo\").getSelectedKey();\r\n\t\t\tif (sVarname !== \"Select Variant\") {\r\n\t\t\t\tif (!this.Confirmation) {\r\n\t\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\ttitle: i18n.getText(\"Confirmation\"),\r\n\t\t\t\t\t\ttext: i18n.getText(\"variantModifyConfirmMsg\"),\r\n\t\t\t\t\t\tnegativeButton: i18n.getText(\"Cancel\"),\r\n\t\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\t\tpositiveButton: i18n.getText(\"Proceed\"),\r\n\t\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Duplicate.svg\",\r\n\t\t\t\t\t\tIndicator: \"MODIFY_VAR\", // indication for Modifiy varient\r\n\t\t\t\t\t\tVarientName: sVarname\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Set model with name\r\n\t\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\r\n\t\t\t\t\tthis.Confirmation = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.ConfirmationExit\", this);\r\n\t\t\t\t\tthis.getView().addDependent(this.Confirmation);\r\n\t\t\t\t}\r\n\t\t\t\tthis.Confirmation.open();\r\n\t\t\t} else {\r\n\t\t\t\tif (!this.Variant) {\r\n\t\t\t\t\tthis.Variant = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.create_varient\", this);\r\n\t\t\t\t\tthis.getView().addDependent(this.Variant);\r\n\t\t\t\t}\r\n\t\t\t\tthis.Variant.open();\r\n\t\t\t\tvar vItem = this.getView().getModel(\"JMListVariant\");\r\n\t\t\t\tif (vItem !== undefined) {\r\n\t\t\t\t\tvItem = vItem.getData();\r\n\t\t\t\t\tvar vFinEntity = [];\r\n\t\t\t\t\tvItem.slice(1).forEach(function(oItem) {\r\n\t\t\t\t\t\tvar oEn = {\r\n\t\t\t\t\t\t\tVarintName: oItem.VariantName,\r\n\t\t\t\t\t\t\tNew: false\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvFinEntity.push(oEn);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar oJSONVariant = new sap.ui.model.json.JSONModel(vFinEntity);\r\n\t\t\t\t\tthis.getView().setModel(oJSONVariant, \"JMVaraint\");\r\n\t\t\t\t\tsap.ui.getCore().byId(\"id_variantTab\").setSelectedIndex(0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// close the varient dialog\r\n\t\tfnConfirmationFragmentClose: function() {\r\n\t\t\tif (this.Confirmation) {\r\n\t\t\t\tthis.Confirmation.close();\r\n\t\t\t\tthis.Confirmation.destroy();\r\n\t\t\t\tthis.Confirmation = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// press submit for the varient dialog\r\n\t\tfnSubmitConfirmation: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tvar variantName = this.getView().getModel(\"JM_Popup\").getProperty(\"/VarientName\");\r\n\t\t\tif (state === \"MODIFY_VAR\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tthis.fnSaveVariantBackend(variantName);\r\n\t\t\t}\r\n\t\t\tif (state === \"CHANGE\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tif (this.Selecteddata) {\r\n\t\t\t\t\tthis.fnChangeLogic(this.Selecteddata);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (state === \"DELETE_VARIENT\") {\r\n\t\t\t\tvar oTable = sap.ui.getCore().byId(\"id_variantTab\");\r\n\t\t\t\tvar iIndex = oTable.getSelectedIndex();\r\n\t\t\t\tif (iIndex === -1) {\r\n\t\t\t\t\tvar vMsg = i18n.getText(\"DeletionSuccess\");\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(vMsg, \"success\", this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JMVaraint\");\r\n\t\t\t\tvar aData = oModel.getData();\r\n\t\t\t\tvar vVariantName = aData[iIndex].VarintName;\r\n\r\n\t\t\t\t/* -------------------------------\r\n\t\t\t\t   DELETE FROM JMVaraint MODEL\r\n\t\t\t\t-------------------------------- */\r\n\t\t\t\taData.splice(iIndex, 1);\r\n\t\t\t\toModel.setData(aData);\r\n\t\t\t\toModel.refresh(true);\r\n\r\n\t\t\t\t/* -------------------------------\r\n\t\t\t\t   DELETE FROM JMListVariant MODEL (ES5)\r\n\t\t\t\t-------------------------------- */\r\n\t\t\t\tvar oListModel = this.getView().getModel(\"JMListVariant\");\r\n\t\t\t\tif (oListModel) {\r\n\t\t\t\t\tvar aList = oListModel.getData();\r\n\t\t\t\t\tvar iRemoveIndex = -1;\r\n\t\t\t\t\tfor (var i = 0; i < aList.length; i++) {\r\n\t\t\t\t\t\tif (aList[i].VariantName === vVariantName) {\r\n\t\t\t\t\t\t\tiRemoveIndex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (iRemoveIndex !== -1) {\r\n\t\t\t\t\t\taList.splice(iRemoveIndex, 1);\r\n\t\t\t\t\t\toListModel.setData(aList);\r\n\t\t\t\t\t\toListModel.refresh(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Clear table selection\r\n\t\t\t\toTable.clearSelection();\r\n\t\t\t\t// Prepare backend delete payload\r\n\t\t\t\tvar oMainModel = this.getView().getModel(\"JMConfig\");\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tMdmMaster: \"R\",\r\n\t\t\t\t\tVariantName: vVariantName,\r\n\t\t\t\t\tFlag: \"D\",\r\n\t\t\t\t\tNavSearch_Variant: []\r\n\t\t\t\t};\r\n\t\t\t\t// Create call\r\n\t\t\t\toMainModel.create(\"/Search_VariantSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"Variant_Delete_Success\"), \"success\", this);\r\n\t\t\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function() {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"Variant_Delete_Error\"), \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//Add variant\r\n\t\tfnAddVariant: function() {\r\n\t\t\tvar vMaterial = this.getView().byId(\"SID_RECI_MATNR\").getValue();\r\n\t\t\tvar vPlant = this.getView().byId(\"SID_RECI_WERKS\").getValue();\r\n\t\t\tvar vGroup = this.getView().byId(\"SID_RECI_PLNNR\").getValue();\r\n\t\t\tvar vAnd = this.byId(\"id_and\").getSelected();\r\n\t\t\tvar vOr = this.byId(\"id_and\").getSelected();\r\n\t\t\tvar vSelectedIndex = [];\r\n\t\t\tvar vColumnArray = this.getView().byId(\"id_search_table\").getColumns();\r\n\t\t\tfor (var i = 0; i < vColumnArray.length; i++) {\r\n\t\t\t\tif (vColumnArray[i].getVisible()) {\r\n\t\t\t\t\tvSelectedIndex.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (vMaterial === \"\" && vPlant === \"\" && vGroup === \"\" && vSelectedIndex.length === 14) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"inputOrColumnSelectionRequired\"), \"Warning\", this);\r\n\t\t\t} else {\r\n\t\t\t\tvar vTemp = [];\r\n\t\t\t\tvar vUser = this.getView().getModel(\"JM_UserModel\").getData();\r\n\t\t\t\tvar vVariant = this.getView().getModel(\"JMVaraint\");\r\n\t\t\t\tif (vVariant !== undefined) {\r\n\t\t\t\t\tvTemp = vVariant.getData();\r\n\t\t\t\t\tif (vTemp.length > 0) {\r\n\t\t\t\t\t\tvar oLast = vTemp[vTemp.length - 1]; // last record\r\n\t\t\t\t\t\tif (oLast.New === true) {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"completeSavePreviousRowWarn\"), \"Warning\", this);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar vSelIndex = sap.ui.getCore().byId(\"id_variantTab\").getSelectedIndex();\r\n\t\t\t\t\t\tif (vSelIndex === -1) {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectVarientToSave\"), \"Warning\", this);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar vlen = vSelIndex;\r\n\t\t\t\t\t\tvar vTextLen = vTemp[vlen].VarintName.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (vlen >= 0 && vTemp[vlen].VarintName === \"\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"completePreviousRowWarn\"), \"Warning\", this);\r\n\t\t\t\t} else if (vTextLen < 3) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"variantNameMinimumCharsWarn\"), \"Warning\", this);\r\n\t\t\t\t} else if (vVariant !== undefined && this.Save !== undefined && !this.Save) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"saveVariantBeforeAddRowWarn\"), \"Warning\", this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar vEntity = {\r\n\t\t\t\t\t\tVarintName: \"\",\r\n\t\t\t\t\t\tUser: vUser[0].Uname,\r\n\t\t\t\t\t\tNew: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvTemp.push(vEntity);\r\n\t\t\t\t\tvar oJSONVariant = new sap.ui.model.json.JSONModel(vTemp);\r\n\t\t\t\t\tthis.getView().setModel(oJSONVariant, \"JMVaraint\");\r\n\t\t\t\t\tsap.ui.getCore().byId(\"id_variantTab\").setSelectedIndex((vTemp.length - 1));\r\n\r\n\t\t\t\t\tvar vTable = sap.ui.getCore().byId(\"id_variantTab\");\r\n\t\t\t\t\tvTable.setFirstVisibleRow((vTemp.length - 1));\r\n\r\n\t\t\t\t\tvTable.attachEventOnce(\"rowsUpdated\", function() {\r\n\t\t\t\t\t\tvar vSelRow = vTable.getFirstVisibleRow();\r\n\t\t\t\t\t\tvTable.getRows()[(vTemp.length - 1) - vSelRow].getCells()[0].focus();\r\n\t\t\t\t\t\tvTable.getRows()[(vTemp.length - 1) - vSelRow].getCells()[0].removeStyleClass(\"cl_varTabInput\");\r\n\t\t\t\t\t\tvTable.getRows()[(vTemp.length - 1) - vSelRow].getCells()[0].addStyleClass(\"cl_varTabNew\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Delete Varaint\r\n\t\tfnDeleteVariant: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar vSelIndex = sap.ui.getCore().byId(\"id_variantTab\").getSelectedIndex();\r\n\t\t\tif (vSelIndex < 0) {\r\n\t\t\t\tvar vErrorMsg = i18n.getText(\"SelectItem\");\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(vErrorMsg), \"Error\", this);\r\n\t\t\t} else {\r\n\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\ttitle: \"Information\",\r\n\t\t\t\t\ttext: \"Do you want to delete this varient\",\r\n\t\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\tIndicator: \"DELETE_VARIENT\"\r\n\t\t\t\t});\r\n\t\t\t\t// Set model with name\r\n\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\tif (!this.Confirmation) {\r\n\t\t\t\t\tthis.Confirmation = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\t\tthis\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.getView().addDependent(this.Confirmation);\r\n\t\t\t\t}\r\n\t\t\t\tthis.Confirmation.open();\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSaveVariant: function() {\r\n\t\t\tthis.fnSaveVariantBackend(undefined);\r\n\t\t},\r\n\r\n\t\t//Sumbit\r\n\t\tfnSaveVariantBackend: function(variant) {\r\n\t\t\tthis.Save = true;\r\n\t\t\tvar oModel = this.getView().getModel(\"JMConfig\");\r\n\t\t\tvar oModel1 = this.getView().getModel(\"JMListVariant\");\r\n\t\t\tvar aVariants = oModel1.getData();\r\n\t\t\tvar vSelIndex;\r\n\t\t\tvar variantName;\r\n\t\t\tvar message;\r\n\r\n\t\t\tif (variant) {\r\n\t\t\t\tvariantName = variant;\r\n\t\t\t\tmessage = i18n.getText(\"variantModifiedSuccess\");\r\n\t\t\t} else {\r\n\t\t\t\tvSelIndex = sap.ui.getCore().byId(\"id_variantTab\").getSelectedIndex();\r\n\t\t\t\tvariantName = this.getView().getModel(\"JMVaraint\").getData()[vSelIndex].VarintName.toUpperCase();\r\n\t\t\t\tmessage = i18n.getText(\"variantSavedSuccess\");\r\n\r\n\t\t\t\t// Check if the variant already exists\r\n\t\t\t\tvar exists = aVariants.some(function(item) {\r\n\t\t\t\t\treturn item.VariantName === variantName;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (exists) {\r\n\t\t\t\t// Show error if variant already exists\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"variantAlreadyExists\", [variantName]), \"Error\", this);\r\n\t\t\t\treturn; // stop further processing\r\n\t\t\t}\r\n\t\t\t// Check if the variant name is at least 4 characters\r\n\t\t\tif (!variantName || variantName.length < 4) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"variantNameMinLength\"), \"Error\", this);\r\n\t\t\t\treturn; // stop further processing\r\n\t\t\t}\r\n\r\n\t\t\tvar vIdArray = [\"SID_RECI_MATNR\", \"SID_RECI_MATNR_DES\", \"SID_RECI_WERKS\", \"SID_RECI_WERKS_DES\", \"SID_RECI_PLNNR\",\r\n\t\t\t\t\"SID_RECI_PLNNR_DES\", \"id_or\", \"id_and\"\r\n\t\t\t];\r\n\t\t\tvar vArrayVariant = [];\r\n\t\t\tvar oThat = this;\r\n\t\t\tvIdArray.forEach(function(oItem) {\r\n\t\t\t\tvar vValue;\r\n\t\t\t\tif (oItem === \"id_or\" || oItem === \"id_and\") {\r\n\t\t\t\t\tvar isSelected = oThat.getView().byId(oItem).getSelected();\r\n\t\t\t\t\tvValue = isSelected ? \"True\" : \"False\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvValue = oThat.getView().byId(oItem).getValue();\r\n\t\t\t\t}\r\n\t\t\t\tif (vValue !== \"\") {\r\n\t\t\t\t\tvar oPayload = {\r\n\t\t\t\t\t\t\"MdmMaster\": \"R\",\r\n\t\t\t\t\t\t\"VariantName\": variantName,\r\n\t\t\t\t\t\t\"FieldId\": oItem,\r\n\t\t\t\t\t\t\"Value\": vValue\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvArrayVariant.push(oPayload);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// Collect table column visibility\r\n\t\t\tvar oTable = this.getView().byId(\"id_search_table\");\r\n\t\t\tif (oTable) {\r\n\t\t\t\toTable.getColumns().forEach(function(oCol) {\r\n\t\t\t\t\tvar sColId = oCol.getId();\r\n\t\t\t\t\tvar sField = sColId.split(\"--\").pop();\r\n\t\t\t\t\tvArrayVariant.push({\r\n\t\t\t\t\t\tMdmMaster: \"R\",\r\n\t\t\t\t\t\tVariantName: variantName,\r\n\t\t\t\t\t\tFieldId: sField,\r\n\t\t\t\t\t\tValue: oCol.getVisible() ? \"X\" : \"\"\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tvar oEntity = {\r\n\t\t\t\t\"MdmMaster\": \"R\",\r\n\t\t\t\t\"Flag\": \"S\",\r\n\t\t\t\t\"VariantName\": variantName,\r\n\t\t\t\t\"NavSearch_Variant\": vArrayVariant\r\n\t\t\t};\r\n\t\t\tvar that = this;\r\n\t\t\toModel.create(\"/Search_VariantSet\", oEntity, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(message, \"success\", that);\r\n\t\t\t\t\tif (!variant) {\r\n\t\t\t\t\t\tvariantName = oEntity.VariantName;\r\n\t\t\t\t\t\taVariants = that.getView().getModel(\"JMListVariant\").getData();\r\n\t\t\t\t\t\taVariants.push({\r\n\t\t\t\t\t\t\tVariantName: variantName\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.getView().getModel(\"JMListVariant\").setData(aVariants);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.fnCancelVariant();\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// varient row selections\r\n\t\tfnVarinatSelect: function(oEvent) {\r\n\t\t\tvar oValueModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar sVarname = oEvent.getSource().getSelectedKey();\r\n\t\t\tvar oTable = this.getView().byId(\"id_search_table\");\r\n\t\t\tvar aColumns = oTable.getColumns();\r\n\r\n\t\t\tif (sVarname === \"Select Variant\") {\r\n\t\t\t\tthis.fnClearAllfields();\r\n\t\t\t\taColumns.forEach(function(col) {\r\n\t\t\t\t\tcol.setVisible(true);\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\taColumns.forEach(function(col) {\r\n\t\t\t\tcol.setVisible(false);\r\n\t\t\t});\r\n\t\t\tthis.fnClearAllfields();\r\n\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tMdmMaster: \"R\",\r\n\t\t\t\tVariantName: sVarname,\r\n\t\t\t\tFlag: \"G\",\r\n\t\t\t\tNavSearch_Variant: []\r\n\t\t\t};\r\n\t\t\toValueModel.create(\"/Search_VariantSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar aResults = oData.NavSearch_Variant.results;\r\n\t\t\t\t\tvar oView = this.getView();\r\n\t\t\t\t\t// Loop through each result entry\r\n\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\tvar sFieldId = item.FieldId;\r\n\t\t\t\t\t\tvar sValue = item.Value;\r\n\t\t\t\t\t\tif (sFieldId === \"id_and\" || sFieldId === \"id_or\") {\r\n\t\t\t\t\t\t\tvar oCheckbox = oView.byId(sFieldId);\r\n\t\t\t\t\t\t\tvar state = (sValue === \"True\") ? true : false;\r\n\t\t\t\t\t\t\toCheckbox.setSelected(state);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (sValue !== \"X\") {\r\n\t\t\t\t\t\t\t\tvar oInput = oView.byId(sFieldId);\r\n\t\t\t\t\t\t\t\tif (oInput) {\r\n\t\t\t\t\t\t\t\t\tif (oInput.setValue) {\r\n\t\t\t\t\t\t\t\t\t\toInput.setValue(sValue);\r\n\t\t\t\t\t\t\t\t\t} else if (oInput.setText) {\r\n\t\t\t\t\t\t\t\t\t\toInput.setText(sValue);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar iColIndex = parseInt(sFieldId.replace(\"__column\", \"\"), 10);\r\n\t\t\t\t\t\t\t\tif (!isNaN(iColIndex) && aColumns[iColIndex]) {\r\n\t\t\t\t\t\t\t\t\t// If Value = \"X\"  show the column\r\n\t\t\t\t\t\t\t\t\tvar bVisible = (sValue === \"X\");\r\n\t\t\t\t\t\t\t\t\taColumns[iColIndex].setVisible(bVisible);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.fnSearch();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t// Close Varaint\r\n\t\tfnCancelVariant: function() {\r\n\t\t\tthis.Variant.close();\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tFunction for Search Field (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t//search filter in the table  \r\n\t\tfnSearchTable: function(oEvent) {\r\n\t\t\tvar sQuery = oEvent.getParameter(\"value\").toLowerCase();\r\n\t\t\tvar oTable = this.getView().byId(\"id_search_table\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"rows\");\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_Recidetails\");\r\n\t\t\tvar aAllData = oModel.getProperty(\"/records\") || [];\r\n\r\n\t\t\t// If search is empty  reset filter and count\r\n\t\t\tif (!sQuery) {\r\n\t\t\t\toBinding.filter([]);\r\n\t\t\t\toModel.setProperty(\"/total\", \"(\" + aAllData.length + \")\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Create filters for multiple fields\r\n\t\t\tvar aFilters = [\r\n\t\t\t\tnew sap.ui.model.Filter(\"Matnr\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Maktx\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Plnnr\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Werks\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Plnme\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Statu\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Annam\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Aennr\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Stlan\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Stlal\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Verid\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Zkriz\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Plnal\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Plnty\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\tnew sap.ui.model.Filter(\"Plnnr\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t];\r\n\r\n\t\t\tvar oFinalFilter = new sap.ui.model.Filter({\r\n\t\t\t\tfilters: aFilters,\r\n\t\t\t\tand: false\r\n\t\t\t});\r\n\r\n\t\t\t// Apply filter\r\n\t\t\toBinding.filter(oFinalFilter);\r\n\r\n\t\t\t// Delay count update slightly to let binding update\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tvar iFilteredLength = oBinding.getLength();\r\n\t\t\t\toModel.setProperty(\"/total\", \"(\" + iFilteredLength + \")\");\r\n\t\t\t}, 100);\r\n\t\t},\r\n\r\n\t\t// download functinalite in the table records\r\n\t\tfnDownloadTable: function() {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_Recidetails\");\r\n\t\t\tvar aData = oModel.getProperty(\"/records\") || [];\r\n\r\n\t\t\tif (aData.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"noDatatoDownload\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!aData || aData.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"noDatatoDownload\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Build hard-coded structure for Excel\r\n\t\t\tvar rowData = aData.map(function(item) {\r\n\t\t\t\tvar row = {};\r\n\t\t\t\trow[i18n.getText(\"ProcessState\")] = formatter.fnConverStatustoTooltip(item.Status);\r\n\t\t\t\trow[i18n.getText(\"Material\")] = item.Matnr || \"\";\r\n\t\t\t\trow[i18n.getText(\"MaterialDesc\")] = item.Maktx || \"\";\r\n\t\t\t\trow[i18n.getText(\"Group\")] = item.Plnnr || \"\";\r\n\t\t\t\trow[i18n.getText(\"TaskListType\")] = item.Plnty || \"\";\r\n\t\t\t\trow[i18n.getText(\"GroupCounter\")] = item.Plnal || \"\";\r\n\t\t\t\trow[i18n.getText(\"Counter\")] = item.Zkriz || \"\";\r\n\t\t\t\trow[i18n.getText(\"ProductionVersion\")] = item.Verid || \"\";\r\n\t\t\t\trow[i18n.getText(\"AlternativeBOM\")] = item.Stlal || \"\";\r\n\t\t\t\trow[i18n.getText(\"Usage\")] = item.Stlan || \"\";\r\n\t\t\t\trow[i18n.getText(\"Change\")] = item.Aennr || \"\";\r\n\t\t\t\trow[i18n.getText(\"User\")] = item.Annam || \"\";\r\n\t\t\t\trow[i18n.getText(\"Plant\")] = item.Werks || \"\";\r\n\t\t\t\trow[i18n.getText(\"Status\")] = item.Statu || \"\";\r\n\t\t\t\trow[i18n.getText(\"UnitofMeasures\")] = item.Plnme || \"\";\r\n\t\t\t\treturn row;\r\n\t\t\t});\r\n\r\n\t\t\t// Export to Excel\r\n\t\t\tif (typeof XLSX !== \"undefined\") {\r\n\t\t\t\tvar wb = window.XLSX.utils.book_new();\r\n\t\t\t\tvar ws = window.XLSX.utils.json_to_sheet(rowData);\r\n\t\t\t\twindow.XLSX.utils.book_append_sheet(wb, ws, \"TableData\");\r\n\t\t\t\twindow.XLSX.writeFile(wb, \"TableValues.xlsx\");\r\n\t\t\t} else {\r\n\t\t\t\tsap.m.MessageToast.show(\"XLSX library not loaded!\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tFunction for Clear all the fields and Model (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// clear all fields in search scren \r\n\t\tfnClearAllfields: function() {\r\n\t\t\tthis.getView().byId(\"SID_RECI_MATNR\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"SID_RECI_PLNNR\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"SID_RECI_PLNNR_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"SID_RECI_WERKS\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"SID_RECI_WERKS_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"SID_RECI_MATNR_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"id_combo\").setSelectedKey(0);\r\n\t\t\tthis.getView().byId(\"idRBGroup\").setSelectedIndex(0); // selects \"No\"   \r\n\t\t\tvar vSearchResults = {\r\n\t\t\t\trecords: []\r\n\t\t\t};\r\n\t\t\tvar oModel = new sap.ui.model.json.JSONModel(vSearchResults);\r\n\t\t\tthis.getView().setModel(oModel, \"JM_Recidetails\");\r\n\t\t},\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tFunction for Navigate Key Data (Added by sabarish - 06-10-2025)\r\n\t\t// *-----------------------------------------------------------------------------------------\r\n\r\n\t\t// create new drop down press\r\n\t\tfnMenu: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar sKey1 = oEvent.getParameter(\"item\").getKey();\r\n\t\t\tswitch (sKey1) {\r\n\t\t\t\tcase \"RECI_CREATE\":\r\n\t\t\t\t\tthis.fnSetParmdata(\"RC\").then(function(state) {\r\n\t\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_keydata\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"RECI_CHANGE\":\r\n\r\n\t\t\t\t\tvar oTable = this.getView().byId(\"id_search_table\");\r\n\t\t\t\t\tvar index = oTable.getSelectedIndex();\r\n\t\t\t\t\tif (index === -1) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"selectRowToChangeProcess\"), \"Warning\", this);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.Selecteddata = this.getView().getModel(\"JM_Recidetails\").getProperty(\"/records/\" + index);\r\n\r\n\t\t\t\t\tif (this.Selecteddata.Status === \"I\" || this.Selecteddata.Status === \"S\" || this.Selecteddata.Status === \"D\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(this.Selecteddata.MsgLine, \"Warning\", this);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// show pop up\r\n\t\t\t\t\t// Example Popup model data\r\n\t\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\ttitle: \"Information\",\r\n\t\t\t\t\t\ttext: \"Do you want to proceed with changing this recipe\",\r\n\t\t\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\t\tIndicator: \"CHANGE\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Set model with name\r\n\t\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\t\tif (!this.Confirmation) {\r\n\t\t\t\t\t\tthis.Confirmation = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.getView().addDependent(this.Confirmation);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.Confirmation.open();\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// change function logic and get parm data and key data\r\n\t\tfnChangeLogic: function(Selecteddata) {\r\n\t\t\tvar oServiceCall = this.getOwnerComponent().getModel();\r\n\t\t\tthis.fnSetParmdata(\"RX\").then(function(state) {\r\n\t\t\t\tif (state) {\r\n\t\t\t\t\tdelete Selecteddata.__metadata;\r\n\t\t\t\t\t// Selecteddata.Appid = \"RX\";\r\n\t\t\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\t\t\toWfparm.setData(Selecteddata); // replaces the data\r\n\t\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\t\tvar oPayload = {};\r\n\t\t\t\t\toPayload.Ind = \"C\";\r\n\t\t\t\t\toPayload.Matnr = Selecteddata.Matnr;\r\n\t\t\t\t\toPayload.Werks = Selecteddata.Werks;\r\n\t\t\t\t\toPayload.NavRecipeSearch = [Selecteddata];\r\n\t\t\t\t\toPayload.NavSearchDescription = [];\r\n\t\t\t\t\toServiceCall.create(\"/Recipe_Search_HeaderSet\", oPayload, {\r\n\t\t\t\t\t\tsuccess: function(oData) {\r\n\r\n\t\t\t\t\t\t\tif (oData.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tvar result = oData.NavSearchDescription.results;\r\n\t\t\t\t\t\t\t\toPayload = {};\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < result.length; i++) {\r\n\t\t\t\t\t\t\t\t\tvar data = result[i];\r\n\t\t\t\t\t\t\t\t\tif (data.Fieldname === \"MATNR\") {\r\n\t\t\t\t\t\t\t\t\t\toPayload.Matnr = data.Fieldvalue.replace(/^0+/, \"\");\r\n\t\t\t\t\t\t\t\t\t\toPayload.Maktx = data.Fielddesc;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (data.Fieldname === \"PROFID_STD\") {\r\n\t\t\t\t\t\t\t\t\t\toPayload.ProfileDes = data.Fielddesc;\r\n\t\t\t\t\t\t\t\t\t\toPayload.Profile = data.Fieldvalue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (data.Fieldname === \"WERKS\") {\r\n\t\t\t\t\t\t\t\t\t\toPayload.WerksDes = data.Fielddesc;\r\n\t\t\t\t\t\t\t\t\t\toPayload.Werks = data.Fieldvalue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\toPayload.ReciDes = Selecteddata.Ktext;\r\n\t\t\t\t\t\t\t\toPayload.AppId = \"RX\";\r\n\t\t\t\t\t\t\t\toWfparm = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\t\t\t\t\toWfparm.setData(oPayload); // replaces the data\r\n\t\t\t\t\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\t\t\t\t\tthis.Selecteddata = undefined;\r\n\t\t\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_keydata\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t// set the parm data in the model\r\n\t\tfnSetParmdata: function(AppId) {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar KeyDataId = [\r\n\t\t\t\t\t\"KID_RECI_MATNR\", \"KID_RECI_WERKS\", \"KID_RECI_PROFID_STD\", \"KID_RECI_RECIDES\"\r\n\t\t\t\t];\r\n\t\t\t\tvar oWFParmSet = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toWFParmSet.read(\"/WFParmSet\", {\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"AppId\", sap.ui.model.FilterOperator.EQ, AppId)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tvar oEntry = oData.results[0];\r\n\t\t\t\t\t\tvar oMatchedParams = {};\r\n\t\t\t\t\t\tvar aInvalidParams = [];\r\n\t\t\t\t\t\t// Getting the workflow parameter\r\n\t\t\t\t\t\tObject.keys(oEntry).forEach(function(sKey) {\r\n\t\t\t\t\t\t\tif (/^WfParm\\d+Id$/.test(sKey)) {\r\n\t\t\t\t\t\t\t\tvar sVal = oEntry[sKey];\r\n\t\t\t\t\t\t\t\tif (sVal && sVal.trim() !== \"\") {\r\n\t\t\t\t\t\t\t\t\tif (KeyDataId.includes(sVal.trim())) {\r\n\t\t\t\t\t\t\t\t\t\toMatchedParams[sKey] = sVal.trim();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\taInvalidParams.push(sVal);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\toMatchedParams.AppId = oEntry.AppId;\r\n\r\n\t\t\t\t\t\t// bind the model for the next view\r\n\t\t\t\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\toWfparm.setData(oMatchedParams); // replaces the data\r\n\t\t\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\tif (aInvalidParams.length > 0) {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"workflowParamNotMaintained\"), \"Error\", this);\r\n\t\t\t\t\t\t\tReject(false);\r\n\t\t\t\t\t\t} else if (Object.keys(oMatchedParams).length > 0) {\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tReject(false);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t// navigation to the other views\r\n\t\tfnNavigateToView: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\t// to navigate to the UWL screen\r\n\t\t\tif (id === \"id_uwl\") {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_uwl\");\r\n\t\t\t}\r\n\t\t\tif (id === \"id_material\") {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t}\r\n\t\t\tif (id === \"id_dashboard\") {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_dashboard\");\r\n\t\t\t}\r\n\t\t\tif (id === \"id_workFlow\") {\r\n\t\t\t\tsap.m.URLHelper.redirect(\r\n\t\t\t\t\t\"http://hd1sap.exalca.com:8000/sap/bc/ui5_ui5/sap/zmdm_search/webapp/index.html?sap-client=300&sap-ui-language=EN&sap-ui-xx-devmode=true\",\r\n\t\t\t\t\tfalse);\r\n\t\t\t}\r\n\t\t\tif (id === \"id_RulesEngine\") {\r\n\t\t\t\tsap.m.URLHelper.redirect(\r\n\t\t\t\t\t\"http://hd1sap.exalca.com:8000/sap/bc/ui5_ui5/sap/zmaintain_rules/webapp/index.html?sap-client=300&sap-ui-language=EN&sap-ui-xx-devmode=true\",\r\n\t\t\t\t\tfalse);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// to expand the child list\r\n\t\tfnNavExpandList: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tif (id === \"id_appList\") {\r\n\t\t\t\tthis.getView().byId(\"id_appList_i\").setVisible(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSelectBomRow: function(oEvent) {\r\n\t\t\tvar oTable = oEvent.getSource();\r\n\t\t\tvar iSelectedIndex = oTable.getSelectedIndex();\r\n\t\t\tif (iSelectedIndex < 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar oContext = oTable.getContextByIndex(iSelectedIndex);\r\n\t\t\tif (oContext) {\r\n\t\t\t\tvar oRowData = oContext.getObject();\r\n\t\t\t\tvar vStatus;\r\n\t\t\t\tswitch (oRowData.Status) {\r\n\t\t\t\t\tcase \"C\":\r\n\t\t\t\t\t\tvStatus = \"success\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"I\":\r\n\t\t\t\t\t\tvStatus = \"Error\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"S\":\r\n\t\t\t\t\t\tvStatus = \"Error\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"R\":\r\n\t\t\t\t\t\tvStatus = \"Error\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (oRowData.MsgLine !== \"\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(oRowData.MsgLine, vStatus, this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnMobileViewChanges: function() {\r\n\t\t\tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", false);\r\n\t\t\tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_roadmap\");\r\n\t\t\tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_roadmapSS\");\r\n\t\t\tthis.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t\tthis.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t},\r\n\t\tfnTabDesktopViewChanges: function() {\r\n\t\t\tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", true);\r\n\t\t\tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_roadmapSS\");\r\n\t\t\tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_roadmap\");\r\n\t\t\tthis.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t\tthis.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t},\r\n\t\t_onResize: function() {\r\n\t\t\tvar oRange = sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD);\r\n\r\n\t\t\tif (oRange.name === \"Phone\") {\r\n\t\t\t\tthis.fnMobileViewChanges();\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnTabDesktopViewChanges();\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n});",
		"MANAGED_RECIPE/controller/ErrorHandler.js": "sap.ui.define([], function() {\r\n\t\"use strict\";\r\n\r\n\treturn {\r\n\r\n\t\tparseODataError: function(oResponse) {\r\n\t\t\tvar sErrorMessage = \"Unexpected Error\";\r\n\r\n\t\t\tif (!oResponse) {\r\n\t\t\t\treturn \"No response from server.\";\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (oResponse.responseText) {\r\n\t\t\t\t\tvar oErrorObj = JSON.parse(oResponse.responseText);\r\n\r\n\t\t\t\t\t// Batch response array\r\n\t\t\t\t\tif (Array.isArray(oErrorObj) && oErrorObj[0]) {\r\n\t\t\t\t\t\tvar oErr = oErrorObj[0];\r\n\t\t\t\t\t\tvar sType = oErr.type || \"Error\";\r\n\t\t\t\t\t\tvar sMsg = oErr.message || \"Unknown error\";\r\n\t\t\t\t\t\tvar sCode = oResponse.statusCode || \"\";\r\n\t\t\t\t\t\tsErrorMessage = (sCode ? sCode + \" - \" : \"\") + sType + \": \" + sMsg;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Standard OData JSON\r\n\t\t\t\t\telse if (oErrorObj.error && oErrorObj.error.message && oErrorObj.error.message.value) {\r\n\t\t\t\t\t\tsErrorMessage = oResponse.statusCode + \" - \" + oErrorObj.error.message.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Root-level message\r\n\t\t\t\t\telse if (oErrorObj.message) {\r\n\t\t\t\t\t\tsErrorMessage = oResponse.statusCode + \" - Error: \" + oErrorObj.message;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsErrorMessage = oResponse.statusCode + \" - \" + (oResponse.statusText || \"Unknown Error\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsErrorMessage = oResponse.statusCode + \" - \" + (oResponse.statusText || \"Unknown Error\");\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tsErrorMessage = oResponse.statusCode + \" - \" + (oResponse.statusText || \"Unexpected Error\");\r\n\t\t\t}\r\n\r\n\t\t\treturn sErrorMessage;\r\n\t\t},\r\n\r\n\t\tshowCustomSnackbar: function(sMessage, sType, oController) {\r\n\t\t\tthis.createSnackbar();\r\n\r\n\t\t\t// Clear previous content\r\n\t\t\tthis._snackbar.removeAllItems();\r\n\t\t\tthis._snackbar.removeStyleClass(\"\");\r\n\t\t\tthis._snackbar.addStyleClass(\"customSnackbar hideMessage\");\r\n\r\n\t\t\t// Determine style and icon\r\n\r\n\t\t\tvar sSubheading = \"\";\r\n\t\t\tvar sTitlestyle = \"\";\r\n\r\n\t\t\tvar sIcon = \"\";\r\n\t\t\tswitch (sType) {\r\n\t\t\t\tcase \"success\":\r\n\t\t\t\t\tsSubheading = \"cl_snackbar_subhedding_s\";\r\n\t\t\t\t\tsTitlestyle = \"cl_msgBoxTitle_s\";\r\n\t\t\t\t\tsIcon = oController.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Sucess.svg\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Error\":\r\n\t\t\t\t\tsSubheading = \"cl_snackbar_subhedding_e\";\r\n\t\t\t\t\tsTitlestyle = \"cl_msgBoxTitle_e\";\r\n\t\t\t\t\tsIcon = oController.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Error.svg\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Warning\":\r\n\t\t\t\t\tsSubheading = \"cl_snackbar_subhedding_w\";\r\n\t\t\t\t\tsTitlestyle = \"cl_msgBoxTitle_w\";\r\n\t\t\t\t\tsIcon = oController.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Warning.svg\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"info\":\r\n\t\t\t\tcase \"information\":\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tsSubheading = \"cl_snackbar_subhedding_i\";\r\n\t\t\t\t\tsTitlestyle = \"cl_msgBoxTitle_i\";\r\n\t\t\t\t\tsIcon = oController.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Info.svg\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvar oIcon = new sap.m.Image({\r\n\t\t\t\tsrc: sIcon,\r\n\t\t\t\twidth: \"31px\"\r\n\t\t\t}).addStyleClass(\"cl_snackbarIcon\");\r\n\r\n\t\t\tvar oLeftVBox = new sap.m.VBox({\r\n\t\t\t\talignItems: \"Center\",\r\n\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\twidth: \"3.5rem\",\r\n\t\t\t\titems: [oIcon]\r\n\t\t\t});\r\n\r\n\t\t\t// RIGHT VBox with 2 HBoxes (title + message)\r\n\t\t\tvar oTitle = new sap.m.Text({\r\n\t\t\t\ttext: sType\r\n\t\t\t}).addStyleClass(sTitlestyle);\r\n\r\n\t\t\tvar oMessage = new sap.m.Text({\r\n\t\t\t\ttext: sMessage\r\n\t\t\t}).addStyleClass(\"cl_msgBoxMessage\");\r\n\r\n\t\t\tvar oTitleHBox = new sap.m.HBox({\r\n\t\t\t\titems: [oTitle]\r\n\t\t\t});\r\n\r\n\t\t\tvar oMessageHBox = new sap.m.HBox({\r\n\t\t\t\titems: [oMessage]\r\n\t\t\t});\r\n\r\n\t\t\tvar oRightVBox = new sap.m.VBox({\r\n\t\t\t\titems: [oTitleHBox, oMessageHBox]\r\n\t\t\t});\r\n\r\n\t\t\tvar oHBox = new sap.m.HBox({\r\n\t\t\t\talignItems: \"Center\",\r\n\t\t\t\theight: \"2.5rem\",\r\n\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\titems: [oLeftVBox, oRightVBox]\r\n\t\t\t}).addStyleClass(sSubheading);\r\n\r\n\t\t\tthis._snackbar.addItem(oHBox);\r\n\r\n\t\t\t// Show with animation\r\n\t\t\tthis._snackbar.setVisible(true);\r\n\t\t\tthis._snackbar.removeStyleClass(\"hideMessage\");\r\n\t\t\tthis._snackbar.addStyleClass(\"showMessage\");\r\n\r\n\t\t\t// Hide after timeout\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tthis._snackbar.removeStyleClass(\"showMessage\");\r\n\t\t\t\tthis._snackbar.addStyleClass(\"hideMessage\");\r\n\t\t\t}.bind(this), 3000);\r\n\t\t},\r\n\r\n\t\tcreateSnackbar: function() {\r\n\t\t\tif (this._snackbar) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._snackbar = new sap.m.VBox({\r\n\t\t\t\talignItems: \"Center\",\r\n\t\t\t\tjustifyContent: \"Center\"\r\n\t\t\t}).addStyleClass(\"customSnackbar hideMessage\").placeAt(sap.ui.getCore().getStaticAreaRef());\r\n\t\t}\r\n\t};\r\n});",
		"MANAGED_RECIPE/controller/reci_initiator.controller.js": "sap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n], function(Controller, ErrorHandler, formatter, FilterOperator, Filter, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tvar frontEndId = [\"ID_RECI_LOSVN\", \"ID_RECI_LOSBS\", \"ID_RECI_PLNME\", \"ID_RECI_BMSCH\", \"ID_RECI_MEINH\",\r\n\t\t\"ID_RECI_UMREZ\", \"ID_RECI_UMREN\", \"ID_RECI_STATU\", \"ID_RECI_VERWE\", \"ID_RECI_VAGRP\"\r\n\t];\r\n\r\n\tvar i18n;\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.reci_initiator\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\tonInit: function() {\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\tthis.f4Cache = {};\r\n\t\t\tthis.ChangeDataArray = [];\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"reci_initiator\").attachPatternMatched(this.fnRouter, this);\r\n\t\t},\r\n\r\n\t\tfnRouter: function() {\r\n\r\n\t\t\t// added by sabarish 20.11.2025\r\n\t\t\t// var oVisModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t// \tlabelVisible: true\r\n\t\t\t// });\r\n\t\t\t// this.getView().setModel(oVisModel, \"RoadMapUI\");\r\n\t\t\t// sap.ui.Device.resize.attachHandler(this._onResize, this);\r\n\t\t\t// this._onResize();\r\n\t\t\t//eoc\r\n\t\t\tthis._loadContextModelLocal();\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tbusyDialog.open();\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_UserModel\");\r\n\t\t\t\t\tthis.UserName = oData.results[0].Uname;\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").removeStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").addStyleClass(\"cl_list_con\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").addStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").removeStyleClass(\"cl_list_con\");\r\n\r\n\t\t\tvar oKeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\tvar oWfParmeter = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\r\n\t\t\tif (Object.keys(oKeyDataModel.getData() || {}).length > 0 && Object.keys(oWfParmeter.getData() || {}).length > 0) { // initiator\r\n\t\t\t\tthis.AppId = \"RC\";\r\n\t\t\t\tvar oTableModel1 = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tList: []\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oTableModel1, \"JM_DocTypeModel\"); // local model for the Attachemnt \r\n\r\n\t\t\t\tvar oMainModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tuploadedFileName: \"\"\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oMainModel); // local modle of attachement name\r\n\r\n\t\t\t\t// Reviwer and Approver Process\r\n\t\t\t\tvar UwlData = oFromUwl.getData();\r\n\t\t\t\tvar oUwlModel = new sap.ui.model.json.JSONModel(UwlData);\r\n\r\n\t\t\t\tthis.getView().setModel(oUwlModel, \"JM_ContextModel\");\r\n\t\t\t\tthis.fnInitializeScreen();\r\n\t\t\t\tvar footerBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\tReject: false,\r\n\t\t\t\t\tDraft: true,\r\n\t\t\t\t\tsubmit: true,\r\n\t\t\t\t\tCheckDup: true\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\"); // local Model to set visble and unvisble the footer button\r\n\r\n\t\t\t\tvar vKeyData = oKeyDataModel.getData();\r\n\t\t\t\tvar lkeyDataModel = new sap.ui.model.json.JSONModel(vKeyData);\r\n\t\t\t\tthis.getView().setModel(lkeyDataModel, \"JM_KeydataModel\"); // local model for the Key data \r\n\r\n\t\t\t\tvar recipeModel = this.getView().getModel(\"JM_InitiatorModel\");\r\n\t\t\t\tif (!recipeModel) {\r\n\t\t\t\t\tvar RecipeModel = {\r\n\t\t\t\t\t\tStatu: \"\",\r\n\t\t\t\t\t\tVerwe: \"\",\r\n\t\t\t\t\t\tVagrp: \"\",\r\n\t\t\t\t\t\tNname: \"\",\r\n\t\t\t\t\t\tLosvn: \"\",\r\n\t\t\t\t\t\tPlnme: \"\",\r\n\t\t\t\t\t\tLosbs: 9999999999.000,\r\n\t\t\t\t\t\tBmsch: \"1.00\",\r\n\t\t\t\t\t\tMeinh: \"\",\r\n\t\t\t\t\t\tUmrez: 1,\r\n\t\t\t\t\t\tUmren: 1,\r\n\t\t\t\t\t\tChrule: \" \"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar oRecipeModel = new sap.ui.model.json.JSONModel(RecipeModel);\r\n\t\t\t\t\tthis.getView().setModel(oRecipeModel, \"JM_InitiatorModel\"); // local model of recipe Data\r\n\r\n\t\t\t\t\t//Call entity for Tskl Unit\r\n\t\t\t\t\tvar oInitiator = this.getOwnerComponent().getModel();\r\n\t\t\t\t\tvar oPayload = {\r\n\t\t\t\t\t\tMatnr: this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Matnr\"),\r\n\t\t\t\t\t\tInd: \"G\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\toPayload.NavRecipeBasic = [];\r\n\t\t\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\t\t\toPayload.NavRecipeAttachment = [];\r\n\r\n\t\t\t\t\tbusyDialog.open();\r\n\t\t\t\t\toInitiator.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\t\tif (oData && oData.NavRecipeBasic && oData.NavRecipeBasic.results && oData.NavRecipeBasic.results.length > 0) {\r\n\t\t\t\t\t\t\t\tvar vValue = oData.NavRecipeBasic.results[0].Plnme;\r\n\t\t\t\t\t\t\t\tthis.getView().getModel(\"JM_InitiatorModel\").setProperty(\"/Plnme\", vValue);\r\n\t\t\t\t\t\t\t\tthis.selectedField = \"ID_RECI_PLNME\";\r\n\t\t\t\t\t\t\t\tvar oPlnmePayload = {\r\n\t\t\t\t\t\t\t\t\tFieldId: \"ID_RECI_PLNME\",\r\n\t\t\t\t\t\t\t\t\tProcess: \"X\",\r\n\t\t\t\t\t\t\t\t\tF4Type: \"P\"\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\toPlnmePayload.NavSerchResult = [];\r\n\t\t\t\t\t\t\t\tthis.fnNewReadF4Cache(oPlnmePayload, vValue.toUpperCase());\r\n\t\t\t\t\t\t\t\tvar ChangeRulePayload = {\r\n\t\t\t\t\t\t\t\t\tFieldId: \"ID_RECI_CHRULE\",\r\n\t\t\t\t\t\t\t\t\tProcess: \"X\",\r\n\t\t\t\t\t\t\t\t\tF4Type: \"F\"\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tChangeRulePayload.NavSerchResult = [];\r\n\t\t\t\t\t\t\t\tthis.fnNewReadF4Cache(ChangeRulePayload, \"\", \"F\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (Object.keys(oFromUwl.getData() || {}).length > 0) {\r\n\t\t\t\tvar Ind = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Ind\");\r\n\t\t\t\tthis.AppId = this.getOwnerComponent().getModel(\"JM_KeyData\").getProperty(\"/AppId\");\r\n\t\t\t\tif (!this.AppId) {\r\n\t\t\t\t\tthis.AppId = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Appid\");\r\n\t\t\t\t}\r\n\t\t\t\tif (this.AppId === \"RX\" && Ind !== \"X\" && Ind !== \"D\" && Ind !== \"T\") {\r\n\r\n\t\t\t\t\t// this.fnRecipeChangeProcess();\r\n\t\t\t\t\tvar contextModel = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\t\t\tcontextModel.setProperty(\"/Appid\", \"RX\");\r\n\t\t\t\t\toPayload = {\r\n\t\t\t\t\t\tAppId: \"RX\",\r\n\t\t\t\t\t\tInd: \"P\",\r\n\t\t\t\t\t\tPlnnr: contextModel.getProperty(\"/Plnnr\"),\r\n\t\t\t\t\t\tPlnal: contextModel.getProperty(\"/Plnal\")\r\n\t\t\t\t\t};\r\n\t\t\t\t\toPayload.NavRecipeBasic = [];\r\n\t\t\t\t\toPayload.NavDescription = [];\r\n\t\t\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\t\t\toPayload.NavRecipeAttachment = [];\r\n\t\t\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\t\t\toPayload.NavRecipe_Operation = [];\r\n\t\t\t\t\toPayload.NavBomHeader = [];\r\n\t\t\t\t\toPayload.NavBomItem = [];\r\n\t\t\t\t\toPayload.NavPV_BasicFields = [];\r\n\t\t\t\t\toPayload.NavPV_MaterialCompData = [];\r\n\t\t\t\t\toPayload.NavUserInput = [];\r\n\t\t\t\t\tthis.fnInitializeScreen();\r\n\t\t\t\t\tvar ChangeRulePayload = {\r\n\t\t\t\t\t\tFieldId: \"ID_RECI_CHRULE\",\r\n\t\t\t\t\t\tProcess: \"X\",\r\n\t\t\t\t\t\tF4Type: \"F\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tChangeRulePayload.NavSerchResult = [];\r\n\t\t\t\t\tthis.fnNewReadF4Cache(ChangeRulePayload, \"\", \"F\");\r\n\t\t\t\t\tthis.fnGetandSetData(this.flag, oPayload);\r\n\t\t\t\t\tfooterBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\t\tReject: false,\r\n\t\t\t\t\t\tDraft: true,\r\n\t\t\t\t\t\tsubmit: true,\r\n\t\t\t\t\t\tCheckDup: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tUwlData = oFromUwl.getData();\r\n\t\t\t\t\toUwlModel = new sap.ui.model.json.JSONModel(UwlData);\r\n\r\n\t\t\t\t\tthis.getView().setModel(oUwlModel, \"JM_ContextModel\");\r\n\t\t\t\t\tthis.workId = this.getView().getModel(\"JM_ContextModel\").getProperty(\"/WiId\");\r\n\t\t\t\t\tthis.Transid = this.getView().getModel(\"JM_ContextModel\").getProperty(\"/Transid\");\r\n\t\t\t\t\tthis.Level = this.getView().getModel(\"JM_ContextModel\").getProperty(\"/Level\");\r\n\t\t\t\t\tthis.Ind = this.getView().getModel(\"JM_ContextModel\").getProperty(\"/Ind\");\r\n\r\n\t\t\t\t\tthis.fnInitializeScreen();\r\n\r\n\t\t\t\t\tfooterBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\tsendBack: true,\r\n\t\t\t\t\t\tReject: true,\r\n\t\t\t\t\t\tDraft: false,\r\n\t\t\t\t\t\tsubmit: true,\r\n\t\t\t\t\t\tCheckDup: false\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\r\n\t\t\t\t\tif (this.Ind === \"T\") {\r\n\t\t\t\t\t\tfooterBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\t\t\tReject: false,\r\n\t\t\t\t\t\t\tDraft: false,\r\n\t\t\t\t\t\t\tCheckDup: false,\r\n\t\t\t\t\t\t\tsubmit: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.Ind === \"D\") {\r\n\t\t\t\t\t\tfooterBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\t\t\tReject: false,\r\n\t\t\t\t\t\t\tDraft: false,\r\n\t\t\t\t\t\t\tsubmit: true,\r\n\t\t\t\t\t\t\tCheckDup: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar sendback = this.getView().getModel(\"JM_ContextModel\").getProperty(\"/Sendback\");\r\n\t\t\t\t\tif (sendback === \"X\") {\r\n\t\t\t\t\t\tthis.getView().getModel(\"JM_FooterBtnModel\").setProperty(\"/sendBack\", false);\r\n\t\t\t\t\t\tthis.getView().getModel(\"JM_FooterBtnModel\").refresh(true);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\toPayload = {\r\n\t\t\t\t\t\tTransid: this.getView().getModel(\"JM_ContextModel\").getProperty(\"/Transid\"),\r\n\t\t\t\t\t\tInd: \"G\",\r\n\t\t\t\t\t\tAppId: this.AppId,\r\n\t\t\t\t\t\tWiId: this.getView().getModel(\"JM_ContextModel\").getProperty(\"/WiId\")\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\toPayload.NavRecipeBasic = [];\r\n\t\t\t\t\toPayload.NavDescription = [];\r\n\t\t\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\t\t\toPayload.NavRecipeAttachment = [];\r\n\t\t\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\t\t\toPayload.NavRecipe_Operation = [];\r\n\t\t\t\t\toPayload.NavBomHeader = [];\r\n\t\t\t\t\toPayload.NavBomItem = [];\r\n\t\t\t\t\toPayload.NavPV_BasicFields = [];\r\n\t\t\t\t\toPayload.NavPV_MaterialCompData = [];\r\n\t\t\t\t\toPayload.NavUserInput = [];\r\n\t\t\t\t\toPayload.NavRecipe_ChangeLog = [];\r\n\r\n\t\t\t\t\tthis.fnGetandSetData(this.flag, oPayload);\r\n\t\t\t\t}\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnsetIndicationforChangedData: function(ChangedData) {\r\n\t\t\tChangedData = ChangedData.filter(function(item) {\r\n\t\t\t\treturn item.ProcessInd === \"R\";\r\n\t\t\t});\r\n\t\t\t// Loop through filtered data and highlight the matching controls\r\n\t\t\tChangedData.forEach(function(item) {\r\n\t\t\t\tvar sFieldId = item.FieldId; // get FieldId from each object\r\n\t\t\t\tif (sFieldId) { // skip empty objects\r\n\t\t\t\t\t// Find the control using the FieldId\r\n\t\t\t\t\tvar oControl = this.byId(sFieldId);\r\n\r\n\t\t\t\t\t// Add highlight class if control exists\r\n\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\toControl.addStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)); // keep controller context\r\n\t\t},\r\n\r\n\t\tfnClearIndicationforChangedData: function(ChangedData) {\r\n\t\t\tChangedData = ChangedData.filter(function(item) {\r\n\t\t\t\treturn item.ProcessInd === \"R\";\r\n\t\t\t});\r\n\t\t\t// Loop through filtered data and highlight the matching controls\r\n\t\t\tChangedData.forEach(function(item) {\r\n\t\t\t\tvar sFieldId = item.FieldId; // get FieldId from each object\r\n\t\t\t\tif (sFieldId) { // skip empty objects\r\n\t\t\t\t\t// Find the control using the FieldId\r\n\t\t\t\t\tvar oControl = this.byId(sFieldId);\r\n\r\n\t\t\t\t\t// Add highlight class if control exists\r\n\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\toControl.removeStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)); // keep controller context\r\n\t\t},\r\n\r\n\t\tfnGetandSetData: function(flag, oPayload) {\r\n\t\t\tvar oKeyDataModel;\r\n\t\t\tvar oRecipeModel;\r\n\t\t\tvar lkeyDataModel;\r\n\t\t\tvar oServiceCall = this.getOwnerComponent().getModel();\r\n\t\t\tif (!this.flag || this.flag === undefined) {\r\n\t\t\t\tvar oTableModel1 = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tList: []\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oTableModel1, \"JM_DocTypeModel\"); // local model for the Attachemnt \r\n\r\n\t\t\t\tvar oMainModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tuploadedFileName: \"\"\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oMainModel); // local modle of attachement name\r\n\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toServiceCall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tthis.flag = true;\r\n\r\n\t\t\t\t\t\tvar oOdata = this.getOwnerComponent().getModel(\"JM_InitialDatas\");\r\n\t\t\t\t\t\toOdata.setData(oData); // replaces the data\r\n\t\t\t\t\t\toOdata.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\t// Description Model\r\n\t\t\t\t\t\tvar descModel = {};\r\n\t\t\t\t\t\tvar descData = oData.NavDescription.results;\r\n\t\t\t\t\t\tfor (var i = 0; i < descData.length; i++) {\r\n\t\t\t\t\t\t\tvar item = descData[i];\r\n\t\t\t\t\t\t\tif (item.Itemno !== \"\") {\r\n\t\t\t\t\t\t\t\tif (!descModel[item.Itemno]) {\r\n\t\t\t\t\t\t\t\t\tdescModel[item.Itemno] = [];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar data = {\r\n\t\t\t\t\t\t\t\t\tvalue: item.Fieldvalue,\r\n\t\t\t\t\t\t\t\t\tdesc: item.Fielddesc,\r\n\t\t\t\t\t\t\t\t\tFieldName: item.Fieldname\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tdescModel[item.Itemno].push(data);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (!descModel[item.Fieldname]) {\r\n\t\t\t\t\t\t\t\t\tdescModel[item.Fieldname] = {\r\n\t\t\t\t\t\t\t\t\t\tvalue: item.Fieldvalue,\r\n\t\t\t\t\t\t\t\t\t\tdesc: item.Fielddesc\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar oDescModel = new sap.ui.model.json.JSONModel(descModel);\r\n\t\t\t\t\t\tthis.getView().setModel(oDescModel, \"JM_DescriptionModel\");\r\n\t\t\t\t\t\tsap.ui.getCore().setModel(oDescModel, \"JM_DescriptionModel\");\r\n\r\n\t\t\t\t\t\tthis.fnBindDescriptionForRecipe();\r\n\r\n\t\t\t\t\t\t// Key Model for Global and Local\r\n\t\t\t\t\t\tvar KeyDataModel = {\r\n\t\t\t\t\t\t\tAppId: this.AppId,\r\n\t\t\t\t\t\t\tMatnr: oData.Matnr,\r\n\t\t\t\t\t\t\tMaktx: oData.Maktx,\r\n\t\t\t\t\t\t\tWerks: oData.Werks,\r\n\t\t\t\t\t\t\tWerksDes: oData.Name1,\r\n\t\t\t\t\t\t\tProfile: oData.Profidnetz,\r\n\t\t\t\t\t\t\tReciDes: oData.Ktext,\r\n\t\t\t\t\t\t\tPlnnr: oData.Plnnr,\r\n\t\t\t\t\t\t\tPlnal: oData.Plnal\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\toKeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\t\t\toKeyDataModel.setData(KeyDataModel); // replaces the data\r\n\t\t\t\t\t\toKeyDataModel.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\t// Recipe Data\r\n\t\t\t\t\t\toRecipeModel = this.getOwnerComponent().getModel(\"JM_Recipe\");\r\n\t\t\t\t\t\toRecipeModel.setData(oData.NavRecipeBasic.results[0]); // replaces the data\r\n\t\t\t\t\t\toRecipeModel.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\t\t\toChangeLogModel.setData(oData.NavRecipe_ChangeLog.results); // replaces the data\r\n\t\t\t\t\t\toRecipeModel.refresh(true); // updates the bindingsS\r\n\r\n\t\t\t\t\t\tlkeyDataModel = new sap.ui.model.json.JSONModel(KeyDataModel);\r\n\t\t\t\t\t\tthis.getView().setModel(lkeyDataModel, \"JM_KeydataModel\"); // local model for the Key data \r\n\t\t\t\t\t\tvar oDataCopy = JSON.parse(JSON.stringify(oData.NavRecipeBasic.results[0]));\r\n\t\t\t\t\t\tvar lkeyDataModel1 = new sap.ui.model.json.JSONModel(oData.NavRecipeBasic.results[0]);\r\n\t\t\t\t\t\tvar lkeyDataModel2 = new sap.ui.model.json.JSONModel(oDataCopy);\r\n\r\n\t\t\t\t\t\tthis.getView().setModel(lkeyDataModel1, \"JM_InitiatorModel\"); // local model for Recipe data\r\n\t\t\t\t\t\tthis.getView().setModel(lkeyDataModel2, \"JM_RecipeInitialData\"); // local model for Recipe Data for cahnge process\r\n\r\n\t\t\t\t\t\t// Opeartion Screen \r\n\t\t\t\t\t\tvar oModel1 = {\r\n\t\t\t\t\t\t\tNavRecipe_Operation: oData.NavRecipe_Operation.results\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tvar oOperationModel = this.getOwnerComponent().getModel(\"JM_Operation\");\r\n\t\t\t\t\t\toOperationModel.setData(oModel1); // replaces the data\r\n\t\t\t\t\t\toOperationModel.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\t// Production Version data\r\n\t\t\t\t\t\tvar model = {\r\n\t\t\t\t\t\t\tNavPV_BasicFields: oData.NavPV_BasicFields.results,\r\n\t\t\t\t\t\t\tNavPV_MaterialCompData: oData.NavPV_MaterialCompData.results\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar oProductionVersion = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\t\t\t\toProductionVersion.setData(model); // replaces the data\r\n\t\t\t\t\t\toProductionVersion.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\t// BOM Model \r\n\t\t\t\t\t\tmodel = {\r\n\t\t\t\t\t\t\tNavBomHeader: oData.NavBomHeader.results,\r\n\t\t\t\t\t\t\tNavBomItem: oData.NavBomItem.results\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar oBomModel = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\t\t\t\toBomModel.setData(model); // replaces the data\r\n\t\t\t\t\t\toBomModel.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\t//Comments \r\n\t\t\t\t\t\tvar oCommentBox = this.getView().byId(\"id_commentbox\");\r\n\t\t\t\t\t\tthis.fnBindComments(oData.NavRecipeComments.results, oCommentBox);\r\n\r\n\t\t\t\t\t\t//Attachments \r\n\t\t\t\t\t\tthis.fnBindAttachements(oData);\r\n\r\n\t\t\t\t\t\t//update change log for Reviwer and approver for the change process\r\n\t\t\t\t\t\toChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\t\t\tif (Object.keys(oChangeLogModel.getData() || {}).length > 0) {\r\n\t\t\t\t\t\t\t// Get data and create a deep copy\r\n\t\t\t\t\t\t\tvar existingData = oChangeLogModel ? JSON.parse(JSON.stringify(oChangeLogModel.getData())) : [];\r\n\t\t\t\t\t\t\t// Check if model has some data and AppId === \"RX\"\r\n\t\t\t\t\t\t\tif (existingData && existingData.length > 0 && this.AppId === \"RX\") {\r\n\t\t\t\t\t\t\t\tthis.fnsetIndicationforChangedData(existingData);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar ChangeRulePayload = {\r\n\t\t\t\t\t\t\tFieldId: \"ID_RECI_CHRULE\",\r\n\t\t\t\t\t\t\tProcess: \"X\",\r\n\t\t\t\t\t\t\tF4Type: \"F\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tChangeRulePayload.NavSerchResult = [];\r\n\t\t\t\t\t\tthis.fnNewReadF4Cache(ChangeRulePayload, \"\", \"F\");\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t}); // Reviwer and Approver process\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnBindComments: function(backendData, container) {\r\n\t\t\tfor (var c = 0; c < backendData.length; c++) {\r\n\t\t\t\t// Create the dot indicator and line logic VBox\r\n\t\t\t\tvar Pos1 = (backendData[c].Pos === \"\") ? true : false;\r\n\t\t\t\tvar Pos2 = (backendData[c].Pos === \"Last\") ? true : false;\r\n\t\t\t\tvar oDotVBox = new sap.m.VBox({\r\n\t\t\t\t\talignContent: \"Start\",\r\n\t\t\t\t\talignItems: \"Center\",\r\n\t\t\t\t\tjustifyContent: \"Start\",\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\tnew sap.m.Image({\r\n\t\t\t\t\t\t\tsrc: \"image/CommentDot.svg\",\r\n\t\t\t\t\t\t\twidth: \"0.4rem\"\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tnew sap.m.HBox({\r\n\t\t\t\t\t\t\tvisible: Pos1\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tnew sap.m.HBox({\r\n\t\t\t\t\t\t\tvisible: Pos2\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t]\r\n\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBegin\");\r\n\t\t\t\t// Create the right side (profile + comment)\r\n\t\t\t\tvar oRightVBox = new sap.m.VBox({\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\tnew sap.m.HBox({\r\n\t\t\t\t\t\t\titems: [\r\n\t\t\t\t\t\t\t\tnew sap.m.Image({\r\n\t\t\t\t\t\t\t\t\tsrc: \"Image/profile.svg\",\r\n\t\t\t\t\t\t\t\t\twidth: \"1.5rem\"\r\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBeginEnd\"),\r\n\t\t\t\t\t\t\t\tnew sap.m.Text({\r\n\t\t\t\t\t\t\t\t\ttext: backendData[c].CreatedBy\r\n\t\t\t\t\t\t\t\t}).addStyleClass(\"cl_comm_nam\"),\r\n\t\t\t\t\t\t\t\tnew sap.m.Text({\r\n\t\t\t\t\t\t\t\t\ttext: \"Added A Comment\"\r\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBeginEnd cl_comm_subtx\"),\r\n\t\t\t\t\t\t\t\tnew sap.m.Image({\r\n\t\t\t\t\t\t\t\t\tsrc: \"image/dot_c2.svg\",\r\n\t\t\t\t\t\t\t\t\twidth: \"0.4rem\"\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\tnew sap.m.Text({\r\n\t\t\t\t\t\t\t\t\ttext: backendData[c].CrtdDate + \" - \" + backendData[c].CrtdTime\r\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBeginEnd cl_comm_date\")\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tnew sap.m.Panel({\r\n\t\t\t\t\t\t\t// width: \"10%\",\r\n\t\t\t\t\t\t\tcontent: [\r\n\t\t\t\t\t\t\t\tnew sap.m.Text({\r\n\t\t\t\t\t\t\t\t\ttext: backendData[c].Comments,\r\n\t\t\t\t\t\t\t\t\twrapping: true,\r\n\t\t\t\t\t\t\t\t\twidth: \"100%\"\r\n\t\t\t\t\t\t\t\t}).addStyleClass(\"cl_cmt_txt\")\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}).addStyleClass(\"cl_cmmt_bx sapUiTinyMarginBegin sapUiSmallMarginBottom\")\r\n\t\t\t\t\t]\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Combine left and right side into HBox\r\n\t\t\t\tvar oCommentCard = new sap.m.HBox({\r\n\t\t\t\t\twidth: \"45%\",\r\n\t\t\t\t\titems: [oDotVBox, oRightVBox]\r\n\t\t\t\t}).addStyleClass(\"cl_commt_hbx sapUiSmallMarginTop\");\r\n\r\n\t\t\t\t// Add to container\r\n\t\t\t\tcontainer.addItem(oCommentCard);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnBindAttachements: function(oData) {\r\n\t\t\tvar vAttachmentDataArray = [];\r\n\t\t\tfor (var b = 0; b < oData.NavRecipeAttachment.results.length; b++) {\r\n\t\t\t\tvar serial = Number(oData.NavRecipeAttachment.results[b].SerialNo);\r\n\t\t\t\tvar vObj = {\r\n\t\t\t\t\t\"AttachmentNo\": serial,\r\n\t\t\t\t\t\"TagName\": oData.NavRecipeAttachment.results[b].FileName,\r\n\t\t\t\t\t\"DocType\": oData.NavRecipeAttachment.results[b].FileName.split('.')[1],\r\n\t\t\t\t\t\"Xstring\": oData.NavRecipeAttachment.results[b].Xstring,\r\n\t\t\t\t\t\"MimeType\": oData.NavRecipeAttachment.results[b].MimeType,\r\n\t\t\t\t\t\"Size\": oData.NavRecipeAttachment.results[b].FileSize\r\n\t\t\t\t};\r\n\t\t\t\tvAttachmentDataArray.push(vObj);\r\n\t\t\t}\r\n\r\n\t\t\t// var oJsonList2 = new sap.ui.model.json.JSONModel();\r\n\t\t\tvar oJsonList2 = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tList: vAttachmentDataArray\r\n\t\t\t});\r\n\r\n\t\t\tthis.attachments = oData.NavRecipeAttachment.results;\r\n\r\n\t\t\t// oJsonList2.setData(vAttachmentDataArray);\r\n\t\t\tthis.getView().setModel(oJsonList2, \"JM_DocTypeModel\");\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for Live Change (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\r\n\t\t\t// Convert input to uppercase (for text fields)\r\n\t\t\toInput.setValue(vValue);\r\n\r\n\t\t\tthis.selectedField = id;\r\n\t\t\toInput.setValueState(\"None\"); // reset previous error\r\n\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: id,\r\n\t\t\t\tProcess: \"X\",\r\n\t\t\t\tF4Type: \"P\"\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tif (id === \"ID_RECI_VAGRP\" || id === \"ID_RECI_NNAME\") {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\tvar KeyDataModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\t\tif (KeyDataModel) {\r\n\t\t\t\t\toPayload.Value1 = KeyDataModel.getProperty(\"/Werks\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (id === \"KID_RECI_MATNR\") {\r\n\t\t\t\tthis.fnNewReadF4Cache(oPayload, vValue.toUpperCase().replace(/^0+/, \"\"));\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnNewReadF4Cache(oPayload, vValue.toUpperCase());\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(id);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnNewReadF4Cache: function(oPayload, vValue) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar vId = oPayload.FieldId;\r\n\t\t\tvar f4type = oPayload.F4Type;\r\n\t\t\tvar match;\r\n\t\t\tvar descriptionField;\r\n\r\n\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\tif (f4type === \"P\") {\r\n\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\treturn item.Value1 === vValue.toUpperCase();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(match.Value2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (f4type === \"F\") {\r\n\t\t\t\t\tvar changeRuledata = [];\r\n\t\t\t\t\tresults.forEach(function(item) {\r\n\t\t\t\t\t\tvar data = {\r\n\t\t\t\t\t\t\tkey: item.DomvalueL,\r\n\t\t\t\t\t\t\tvalue: item.Ddtext\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tchangeRuledata.push(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar changeRuleModel = new sap.ui.model.json.JSONModel(changeRuledata);\r\n\t\t\t\t\tthat.getView().setModel(changeRuleModel, \"JM_ChangeRule\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar length = that.fnCheckDatavalidation(that.selectedField, vValue);\r\n\t\t\t\tif (length === 0 && vValue !== \"\") {\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"Error\");\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueStateText(i18n.getText(\"valueNotAvail\", [vValue]));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"None\");\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4NewdescriptionGet(oPayload, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tf4NewdescriptionGet: function(oPayload, fnCallback) {\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar vId = oPayload.FieldId;\r\n\t\t\toModel.setUseBatch(false);\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthis.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnCheckDatavalidation: function(id, value) {\r\n\t\t\tvar data = this.f4Cache[id];\r\n\t\t\tif (!data || !Array.isArray(data)) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tvar sQuery = value ? value.toUpperCase() : \"\";\r\n\t\t\tvar aMatched = [];\r\n\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taMatched = data.filter(function(item) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t(item.Value1 && item.Value1.toUpperCase().includes(sQuery))\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Return matched length\r\n\t\t\treturn aMatched.length;\r\n\t\t},\r\n\r\n\t\tfnUpdateChangelog: function(vId) {\r\n\t\t\tvar newValue = this.getView().byId(vId).getValue();\r\n\r\n\t\t\t// Step 1: Remove prefix \"ID_RECI_\"\r\n\t\t\tvar trimmed = vId.replace(/^ID_RECI_/, \"\");\r\n\r\n\t\t\t// Step 2: Convert to PascalCase (e.g. PROFILE_DES  ProfileDes)\r\n\t\t\tvar parts = trimmed.toLowerCase().split(\"_\");\r\n\t\t\tvar ObjectId = parts.map(function(p) {\r\n\t\t\t\treturn p.charAt(0).toUpperCase() + p.slice(1);\r\n\t\t\t}).join(\"\");\r\n\r\n\t\t\t// Step 3: Get RecipeInitialData model\r\n\t\t\tvar oRecipeInitialDataModel = this.getView().getModel(\"JM_RecipeInitialData\");\r\n\t\t\tif (!oRecipeInitialDataModel) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oRecipeData = oRecipeInitialDataModel.getData();\r\n\r\n\t\t\t// Step 4: Check if field exists\r\n\t\t\tif (!oRecipeData.hasOwnProperty(ObjectId)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oldValue = oRecipeData[ObjectId];\r\n\r\n\t\t\t// Step 5: Get or create ChangeLog model\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\r\n\t\t\t// Ensure we have an array\r\n\t\t\tvar oChangeLogData = oChangeLogModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\toChangeLogData = [];\r\n\t\t\t}\r\n\r\n\t\t\t// Step 6: Find if entry already exists\r\n\t\t\tvar idx = oChangeLogData.findIndex(function(item) {\r\n\t\t\t\treturn item.FieldId === vId;\r\n\t\t\t});\r\n\r\n\t\t\t// Step 7: Add, update, or remove entry\r\n\t\t\tif (oldValue !== newValue) {\r\n\t\t\t\tif (idx === -1) {\r\n\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\t\tProcessInd: \"R\",\r\n\t\t\t\t\t\tProcessDesc: \"Recipe\",\r\n\t\t\t\t\t\tItemNo: \"\",\r\n\t\t\t\t\t\tFieldName: this.getView().byId(vId + \"_TXT\").getText(),\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\t\tChangedBy: this.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLogData[idx].NewValue = newValue;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Remove entry if reverted to old value\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\toChangeLogData.splice(idx, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Step 8: Update model\r\n\t\t\toChangeLogModel.setData(oChangeLogData);\r\n\t\t\toChangeLogModel.refresh(true);\r\n\t\t},\r\n\r\n\t\tfnUpdateChangelogforSelectBox: function(vId, key, Model) {\r\n\t\t\tvar oModel = this.getView().getModel(Model);\r\n\t\t\tif (oModel) {\r\n\t\t\t\tif (key === \"\") {\r\n\t\t\t\t\tkey = 0;\r\n\t\t\t\t}\r\n\t\t\t\tvar newValue = oModel.getProperty(\"/\" + key + \"/value\");\r\n\t\t\t}\r\n\t\t\tvar oRecipeInitialDataModel = this.getView().getModel(\"JM_RecipeInitialData\");\r\n\t\t\tif (oRecipeInitialDataModel) {\r\n\t\t\t\tvar oIntialkeyValue = oRecipeInitialDataModel.getProperty(\"/Chrule\");\r\n\t\t\t\tif (oIntialkeyValue === \"\") {\r\n\t\t\t\t\toIntialkeyValue = 0;\r\n\t\t\t\t}\r\n\t\t\t\tvar oldValue = oModel.getProperty(\"/\" + oIntialkeyValue + \"/value\");\r\n\t\t\t\t// Step 5: Get or create ChangeLog model\r\n\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ensure we have an array\r\n\t\t\t\tvar oChangeLogData = oChangeLogModel.getData();\r\n\t\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\t\toChangeLogData = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Step 6: Find if entry already exists\r\n\t\t\t\tvar idx = oChangeLogData.findIndex(function(item) {\r\n\t\t\t\t\treturn item.FieldId === vId;\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Step 7: Add, update, or remove entry\r\n\t\t\t\tif (oldValue !== newValue) {\r\n\t\t\t\t\tif (idx === -1) {\r\n\t\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\t\t\tProcessInd: \"R\",\r\n\t\t\t\t\t\t\tProcessDesc: \"Recipe\",\r\n\t\t\t\t\t\t\tItemNo: \"\",\r\n\t\t\t\t\t\t\tFieldName: this.getView().byId(vId + \"_TXT\").getText(),\r\n\t\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\t\tNewValue: newValue\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toChangeLogData[idx].NewValue = newValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Remove entry if reverted to old value\r\n\t\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\t\toChangeLogData.splice(idx, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Step 8: Update model\r\n\t\t\t\toChangeLogModel.setData(oChangeLogData);\r\n\t\t\t\toChangeLogModel.refresh(true);\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnQuanDataElementValidation: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tthis.selectedField = id;\r\n\t\t\toInput.setValueState(\"None\"); // Reset previous error\r\n\t\t\tvar inputType = oInput.getType();\r\n\t\t\tif (inputType === \"Number\") {\r\n\t\t\t\tvar maxLength = oInput.getMaxLength();\r\n\t\t\t\tvar hasDot = vValue.indexOf(\".\") !== -1;\r\n\r\n\t\t\t\t// Allowed chars: digits and single dot\r\n\t\t\t\tvValue = vValue.replace(/[^0-9.]/g, \"\");\r\n\r\n\t\t\t\t// Keep only the first dot\r\n\t\t\t\tvar firstDotIndex = vValue.indexOf(\".\");\r\n\t\t\t\tif (firstDotIndex !== -1) {\r\n\t\t\t\t\tvar parts = vValue.split(\".\");\r\n\t\t\t\t\tvar integerPart = parts[0];\r\n\t\t\t\t\tvar decimalPart = parts[1] ? parts[1].substring(0, 3) : \"\"; // limit to 3 decimals\r\n\t\t\t\t\tvValue = integerPart + (decimalPart ? \".\" + decimalPart : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Remove trailing dot if it exists\r\n\t\t\t\tif (vValue.charAt(vValue.length - 1) === \".\") {\r\n\t\t\t\t\tvValue = vValue.substring(0, vValue.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Determine effective max length\r\n\t\t\t\tvar effectiveMaxLength = hasDot ? maxLength + 1 : maxLength;\r\n\t\t\t\t// Prevent input if limit reached\r\n\t\t\t\tif (vValue.length > effectiveMaxLength) {\r\n\t\t\t\t\tvValue = vValue.substring(0, effectiveMaxLength);\r\n\t\t\t\t}\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(id);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnNumberFieldValidation: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar vValue = oInput.getValue();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar maxLength = oInput.getMaxLength(); // e.g., 10\r\n\r\n\t\t\t// Reset previous error\r\n\t\t\toInput.setValueState(\"None\");\r\n\r\n\t\t\t// Remove non-digit characters\r\n\t\t\tvar cleaned = vValue.replace(/[^0-9]/g, \"\");\r\n\r\n\t\t\t// Trim to maxLength if exceeded\r\n\t\t\tif (cleaned.length > maxLength) {\r\n\t\t\t\tcleaned = cleaned.substring(0, maxLength);\r\n\t\t\t}\r\n\r\n\t\t\t// Update input\r\n\t\t\toInput.setValue(cleaned);\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(id);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t New F4 logic implement from config package (Added by sabarish 10.11.2025)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnNewF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: id,\r\n\t\t\t\tProcess: \"X\",\r\n\t\t\t\tF4Type: \"P\"\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tif (id === \"ID_RECI_VAGRP\" || id === \"ID_RECI_NNAME\") {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\tvar KeyDataModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\t\tif (KeyDataModel) {\r\n\t\t\t\t\toPayload.Value1 = KeyDataModel.getProperty(\"/Werks\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fnBindF4ValuetoModel(oPayload);\r\n\t\t},\r\n\r\n\t\tfnBindF4ValuetoModel: function(oPayload, oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vLength;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar omodel1 = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\t// busyDialog.open();\r\n\t\t\tvar that = this;\r\n\t\t\tomodel1.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgType === \"I\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.Message, \"Error\", that);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar aResults = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\t\t//check the first value is in the domain value or not \r\n\t\t\t\t\t\tif (oFirst && (oFirst.DomvalueL || oFirst.Ddtext)) {\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\toLabels.col1 = \"Key\";\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1) {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.DomvalueL;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Ddtext;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.DomvalueL3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.DomvalueL4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = sap.ui.getCore().byId(this.sitem + \"_TXT\").getText() + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthis.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1 === \"Material\") {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1 ? item.Value1.replace(/^0+/, \"\") : item.Value1;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tthis.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = this.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthis.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for F4 Event (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar item = oContext.getProperty(\"col1\"); // Value (e.g., 'IN')\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\"); // Description (e.g., 'India')\r\n\r\n\t\t\tthis.getView().byId(this.selectedField).setValue(item);\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\r\n\t\t\tvar desId = this.getView().byId(this.selectedField + \"_DES\");\r\n\t\t\tif (desId) {\r\n\t\t\t\tdesId.setValue(item1);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(this.selectedField);\r\n\t\t\t}\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar aFilters = [];\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.StartsWith, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.StartsWith, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.StartsWith, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.StartsWith, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for expand and collapse pannel (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnExpandCollapse: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar GridVisibleState = this.getView().byId(id + \"_GRID\").getVisible();\r\n\t\t\tvar PannelHead = this.getView().byId(id + \"_HEADER\");\r\n\t\t\tif (GridVisibleState) {\r\n\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(false);\r\n\t\t\t\tthis.getView().byId(id).addStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHead\");\r\n\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(true);\r\n\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t\tthis.getView().byId(id).removeStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHead\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCollpaseExpandAll: function(oEvent) {\r\n\t\t\tvar vId = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar Button = this.getView().byId(vId);\r\n\t\t\tvar vAllId = [\"ID_RECI_ASSIGN\", \"ID_RECI_CQR\", \"ID_RECI_DEFAULT\", \"ID_RECI_CP\"];\r\n\t\t\tvar state = Button.getText();\r\n\t\t\tif (state === \"Expand All\") {\r\n\t\t\t\tvAllId.forEach(function(id) {\r\n\t\t\t\t\tvar PannelHead = this.getView().byId(id + \"_HEADER\");\r\n\t\t\t\t\t// Expand\r\n\t\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(true);\r\n\t\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t\t\tthis.getView().byId(id).removeStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHead\");\r\n\t\t\t\t\tButton.setText(i18n.getText(\"CollapseAll\"));\r\n\t\t\t\t}.bind(this));\r\n\t\t\t} else {\r\n\t\t\t\tvAllId.forEach(function(id) {\r\n\t\t\t\t\tvar PannelHead = this.getView().byId(id + \"_HEADER\");\r\n\t\t\t\t\t// Collapse\r\n\t\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(false);\r\n\t\t\t\t\tthis.getView().byId(id).addStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHead\");\r\n\t\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t\t\tButton.setText(i18n.getText(\"ExpandAll\"));\r\n\t\t\t\t}.bind(this));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for Attachments logic (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnUploadButtonpres: function() {\r\n\t\t\tvar oFileUploader = this.byId(\"hiddenUploader\");\r\n\t\t\tif (oFileUploader) {\r\n\t\t\t\tvar oDomRef = oFileUploader.getFocusDomRef();\r\n\t\t\t\tif (oDomRef) {\r\n\t\t\t\t\toDomRef.click(); // Opens file dialog\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnFileSelected: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oFileUploader = this.byId(\"hiddenUploader\");\r\n\t\t\tvar oFile = oEvent.getParameter(\"files\")[0];\r\n\t\t\tif (oFile) {\r\n\t\t\t\tif (oFile.size > 2 * 1024 * 1024) {\r\n\t\t\t\t\tthis.showCustomSnackbar(\"Each file must be less that 2 MB\", \"Information\");\r\n\t\t\t\t\toFileUploader.setValue(\"\"); // Reset to allow re-selection\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\treader.onload = function(e) {\r\n\t\t\t\t\tvar sBase64 = e.target.result.split(\",\")[1];\r\n\t\t\t\t\tvar oTableModel = that.getView().getModel(\"JM_DocTypeModel\");\r\n\t\t\t\t\tvar aRows = oTableModel.getProperty(\"/List\") || [];\r\n\t\t\t\t\tvar bDuplicate = aRows.some(function(row) {\r\n\t\t\t\t\t\treturn row.Xstring === sBase64;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (oFileUploader) {\r\n\t\t\t\t\t\toFileUploader.setValue(\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (bDuplicate) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"fileAlreadyUploaded\"), \"Error\", that);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Store temporarily\r\n\t\t\t\t\tvar oModel = that.getView().getModel();\r\n\t\t\t\t\toModel.setProperty(\"/uploadedFileName\", oFile.name);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedFileContent\", sBase64);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedMimeType\", oFile.type);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedFileSize\", oFile.size);\r\n\t\t\t\t};\r\n\t\t\t\treader.readAsDataURL(oFile);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfnMassDownload: function() {\r\n\t\t\tvar oTableModel = this.getView().getModel(\"JM_DocTypeModel\");\r\n\t\t\tvar aFiles = oTableModel.getProperty(\"/List\") || [];\r\n\r\n\t\t\tif (aFiles.length === 0) {\r\n\t\t\t\tsap.m.MessageToast.show(\"No files to download.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Disable the button temporarily to prevent double click (optional)\r\n\t\t\tvar oButton = this.getView().byId(\"id_massDownloadButton\");\r\n\t\t\tif (oButton) {\r\n\t\t\t\toButton.setEnabled(false);\r\n\t\t\t}\r\n\r\n\t\t\tvar zip = new JSZip();\r\n\r\n\t\t\taFiles.forEach(function(file) {\r\n\t\t\t\tif (file.Xstring && file.TagName) {\r\n\t\t\t\t\tvar byteCharacters = atob(file.Xstring);\r\n\t\t\t\t\tvar byteNumbers = new Array(byteCharacters.length);\r\n\t\t\t\t\tfor (var i = 0; i < byteCharacters.length; i++) {\r\n\t\t\t\t\t\tbyteNumbers[i] = byteCharacters.charCodeAt(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\r\n\r\n\t\t\t\t\tzip.file(file.TagName, byteArray);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Create the ZIP file\r\n\t\t\tzip.generateAsync({\r\n\t\t\t\ttype: \"blob\"\r\n\t\t\t}).then(function(content) {\r\n\t\t\t\tvar zipName = \"Attachments.zip\";\r\n\r\n\t\t\t\t// Create temporary <a> element and trigger download\r\n\t\t\t\tvar link = document.createElement(\"a\");\r\n\t\t\t\tlink.style.display = \"none\";\r\n\t\t\t\tlink.href = URL.createObjectURL(content);\r\n\t\t\t\tlink.download = zipName;\r\n\r\n\t\t\t\tdocument.body.appendChild(link);\r\n\t\t\t\tlink.click();\r\n\r\n\t\t\t\t// Clean up\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tURL.revokeObjectURL(link.href);\r\n\t\t\t\t\tdocument.body.removeChild(link);\r\n\r\n\t\t\t\t\tif (oButton) {\r\n\t\t\t\t\t\toButton.setEnabled(true); // Re-enable after download\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 100);\r\n\t\t\t}).catch(function(err) {\r\n\t\t\t\t// console.error(\"ZIP creation failed: \", err);\r\n\t\t\t\tsap.m.MessageBox.error(\"Failed to generate ZIP file.\");\r\n\t\t\t\tif (oButton) {\r\n\t\t\t\t\toButton.setEnabled(true);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tfnDownloadSingleFile: function(oEvent) {\r\n\t\t\tvar oContext = oEvent.getSource().getBindingContext(\"JM_DocTypeModel\");\r\n\t\t\tvar oFile = oContext.getObject(); // contains Xstring and TagName\r\n\r\n\t\t\tif (!oFile || !oFile.Xstring || !oFile.TagName) {\r\n\t\t\t\tsap.m.MessageToast.show(\"File data is missing.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tvar byteCharacters = atob(oFile.Xstring);\r\n\t\t\t\tvar byteNumbers = new Array(byteCharacters.length);\r\n\t\t\t\tfor (var i = 0; i < byteCharacters.length; i++) {\r\n\t\t\t\t\tbyteNumbers[i] = byteCharacters.charCodeAt(i);\r\n\t\t\t\t}\r\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\r\n\t\t\t\tvar blob = new Blob([byteArray]);\r\n\r\n\t\t\t\t// Create temporary <a> element to trigger download\r\n\t\t\t\tvar link = document.createElement(\"a\");\r\n\t\t\t\tlink.href = URL.createObjectURL(blob);\r\n\t\t\t\tlink.download = oFile.TagName;\r\n\t\t\t\tdocument.body.appendChild(link);\r\n\t\t\t\tlink.click();\r\n\r\n\t\t\t\t// Cleanup\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tURL.revokeObjectURL(link.href);\r\n\t\t\t\t\tdocument.body.removeChild(link);\r\n\t\t\t\t}, 100);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tsap.m.MessageBox.error(\"Failed to download file.\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnAttachPress: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oMainModel = oView.getModel();\r\n\t\t\tvar oTableModel = oView.getModel(\"JM_DocTypeModel\");\r\n\t\t\tvar aRows = oTableModel.getProperty(\"/List\") || [];\r\n\t\t\tvar sFileName = oMainModel.getProperty(\"/uploadedFileName\");\r\n\t\t\tvar sBase64 = oMainModel.getProperty(\"/uploadedFileContent\");\r\n\t\t\tvar sMimeType = oMainModel.getProperty(\"/uploadedMimeType\");\r\n\t\t\tvar iNewFileSize = oMainModel.getProperty(\"/uploadedFileSize\") || 0;\r\n\t\t\tvar sTagNameInput = oView.byId(\"id_tagInput\").getValue().trim();\r\n\t\t\tvar sDocTypeKey = oView.byId(\"id_varients\").getSelectedKey();\r\n\t\t\tif (!sFileName || !sBase64) {\r\n\t\t\t\tsap.m.MessageToast.show(\"Please select a file.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar bFileExists = aRows.some(function(row) {\r\n\t\t\t\treturn row.TagName === sFileName || row.Xstring === sBase64;\r\n\t\t\t});\r\n\t\t\tif (bFileExists) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"fileAlreadyUploaded\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar iTotalSize = iNewFileSize; // start with new file\r\n\t\t\taRows.forEach(function(row) {\r\n\t\t\t\tif (row.Size) {\r\n\t\t\t\t\tiTotalSize += row.Size;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (iTotalSize > 10 * 1024 * 1024) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"totalFileSizeLimit\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar fileSizeBytes = iNewFileSize;\r\n\t\t\t// Convert to readable size string\r\n\t\t\tvar fileSizeDisplay = \"\";\r\n\t\t\tif (fileSizeBytes < 1024) {\r\n\t\t\t\tfileSizeDisplay = fileSizeBytes + \" Bytes\";\r\n\t\t\t} else if (fileSizeBytes < 1024 * 1024) {\r\n\t\t\t\tfileSizeDisplay = (fileSizeBytes / 1024).toFixed(2) + \" KB\";\r\n\t\t\t} else {\r\n\t\t\t\tfileSizeDisplay = (fileSizeBytes / (1024 * 1024)).toFixed(2) + \" MB\";\r\n\t\t\t}\r\n\t\t\tvar aParts = sFileName.split(\".\");\r\n\t\t\tvar sExtension = aParts.length > 1 ? aParts.pop() : \"\";\r\n\t\t\tvar sNameWithoutExt = aParts.join(\".\");\r\n\t\t\tvar sTagNameFinal = sTagNameInput || sNameWithoutExt || \"untitled\";\r\n\t\t\tvar sFinalFilename = sTagNameFinal + (sExtension ? \".\" + sExtension : \"\");\r\n\t\t\tvar bTagExists = aRows.some(function(row) {\r\n\t\t\t\treturn row.TagName === sFinalFilename;\r\n\t\t\t});\r\n\t\t\tif (bTagExists) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"tagNameAlreadyUsed\", [sTagNameFinal]), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar sDocTypeFinal = sDocTypeKey || \"Default\";\r\n\t\t\taRows.push({\r\n\t\t\t\tAttachmentNo: aRows.length + 1,\r\n\t\t\t\tTagName: sFinalFilename,\r\n\t\t\t\tDocType: sDocTypeFinal,\r\n\t\t\t\tMimeType: sMimeType,\r\n\t\t\t\tXstring: sBase64,\r\n\t\t\t\tSize: fileSizeDisplay\r\n\t\t\t});\r\n\t\t\toTableModel.setProperty(\"/List\", aRows);\r\n\t\t\tthis.fnUpdateStateMassDownload();\r\n\t\t\t// Clear\r\n\t\t\toMainModel.setProperty(\"/uploadedFileName\", \"\");\r\n\t\t\toMainModel.setProperty(\"/uploadedFileContent\", \"\");\r\n\t\t\toMainModel.setProperty(\"/uploadedMimeType\", \"\");\r\n\t\t\toMainModel.setProperty(\"/uploadedFileSize\", 0);\r\n\t\t\toView.byId(\"id_tagInput\").setValue(\"\");\r\n\t\t\toView.byId(\"id_varients\").setSelectedKey(\"\");\r\n\t\t},\r\n\r\n\t\tfnUpdateStateMassDownload: function() {\r\n\t\t\tvar oTableModel = this.getView().getModel(\"JM_DocTypeModel\");\r\n\t\t\tvar aFiles = oTableModel.getProperty(\"/List\") || [];\r\n\r\n\t\t\tvar oButton = this.getView().byId(\"id_massDownloadButton\");\r\n\t\t\tif (oButton) {\r\n\t\t\t\toButton.setEnabled(aFiles.length > 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnDeleteAttachRow: function(oEvent) {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_DocTypeModel\");\r\n\t\t\tvar aData = oModel.getProperty(\"/List\");\r\n\t\t\tvar oContext = oEvent.getSource().getBindingContext(\"JM_DocTypeModel\");\r\n\t\t\tvar iIndex = oContext.getPath().split(\"/\").pop();\r\n\r\n\t\t\t// Remove the selected item\r\n\t\t\taData.splice(iIndex, 1);\r\n\r\n\t\t\t// Reassign AttachmentNo in order\r\n\t\t\taData.forEach(function(item, idx) {\r\n\t\t\t\titem.AttachmentNo = idx + 1;\r\n\t\t\t});\r\n\r\n\t\t\t// Update the model\r\n\t\t\toModel.setProperty(\"/List\", aData);\r\n\r\n\t\t\t// Refresh UI state if needed\r\n\t\t\tthis.fnUpdateStateMassDownload();\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for check when save press, operation, material (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnCheckMandatoryOperFields: function() {\r\n\t\t\tvar vStatus = this.getView().byId(\"ID_RECI_STATU\").getValue();\r\n\t\t\tvar vUsage = this.getView().byId(\"ID_RECI_VERWE\").getValue();\r\n\t\t\tvar vTsklUnit = this.getView().byId(\"ID_RECI_PLNME\").getValue();\r\n\t\t\tvar retMsg = true;\r\n\t\t\tif (vStatus !== \"\" && vUsage !== \"\" && vTsklUnit !== \"\") {\r\n\t\t\t\tretMsg = true;\r\n\t\t\t} else {\r\n\t\t\t\tif (vStatus === \"\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueStateText(i18n.getText(\"EnterStatus\"));\r\n\t\t\t\t\tthis.fnFocusErroField(\"ID_RECI_STATU\");\r\n\t\t\t\t}\r\n\t\t\t\tif (vUsage === \"\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueStateText(i18n.getText(\"EnterUsage\"));\r\n\t\t\t\t\tthis.fnFocusErroField(\"ID_RECI_VERWE\");\r\n\t\t\t\t}\r\n\t\t\t\tif (vTsklUnit === \"\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_PLNME\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"ID_RECI_PLNME\").setValueStateText(i18n.getText(\"EnterTsklUnit\"));\r\n\t\t\t\t\tthis.fnFocusErroField(\"ID_RECI_PLNME\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn retMsg;\r\n\t\t},\r\n\r\n\t\tfnFocusErroField: function(vId) {\r\n\t\t\tif (vId === \"ID_RECI_STATU\" || vId === \"ID_RECI_VERWE\") {\r\n\t\t\t\tvar id = \"ID_RECI_ASSIGN\";\r\n\t\t\t\tvar oPanelHead = this.getView().byId(id + \"_HEADER\");\r\n\r\n\t\t\t\t// Make sure the panel is visible\r\n\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(true);\r\n\r\n\t\t\t\t// Adjust styles\r\n\t\t\t\toPanelHead.addStyleClass(\"cl_pannelHead\");\r\n\t\t\t\toPanelHead.removeStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t\tthis.getView().byId(id).removeStyleClass(\"cl_search_rotateImage\");\r\n\r\n\t\t\t\tvar oControl = this.getView().byId(vId);\r\n\r\n\t\t\t\t// Wait until its rendered\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tif (oControl && oControl.getDomRef()) {\r\n\t\t\t\t\t\toControl.getDomRef().scrollIntoView({\r\n\t\t\t\t\t\t\tbehavior: \"smooth\",\r\n\t\t\t\t\t\t\tblock: \"center\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// Add another small delay for focus\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\toControl.focus();\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 300);\r\n\r\n\t\t\t} else if (vId === \"ID_RECI_PLNME\") {\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCheckMandatoryFields: function() {\r\n\t\t\tvar vStatus = this.getView().byId(\"ID_RECI_STATU\").getValue();\r\n\t\t\tvar vUsage = this.getView().byId(\"ID_RECI_VERWE\").getValue();\r\n\t\t\tvar retMsg = true;\r\n\t\t\tif (vStatus === \"\" && vUsage === \"\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tthis.fnFocusErroField(\"ID_RECI_STATU\");\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"fillMandatoryField\"), \"Error\", this);\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueStateText(i18n.getText(\"EnterStatus\"));\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueState(i18n.getText(\"EnterUsage\"));\r\n\t\t\t} else if (vStatus === \"\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tthis.fnFocusErroField(\"ID_RECI_STATU\");\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"statusMandatory\"), \"Error\", this);\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_STATU\").setValueStateText(i18n.getText(\"EnterStatus\"));\r\n\t\t\t} else if (vUsage === \"\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tthis.fnFocusErroField(\"ID_RECI_VERWE\");\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"usageMandatory\"), \"Error\", this);\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"ID_RECI_VERWE\").setValueState(i18n.getText(\"EnterUsage\"));\r\n\t\t\t}\r\n\t\t\treturn retMsg;\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for other Screen Navigation (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnNavBack: function() {\r\n\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\tif (Object.keys(oFromUwl.getData() || {}).length > 0) {\r\n\t\t\t\tthis.fnClearallModel();\r\n\t\t\t\t// sap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_uwl\");\r\n\t\t\t\tthis.fnDeqeueTrans().then(function(status) {\r\n\t\t\t\t\tif (status) {\r\n\t\t\t\t\t\tvar oCrossAppNav = sap.ushell.Container.getService(\"CrossApplicationNavigation\");\r\n\t\t\t\t\t\toCrossAppNav.toExternal({\r\n\t\t\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\t\t\tsemanticObject: \"ZMDM_UWL_DB\",\r\n\t\t\t\t\t\t\t\taction: \"display\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tappSpecificRoute: \"uwl\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\t\t\tif (oModel) {\r\n\t\t\t\t\t\t\toModel.setData({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnClearallModel();\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_keydata\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tfnDeqeueTrans: function() {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tInd: \"F\",\r\n\t\t\t\t\t\"Transid\": this.Transid,\r\n\t\t\t\t\t\"WiId\": this.workId,\r\n\t\t\t\t\t\"NavRecipeComments\": []\r\n\t\t\t\t};\r\n\t\t\t\tvar oModel = this.getOwnerComponent().getModel();\r\n\t\t\t\toModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(oResponse) {\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for to clear all the Model and (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnClearallModel: function() {\r\n\t\t\tthis.getView().setModel(undefined, \"JM_InitiatorModel\");\r\n\t\t\tthis.getView().setModel(undefined, \"JM_ParmModel\");\r\n\t\t\tthis.Draft = false;\r\n\r\n\t\t\tthis.getView().byId(\"id_textarea\").setValue(\"\");\r\n\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\t\t\tvar aGlobalModels = [\r\n\t\t\t\t\"JM_Recipe\",\r\n\t\t\t\t\"JM_Operation\",\r\n\t\t\t\t\"JM_ProductionVrsn\",\r\n\t\t\t\t\"JM_Bom\",\r\n\t\t\t\t\"JM_ContextModel\",\r\n\t\t\t\t\"JM_InitialDatas\"\r\n\t\t\t];\r\n\t\t\tthis.flag = false;\r\n\r\n\t\t\taGlobalModels.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = oComponent.getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\tif (oModel.setData) {\r\n\t\t\t\t\t\toModel.setData({});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar oTableModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tList: []\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oTableModel, \"JM_AttachmentModel\");\r\n\r\n\t\t\t// Model for Table (initially empty, will be filled later)\r\n\t\t\tvar oTableModel1 = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tList: []\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oTableModel1, \"JM_DocTypeModel\");\r\n\r\n\t\t\t// Attachments To show the filename in the model \r\n\t\t\tvar oMainModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tuploadedFileName: \"\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oMainModel);\r\n\t\t\tvar oComment = this.getView().byId(\"id_commentbox\");\r\n\t\t\tif (oComment) {\r\n\t\t\t\toComment.destroyItems(); // This will destroy all controls inside the VBox\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < frontEndId.length; i++) {\r\n\t\t\t\tvar data = this.getView().byId(frontEndId[i] + \"_DES\");\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\tdata.setValue(\"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (Object.keys(oChangeLogModel.getData() || {}).length > 0) {\r\n\t\t\t\t// Get data and create a deep copy\r\n\t\t\t\tvar existingData = oChangeLogModel ? JSON.parse(JSON.stringify(oChangeLogModel.getData())) : [];\r\n\t\t\t\t// Check if model has some data and AppId === \"RX\"\r\n\t\t\t\tif (existingData && existingData.length > 0 && this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnClearIndicationforChangedData(existingData);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tRecipe Duplicate Dialog Open and Close\r\n\t\t// *-----------------------------------------------------------------------\r\n\r\n\t\tfnCheckDuplicate: function() {\r\n\t\t\tvar oKeyDataEntity = this.getOwnerComponent().getModel();\r\n\t\t\tvar KeyDataModel = this.getView().getModel(\"JM_KeydataModel\").getData();\r\n\t\t\tvar payLoad = {\r\n\t\t\t\tMatnr: KeyDataModel.Matnr,\r\n\t\t\t\tWerks: KeyDataModel.Werks,\r\n\t\t\t\tInd: \"D\" // Validation and Duplicate pop Up\r\n\t\t\t};\r\n\t\t\tpayLoad.Nav_Duplicate = [];\r\n\t\t\tbusyDialog.open();\r\n\t\t\toKeyDataEntity.create(\"/Recipe_Key_dataSet\", payLoad, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar length = oData.Nav_Duplicate.results.length;\r\n\t\t\t\t\tvar aData = {\r\n\t\t\t\t\t\tDuplicate: oData.Nav_Duplicate.results,\r\n\t\t\t\t\t\tlength: \"(\" + length + \")\"\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar oModel = new sap.ui.model.json.JSONModel(aData);\r\n\t\t\t\t\tthis.getView().setModel(oModel, \"JM_ReciDuplicate\");\r\n\t\t\t\t\tif (length === 0) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(\"No Duplication found\", \"Information\", this);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.fnReciDuplicate();\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnReciDuplicate: function() {\r\n\t\t\tif (!this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.reci_duplicate\", // Fragment name\r\n\t\t\t\t\tthis // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.duplicateDialog);\r\n\t\t\t}\r\n\t\t\tthis.getView().byId(\"id_dupSubmit\").setVisible(false);\r\n\t\t\tthis.duplicateDialog.open();\r\n\t\t},\r\n\r\n\t\tfncloseDialog: function() {\r\n\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for to set the RoadMap and (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tfnInitializeScreen: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oCtx = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\tvar ctxData = oCtx.getData() || {};\r\n\t\t\tvar state = ctxData.Level;\r\n\t\t\tvar tranid = ctxData.Transid;\r\n\t\t\tvar AppId = ctxData.Appid;\r\n\t\t\tvar SendBack = ctxData.Sendback;\r\n\t\t\tvar Progress = ctxData.Progress;\r\n\r\n\t\t\tthis.fnRefreshRoadMap();\r\n\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\t//  Helper function for building Page Title\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\tvar getBaseTitle = function() {\r\n\t\t\t\treturn AppId === \"RC\" ? \"Recipe Creation \" : \"Recipe Change \";\r\n\t\t\t};\r\n\r\n\t\t\tvar getStatusTitle = function() {\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\treturn \"- Reviewer - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\treturn \"- Approver - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (SendBack === \"X\") {\r\n\t\t\t\t\treturn \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"\";\r\n\t\t\t};\r\n\r\n\t\t\tvar getInitiatorTitle = function() {\r\n\t\t\t\tif (state !== \"I\") {\r\n\t\t\t\t\treturn \"\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (Progress === \"Complete\") {\r\n\t\t\t\t\treturn \"- Completed Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (Progress === \"Inprogress\") {\r\n\t\t\t\t\treturn \"- Inprogress Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (Progress === \"Draft\") {\r\n\t\t\t\t\treturn \"- Drafted Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (Progress === \"SendBack\" || SendBack === \"X\") {\r\n\t\t\t\t\treturn \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tif (Progress === \"Reject\") {\r\n\t\t\t\t\treturn \"- Rejected Record - \" + tranid;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn \"- Initiator - \" + tranid;\r\n\t\t\t};\r\n\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\t//  Initial Load (No ContextModel Data)\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\tif (!Object.keys(ctxData).length) {\r\n\t\t\t\toView.byId(\"id_initiator\").addItem(this.fnCreateRoadMapwithHighlight(\"Recipe Details\"));\r\n\t\t\t\toView.byId(\"id_reviewer\").addItem(this.fnCreateRoadMapwihoutHighlight(\"Reviewer\"));\r\n\t\t\t\toView.byId(\"id_approver\").addItem(this.fnCreateRoadMapwihoutHighlight(\"Approver\"));\r\n\r\n\t\t\t\toView.byId(\"id_submit\").setText(\"Submit\");\r\n\t\t\t\toView.byId(\"id_title\").setText(\"Recipe Creation - Initiator\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// } else {\r\n\t\t\t// \toView.byId(\"id_initiator\").addItem(this.fnCreateRoadMapwithHighlight(\"Recipe Details\"));\r\n\t\t\t// \toView.byId(\"id_reviewer\").addItem(this.fnCreateRoadMapwihoutHighlight(\"Reviewer\"));\r\n\t\t\t// \toView.byId(\"id_approver\").addItem(this.fnCreateRoadMapwihoutHighlight(\"Approver\"));\r\n\r\n\t\t\t// \toView.byId(\"id_submit\").setText(\"Submit\");\r\n\t\t\t// \toView.byId(\"id_title\").setText(\"Recipe Change - Initiator\");\r\n\t\t\t// \treturn;\r\n\t\t\t// }\r\n\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\t//  Common Roadmap Setup\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\tvar isInitiator = state === \"I\";\r\n\t\t\tvar isReviewer = state === \"R\";\r\n\t\t\tvar isApprover = state === \"A\";\r\n\r\n\t\t\toView.byId(\"id_initiator\").addItem(\r\n\t\t\t\tisInitiator ? this.fnCreateRoadMapwithHighlight(\"Recipe Details\") : this.fnCreateRoadMapwihoutHighlight(\"Recipe Details\")\r\n\t\t\t);\r\n\r\n\t\t\toView.byId(\"id_reviewer\").addItem(\r\n\t\t\t\tisReviewer ? this.fnCreateRoadMapwithHighlight(\"Reviewer\") : this.fnCreateRoadMapwihoutHighlight(\"Reviewer\")\r\n\t\t\t);\r\n\r\n\t\t\toView.byId(\"id_approver\").addItem(\r\n\t\t\t\tisApprover ? this.fnCreateRoadMapwithHighlight(\"Approver\") : this.fnCreateRoadMapwihoutHighlight(\"Approver\")\r\n\t\t\t);\r\n\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\t//  Button Adjustments\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\tif (isApprover) {\r\n\t\t\t\toView.byId(\"id_saveDraft\").setVisible(false);\r\n\t\t\t\toView.byId(\"id_submit\").setText(\"Approve\").setWidth(\"6rem\");\r\n\t\t\t} else if (isReviewer) {\r\n\t\t\t\toView.byId(\"id_saveDraft\").setVisible(false);\r\n\t\t\t\toView.byId(\"id_submit\").setText(\"Submit\");\r\n\t\t\t} else if (isInitiator) {\r\n\t\t\t\toView.byId(\"id_submit\").setText(\"Submit\");\r\n\r\n\t\t\t\t// Footer button model for initiator\r\n\t\t\t\tvar footerBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\tReject: false,\r\n\t\t\t\t\tDraft: false\r\n\t\t\t\t});\r\n\t\t\t\toView.setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\t\t\t}\r\n\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\t//  Title Calculation\r\n\t\t\t// -------------------------------------------------------------\r\n\t\t\tvar title = getBaseTitle();\r\n\r\n\t\t\tif (isInitiator) {\r\n\t\t\t\ttitle += getInitiatorTitle();\r\n\t\t\t} else {\r\n\t\t\t\ttitle += getStatusTitle();\r\n\t\t\t}\r\n\r\n\t\t\t// Fallback if no match\r\n\t\t\tif (!title) {\r\n\t\t\t\ttitle = \"Recipe Change - Initiator\";\r\n\t\t\t}\r\n\r\n\t\t\toView.byId(\"id_title\").setText(title);\r\n\t\t},\r\n\r\n\t\tfnCreateRoadMapwithHighlight: function(text) {\r\n\t\t\tvar image = ((text === \"Recipe Details\") ? text.split(\" \")[0] : text);\r\n\t\t\tvar oImageModel = this.getView().getModel(\"JM_ImageModel\");\r\n\t\t\tvar sBasePath = oImageModel.getProperty(\"/path\");\r\n\t\t\tvar sImg = image;\r\n\t\t\tvar sSrc = sBasePath + sImg + \".svg\";\r\n\t\t\tvar oHBox = new sap.m.HBox({\r\n\t\t\t\talignItems: \"Center\",\r\n\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\titems: [\r\n\t\t\t\t\tnew sap.m.HBox({\r\n\t\t\t\t\t\tid: \"id_roadmapHighlighter\", // added by sabarish 20.11.2025\r\n\t\t\t\t\t\talignItems: \"Center\",\r\n\t\t\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\t\t\titems: [\r\n\t\t\t\t\t\t\tnew sap.m.Image({\r\n\t\t\t\t\t\t\t\tsrc: sSrc,\r\n\t\t\t\t\t\t\t\ttooltip: text\r\n\t\t\t\t\t\t\t}).addStyleClass(\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"),\r\n\t\t\t\t\t\t\tnew sap.m.Label({\r\n\t\t\t\t\t\t\t\ttext: text,\r\n\t\t\t\t\t\t\t\tvisible: \"{RoadMapUI>/labelVisible}\"\r\n\t\t\t\t\t\t\t}).addStyleClass(\"cl_HighlightText_roadMap\")\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}).addStyleClass(\"cl_Highlightborder_roadMap\")\r\n\t\t\t\t]\r\n\t\t\t});\r\n\t\t\treturn oHBox;\r\n\t\t},\r\n\r\n\t\tfnCreateRoadMapwihoutHighlight: function(text) {\r\n\t\t\tvar image = ((text === \"Recipe Details\") ? text.split(\" \")[0] : text);\r\n\t\t\tvar oImageModel = this.getView().getModel(\"JM_ImageModel\");\r\n\t\t\tvar sBasePath = oImageModel.getProperty(\"/path\");\r\n\t\t\tvar sImg = image;\r\n\t\t\tvar sSrc = sBasePath + sImg + \".svg\";\r\n\t\t\tvar oHBox = new sap.m.HBox({\r\n\t\t\t\talignItems: \"Center\",\r\n\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\titems: [\r\n\t\t\t\t\tnew sap.m.Image({\r\n\t\t\t\t\t\tsrc: sSrc,\r\n\t\t\t\t\t\ttooltip: text\r\n\t\t\t\t\t}).addStyleClass(\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"),\r\n\t\t\t\t\tnew sap.m.Label({\r\n\t\t\t\t\t\ttext: text,\r\n\t\t\t\t\t\tvisible: \"{RoadMapUI>/labelVisible}\" // added by sabarish 20.11.2025\r\n\t\t\t\t\t}).addStyleClass(\"cl_textStyle_roadMap\")\r\n\t\t\t\t]\r\n\t\t\t});\r\n\t\t\treturn oHBox;\r\n\t\t},\r\n\r\n\t\tfnRefreshRoadMap: function() {\r\n\t\t\tvar reviewerRoadmapBox = this.getView().byId(\"id_reviewer\");\r\n\t\t\tif (reviewerRoadmapBox) {\r\n\t\t\t\treviewerRoadmapBox.destroyItems();\r\n\t\t\t}\r\n\t\t\tvar ApproverRoadMapBox = this.getView().byId(\"id_approver\");\r\n\t\t\tif (ApproverRoadMapBox) {\r\n\t\t\t\tApproverRoadMapBox.destroyItems();\r\n\t\t\t}\r\n\t\t\tvar InitiatorRoadMapBox = this.getView().byId(\"id_initiator\");\r\n\t\t\tif (InitiatorRoadMapBox) {\r\n\t\t\t\tInitiatorRoadMapBox.destroyItems();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t\t\t\t\tFunction for Reject functionalities\r\n\t\t// *----------------------------------------------------------------------------------------------------\r\n\r\n\t\tfnReject: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTextArea = this.byId(\"id_textarea\");\r\n\t\t\tvar sValue = oTextArea.getValue().trim();\r\n\t\t\tif (sValue === \"\") {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"enterComments\"), \"Information\", this);\r\n\t\t\t\treturn; // stop further process\r\n\t\t\t} else {\r\n\t\t\t\t// Example Popup model data\r\n\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\ttitle: \"Information\",\r\n\t\t\t\t\ttext: i18n.getText(\"assignedCRDDeletedAutomatically\"),\r\n\t\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\t\tIndicator: \"REJECT\"\r\n\t\t\t\t});\r\n\t\t\t\t// Set model with name\r\n\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\tif (!this.oDialog) {\r\n\t\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\t\tthis\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t\t}\r\n\t\t\t\tthis.oDialog.open();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnrejectfunc: function() {\r\n\t\t\tvar oPayload = {\r\n\t\t\t\t\"AppId\": \"RC\",\r\n\t\t\t\t\"Ind\": \"R\",\r\n\t\t\t\t\"WiId\": this.workId,\r\n\t\t\t\t\"Transid\": this.Transid\r\n\t\t\t};\r\n\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\toPayload.NavAgent = [];\r\n\t\t\tvar commentsValue = this.getView().byId(\"id_textarea\").getValue();\r\n\t\t\toPayload.NavRecipeComments.push({\r\n\t\t\t\t\"Comments\": commentsValue\r\n\t\t\t});\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oRejectModel = this.getOwnerComponent().getModel();\r\n\t\t\tbusyDialog.open();\r\n\t\t\toRejectModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(odata) {\r\n\t\t\t\t\tif (odata.MsgTyp === \"E\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(odata.MsgLine, \"Error\", that);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(odata.MsgLine, \"success\", that);\r\n\t\t\t\t\t\tthat.fnClearallModel();\r\n\t\t\t\t\t\t// Wait for 2 seconds, then remove busy & navigate\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t// sap.ui.core.UIComponent.getRouterFor(that).navTo(\"reci_uwl\");\r\n\t\t\t\t\t\t\tvar oCrossAppNav = sap.ushell.Container.getService(\"CrossApplicationNavigation\");\r\n\t\t\t\t\t\t\toCrossAppNav.toExternal({\r\n\t\t\t\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\t\t\t\tsemanticObject: \"ZMDM_UWL_DB\",\r\n\t\t\t\t\t\t\t\t\taction: \"display\"\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tappSpecificRoute: \"uwl\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}, 2000);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t Sendback functionalities\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\tfnSendBackDialog: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTextArea = this.byId(\"id_textarea\");\r\n\t\t\tvar sValue = oTextArea.getValue().trim();\r\n\t\t\tif (sValue === \"\") {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"enterComments\"), \"Information\", that);\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tvar olevelDetailsSet = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\tolevelDetailsSet.read(\"/Level_DetailsSet\", {\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"Transid\", sap.ui.model.FilterOperator.EQ, this.Transid)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\t// 1. Build unique Level list\r\n\t\t\t\t\t\tvar aLevels = [];\r\n\t\t\t\t\t\tvar oLevelMap = {};\r\n\t\t\t\t\t\tvar oMinApproverMap = {};\r\n\t\t\t\t\t\tfor (var i = 0; i < oData.results.length; i++) {\r\n\t\t\t\t\t\t\tvar sLvl = oData.results[i].Lvl;\r\n\t\t\t\t\t\t\tvar sMinApprover = oData.results[i].MinApprover;\r\n\t\t\t\t\t\t\tif (!oLevelMap[sLvl]) {\r\n\t\t\t\t\t\t\t\toLevelMap[sLvl] = true;\r\n\t\t\t\t\t\t\t\taLevels.push({\r\n\t\t\t\t\t\t\t\t\tLevel: sLvl\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\toMinApproverMap[sLvl] = sMinApprover;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 2. Set Level Model\r\n\t\t\t\t\t\tvar oLevelModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tLevelData: aLevels\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.getView().setModel(oLevelModel, \"JM_LevelModel\");\r\n\t\t\t\t\t\t// 3. Set MinApprover Model\r\n\t\t\t\t\t\tvar oMinApproverModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tMinApproverMap: oMinApproverMap\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.getView().setModel(oMinApproverModel, \"JM_MinApproverModel\");\r\n\r\n\t\t\t\t\t\t// 3. Set Agent Model (empty first)\r\n\t\t\t\t\t\tvar oAgentModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tAgents: [] // empty initially\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.getView().setModel(oAgentModel, \"JM_AgentModel\");\r\n\r\n\t\t\t\t\t\t// keep full data in view for filtering\r\n\t\t\t\t\t\tthat._allAgentData = oData.results;\r\n\r\n\t\t\t\t\t\tthat.fnOpenSendBackDialog();\r\n\r\n\t\t\t\t\t\tvar oLevelTable = sap.ui.getCore().byId(\"idLevelTable\"); // adjust ID if needed\r\n\t\t\t\t\t\tif (oLevelTable && aLevels.length > 0) {\r\n\t\t\t\t\t\t\tfor (var j = 0; j < aLevels.length; j++) {\r\n\t\t\t\t\t\t\t\tif (aLevels[j].Level === \"L0\") {\r\n\t\t\t\t\t\t\t\t\toLevelTable.setSelectedIndex(j);\r\n\t\t\t\t\t\t\t\t\tthat._currentLevel = \"L0\";\r\n\t\t\t\t\t\t\t\t\tthat._currentLevelIndex = j;\r\n\t\t\t\t\t\t\t\t\tthat._loadAgentsForLevel(\"L0\"); // load agents for L0\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnOpenSendBackDialog: function() {\r\n\t\t\t// Open dialog\r\n\t\t\tif (!this.sendBackDialog) {\r\n\t\t\t\tthis.sendBackDialog = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.SendBack\", this);\r\n\t\t\t\tthis.getView().addDependent(this.sendBackDialog);\r\n\t\t\t}\r\n\t\t\tthis.sendBackDialog.open();\r\n\t\t},\r\n\r\n\t\tonLevelSelect: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = oEvent.getSource();\r\n\t\t\tvar iIndex = oTable.getSelectedIndex();\r\n\t\t\tvar oAgentModel = this.getView().getModel(\"JM_AgentModel\");\r\n\r\n\t\t\t// nothing selected  clear table\r\n\t\t\tif (iIndex === -1) {\r\n\t\t\t\toAgentModel.setProperty(\"/Agents\", []);\r\n\t\t\t\tthis._currentLevelIndex = -1;\r\n\t\t\t\tthis._currentLevel = null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oContext = oTable.getContextByIndex(iIndex);\r\n\t\t\tvar sSelectedLevel = oContext.getObject().Level;\r\n\r\n\t\t\t// 1. Check if any checkbox is edited\r\n\t\t\tvar aAgents = oAgentModel.getData().Agents;\r\n\t\t\tvar editedFlag = false;\r\n\t\t\tfor (var i = 0; i < aAgents.length; i++) {\r\n\t\t\t\tif (aAgents[i].checkboxstate === false) {\r\n\t\t\t\t\teditedFlag = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (editedFlag && this._currentLevel !== null && this._currentLevel !== sSelectedLevel) {\r\n\t\t\t\t// store the level the user wants to switch to\r\n\t\t\t\tthis._pendingLevel = sSelectedLevel;\r\n\t\t\t\tthis._pendingLevelIndex = iIndex;\r\n\t\t\t\t// revert selection temporarily to previous level\r\n\t\t\t\toTable.setSelectedIndex(this._currentLevelIndex);\r\n\t\t\t\t// open discard confirmation fragment\r\n\r\n\t\t\t\t// Example Popup model data\r\n\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\ttitle: \"Confirmation\",\r\n\t\t\t\t\ttext: i18n.getText(\"confirmLevelChange\"),\r\n\t\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\tIndicator: \"SendBack\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Set model with name\r\n\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\tif (!this.oDialog) {\r\n\t\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\t\tthis\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.oDialog.open();\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// --- fetch MinApprover from model ---\r\n\t\t\t\tvar oMinApproverModel = this.getView().getModel(\"JM_MinApproverModel\");\r\n\t\t\t\tvar sMinApprover = oMinApproverModel.getProperty(\"/MinApproverMap/\" + sSelectedLevel);\r\n\r\n\t\t\t\t// --- set label text via model ---\r\n\t\t\t\tif (sSelectedLevel === \"L0\") {\r\n\t\t\t\t\toMinApproverModel.setProperty(\"/LabelText\", \"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (sMinApprover) {\r\n\t\t\t\t\t\toMinApproverModel.setProperty(\"/LabelText\", i18n.getText(\"minSendBackCount\", [sMinApprover]));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toMinApproverModel.setProperty(\"/LabelText\", \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// normal load\r\n\t\t\t\tthis._loadAgentsForLevel(sSelectedLevel);\r\n\t\t\t\tthis._currentLevel = sSelectedLevel;\r\n\t\t\t\tthis._currentLevelIndex = iIndex;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnLevelChange: function() {\r\n\t\t\tvar oAgentModel = this.getView().getModel(\"JM_AgentModel\");\r\n\t\t\tvar aAgents = oAgentModel.getData().Agents;\r\n\r\n\t\t\t// 1. reset all checkboxes\r\n\t\t\tfor (var i = 0; i < aAgents.length; i++) {\r\n\t\t\t\taAgents[i].checkboxstate = false;\r\n\t\t\t}\r\n\t\t\toAgentModel.setProperty(\"/Agents\", aAgents);\r\n\r\n\t\t\t// 2. load agents for the pending level\r\n\t\t\tif (this._pendingLevel) {\r\n\t\t\t\tthis._loadAgentsForLevel(this._pendingLevel);\r\n\r\n\t\t\t\t// update the level table selection\r\n\t\t\t\tvar oLevelTable = sap.ui.getCore().byId(\"idLevelTable\");\r\n\t\t\t\tif (this._pendingLevelIndex !== undefined && this._pendingLevelIndex !== null) {\r\n\t\t\t\t\toLevelTable.setSelectedIndex(this._pendingLevelIndex);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// update current level trackers\r\n\t\t\t\tthis._currentLevel = this._pendingLevel;\r\n\t\t\t\tthis._currentLevelIndex = this._pendingLevelIndex;\r\n\r\n\t\t\t\t// clear pending variables\r\n\t\t\t\tthis._pendingLevel = null;\r\n\t\t\t\tthis._pendingLevelIndex = null;\r\n\r\n\t\t\t\tif (this.oDialog) {\r\n\t\t\t\t\tthis.oDialog.close();\r\n\t\t\t\t\tthis.oDialog.destroy(); // if you want destroy after close\r\n\t\t\t\t\tthis.oDialog = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Helper: load agents for a level\r\n\t\t_loadAgentsForLevel: function(sLevel) {\r\n\t\t\tvar aFilteredAgents = [];\r\n\t\t\tfor (var i = 0; i < this._allAgentData.length; i++) {\r\n\t\t\t\tif (this._allAgentData[i].Lvl === sLevel) {\r\n\t\t\t\t\taFilteredAgents.push({\r\n\t\t\t\t\t\tindicator: this.changeidicatortoImage(this._allAgentData[i].Submit),\r\n\t\t\t\t\t\tAgent: this._allAgentData[i].Agent,\r\n\t\t\t\t\t\tAgentName: this._allAgentData[i].Name,\r\n\t\t\t\t\t\tcheckboxstate: true, // default unchecked\r\n\t\t\t\t\t\tcheckboxEditable: true\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.getView().getModel(\"JM_AgentModel\").setProperty(\"/Agents\", aFilteredAgents);\r\n\r\n\t\t\t// store current level\r\n\t\t\tthis._currentLevel = sLevel;\r\n\t\t},\r\n\r\n\t\tchangeidicatortoImage: function(value) {\r\n\t\t\tif (value === \"X\") {\r\n\t\t\t\treturn \"Image/NodesGrn.svg\"; // your green icon\r\n\t\t\t} else {\r\n\t\t\t\treturn \"Image/NodesOrg.svg\"; // your red icon\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnsendBack: function() {\r\n\t\t\tbusyDialog.open();\r\n\t\t\tvar oLevelModel = this.getView().getModel(\"JM_LevelModel\");\r\n\t\t\tvar oAgentModel = this.getView().getModel(\"JM_AgentModel\");\r\n\r\n\t\t\t// 1. Get currently selected level\r\n\t\t\tvar aLevels = oLevelModel.getProperty(\"/LevelData\");\r\n\t\t\tvar sCurrentLevel = null;\r\n\t\t\tfor (var i = 0; i < aLevels.length; i++) {\r\n\t\t\t\tif (i === this._currentLevelIndex) {\r\n\t\t\t\t\tsCurrentLevel = aLevels[i].Level;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!sCurrentLevel) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"selectLevelBeforeSubmit\"), \"Warning\", this);\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 2. Filter agents with checkboxstate = true\r\n\t\t\tvar aAllAgents = oAgentModel.getProperty(\"/Agents\");\r\n\t\t\tvar aSelectedAgents = [];\r\n\t\t\tfor (var j = 0; j < aAllAgents.length; j++) {\r\n\t\t\t\tif (aAllAgents[j].checkboxstate === true) {\r\n\t\t\t\t\taSelectedAgents.push({\r\n\t\t\t\t\t\tAgents: aAllAgents[j].Agent\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (aSelectedAgents.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"agentSelectionRequired\"), \"Warning\", this);\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar that = this;\r\n\r\n\t\t\t// 3. Build payload\r\n\t\t\tvar payload = {\r\n\t\t\t\t\"Ind\": \"S\",\r\n\t\t\t\t\"Transid\": this.Transid,\r\n\t\t\t\t\"WiId\": this.workId,\r\n\t\t\t\t\"Lvl\": sCurrentLevel,\r\n\t\t\t\t\"NavAgent\": aSelectedAgents,\r\n\t\t\t\t\"AppId\": this.AppId\r\n\t\t\t};\r\n\t\t\tpayload.NavRecipeComments = [];\r\n\r\n\t\t\tvar commentsValue = this.getView().byId(\"id_textarea\").getValue();\r\n\r\n\t\t\tpayload.NavRecipeComments.push({\r\n\t\t\t\t\"Comments\": commentsValue\r\n\t\t\t});\r\n\r\n\t\t\tvar oSendBackService = this.getOwnerComponent().getModel();\r\n\t\t\tbusyDialog.open();\r\n\t\t\toSendBackService.create(\"/Recipe_HeaderSet\", payload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgType === \"E\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.MsgLine, \"Error\", that); // Changed by srikanth message to MsgLine\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Show snackbar\r\n\t\t\t\t\t\tthat.fnClearallModel();\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.MsgLine, \"success\", that); // Changed by srikanth message to MsgLine\r\n\t\t\t\t\t\tthat.onSendBackClose();\r\n\t\t\t\t\t\t// Wait for 2 seconds, then remove busy & navigate\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\t// sap.ui.core.UIComponent.getRouterFor(that).navTo(\"reci_uwl\");\r\n\t\t\t\t\t\t\tvar oCrossAppNav = sap.ushell.Container.getService(\"CrossApplicationNavigation\");\r\n\t\t\t\t\t\t\toCrossAppNav.toExternal({\r\n\t\t\t\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\t\t\t\tsemanticObject: \"ZMDM_UWL_DB\",\r\n\t\t\t\t\t\t\t\t\taction: \"display\"\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tappSpecificRoute: \"uwl\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tonSendBackClose: function(oEvent) {\r\n\t\t\tif (this.sendBackDialog) {\r\n\t\t\t\tthis.sendBackDialog.close();\r\n\t\t\t\tthis.sendBackDialog.destroy();\r\n\t\t\t\tthis.sendBackDialog = null;\r\n\t\t\t}\r\n\t\t\t// Clear Level and Agent models\r\n\t\t\tvar oLevelModel = this.getView().getModel(\"JM_LevelModel\");\r\n\t\t\tvar oAgentModel = this.getView().getModel(\"JM_AgentModel\");\r\n\r\n\t\t\tif (oLevelModel) {\r\n\t\t\t\toLevelModel.setProperty(\"/LevelData\", []);\r\n\t\t\t}\r\n\t\t\tif (oAgentModel) {\r\n\t\t\t\toAgentModel.setProperty(\"/Agents\", []);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t confirmation close and submit button functionlaties\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnConfirmationFragmentClose: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"SendBack\") {\r\n\t\t\t\t// reselect previous level row if needed\r\n\t\t\t\tvar oTable = sap.ui.getCore().byId(\"idLevelTable\");\r\n\t\t\t\tvar aLevels = oTable.getBinding(\"rows\").getModel().getProperty(\"/LevelData\");\r\n\t\t\t\tfor (var i = 0; i < aLevels.length; i++) {\r\n\t\t\t\t\tif (aLevels[i].Level === this._currentLevel) {\r\n\t\t\t\t\t\toTable.setSelectedIndex(i);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.oDialog) {\r\n\t\t\t\tthis.oDialog.close();\r\n\t\t\t\tthis.oDialog.destroy(); // if you want destroy after close\r\n\t\t\t\tthis.oDialog = null;\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JM_Popup\");\r\n\t\t\t\toModel.setData({});\r\n\t\t\t\toModel.refresh(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSubmitConfirmation: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"REJECT\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tthis.fnrejectfunc();\r\n\t\t\t\tthis.getOwnerComponent().getModel(\"JM_KeyData\").setData({}); // Added by srikanth\r\n\t\t\t\tthis.getOwnerComponent().getModel(\"JM_WfParm\").setData({}); // Added by srikanth\r\n\t\t\t}\r\n\t\t\tif (state === \"SendBack\") {\r\n\t\t\t\tthis.fnLevelChange();\r\n\t\t\t\tthis.getOwnerComponent().getModel(\"JM_KeyData\").setData({}); // Added by srikanth\r\n\t\t\t\tthis.getOwnerComponent().getModel(\"JM_WfParm\").setData({}); // Added by srikanth\r\n\t\t\t}\r\n\t\t\tif (state === \"SAVE\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tvar payload = this.fnpayLoadBind();\r\n\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnSetGetParmforChange(\"RX\").then(function(flag) {\r\n\t\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\t\tvar parmModel1 = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\t\tif (parmModel1) {\r\n\t\t\t\t\t\t\t\tvar parmData = parmModel1.getData();\r\n\t\t\t\t\t\t\t\tfor (var key in parmData) {\r\n\t\t\t\t\t\t\t\t\tif (parmData.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\t\t\t\tpayload[key] = parmData[key];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar oGlobalPam = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\t\toGlobalPam.setData({}); // clear\r\n\t\t\t\t\t\t\toGlobalPam.refresh(true);\r\n\t\t\t\t\t\t\tvar changelog = this.fnAlignChangelog();\r\n\t\t\t\t\t\t\tpayload.NavRecipe_ChangeLog = changelog;\r\n\t\t\t\t\t\t\tthis.fnSendDatatoBackend(payload);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this));\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fnSendDatatoBackend(payload);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (state === \"DRAFT\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tthis.Draft = true;\r\n\t\t\t\tpayload = this.fnpayLoadBind();\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnSetGetParmforChange(\"RX\").then(function(flag) {\r\n\t\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\t\tvar parmModel1 = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\t\tif (parmModel1) {\r\n\t\t\t\t\t\t\t\tvar parmData = parmModel1.getData();\r\n\t\t\t\t\t\t\t\tfor (var key in parmData) {\r\n\t\t\t\t\t\t\t\t\tif (parmData.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\t\t\t\tpayload[key] = parmData[key];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar oGlobalPam = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\t\toGlobalPam.setData({}); // clear\r\n\t\t\t\t\t\t\toGlobalPam.refresh(true);\r\n\t\t\t\t\t\t\tvar changelog = this.fnAlignChangelog();\r\n\t\t\t\t\t\t\tpayload.NavRecipe_ChangeLog = changelog;\r\n\t\t\t\t\t\t\tthis.fnSendDatatoBackend(payload);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this));\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fnSendDatatoBackend(payload);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnAlignChangelog: function() {\r\n\t\t\tvar retPaylod = [];\r\n\t\t\tvar vMatnr = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Matnr\");\r\n\t\t\tvar vWerks = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\");\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (Object.keys(oModel.getData() || {}).length > 0) {\r\n\t\t\t\tvar data = JSON.parse(JSON.stringify(oModel.getData()));\r\n\t\t\t\tdata.forEach(function(oItem) {\r\n\t\t\t\t\t[\"ChangedOn\"].forEach(function(field) {\r\n\t\t\t\t\t\tvar value = oItem[field];\r\n\t\t\t\t\t\tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t\t\t\t\t\toItem[field] = new Date(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\t\tvar result = data[i];\r\n\t\t\t\t\tretPaylod.push({\r\n\t\t\t\t\t\tTransid: this.Transid,\r\n\t\t\t\t\t\tItemNo: result.ItemNo,\r\n\t\t\t\t\t\tMatnr: vMatnr,\r\n\t\t\t\t\t\tWerks: vWerks,\r\n\t\t\t\t\t\tProcessDesc: result.ProcessDesc,\r\n\t\t\t\t\t\tProcessInd: result.ProcessInd,\r\n\t\t\t\t\t\tFieldId: result.FieldId,\r\n\t\t\t\t\t\tFieldName: result.FieldName,\r\n\t\t\t\t\t\tOldValue: result.OldValue,\r\n\t\t\t\t\t\tNewValue: result.NewValue,\r\n\t\t\t\t\t\tChangedBy: result.ChangedBy, // added by srikanth\r\n\t\t\t\t\t\tChangedOn: result.ChangedOn // added by srikanth\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn retPaylod;\r\n\t\t},\r\n\r\n\t\tfnBindDescriptionForRecipe: function() {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_DescriptionModel\");\r\n\t\t\tif (!oModel) return;\r\n\t\t\tvar oData = oModel.getData();\r\n\t\t\tObject.keys(oData).forEach(function(key) {\r\n\t\t\t\tif ([\"VERWE\", \"QPART\", \"VAGRP\", \"PLNME\", \"STATU\"].includes(key.toUpperCase())) {\r\n\t\t\t\t\tvar desId = \"ID_RECI_\" + key.toUpperCase() + \"_DES\";\r\n\t\t\t\t\tvar oInput = this.getView().byId(desId);\r\n\t\t\t\t\tif (oInput) {\r\n\t\t\t\t\t\tif (!oInput.getBinding(\"value\")) {\r\n\t\t\t\t\t\t\toInput.setValue(oData[key].desc);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for Paylod binding and Send Data to Backend (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\tremoveMetadata: function(oPayload) {\r\n\t\t\tfunction clean(obj) {\r\n\t\t\t\tif (Array.isArray(obj)) {\r\n\t\t\t\t\tobj.forEach(clean);\r\n\t\t\t\t} else if (typeof obj === \"object\" && obj !== null) {\r\n\t\t\t\t\tdelete obj.__metadata;\r\n\t\t\t\t\tObject.keys(obj).forEach(function(key) {\r\n\t\t\t\t\t\tclean(obj[key]);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tclean(oPayload); // recursively clean\r\n\t\t\treturn oPayload; // return the cleaned payload\r\n\t\t},\r\n\r\n\t\tfnDraft: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\ttitle: \"Confirmation\",\r\n\t\t\t\t\ttext: i18n.getText(\"confirmSaveDraft\"),\r\n\t\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\tIndicator: \"DRAFT\"\r\n\t\t\t\t});\r\n\t\t\t\t// Set model with name\r\n\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.ConfirmationExit\", this);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnpayLoadBind: function() {\r\n\t\t\tvar oPayload = {};\r\n\t\t\t// var vCheckMandatoryState;\r\n\t\t\tif (!this.Draft) {\r\n\t\t\t\t// vCheckMandatoryState = this.fnCheckMandatoryFields();\r\n\t\t\t\tvar Ind = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Ind\");\r\n\t\t\t\tif (Ind === \"X\") {\r\n\t\t\t\t\toPayload.Ind = \"A\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\toPayload.Ind = \"I\";\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// vCheckMandatoryState = true;/\r\n\t\t\t\toPayload.Ind = \"D\";\r\n\t\t\t}\r\n\t\t\t// if (vCheckMandatoryState) {\r\n\t\t\tvar data;\r\n\t\t\t// Production Version Data\r\n\t\t\tvar production = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\t// Opeations data\r\n\t\t\tvar operation = this.getOwnerComponent().getModel(\"JM_Operation\");\r\n\t\t\t// recipe data\r\n\t\t\tvar recipeData = this.getView().getModel(\"JM_InitiatorModel\").getData();\r\n\t\t\t// BOM Data\r\n\t\t\tvar BOMData = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\r\n\t\t\tvar vMatnr = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Matnr\");\r\n\t\t\tvar vProfile = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Profile\");\r\n\t\t\tvar vKtext = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/ReciDes\");\r\n\t\t\tvar vWerks = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\");\r\n\t\t\tvar parmModel = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t//Inititor\r\n\t\t\tif (Object.keys(parmModel.getData() || {}).length > 0) {\r\n\t\t\t\tvar parmModel1 = this.getView().getModel(\"JM_WfParm\");\r\n\t\t\t\tvar oGlobalPam = {};\r\n\r\n\t\t\t\tif (parmModel1) {\r\n\r\n\t\t\t\t\tparmModel1 = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t\t\tvar cleanedParamData = {};\r\n\t\t\t\t\tObject.keys(parmModel1).forEach(function(key) {\r\n\t\t\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\t\t\tvar field = this.byId(parmModel1[key]);\r\n\t\t\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tcleanedParamData[key] = parmModel1[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\toGlobalPam = cleanedParamData;\r\n\r\n\t\t\t\t\tvar parmData = cleanedParamData;\r\n\t\t\t\t\tfor (var key in parmData) {\r\n\t\t\t\t\t\tif (parmData.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\toPayload[key] = parmData[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\toPayload.AppId = this.AppId;\r\n\t\t\t\toPayload.Matnr = vMatnr;\r\n\t\t\t\toPayload.Profidnetz = vProfile;\r\n\t\t\t\toPayload.Werks = vWerks;\r\n\t\t\t\toPayload.Ktext = vKtext;\r\n\t\t\t\toPayload.Plnnr = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Plnnr\");\r\n\t\t\t\toPayload.Plnal = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Plnal\");\r\n\t\t\t} else { // Reviwer process\r\n\t\t\t\toPayload.AppId = this.AppId;\r\n\t\t\t\toPayload.Transid = this.Transid;\r\n\t\t\t\toPayload.WiId = this.workId;\r\n\t\t\t\toPayload.Matnr = vMatnr;\r\n\t\t\t\toPayload.Werks = vWerks;\r\n\t\t\t\toPayload.Ktext = vKtext;\r\n\t\t\t\toPayload.Profidnetz = vProfile;\r\n\t\t\t\toPayload.Plnnr = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Plnnr\");\r\n\t\t\t\toPayload.Plnal = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Plnal\");\r\n\t\t\t}\r\n\r\n\t\t\toPayload.NavRecipeBasic = [];\r\n\t\t\toPayload.NavRecipeBasic.push(recipeData);\r\n\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\toPayload.Ind = (this.Draft) ? \"D\" : oPayload.Ind;\r\n\r\n\t\t\tif (Object.keys(production.getData() || {}).length > 0) {\r\n\t\t\t\tdata = production.getData();\r\n\t\t\t\toPayload.NavPV_BasicFields = data.NavPV_BasicFields;\r\n\t\t\t\toPayload.NavPV_MaterialCompData = data.NavPV_MaterialCompData;\r\n\t\t\t}\r\n\t\t\tif (Object.keys(operation.getData() || {}).length > 0) {\r\n\t\t\t\tdata = operation.getData();\r\n\t\t\t\toPayload.NavRecipe_Operation = data.NavRecipe_Operation;\r\n\t\t\t}\r\n\t\t\tif (Object.keys(BOMData.getData() || {}).length > 0) {\r\n\t\t\t\tdata = BOMData.getData();\r\n\t\t\t\toPayload.NavBomHeader = data.NavBomHeader;\r\n\t\t\t\toPayload.NavBomItem = data.NavBomItem.filter(function(item) {\r\n\t\t\t\t\treturn item.Idnrk && item.Postp;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Change Data type compatable to the Backend\r\n\t\t\toPayload.NavRecipeBasic[0].Losbs = this.fnToEdmDecimal(oPayload.NavRecipeBasic[0].Losbs, 13, 3);\r\n\t\t\toPayload.NavRecipeBasic[0].Losvn = this.fnToEdmDecimal(oPayload.NavRecipeBasic[0].Losvn, 13, 3);\r\n\t\t\toPayload.NavRecipeBasic[0].Bmsch = this.fnToEdmDecimal(oPayload.NavRecipeBasic[0].Bmsch, 13, 3);\r\n\t\t\toPayload.NavRecipeBasic[0].Umrez = this.fnToEdmDecimal(oPayload.NavRecipeBasic[0].Umrez, 5, 0);\r\n\t\t\toPayload.NavRecipeBasic[0].Umren = this.fnToEdmDecimal(oPayload.NavRecipeBasic[0].Umren, 5, 0);\r\n\r\n\t\t\t// Comments\r\n\t\t\tvar commentsValue = this.getView().byId(\"id_textarea\").getValue();\r\n\t\t\toPayload.NavRecipeComments.push({\r\n\t\t\t\t\"Comments\": commentsValue\r\n\t\t\t});\r\n\r\n\t\t\t// Attachments\r\n\t\t\toPayload.NavRecipeAttachment = [];\r\n\t\t\tvar oTableModel = this.getView().getModel(\"JM_DocTypeModel\");\r\n\t\t\tvar aTableRows = oTableModel.getProperty(\"/List\") || [];\r\n\t\t\taTableRows.forEach(function(row) {\r\n\t\t\t\toPayload.NavRecipeAttachment.push({\r\n\t\t\t\t\tSerialNo: row.AttachmentNo.toString().padStart(10, \"0\"),\r\n\t\t\t\t\tDocType: row.DocType || \"\",\r\n\t\t\t\t\tFileName: row.TagName || \"\",\r\n\t\t\t\t\tMimeType: row.MimeType || \"\",\r\n\t\t\t\t\tXstring: row.Xstring || \"\",\r\n\t\t\t\t\tFileSize: row.Size\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\toPayload = this.removeMetadata(oPayload);\r\n\t\t\tthis.Draft = null;\r\n\t\t\treturn oPayload;\r\n\t\t},\r\n\r\n\t\tfnSetGetParmforChange: function(Appid) {\r\n\t\t\tvar that = this;\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar KeyDataId = [\r\n\t\t\t\t\t\"KID_RECI_MATNR\", \"KID_RECI_WERKS\", \"KID_RECI_PROFID_STD\", \"KID_RECI_RECIDES\"\r\n\t\t\t\t];\r\n\t\t\t\tvar oWFParmSet = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toWFParmSet.read(\"/WFParmSet\", {\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"AppId\", sap.ui.model.FilterOperator.EQ, Appid)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tvar oEntry = oData.results[0];\r\n\t\t\t\t\t\tvar oMatchedParams = {};\r\n\t\t\t\t\t\tvar aInvalidParams = [];\r\n\r\n\t\t\t\t\t\t// Getting the workflow parameter\r\n\t\t\t\t\t\tObject.keys(oEntry).forEach(function(sKey) {\r\n\t\t\t\t\t\t\tif (/^WfParm\\d+Id$/.test(sKey)) {\r\n\t\t\t\t\t\t\t\tvar sVal = oEntry[sKey];\r\n\t\t\t\t\t\t\t\tif (sVal && sVal.trim() !== \"\") {\r\n\t\t\t\t\t\t\t\t\tif (KeyDataId.includes(sVal.trim())) {\r\n\t\t\t\t\t\t\t\t\t\toMatchedParams[sKey] = sVal.trim();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\taInvalidParams.push(sVal);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar oWFparamData = oMatchedParams;\r\n\t\t\t\t\t\tvar cleanedParamData = {};\r\n\t\t\t\t\t\tObject.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\t\t\t\tvar fieldId = oWFparamData[key].split(\"_\")[2];\r\n\t\t\t\t\t\t\t\tfieldId = fieldId.charAt(0).toUpperCase() + fieldId.slice(1).toLowerCase();\r\n\t\t\t\t\t\t\t\tvar keyData = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\t\t\t\t\t\tif (keyData) {\r\n\t\t\t\t\t\t\t\t\tvar fieldValue = keyData.getProperty(\"/\" + fieldId);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\tvar oGlobalPam = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\toGlobalPam.setData(cleanedParamData); // clear\r\n\t\t\t\t\t\toGlobalPam.refresh(true);\r\n\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\tif (aInvalidParams.length > 0) {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"workflowParamNotMaintained\"), \"Error\", that);\r\n\t\t\t\t\t\t\tResolve(false);\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t} else if (Object.keys(oMatchedParams).length > 0) {\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnsaveRecipe: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tthis.fnVBackendValidateFields(\"S\").then(function(state) {\r\n\t\t\t\tif (state) {\r\n\r\n\t\t\t\t\tif (!this.oDialog) {\r\n\t\t\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\ttitle: \"Confirmation\",\r\n\t\t\t\t\t\t\ttext: i18n.getText(\"confirmSaveRecipe\"),\r\n\t\t\t\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\t\t\tIndicator: \"SAVE\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// Set model with name\r\n\t\t\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\r\n\t\t\t\t\t\tthis.oDialog = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.ConfirmationExit\", this);\r\n\t\t\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.oDialog.open();\r\n\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnToEdmDecimal: function(value, totalDigits, decimalPlaces) {\r\n\t\t\tif (value === null || value === undefined || value === \"\") {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar num = parseFloat(value);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar fixedValue = num.toFixed(decimalPlaces);\r\n\t\t\tvar parts = fixedValue.split(\".\");\r\n\t\t\tvar intPart = parts[0];\r\n\t\t\tvar decPart = parts[1] || \"\";\r\n\t\t\tvar maxIntLength = totalDigits - decimalPlaces;\r\n\t\t\tif (intPart.length > maxIntLength) {\r\n\t\t\t\tintPart = intPart.slice(0, maxIntLength);\r\n\t\t\t}\r\n\t\t\tvar result = decimalPlaces > 0 ? intPart + \".\" + decPart : intPart;\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tfnSendDatatoBackend: function(oPayload) {\r\n\t\t\tdelete oPayload.Nav_Duplicate;\r\n\t\t\toPayload.Plnty = \"2\";\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel();\r\n\t\t\tbusyDialog.open();\r\n\t\t\tvar vErrorState = this.fnCheckErrorState();\r\n\t\t\tif (vErrorState) {\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tif (oData.MsgTyp !== \"E\") {\r\n\r\n\t\t\t\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\t\t\t\tif (Object.keys(oChangeLogModel.getData() || {}).length > 0 && this.AppId === \"RX\") {\r\n\t\t\t\t\t\t\t\t// Get data and create a deep copy\r\n\t\t\t\t\t\t\t\tvar existingData = oChangeLogModel ? JSON.parse(JSON.stringify(oChangeLogModel.getData())) : [];\r\n\t\t\t\t\t\t\t\t// Check if model has some data and AppId === \"RX\"\r\n\t\t\t\t\t\t\t\tif (existingData && existingData.length > 0 && this.AppId === \"RX\") {\r\n\t\t\t\t\t\t\t\t\tthis.fnClearIndicationforChangedData(existingData);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// ErrorHandler.showCustomSnackbar(oData.MsgLine, \"success\");\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\t\t\t\t\tif (Object.keys(oFromUwl.getData() || {}).length > 0) {\r\n\t\t\t\t\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\t\ttitle: \"Confirmation\",\r\n\t\t\t\t\t\t\t\t\ttext: oData.MsgLine,\r\n\t\t\t\t\t\t\t\t\tpositiveButton: \"Ok\",\r\n\t\t\t\t\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\t\t\t\t\tIndicator: \"UWL\"\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t// Set model with name\r\n\t\t\t\t\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\t\t\t\t\tif (!this.oSuccessdialog) {\r\n\t\t\t\t\t\t\t\t\tthis.oSuccessdialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.SucessDialog\", // Fragment path\r\n\t\t\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tthis.getView().addDependent(this.oSuccessdialog);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.oSuccessdialog.open();\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\t\ttitle: \"Confirmation\",\r\n\t\t\t\t\t\t\t\t\ttext: oData.MsgLine,\r\n\t\t\t\t\t\t\t\t\tpositiveButton: \"Ok\",\r\n\t\t\t\t\t\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Continue.svg\",\r\n\t\t\t\t\t\t\t\t\tIndicator: \"UWL\"\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t// Set model with name\r\n\t\t\t\t\t\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\t\t\t\t\t\tif (!this.oSuccessdialog) {\r\n\t\t\t\t\t\t\t\t\tthis.oSuccessdialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\t\t\t\t\t\"MANAGED_RECIPE.Fragment.SucessDialog\", // Fragment path\r\n\t\t\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tthis.getView().addDependent(this.oSuccessdialog);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.oSuccessdialog.open();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar message = \"\";\r\n\r\n\t\t\t\t\t\t\tfor (var i = 0; i < oData.NavReturn_Msg.results.length; i++) {\r\n\t\t\t\t\t\t\t\tvar msg = oData.NavReturn_Msg.results[i];\r\n\t\t\t\t\t\t\t\tif (msg.MsgType !== \"S\") {\r\n\t\t\t\t\t\t\t\t\tmessage = msg.Message;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.fnValidationErrorMsgSet(oData.NavReturn_Msg.results);\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(message, \"Error\", this);\r\n\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"correctHighlightedFields\"), \"Error\");\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnRefresh: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"UWL\") {\r\n\t\t\t\tthis.fnClearallModel();\r\n\t\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\toWfparm.setData({}); // replaces the data\r\n\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\tvar oWfparm1 = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\toWfparm1.setData({}); // replaces the data\r\n\t\t\t\toWfparm1.refresh(true); // updates the bindings\r\n\t\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.setData({});\r\n\t\t\t\t}\r\n\t\t\t\t// sap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_uwl\");\r\n\t\t\t\tvar oCrossAppNav = sap.ushell.Container.getService(\"CrossApplicationNavigation\");\r\n\t\t\t\toCrossAppNav.toExternal({\r\n\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\tsemanticObject: \"ZMDM_UWL_DB\",\r\n\t\t\t\t\t\taction: \"display\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tappSpecificRoute: \"uwl\"\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\tif (state === \"SEARCH\") {\r\n\t\t\t\tthis.fnClearallModel();\r\n\t\t\t\toWfparm = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\toWfparm.setData({}); // replaces the data\r\n\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\toWfparm1 = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\toWfparm1.setData({}); // replaces the data\r\n\t\t\t\toWfparm1.refresh(true); // updates the bindings\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\"); // clear & navigate\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCheckErrorState: function() {\r\n\t\t\tvar retMsg = true;\r\n\t\t\tfor (var i = 0; i < frontEndId.length; i++) {\r\n\t\t\t\tif (this.getView().byId(frontEndId[i]).getValueState() === \"Error\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn retMsg;\r\n\t\t},\r\n\r\n\t\tfnValidationErrorMsgSet: function(result) {\r\n\t\t\tfor (var i = 0; i < result.length; i++) {\r\n\t\t\t\tvar data = result[i];\r\n\t\t\t\tvar id = \"ID_RECI_\" + data.Fnm.toUpperCase();\r\n\t\t\t\tvar field = this.getView().byId(id);\r\n\t\t\t\tif (field) {\r\n\t\t\t\t\tthis.getView().byId(id).setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(id).setValueStateText(data.Message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t         Backend Validation navigtion and save\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnNavOperation: function() {\r\n\t\t\tthis.fnVBackendValidateFields(\"F\").then(function(state) {\r\n\t\t\t\tif (state) {\r\n\t\t\t\t\tvar RecipeMasterDetails = this.getView().getModel(\"JM_InitiatorModel\").getData();\r\n\t\t\t\t\tvar oRecipeData = this.getOwnerComponent().getModel(\"JM_Recipe\");\r\n\t\t\t\t\toRecipeData.setData(RecipeMasterDetails); // replaces the data\r\n\t\t\t\t\toRecipeData.refresh(true); // updates the bindings\r\n\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_operations\");\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnNavProductionVersion: function() {\r\n\t\t\tthis.fnVBackendValidateFields(\"F\").then(function(state) {\r\n\t\t\t\tif (state) {\r\n\t\t\t\t\tvar RecipeMasterDetails = this.getView().getModel(\"JM_InitiatorModel\").getData();\r\n\t\t\t\t\tvar oRecipeData = this.getOwnerComponent().getModel(\"JM_Recipe\");\r\n\t\t\t\t\toRecipeData.setData(RecipeMasterDetails); // replaces the data\r\n\t\t\t\t\toRecipeData.refresh(true); // updates the bindings\r\n\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"pv_detail\");\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnVBackendValidateFields: function(Ind) {\r\n\t\t\tvar that = this;\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar payload = this.fnpayLoadBind();\r\n\t\t\t\tif (Ind) {\r\n\t\t\t\t\tpayload.MsgTyp = \"O\";\r\n\t\t\t\t}\r\n\t\t\t\tpayload.Ind = \"C\";\r\n\t\t\t\tvar serviceCall = this.getOwnerComponent().getModel();\r\n\t\t\t\tserviceCall.create(\"/Recipe_HeaderSet\", payload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tvar result = oData.NavReturn_Msg.results;\r\n\t\t\t\t\t\tvar message = \"\";\r\n\t\t\t\t\t\tfor (var i = 0; i < oData.NavReturn_Msg.results.length; i++) {\r\n\t\t\t\t\t\t\tvar msg = oData.NavReturn_Msg.results[i];\r\n\t\t\t\t\t\t\tif (oData.MsgTyp !== \"S\") {\r\n\t\t\t\t\t\t\t\tmessage = msg.Message;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (message !== \"\") {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(message, \"Error\", that);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oData.MsgTyp === \"E\") {\r\n\t\t\t\t\t\t\tthis.fnValidationErrorMsgSet(result);\r\n\t\t\t\t\t\t\tResolve(false);\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tReject(oResponse);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t Change Log Functionlalites\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnChangelog: function() {\r\n\t\t\tif (!this.Changelog) {\r\n\t\t\t\tthis.Changelog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ChangeLog\", // Fragment name\r\n\t\t\t\t\tthis // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.Changelog);\r\n\t\t\t}\r\n\r\n\t\t\tthis.Changelog.open();\r\n\t\t},\r\n\r\n\t\tfnCloseChanLogDialog: function() {\r\n\t\t\tif (this.Changelog) {\r\n\t\t\t\tthis.Changelog.close();\r\n\t\t\t\tthis.Changelog.destroy();\r\n\t\t\t\tthis.Changelog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSelectedLivechange: function(oEvent) {\r\n\t\t\tvar sSelectedKey = oEvent.getSource().getSelectedKey();\r\n\t\t\tthis.fnUpdateChangelogforSelectBox(\"ID_RECI_CHRULE\", sSelectedKey, \"JM_ChangeRule\");\r\n\t\t},\r\n\t\t_loadContextModelLocal: function() {\r\n\t\t\tvar oCtxModel = sap.ui.getCore().getModel(\"JM_ContextModel\");\r\n\t\t\tvar oCtxData = oCtxModel ? oCtxModel.getData() : null;\r\n\r\n\t\t\tif (oCtxData) {\r\n\t\t\t\t// Store in Component Model\r\n\t\t\t\tthis.getOwnerComponent().setModel(\r\n\t\t\t\t\tnew sap.ui.model.json.JSONModel(oCtxData),\r\n\t\t\t\t\t\"JM_ContextModel\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// added by sabarish 20.11.2025\r\n\t\t// fnMobileViewChanges: function() {\r\n\t\t// \tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", false);\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_init_roadmap\");\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_init_roadmapSS\");\r\n\t\t// \t// this.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t// \t// this.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t// },\r\n\t\t// fnTabDesktopViewChanges: function() {\r\n\t\t// \tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", true);\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_init_roadmapSS\");\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_init_roadmap\");\r\n\t\t// \t// this.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t// \t// this.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t// },\r\n\t\t// _onResize: function() {\r\n\t\t// \tvar oRange = sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD);\r\n\r\n\t\t// \tif (oRange.name === \"Phone\") {\r\n\t\t// \t\tthis.fnMobileViewChanges();\r\n\t\t// \t} else {\r\n\t\t// \t\tthis.fnTabDesktopViewChanges();\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t//EOC\r\n\t});\r\n\r\n});",
		"MANAGED_RECIPE/controller/bom_detail.controller.js": "/* global XLSX */\r\nsap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/core/Fragment\",\r\n\t\"sap/ui/model/resource/ResourceModel\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/export/Spreadsheet\",\r\n\t\"sap/ui/export/library\"\r\n], function(Controller, Filter, FilterOperator, ErrorHandler, formatter, Fragment, ResourceModel, JSONModel, Spreadsheet, exportLibrary) {\r\n\t\"use strict\";\r\n\r\n\tvar i18n;\r\n\tvar EdmType = exportLibrary.EdmType;\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\tvar frontEndId = [\r\n\t\t\"ID_BOM_AVOAU\", \"ID_BOM_AUSCH\", \"ID_BOM_ALPGR\", \"ID_BOM_RFPNT\",\r\n\t\t\"ID_BOM_NLFZT\", \"ID_BOM_NLFZV\", \"ID_BOM_NLFMV\", \"ID_BOM_VERTI\",\r\n\t\t\"ID_BOM_DSPST\", \"ID_BOM_ITSOB\", \"ID_BOM_POTX1\", \"ID_BOM_POTX2\",\r\n\t\t\"ID_BOM_ERSKZ\", \"ID_BOM_RVREL\", \"ID_BOM_BEIKZ\", \"ID_BOM_LGORT\",\r\n\t\t\"ID_BOM_KZKUP\", \"ID_BOM_PRVBE\", \"ID_BOM_SANKO\", \"ID_BOM_SANIN\",\r\n\t\t\"ID_BOM_SANFE\", \"ID_BOM_SCHGT\", \"ID_BOM_SCHKZ\", \"ID_BOM_SANKA\",\r\n\t\t\"ID_BOM_EXSTL\", \"ID_BOM_ZTEXT\", \"ID_BOM_STKTX\", \"ID_BOM_BMENG\",\r\n\t\t\"ID_BOM_STLST\", \"ID_BOM_STLBE\", \"ID_BOM_ADATU\", \"ID_BOM_LOSVN\",\r\n\t\t\"ID_BOM_LOSBS\", \"ID_BOM_LABOR\", \"ID_BOM_AENRA\", \"ID_BOM_AENNR\",\r\n\t\t\"ID_BOM_FMENG\", \"ID_BOM_NETAU\", \"ID_BOM_REKRS\", \"ID_BOM_REKRI\"\r\n\t];\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.bom_detail\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\tonInit: function() {\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"bom_detail\").attachPatternMatched(this.fnRouter, this);\r\n\t\t\tthis.f4Cache = {};\r\n\t\t},\r\n\r\n\t\tfnRouter: function() {\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\t\t\t// ********************* i18n MODEL ************************\r\n\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\t// **********************************************************\r\n\t\t\t// ********************* Visible MODEL ************************\r\n\t\t\tvar oVisibleModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tvisible: true,\r\n\t\t\t\trowCount: 5,\r\n\t\t\t\tBasicVisible: true\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oVisibleModel, \"JM_Visible\");\r\n\t\t\t// **********************************************************\r\n\r\n\t\t\tvar oMainModel = new JSONModel({\r\n\t\t\t\tuploadedFileName: \"\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oMainModel, \"JMUploadermodel\");\r\n\r\n\t\t\tvar oMainModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tuploadedFileName: \"\",\r\n\t\t\t\tFileName: \"\"\r\n\t\t\t});\r\n\r\n\t\t\tthis.getView().setModel(oMainModel, \"JMUploadFileModel\"); // added by sabarish 19-12-2025\r\n\r\n\t\t\tvar oKeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\tvar oGobalProductionmodel = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oRecipeModel = this.getOwnerComponent().getModel(\"JM_Recipe\");\r\n\t\t\tvar oGlobalBomModel = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tthis.AppId = oKeyDataModel.getProperty(\"/AppId\");\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel('JMConfig');\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_UserModel\");\r\n\t\t\t\t\tthat.UserName = oData.results[0].Uname;\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.fninitLocalModels(oKeyDataModel, oRecipeModel, oGobalProductionmodel);\r\n\r\n\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\tvar oUwlData = oFromUwl.getData();\r\n\r\n\t\t\tif (oUwlData && Object.keys(oUwlData).length > 0) {\r\n\t\t\t\tthis.fnhandleUWLScenario(oUwlData, oKeyDataModel, oGobalProductionmodel, oGlobalBomModel);\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnhandleNoUWLScenario();\r\n\t\t\t}\r\n\t\t\tthis.fnInitializeScreen();\r\n\t\t\t// this.fnChangeLogHighlighter(oUwlData);\r\n\r\n\t\t},\r\n\r\n\t\tfninitLocalModels: function(oKeyDataModel, oRecipeModel, oGobalProductionmodel) {\r\n\t\t\tif (Object.keys(oKeyDataModel.getData() || {}).length > 0 && Object.keys(oRecipeModel.getData() || {}).length > 0) {\r\n\r\n\t\t\t\tvar lkeyDataModel = new sap.ui.model.json.JSONModel(oKeyDataModel.getData());\r\n\t\t\t\tthis.getView().setModel(lkeyDataModel, \"JM_KeydataModel\");\r\n\r\n\t\t\t\tvar lRecipeModel = new sap.ui.model.json.JSONModel(oRecipeModel.getData());\r\n\t\t\t\tthis.getView().setModel(lRecipeModel, \"JM_RecipeData\");\r\n\r\n\t\t\t\tvar lProductionDataModel = new sap.ui.model.json.JSONModel(oGobalProductionmodel.getData());\r\n\t\t\t\tthis.getView().setModel(lProductionDataModel, \"JM_PVContextModel\");\r\n\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnhandleUWLScenario: function(oUwlData, oKeyDataModel, oGobalProductionmodel, oGlobalBomModel) {\r\n\r\n\t\t\tvar oUwlModel = new sap.ui.model.json.JSONModel(oUwlData);\r\n\t\t\tthis.getView().setModel(oUwlModel, \"JM_ContextModel\");\r\n\r\n\t\t\tvar oDescModel = sap.ui.getCore().getModel(\"JM_DescriptionModel\");\r\n\r\n\t\t\tif (oKeyDataModel && oGobalProductionmodel && oGlobalBomModel && oDescModel) {\r\n\r\n\t\t\t\tvar KeyData = oKeyDataModel.getData();\r\n\t\t\t\tvar ProductionVersionData = oGobalProductionmodel.getData();\r\n\t\t\t\tvar oReciBomData = oGlobalBomModel.getData();\r\n\t\t\t\tvar aDescData = oDescModel.getData();\r\n\r\n\t\t\t\tthis.getView().setModel(new sap.ui.model.json.JSONModel(KeyData), \"JM_KeydataModel\");\r\n\r\n\t\t\t\tthis.getView().setModel(new sap.ui.model.json.JSONModel(aDescData), \"JM_LocalDescriptionModel\");\r\n\t\t\t\tthis.getView().getModel(\"JM_LocalDescriptionModel\").refresh(true);\r\n\r\n\t\t\t\tvar basicData = ProductionVersionData.NavPV_BasicFields[0];\r\n\t\t\t\tfor (var key in basicData) {\r\n\t\t\t\t\tProductionVersionData[key] = basicData[key];\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().setModel(new sap.ui.model.json.JSONModel(ProductionVersionData), \"JM_PVContextModel\");\r\n\r\n\t\t\t\tif (oReciBomData &&\r\n\t\t\t\t\tArray.isArray(oReciBomData.NavBomHeader) && oReciBomData.NavBomHeader.length > 0 ||\r\n\t\t\t\t\tArray.isArray(oReciBomData.NavBomItem) && oReciBomData.NavBomItem.length > 0) {\r\n\t\t\t\t\tthis.fnsetBOMModels(oReciBomData);\r\n\t\t\t\t\tthis.fnChangeLogHighlighter(oUwlData);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fnGetBomDetails(oUwlData);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnhandleNoUWLScenario: function() {\r\n\t\t\tthis.fnGetBomDetails();\r\n\t\t},\r\n\r\n\t\tfnChangeLogHighlighter: function(oUwlData) {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tvar aChangeLogData = (oChangeLogModel && Array.isArray(oChangeLogModel.getData())) ? oChangeLogModel.getData() : [];\r\n\r\n\t\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0 && oUwlData.Appid === \"RX\") {\r\n\r\n\t\t\t\t\tthis.OrgChangeLog = JSON.parse(JSON.stringify(aChangeLogData));\r\n\r\n\t\t\t\t\tvar aChangedItems = aChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ProcessInd === \"B\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar aChangedItemNos = aChangedItems.filter(function(oItem) {\r\n\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t}).map(function(oItem) {\r\n\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\toTable.setRowSettingsTemplate(\r\n\t\t\t\t\t\tnew sap.ui.table.RowSettings({\r\n\t\t\t\t\t\t\thighlight: {\r\n\t\t\t\t\t\t\t\tpath: \"JM_BOMTable>Posnr\",\r\n\t\t\t\t\t\t\t\tformatter: function(sPosnr) {\r\n\t\t\t\t\t\t\t\t\tif (aChangedItemNos.includes(sPosnr)) {\r\n\t\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.Indication06;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.None;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\taChangedItems.forEach(function(oItem) {\r\n\t\t\t\t\t\t\tif (!oItem.ItemNo && oItem.FieldId) {\r\n\t\t\t\t\t\t\t\tvar oControl = oView.byId(oItem.FieldId);\r\n\t\t\t\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\t\t\t\toControl.addStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.OrgChangeLog = JSON.parse(JSON.stringify(aChangeLogData));\r\n\t\t\t\t}\r\n\t\t\t\tvar BOMTableModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\t\tvar BOMHeaderModel = this.getView().getModel(\"JM_BOMModel\");\r\n\t\t\t\tif (BOMTableModel || BOMHeaderModel) {\r\n\t\t\t\t\tthis.oldHeaderValue = JSON.parse(JSON.stringify(BOMHeaderModel.getData()));\r\n\t\t\t\t\tthis.oldItemValue = JSON.parse(JSON.stringify(BOMTableModel.getProperty(\"/BOMList\")));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.oldHeaderValue = {};\r\n\t\t\t\t\tthis.oldItemValue = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnsetBOMModels: function(oReciBomData) {\r\n\t\t\tif (oReciBomData.NavBomHeader && oReciBomData.NavBomHeader.length > 0) {\r\n\r\n\t\t\t\tvar oHeaderData = jQuery.extend(true, {}, (oReciBomData.NavBomHeader[0]));\r\n\t\t\t\tthis.getView().setModel(new sap.ui.model.json.JSONModel(oHeaderData), \"JM_BOMModel\");\r\n\t\t\t\tvar oHeaderModel = this.getView().getModel(\"JM_BOMModel\");\r\n\t\t\t\toHeaderModel.setProperty(\"/Losme\", oHeaderModel.getProperty(\"/Bmein\"));\r\n\t\t\t}\r\n\r\n\t\t\tif (oReciBomData.NavBomItem && oReciBomData.NavBomItem.length > 0) {\r\n\t\t\t\tvar aItems = jQuery.extend(true, [], (oReciBomData.NavBomItem));\r\n\r\n\t\t\t\tvar oDescData = this.getView().getModel(\"JM_LocalDescriptionModel\").getData();\r\n\r\n\t\t\t\tfor (var i = 0; i < aItems.length; i++) {\r\n\r\n\t\t\t\t\taItems[i].SgtCmkz = aItems[i].SgtCmkz === \"X\";\r\n\t\t\t\t\taItems[i].Stlkz = aItems[i].Stlkz === \"X\";\r\n\t\t\t\t\taItems[i].key = aItems[i].Kzkup ? \"Y\" : \"N\";\r\n\t\t\t\t\taItems[i].Ltxpo = aItems[i].Ltxpo === \"X\";\r\n\t\t\t\t\tvar sPosnr = aItems[i].Posnr;\r\n\t\t\t\t\tvar sIdnrk = aItems[i].Idnrk;\r\n\r\n\t\t\t\t\tvar aDescList = oDescData[sPosnr]; // get description array for that posnr\r\n\r\n\t\t\t\t\tif (Array.isArray(aDescList)) {\r\n\t\t\t\t\t\tvar oIdnrkEntry = aDescList.find(function(entry) {\r\n\t\t\t\t\t\t\treturn entry.FieldName === \"IDNRK\";\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (oIdnrkEntry) {\r\n\t\t\t\t\t\t\tvar descIdnrk = oIdnrkEntry.value.replace(/^0+/, \"\"); // If IDNRK matches  update KTEXT\r\n\t\t\t\t\t\t\tif (descIdnrk === sIdnrk) {\r\n\t\t\t\t\t\t\t\taItems[i].Ktext = oIdnrkEntry.desc;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar iStartNo = 10;\r\n\t\t\t\tvar iIncrement = 10;\r\n\t\t\t\tvar TotalItems = 10;\r\n\t\t\t\tvar aBOMList = [];\r\n\t\t\t\tif (Array.isArray(aItems) && aItems.length > 0) {\r\n\t\t\t\t\t// Existing BOM Items\r\n\t\t\t\t\tfor (var i = 0; i < aItems.length; i++) {\r\n\t\t\t\t\t\tvar item = aItems[i];\r\n\t\t\t\t\t\tvar sPosnr = String(iStartNo).padStart(4, \"0\");\r\n\t\t\t\t\t\tiStartNo += iIncrement;\r\n\r\n\t\t\t\t\t\tvar oBOMItem = {\r\n\t\t\t\t\t\t\tPosnr: item.Posnr || sPosnr,\r\n\t\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\t\tKtext: item.Ktext || \"\",\r\n\t\t\t\t\t\t\tIdent: item.Ident || \"\",\r\n\t\t\t\t\t\t\tAenra: item.Aenra || \"\",\r\n\t\t\t\t\t\t\tAlpgr: item.Alpgr || \"\",\r\n\t\t\t\t\t\t\tSgtCmkz: item.SgtCmkz === \"X\",\r\n\t\t\t\t\t\t\tStlkz: item.Stlkz === \"X\",\r\n\t\t\t\t\t\t\t// Cadpo: item.Cadpo || null,\r\n\t\t\t\t\t\t\t// Alekz: item.Alekz || null,\r\n\t\t\t\t\t\t\tSgtCatv: item.SgtCatv || \"\",\r\n\t\t\t\t\t\t\tMenge: item.Menge || null,\r\n\t\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\t\tUpskz: item.Upskz || null,\r\n\t\t\t\t\t\t\tSanka: item.Sanka || \"\",\r\n\t\t\t\t\t\t\tObtsp: item.Obtsp || \"\",\r\n\t\t\t\t\t\t\tSanin: item.Sanin === \"X\",\r\n\t\t\t\t\t\t\tDatuv: item.Datuv || null,\r\n\t\t\t\t\t\t\tDatub: item.Datub || null,\r\n\t\t\t\t\t\t\tAndat: item.Andat || null,\r\n\t\t\t\t\t\t\tAedat: item.Aedat || null,\r\n\t\t\t\t\t\t\tSortf: item.Sortf || \"\",\r\n\t\t\t\t\t\t\tAnnam: item.Annam || \"\",\r\n\t\t\t\t\t\t\tAenam: item.Aenam || \"\",\r\n\t\t\t\t\t\t\tItmid: item.Itmid || \"\",\r\n\t\t\t\t\t\t\tAennr: item.Aennr || \"\",\r\n\t\t\t\t\t\t\tRfpnt: item.Rfpnt || \"\",\r\n\t\t\t\t\t\t\tFmeng: item.Fmeng || false,\r\n\t\t\t\t\t\t\tLtxpo: item.Ltxpo === \"X\",\r\n\t\t\t\t\t\t\tVerti: item.Verti || \"\",\r\n\t\t\t\t\t\t\tAvoau: item.Avoau || null,\r\n\t\t\t\t\t\t\tAusch: item.Ausch || null,\r\n\t\t\t\t\t\t\tNetau: item.Netau || null,\r\n\t\t\t\t\t\t\tRekrs: item.Rekrs || null,\r\n\t\t\t\t\t\t\tRekri: item.Rekri || null,\r\n\t\t\t\t\t\t\tKzkup: item.Kzkup || null,\r\n\t\t\t\t\t\t\tNlfzt: item.Nlfzt || null,\r\n\t\t\t\t\t\t\tNlfzv: item.Nlfzv || null,\r\n\t\t\t\t\t\t\tNlfmv: item.Nlfmv || \"\",\r\n\t\t\t\t\t\t\tDspst: item.Dspst || \"\",\r\n\t\t\t\t\t\t\tItsob: item.Itsob || \"\",\r\n\t\t\t\t\t\t\tDumps: item.Dumps || null,\r\n\t\t\t\t\t\t\tPotx1: item.Potx1 || \"\",\r\n\t\t\t\t\t\t\tPotx2: item.Potx2 || \"\",\r\n\t\t\t\t\t\t\tErskz: item.Erskz || \"\",\r\n\t\t\t\t\t\t\tRvrel: item.Rvrel || \"\",\r\n\t\t\t\t\t\t\tSanko: item.Sanko || null,\r\n\t\t\t\t\t\t\tSanfe: item.Sanfe || null,\r\n\t\t\t\t\t\t\tBeikz: item.Beikz || \"\",\r\n\t\t\t\t\t\t\tLgort: item.Lgort || \"\",\r\n\t\t\t\t\t\t\tPrvbe: item.Prvbe || \"\",\r\n\t\t\t\t\t\t\tSchgt: item.Schgt || null,\r\n\t\t\t\t\t\t\tSchkz: item.Schkz || null\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\taBOMList.push(oBOMItem);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var j = 0; j < TotalItems - aItems.length; j++) {\r\n\t\t\t\t\t\tvar sLastPosnr = aBOMList.length > 0 ? aBOMList[aBOMList.length - 1].Posnr : \"0000\";\r\n\t\t\t\t\t\tvar iNewItem = (parseInt(sLastPosnr, 10) || 0) + 10;\r\n\t\t\t\t\t\tvar sNewPosnr = iNewItem.toString().padStart(4, \"0\");\r\n\t\t\t\t\t\taBOMList.push(this.fncreateEmptyBOMItem(sNewPosnr));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (var k = 0; k < 10; k++) {\r\n\t\t\t\t\t\tvar sPosnr = String(iStartNo).padStart(4, \"0\");\r\n\t\t\t\t\t\tiStartNo += iIncrement;\r\n\t\t\t\t\t\taBOMList.push(this.fncreateEmptyBOMItem(sPosnr));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oItemData = {\r\n\t\t\t\t\tBOMList: aBOMList\r\n\t\t\t\t};\r\n\t\t\t\tvar aItemDetails = jQuery.extend(true, [], (oItemData));\r\n\t\t\t\tthis.getView().setModel(new sap.ui.model.json.JSONModel(aItemDetails), \"JM_BOMTable\");\r\n\t\t\t\tthis.getView().getModel(\"JM_BOMTable\").refresh(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnGetBomDetails: function(oUwlData) {\r\n\r\n\t\t\tvar BomModel = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\tvar oBomData = BomModel.getData();\r\n\t\t\tif (\r\n\t\t\t\t(oBomData && Object.keys(oBomData).length === 0) ||\r\n\t\t\t\t(oBomData &&\r\n\t\t\t\t\tArray.isArray(oBomData.NavBomHeader) && oBomData.NavBomHeader.length === 0 &&\r\n\t\t\t\t\tArray.isArray(oBomData.NavBomItem) && oBomData.NavBomItem.length === 0)\r\n\t\t\t) {\r\n\r\n\t\t\t\tvar aOdataModel = this.getOwnerComponent().getModel();\r\n\t\t\t\tvar that = this;\r\n\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tMatnr: this.getView().byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\tProfidnetz: \"\",\r\n\t\t\t\t\tPlnal: \"\",\r\n\t\t\t\t\tMaktx: \"\",\r\n\t\t\t\t\tPlnnr: \"\",\r\n\t\t\t\t\tTransid: \"\",\r\n\t\t\t\t\tWerks: this.getView().byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tWiId: \"\",\r\n\t\t\t\t\tAppId: \"RC\",\r\n\t\t\t\t\tKtext: \"\",\r\n\t\t\t\t\tMsgTyp: \"\",\r\n\t\t\t\t\tMsgLine: \"\",\r\n\t\t\t\t\tInd: \"B\",\r\n\t\t\t\t\tWfParm1: \"\",\r\n\t\t\t\t\tWfParm2: \"\",\r\n\t\t\t\t\tWfParm3: \"\",\r\n\t\t\t\t\tWfParm4: \"\",\r\n\t\t\t\t\tName1: \"\",\r\n\t\t\t\t\tNavBomHeader: [{\r\n\t\t\t\t\t\tStlan: this.getView().byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\t\t\tStlal: this.getView().byId(\"ID_BOM_STLAL\").getValue(),\r\n\t\t\t\t\t\tTetyp: \"\",\r\n\t\t\t\t\t\tExstl: \"\",\r\n\t\t\t\t\t\tZtext: \"\",\r\n\t\t\t\t\t\tStktx: \"\",\r\n\t\t\t\t\t\tBmeng: null,\r\n\t\t\t\t\t\tBmein: \"\",\r\n\t\t\t\t\t\tLosvn: null,\r\n\t\t\t\t\t\tLosbs: null,\r\n\t\t\t\t\t\tStlst: \"\",\r\n\t\t\t\t\t\tStlbe: \"\",\r\n\t\t\t\t\t\tLabor: \"\",\r\n\t\t\t\t\t\tGroes: \"\"\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tNavBomItem: [],\r\n\t\t\t\t\tNavDescription: []\r\n\t\t\t\t};\r\n\r\n\t\t\t\taOdataModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tif (oData.Msgtype === \"E\") {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.Message, \"Error\", that);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oData.Msgtype === \"S\") {\r\n\t\t\t\t\t\t\tthat.Tetyp = oData.Tetyp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar descModel = {};\r\n\t\t\t\t\t\tvar descData = oData.NavDescription.results;\r\n\t\t\t\t\t\tfor (var i = 0; i < descData.length; i++) {\r\n\t\t\t\t\t\t\tvar item = descData[i];\r\n\t\t\t\t\t\t\tif (item.Itemno !== \"\") {\r\n\t\t\t\t\t\t\t\tif (!descModel[item.Itemno]) {\r\n\t\t\t\t\t\t\t\t\tdescModel[item.Itemno] = [];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar data = {\r\n\t\t\t\t\t\t\t\t\tvalue: item.Fieldvalue,\r\n\t\t\t\t\t\t\t\t\tdesc: item.Fielddesc,\r\n\t\t\t\t\t\t\t\t\tFieldName: item.Fieldname\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tdescModel[item.Itemno].push(data);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (!descModel[item.Fieldname]) {\r\n\t\t\t\t\t\t\t\t\tdescModel[item.Fieldname] = {\r\n\t\t\t\t\t\t\t\t\t\tvalue: item.Fieldvalue,\r\n\t\t\t\t\t\t\t\t\t\tdesc: item.Fielddesc\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar oDescModel = new sap.ui.model.json.JSONModel(descModel);\r\n\t\t\t\t\t\tthat.getView().setModel(oDescModel, \"JM_LocalDescriptionModel\");\r\n\t\t\t\t\t\tsap.ui.getCore().setModel(oDescModel, \"JM_DescriptionModel\");\r\n\r\n\t\t\t\t\t\tthat.fnBindBomDetails(oData, oUwlData);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function() {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"HTTPReqFailedError\"), \"Error\", that);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif (oBomData.NavBomHeader && oBomData.NavBomHeader.length > 0) {\r\n\t\t\t\t\tvar oHeaderData = oBomData.NavBomHeader[0];\r\n\t\t\t\t\tvar oBOMHeaderModel = new sap.ui.model.json.JSONModel(oHeaderData);\r\n\t\t\t\t\tthis.getView().setModel(oBOMHeaderModel, \"JM_BOMModel\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (oBomData.NavBomItem && oBomData.NavBomItem.length > 0) {\r\n\t\t\t\t\tvar aItems = JSON.parse(JSON.stringify(oBomData.NavBomItem));\r\n\t\t\t\t\taItems.forEach(function(item) {\r\n\t\t\t\t\t\titem.SgtCmkz = item.SgtCmkz === \"X\";\r\n\t\t\t\t\t\titem.Stlkz = item.Stlkz === \"X\";\r\n\t\t\t\t\t\titem.Ltxpo = item.Ltxpo === \"X\";\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar oItemData = {\r\n\t\t\t\t\t\tBOMList: aItems\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar oBOMTableModel = new sap.ui.model.json.JSONModel(oItemData);\r\n\t\t\t\t\tthis.getView().setModel(oBOMTableModel, \"JM_BOMTable\");\r\n\t\t\t\t\toBOMTableModel.refresh(true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oDescModel = sap.ui.getCore().getModel(\"JM_DescriptionModel\");\r\n\t\t\t\tif (oDescModel) {\r\n\t\t\t\t\tvar oDescData = oDescModel.getData();\r\n\t\t\t\t\toDescModel = new sap.ui.model.json.JSONModel(oDescData);\r\n\t\t\t\t\tthis.getView().setModel(oDescModel, \"JM_LocalDescriptionModel\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnBindBomDetails: function(oData, oUwlData) {\r\n\t\t\tvar navHeaderResults = oData.NavBomHeader && oData.NavBomHeader.results;\r\n\t\t\tvar oHeader = (navHeaderResults && navHeaderResults.length > 0) ? navHeaderResults[0] : {};\r\n\t\t\tvar aODataItems = (oData.NavBomItem && oData.NavBomItem.results) ? oData.NavBomItem.results : [];\r\n\r\n\t\t\tthis.fnbuildBOMHeaderModel(oHeader);\r\n\r\n\t\t\tthis.fnbuildBOMItemsModel(oHeader, aODataItems);\r\n\r\n\t\t\tthis.fngetComponent().then(function(status) { // added by sabarish 14-01-2025\r\n\t\t\t\tif (status) {\r\n\r\n\t\t\t\t\tif (oUwlData) {\r\n\t\t\t\t\t\tthis.fnChangeLogHighlighter(oUwlData);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)); // added by sabarish 14-01-2025\r\n\r\n\t\t},\r\n\r\n\t\tfnbuildBOMHeaderModel: function(oHeader) {\r\n\t\t\tvar view = this.getView();\r\n\t\t\tvar oBOMModel;\r\n\r\n\t\t\tif (oHeader && Object.keys(oHeader).length > 0) {\r\n\t\t\t\toBOMModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tMatnr: view.byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\tWerks: view.byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tMaktx: view.byId(\"ID_BOM_MAKTX\").getValue(),\r\n\t\t\t\t\tWerksDesc: view.byId(\"ID_BOM_WERKS_DES\").getValue(),\r\n\t\t\t\t\tBomUsage: view.byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\t\tBoMUsageDesc: view.byId(\"ID_BOM_STLAN_DES\").getValue(),\r\n\t\t\t\t\tAltBom: view.byId(\"ID_BOM_STLAL\").getValue(),\r\n\t\t\t\t\tTetyp: \"M\",\r\n\t\t\t\t\tZtext: oHeader.Ztext,\r\n\t\t\t\t\tBmeng: oHeader.Bmeng,\r\n\t\t\t\t\tStktx: oHeader.Stktx,\r\n\t\t\t\t\tExstl: oHeader.Exstl,\r\n\t\t\t\t\tBmein: oHeader.Bmein,\r\n\t\t\t\t\tLosvn: oHeader.Losvn || 1.000,\r\n\t\t\t\t\tLosbs: oHeader.Losbs || 99999.999,\r\n\t\t\t\t\tLosme: oHeader.Losme || oHeader.Bmein,\r\n\t\t\t\t\tStlst: oHeader.Stlst,\r\n\t\t\t\t\tStlbe: oHeader.Stlbe,\r\n\t\t\t\t\tLabor: oHeader.Labor,\r\n\t\t\t\t\tGroes: oHeader.Groes,\r\n\t\t\t\t\tDatub: oHeader.Datub,\r\n\t\t\t\t\tDatuv: oHeader.Datuv,\r\n\t\t\t\t\tDeleteInd: oHeader.DeleteInd\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\toBOMModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tMatnr: view.byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\tWerks: view.byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tMaktx: view.byId(\"ID_BOM_MAKTX\").getValue(),\r\n\t\t\t\t\tWerksDesc: view.byId(\"ID_BOM_WERKS_DES\").getValue(),\r\n\t\t\t\t\tBomUsage: view.byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\t\tBoMUsageDesc: view.byId(\"ID_BOM_STLAN_DES\").getValue(),\r\n\t\t\t\t\tAltBom: view.byId(\"ID_BOM_STLAL\").getValue(),\r\n\t\t\t\t\tTetyp: \"M\",\r\n\t\t\t\t\tZtext: \"\",\r\n\t\t\t\t\tBmeng: 1,\r\n\t\t\t\t\tStktx: \"\",\r\n\t\t\t\t\tExstl: \"\",\r\n\t\t\t\t\tBmein: \"\",\r\n\t\t\t\t\tLosvn: \"1.000\",\r\n\t\t\t\t\tLosbs: \"99999.999\",\r\n\t\t\t\t\tLosme: \"\",\r\n\t\t\t\t\tStlst: \"01\",\r\n\t\t\t\t\tStlbe: \"\",\r\n\t\t\t\t\tLabor: \"\",\r\n\t\t\t\t\tGroes: \"\",\r\n\t\t\t\t\tDatuv: new Date()\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tview.setModel(oBOMModel, \"JM_BOMModel\");\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tfnbuildBOMItemsModel: function(oHeader, aODataItems) {\r\n\t\t\tvar aBOMList = [];\r\n\t\t\tvar aPromises = [];\r\n\t\t\tvar view = this.getView();\r\n\t\t\tvar that = this;\r\n\t\t\tvar iStartNo = 10;\r\n\t\t\tvar iIncrement = 10;\r\n\t\t\tvar TotalItems = 10;\r\n\r\n\t\t\tif (Array.isArray(aODataItems) && aODataItems.length > 0) {\r\n\t\t\t\t// Existing BOM Items\r\n\t\t\t\tfor (var i = 0; i < aODataItems.length; i++) {\r\n\t\t\t\t\tvar item = aODataItems[i];\r\n\t\t\t\t\tvar sPosnr = String(iStartNo).padStart(4, \"0\");\r\n\t\t\t\t\tiStartNo += iIncrement;\r\n\r\n\t\t\t\t\tvar oBOMItem = {\r\n\t\t\t\t\t\tPosnr: item.Posnr || sPosnr,\r\n\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\tKtext: item.Ktext || \"\",\r\n\t\t\t\t\t\tIdent: item.Ident || \"\",\r\n\t\t\t\t\t\tAenra: item.Aenra || \"\",\r\n\t\t\t\t\t\tAlpgr: item.Alpgr || \"\",\r\n\t\t\t\t\t\tSgtCmkz: item.SgtCmkz === \"X\",\r\n\t\t\t\t\t\tStlkz: item.Stlkz === \"X\",\r\n\t\t\t\t\t\t// Cadpo: item.Cadpo || null,\r\n\t\t\t\t\t\t// Alekz: item.Alekz || null,\r\n\t\t\t\t\t\tSgtCatv: item.SgtCatv || \"\",\r\n\t\t\t\t\t\tMenge: item.Menge || null,\r\n\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\tUpskz: item.Upskz || null,\r\n\t\t\t\t\t\tSanka: item.Sanka || \"\",\r\n\t\t\t\t\t\tObtsp: item.Obtsp || \"\",\r\n\t\t\t\t\t\tSanin: item.Sanin === \"X\",\r\n\t\t\t\t\t\tDatuv: item.Datuv || null,\r\n\t\t\t\t\t\tDatub: item.Datub || null,\r\n\t\t\t\t\t\tAndat: item.Andat || null,\r\n\t\t\t\t\t\tAedat: item.Aedat || null,\r\n\t\t\t\t\t\tSortf: item.Sortf || \"\",\r\n\t\t\t\t\t\tAnnam: item.Annam || \"\",\r\n\t\t\t\t\t\tAenam: item.Aenam || \"\",\r\n\t\t\t\t\t\tItmid: item.Itmid || \"\",\r\n\t\t\t\t\t\tAennr: item.Aennr || \"\",\r\n\t\t\t\t\t\tRfpnt: item.Rfpnt || \"\",\r\n\t\t\t\t\t\tFmeng: item.Fmeng || false,\r\n\t\t\t\t\t\tLtxpo: item.Ltxpo === \"X\",\r\n\t\t\t\t\t\tVerti: item.Verti || \"\",\r\n\t\t\t\t\t\tAvoau: item.Avoau || null,\r\n\t\t\t\t\t\tAusch: item.Ausch || null,\r\n\t\t\t\t\t\tNetau: item.Netau || null,\r\n\t\t\t\t\t\tRekrs: item.Rekrs || null,\r\n\t\t\t\t\t\tRekri: item.Rekri || null,\r\n\t\t\t\t\t\tKzkup: item.Kzkup || null,\r\n\t\t\t\t\t\tkey: (item.Kzkup) ? \"Y\" : \"N\",\r\n\t\t\t\t\t\tNlfzt: item.Nlfzt || null,\r\n\t\t\t\t\t\tNlfzv: item.Nlfzv || null,\r\n\t\t\t\t\t\tNlfmv: item.Nlfmv || \"\",\r\n\t\t\t\t\t\tDspst: item.Dspst || \"\",\r\n\t\t\t\t\t\tItsob: item.Itsob || \"\",\r\n\t\t\t\t\t\tDumps: item.Dumps || null,\r\n\t\t\t\t\t\tPotx1: item.Potx1 || \"\",\r\n\t\t\t\t\t\tPotx2: item.Potx2 || \"\",\r\n\t\t\t\t\t\tErskz: item.Erskz || \"\",\r\n\t\t\t\t\t\tRvrel: item.Rvrel || \"\",\r\n\t\t\t\t\t\tSanko: item.Sanko || null,\r\n\t\t\t\t\t\tSanfe: item.Sanfe || null,\r\n\t\t\t\t\t\tBeikz: item.Beikz || \"\",\r\n\t\t\t\t\t\tLgort: item.Lgort || \"\",\r\n\t\t\t\t\t\tPrvbe: item.Prvbe || \"\",\r\n\t\t\t\t\t\tSchgt: item.Schgt || null,\r\n\t\t\t\t\t\tSchkz: item.Schkz || null\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\taBOMList.push(oBOMItem);\r\n\t\t\t\t\t// To set the description for component in BOM items\r\n\t\t\t\t\t// if (item.Idnrk) {\r\n\t\t\t\t\t// \t(function(bomItem, compValue) {\r\n\t\t\t\t\t// \t\taPromises.push(\r\n\t\t\t\t\t// \t\t\tnew Promise(function(resolve) {\r\n\t\t\t\t\t// \t\t\t\tthat.fnReadf4Cache(\"ID_BOM_IDNRK\", compValue, \"X\", function(match) {\r\n\t\t\t\t\t// \t\t\t\t\tif (match && match.Value2) {\r\n\t\t\t\t\t// \t\t\t\t\t\tbomItem.Ktext = match.Value2;\r\n\t\t\t\t\t// \t\t\t\t\t}\r\n\t\t\t\t\t// \t\t\t\t\tresolve();\r\n\t\t\t\t\t// \t\t\t\t});\r\n\t\t\t\t\t// \t\t\t})\r\n\t\t\t\t\t// \t\t);\r\n\t\t\t\t\t// \t})(oBOMItem, item.Idnrk);\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = 0; j < TotalItems - aODataItems.length; j++) {\r\n\t\t\t\t\tvar sLastPosnr = aBOMList.length > 0 ? aBOMList[aBOMList.length - 1].Posnr : \"0000\";\r\n\t\t\t\t\tvar iNewItem = (parseInt(sLastPosnr, 10) || 0) + 10;\r\n\t\t\t\t\tvar sNewPosnr = iNewItem.toString().padStart(4, \"0\");\r\n\t\t\t\t\taBOMList.push(this.fncreateEmptyBOMItem(sNewPosnr));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor (var k = 0; k < 10; k++) {\r\n\t\t\t\t\tvar sPosnr = String(iStartNo).padStart(4, \"0\");\r\n\t\t\t\t\tiStartNo += iIncrement;\r\n\t\t\t\t\taBOMList.push(this.fncreateEmptyBOMItem(sPosnr));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Promise.all(aPromises).then(function() { 14-012026\r\n\t\t\tvar oBOMTableModel = view.getModel(\"JM_BOMTable\");\r\n\t\t\tif (!oBOMTableModel) {\r\n\t\t\t\toBOMTableModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\tview.setModel(oBOMTableModel, \"JM_BOMTable\");\r\n\t\t\t}\r\n\r\n\t\t\toBOMTableModel.setData({\r\n\t\t\t\tBOMList: aBOMList\r\n\t\t\t});\r\n\r\n\t\t\tif (oHeader.Labor) {\r\n\t\t\t\tthat.fnReadf4Cache(\"ID_BOM_LABOR\", oHeader.Labor, \"P\");\r\n\t\t\t\tthat.selectedField = \"ID_BOM_LABOR\";\r\n\t\t\t} else {\r\n\t\t\t\tvar sStlanValue = view.byId(\"ID_BOM_STLAN\").getValue();\r\n\t\t\t\tthat.fnReadf4Cache(\"ID_BOM_STLAN\", sStlanValue, \"P\");\r\n\t\t\t\tthat.selectedField = \"ID_BOM_STLAN\";\r\n\t\t\t}\r\n\t\t\t// }); // bt sabarish 14-01-20205\r\n\t\t},\r\n\r\n\t\tfncreateEmptyBOMItem: function(sPosnr) {\r\n\t\t\treturn {\r\n\t\t\t\tPosnr: sPosnr,\r\n\t\t\t\tPostp: \"L\",\r\n\t\t\t\tIdnrk: \"\",\r\n\t\t\t\tKtext: \"\",\r\n\t\t\t\tMenge: \"\",\r\n\t\t\t\tMeins: \"\",\r\n\t\t\t\tIdent: \"\",\r\n\t\t\t\tAenra: \"\",\r\n\t\t\t\tAlpgr: \"\",\r\n\t\t\t\tSanka: \"\",\r\n\t\t\t\tSanin: null,\r\n\t\t\t\tSgtCatv: \"\",\r\n\t\t\t\tSgtCmkz: false,\r\n\t\t\t\tDatuv: new Date(),\r\n\t\t\t\tAndat: new Date(),\r\n\t\t\t\tDatub: new Date(\"9999-12-31T00:00:00Z\"),\r\n\t\t\t\tUpskz: null,\r\n\t\t\t\tStlkz: false,\r\n\t\t\t\tSortf: \"\",\r\n\t\t\t\tkey: \"\",\r\n\t\t\t\t// Alekz: false,\r\n\t\t\t\tCadpo: false,\r\n\t\t\t\tAennr: \"\",\r\n\t\t\t\tFmeng: false,\r\n\t\t\t\tLtxpo: false,\r\n\t\t\t\tVerti: \"\",\r\n\t\t\t\tAvoau: null,\r\n\t\t\t\tAusch: null,\r\n\t\t\t\tNetau: null,\r\n\t\t\t\tRekrs: null,\r\n\t\t\t\tRekri: null,\r\n\t\t\t\tKzkup: null,\r\n\t\t\t\tNlfzt: null,\r\n\t\t\t\tNlfzv: null,\r\n\t\t\t\tNlfmv: \"\",\r\n\t\t\t\tDspst: \"\",\r\n\t\t\t\tItsob: \"\",\r\n\t\t\t\tDumps: false,\r\n\t\t\t\tPotx1: \"\",\r\n\t\t\t\tPotx2: \"\",\r\n\t\t\t\tErskz: \"\",\r\n\t\t\t\tRvrel: \"\",\r\n\t\t\t\tSanko: null,\r\n\t\t\t\tSanfe: this.getView().byId(\"ID_BOM_STLAN\").getValue() === \"1\" || null,\r\n\t\t\t\tBeikz: \"\",\r\n\t\t\t\tLgort: \"\",\r\n\t\t\t\tPrvbe: \"\",\r\n\t\t\t\tSchgt: null,\r\n\t\t\t\tSchkz: null\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tfnAddRow: function() {\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\t\t\tvar oModel = oTable.getModel(\"JM_BOMTable\");\r\n\t\t\tvar aData = oModel.getProperty(\"/BOMList\") || [];\r\n\r\n\t\t\t// Determine the next item number\r\n\t\t\tvar iNewItem = 10;\r\n\t\t\tif (aData.length > 0) {\r\n\t\t\t\tvar sLastPosnr = aData[aData.length - 1].Posnr || \"0000\";\r\n\t\t\t\tvar iLastItem = parseInt(sLastPosnr, 10) || 0;\r\n\t\t\t\tiNewItem = iLastItem + 10;\r\n\t\t\t}\r\n\t\t\tvar sNewPosnr = iNewItem.toString().padStart(4, \"0\");\r\n\t\t\tvar oNewRow = this.fncreateEmptyBOMItem(sNewPosnr);\r\n\r\n\t\t\taData.push(oNewRow);\r\n\t\t\toModel.setProperty(\"/BOMList\", aData);\r\n\t\t\toModel.refresh(true);\r\n\r\n\t\t\t// Scroll to the newly added row\r\n\t\t\tvar iLastIndex = aData.length - 1;\r\n\t\t\toTable.setFirstVisibleRow(iLastIndex);\r\n\t\t},\r\n\r\n\t\tfnDeleteFrag: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectOneRowToDelete\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: \"Information\",\r\n\t\t\t\ttext: \"Do you want to delete this row ?\",\r\n\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"BOM_DELETE\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnDeleteRow: function() {\r\n\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\t\t\tvar oModel = oTable.getModel(\"JM_BOMTable\");\r\n\t\t\tvar aData = oModel.getProperty(\"/BOMList\");\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\r\n\t\t\taSelectedIndices.sort(function(a, b) {\r\n\t\t\t\treturn b - a;\r\n\t\t\t});\r\n\r\n\t\t\tvar aSelectedRows = aSelectedIndices.map(function(iIndex) {\r\n\t\t\t\tvar oContext = oTable.getContextByIndex(iIndex);\r\n\t\t\t\treturn oContext ? oContext.getObject() : null;\r\n\t\t\t}).filter(Boolean);\r\n\r\n\t\t\t// === Initialize Global and Local Change Logs ===\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\r\n\t\t\t\tvar gChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tif (!gChangeLogModel) {\r\n\t\t\t\t\tgChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\t\tthis.getOwnerComponent().setModel(gChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oChangeLogData = gChangeLogModel.getData();\r\n\t\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\t\toChangeLogData = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar ItemNo = that.oldItemValue.map(function(item) {\r\n\t\t\t\t\treturn item.Posnr;\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// === Process Each Selected Row ===\r\n\t\t\t\taSelectedRows.forEach(function(oRow) {\r\n\t\t\t\t\tvar oPosnr = oRow.Posnr || \"\";\r\n\t\t\t\t\tvar oIdnrk = oRow.Idnrk || \"\";\r\n\t\t\t\t\tvar oUnit = oRow.Meins || \"\";\r\n\t\t\t\t\tvar oQty = oRow.Menge || null;\r\n\t\t\t\t\tvar oMatnr = oIdnrk || \"\";\r\n\r\n\t\t\t\t\tif (ItemNo.includes(oPosnr)) {\r\n\t\t\t\t\t\tvar baseLabel = \"Deleted Item - \" + oPosnr;\r\n\r\n\t\t\t\t\t\tif (oMatnr) {\r\n\t\t\t\t\t\t\tvar entryMat = {\r\n\t\t\t\t\t\t\t\tProcessInd: \"B\",\r\n\t\t\t\t\t\t\t\tFieldId: \"ID_BOM_IDNRK\",\r\n\t\t\t\t\t\t\t\tProcessDesc: \"BOM\",\r\n\t\t\t\t\t\t\t\tItemNo: oPosnr || \"\",\r\n\t\t\t\t\t\t\t\tFieldName: baseLabel || \"\",\r\n\t\t\t\t\t\t\t\tOldValue: oMatnr || \"\",\r\n\t\t\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\toChangeLogData.push(entryMat);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (oUnit) {\r\n\t\t\t\t\t\t\tvar entryUnit = {\r\n\t\t\t\t\t\t\t\tProcessInd: \"B\",\r\n\t\t\t\t\t\t\t\tFieldId: \"ID_BOM_MEINS\",\r\n\t\t\t\t\t\t\t\tProcessDesc: \"BOM\",\r\n\t\t\t\t\t\t\t\tItemNo: oPosnr || \"\",\r\n\t\t\t\t\t\t\t\tFieldName: baseLabel || \"\",\r\n\t\t\t\t\t\t\t\tOldValue: oUnit || \"\",\r\n\t\t\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\toChangeLogData.push(entryUnit);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (oQty) {\r\n\t\t\t\t\t\t\tvar entryQty = {\r\n\t\t\t\t\t\t\t\tScrInd: \"B\",\r\n\t\t\t\t\t\t\t\tFieldId: \"ID_BOM_MENGE\",\r\n\t\t\t\t\t\t\t\tProcessDesc: \"BOM\",\r\n\t\t\t\t\t\t\t\tItemNo: oPosnr || \"\",\r\n\t\t\t\t\t\t\t\tFieldName: baseLabel || \"\",\r\n\t\t\t\t\t\t\t\tOldValue: oQty || \"\",\r\n\t\t\t\t\t\t\t\tProcessInd: \"B\",\r\n\t\t\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\toChangeLogData.push(entryQty);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toChangeLogData = oChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\t\treturn !(item.ItemNo === oPosnr && item.ProcessInd === \"B\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tgChangeLogModel.setData(oChangeLogData);\r\n\t\t\t\tgChangeLogModel.refresh(true);\r\n\t\t\t}\r\n\r\n\t\t\taSelectedIndices.forEach(function(iIndex) {\r\n\t\t\t\taData.splice(iIndex, 1);\r\n\t\t\t});\r\n\r\n\t\t\toModel.setProperty(\"/BOMList\", aData);\r\n\t\t\toTable.clearSelection();\r\n\r\n\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"RowsDeletedSuccess\"), \"success\", this);\r\n\t\t},\r\n\r\n\t\tfnRowSelectionChange: function(oEvent) {\r\n\t\t\tvar oTable = oEvent.getSource();\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tif (oModel) {\r\n\t\t\t\tvar aData = oModel.getProperty(\"/BOMList\");\r\n\r\n\t\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\t\t\t\tvar aDeselect = [];\r\n\r\n\t\t\t\taSelectedIndices.forEach(function(idx) {\r\n\t\t\t\t\tvar oRow = aData[idx];\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t(!oRow.Idnrk || oRow.Idnrk.trim() === \"\") ||\r\n\t\t\t\t\t\t(!oRow.Posnr || oRow.Posnr.trim() === \"\") ||\r\n\t\t\t\t\t\t(!oRow.Postp || oRow.Postp.trim() === \"\" || oRow.POSTP === \"Error\")\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\taDeselect.push(idx);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// Deselect invalid rows\r\n\t\t\t\taDeselect.forEach(function(idx) {\r\n\t\t\t\t\toTable.removeSelectionInterval(idx, idx);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// F4 Functionalities\r\n\t\tfnF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.bindTextF4model(\"P\", id, \"X\", oEvent);\r\n\t\t},\r\n\r\n\t\tfnF4TableInput: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar idClone = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar id = idClone.split(\"-\")[0];\r\n\t\t\tthis.selectedField = oInput.getId();\r\n\t\t\tthis.selectedContext = oInput.getBindingContext(\"JM_BOMTable\");\r\n\t\t\tthis.bindTextF4model(\"P\", id, \"A\", oEvent);\r\n\t\t},\r\n\r\n\t\tbindTextF4model: function(SearchHelp, sitem, process, oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar vLength;\r\n\t\t\tvar that = this;\r\n\t\t\tthat.sitem = sitem;\r\n\t\t\tvar KeyModel = that.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tif (KeyModel) {\r\n\t\t\t\tvar Werks = KeyModel.getProperty(\"/Werks\");\r\n\t\t\t}\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp\r\n\t\t\t};\r\n\r\n\t\t\tif ([\"ID_BOM_LGORT\", \"ID_BOM_PRVBE\", \"ID_BOM_VERTI\", \"ID_BOM_ITSOB\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t}\r\n\t\t\tif ([\"ID_BOM_IDNRK\"].includes(sitem)) {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t\toPayload.Process = \"X\";\r\n\t\t\t}\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\r\n\t\t\t\tsuccess: function(odata, Response) {\r\n\r\n\t\t\t\t\tif (odata.MsgType === \"E\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(odata.Message, \"Error\", that);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar aResults = odata.NavSerchResult.results;\r\n\t\t\t\t\tif (!aResults.length) return;\r\n\t\t\t\t\tvar aFormattedRows = [];\r\n\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\r\n\t\t\t\t\t\tif (oFirst && (oFirst.DomvalueL || oFirst.Ddtext)) {\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", that);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\toLabels.col1 = \"Key\";\r\n\t\t\t\t\t\t\tif (oFirst.Label2) oLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1) row.col1 = item.DomvalueL;\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) row.col2 = item.Ddtext;\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) row.col3 = item.DomvalueL3;\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) row.col4 = item.DomvalueL4;\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = sap.ui.getCore().byId(that.sitem + \"_TXT\").getText() + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", that);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label1) oLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t\tif (oFirst.Label2) oLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\tif (oFirst.Label3) oLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t\tif (oFirst.Label4) oLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t\t// Validate\r\n\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1 === \"Material\") {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1 ? item.Value1.replace(/^0+/, \"\") : item.Value1;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) row.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) row.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) row.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tthat.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = that.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t// MessageToast.show(\"HTTP Respond Failed\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) return;\r\n\r\n\t\t\tvar item = oContext.getProperty(\"col1\"); // main value\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\"); // description (if applicable)\r\n\r\n\t\t\t// Added by sabarish 11-12-2025\r\n\t\t\tif (this.prdStrogeLocFlag && this._selectedFieldEvent && this.sRowPath) {\r\n\r\n\t\t\t\tvar oldValue = this._selectedFieldEvent.getValue(); //Added by srikanth\r\n\t\t\t\tvar newValue = item; //Added by srikanth\r\n\t\t\t\tthis._selectedFieldEvent.setValue(item);\r\n\t\t\t\tthis._selectedFieldEvent.setValueState(\"None\");\r\n\r\n\t\t\t\tthis.getView().getModel(\"JM_BOMTable\").setProperty(this.sRowPath + \"/LgortDes\", item1);\r\n\r\n\t\t\t\tthis.fnAfterCloseFragment();\r\n\r\n\t\t\t\t// Added by srikanth 12-12-2025\r\n\r\n\t\t\t\tvar oChangeLogModel = this.getView().getModel(\"JM_ChangeLogModel\");\r\n\t\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\t\toChangeLogModel = new JSONModel([]);\r\n\t\t\t\t\tthis.getView().setModel(oChangeLogModel, \"JM_ChangeLogModel\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar aChangeLogData = oChangeLogModel.getData();\r\n\t\t\t\tif (!Array.isArray(aChangeLogData)) {\r\n\t\t\t\t\taChangeLogData = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar vId = \"ID_BOM_LGORT\";\r\n\t\t\t\tvar oView = this.getView();\r\n\r\n\t\t\t\tvar oContext = this._selectedFieldEvent.getBindingContext(\"JM_BOMTable\");\r\n\t\t\t\tvar sItemNo = oContext.getProperty(\"Posnr\");\r\n\r\n\t\t\t\tvar FieldName = \"\";\r\n\t\t\t\tif (this.getView().byId(vId + \"_LBL\")) {\r\n\t\t\t\t\tFieldName = this.getView().byId(vId + \"_LBL\").getText();\r\n\t\t\t\t\tif (sItemNo) {\r\n\t\t\t\t\t\tFieldName = FieldName + \" - \" + sItemNo;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if (sap.ui.getCore().byId(vId + \"_LBL\")) {\r\n\t\t\t\t\tFieldName = sap.ui.getCore().byId(vId + \"_LBL\").getText();\r\n\t\t\t\t\tif (sItemNo) {\r\n\t\t\t\t\t\tFieldName = FieldName + \" - \" + sItemNo;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oNewEntry = {\r\n\t\t\t\t\tTransid: \"\",\r\n\t\t\t\t\tWerks: oView.byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tItemNo: sItemNo || \"0000\",\r\n\t\t\t\t\tStlan: oView.byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\t\tMatnr: oView.byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\tStlal: oView.byId(\"ID_BOM_STLAL\").getValue(),\r\n\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\tOldValue: oldValue || \"\",\r\n\t\t\t\t\tFieldName: FieldName || \"\",\r\n\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\tChangedBy: this.User,\r\n\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (oldValue === newValue) {\r\n\t\t\t\t\tvar iIndexToRemove = aChangeLogData.findIndex(function(entry) {\r\n\t\t\t\t\t\treturn entry.ItemNo === oNewEntry.ItemNo && entry.FieldId === oNewEntry.FieldId;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (iIndexToRemove !== -1) {\r\n\t\t\t\t\t\taChangeLogData.splice(iIndexToRemove, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar oExistingEntry = aChangeLogData.find(function(entry) {\r\n\t\t\t\t\t\treturn entry.ItemNo === oNewEntry.ItemNo && entry.FieldId === oNewEntry.FieldId;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (oExistingEntry) {\r\n\t\t\t\t\t\toExistingEntry.NewValue = newValue;\r\n\t\t\t\t\t\toExistingEntry.OldValue = oldValue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\taChangeLogData.push(oNewEntry);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.prdStrogeLocFlag = false;\r\n\t\t\t\tthis._selectedFieldEvent = undefined;\r\n\t\t\t\tthis.sRowPath = undefined;\r\n\t\t\t\toChangeLogModel.setData(aChangeLogData); // added by sabarish 18-12-2025\r\n\t\t\t\t//eoc\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//eoc\r\n\r\n\t\t\t// Get the input that triggered F4\r\n\t\t\tvar sSelectedFieldId = this.selectedField;\r\n\t\t\tvar oSelectedInput = this.getView().byId(sSelectedFieldId) || sap.ui.getCore().byId(sSelectedFieldId) || Fragment.byId(\r\n\t\t\t\t\"ID_ITEMLEVEL\", sSelectedFieldId);\r\n\t\t\tif (!oSelectedInput) return;\r\n\r\n\t\t\t// Set main value\r\n\t\t\toSelectedInput.setValue(item);\r\n\t\t\toSelectedInput.setValueState(\"None\");\r\n\r\n\t\t\tvar oCtx = null;\r\n\r\n\t\t\tif (oSelectedInput.getBindingContext && oSelectedInput.getBindingContext(\"JM_BOMTable\")) {\r\n\t\t\t\toCtx = oSelectedInput.getBindingContext(\"JM_BOMTable\");\r\n\t\t\t}\r\n\r\n\t\t\t// Determine if this is Component field (table or normal input)\r\n\t\t\tvar bIsComponentField = sSelectedFieldId.includes(\"ID_BOM_IDNRK\") || sSelectedFieldId.includes(\"ID_BOM_LABOR\");\r\n\r\n\t\t\tif (bIsComponentField) {\r\n\t\t\t\t// Compute description field ID\r\n\t\t\t\tvar sDesFieldId = sSelectedFieldId.includes(\"ID_BOM_IDNRK\") ? sSelectedFieldId.replace(\"ID_BOM_IDNRK\", \"ID_BOM_IDNRK_DES\") :\r\n\t\t\t\t\tsSelectedFieldId.replace(\"ID_BOM_LABOR\", \"ID_BOM_LABOR_DES\");\r\n\r\n\t\t\t\tvar oDesField = this.getView().byId(sDesFieldId) || sap.ui.getCore().byId(sDesFieldId);\r\n\t\t\t\tif (oDesField) {\r\n\t\t\t\t\toDesField.setValue(item1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar Desc = sSelectedFieldId + \"_DES\";\r\n\t\t\tvar FrgDecs = Fragment.byId(\"ID_ITEMLEVEL\", Desc);\r\n\t\t\tif (FrgDecs) {\r\n\t\t\t\tFrgDecs.setValue(item1);\r\n\t\t\t}\r\n\r\n\t\t\t// Table row update logic\r\n\t\t\tif (this.selectedContext && sSelectedFieldId !== \"ID_BOM_LABOR\") {\r\n\t\t\t\tvar oModel = this.selectedContext.getModel();\r\n\t\t\t\tvar sPath = this.selectedContext.getPath();\r\n\r\n\t\t\t\tif (bIsComponentField) {\r\n\t\t\t\t\toModel.setProperty(sPath + \"/Idnrk\", item);\r\n\t\t\t\t\toModel.setProperty(sPath + \"/Ktext\", item1);\r\n\t\t\t\t} else if (sSelectedFieldId.includes(\"ID_BOM_POSTP\")) {\r\n\t\t\t\t\toModel.setProperty(sPath + \"/Postp\", item);\r\n\t\t\t\t} else if (sSelectedFieldId.includes(\"ID_BOM_MEINS\")) {\r\n\t\t\t\t\toModel.setProperty(sPath + \"/Meins\", item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tvar sProperty = oSelectedInput.getBindingInfo(\"value\").parts[0].path;\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/\" + sProperty, item);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t// silently ignore\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(this.selectedField, oCtx);\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnBomValidation({\r\n\t\t\t\tgetSource: function() {\r\n\t\t\t\t\treturn oSelectedInput;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) return;\r\n\t\t\tvar aFilters = [];\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\tfnCheckBoxLiveChange: function(oEvent) {\r\n\t\t\tvar oCheckBox = oEvent.getSource();\r\n\t\t\tvar oCtx = oCheckBox.getBindingContext(\"JM_BOMTable\");\r\n\t\t\toCheckBox.setValueState(\"None\");\r\n\r\n\t\t\t// Create a fake event object similar to Input liveChange\r\n\t\t\tvar oFakeEvent = {\r\n\t\t\t\tgetSource: function() {\r\n\t\t\t\t\treturn oCheckBox;\r\n\t\t\t\t},\r\n\t\t\t\tgetParameter: function() {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue: oCheckBox.getSelected() ? \"X\" : \"\"\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tgetBindingContext: function() {\r\n\t\t\t\t\treturn oCtx;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.checkboxFlag = true;\r\n\t\t\tthis.fnLiveChange(oFakeEvent);\r\n\t\t},\r\n\r\n\t\tfnLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar fieldId = oInput.getId();\r\n\t\t\tvar vId = fieldId.split(\"--\").pop();\r\n\t\t\tvar shortId = vId.split(\"-\")[0];\r\n\r\n\t\t\tvar vValue = \"\";\r\n\t\t\tif (typeof oInput.getValue === \"function\") {\r\n\t\t\t\tvValue = oInput.getValue();\r\n\t\t\t\tif (shortId !== \"ID_BOM_ZTEXT\" && shortId !== \"ID_BOM_STKTX\") {\r\n\t\t\t\t\tvValue = vValue.toUpperCase();\r\n\t\t\t\t}\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t} else if (typeof oInput.getSelectedKey === \"function\") {\r\n\t\t\t\tvValue = oInput.getSelectedKey().toUpperCase();\r\n\t\t\t} else if (typeof oInput.getSelected === \"function\") {\r\n\t\t\t\tvValue = oInput.getSelected() ? \"X\" : \"\";\r\n\t\t\t} else {\r\n\t\t\t\tvValue = \"\";\r\n\t\t\t}\r\n\t\t\tvar oCtx = oInput.getBindingContext(\"JM_BOMTable\");\r\n\r\n\t\t\t// Field length validation\r\n\t\t\tvar oFieldLengthMap = {\r\n\t\t\t\t\"ID_BOM_ZTEXT\": 40,\r\n\t\t\t\t\"ID_BOM_STKTX\": 40,\r\n\t\t\t\t\"ID_BOM_BMENG\": 13,\r\n\t\t\t\t\"ID_BOM_LOSVN\": 13,\r\n\t\t\t\t\"ID_BOM_LOSBS\": 13,\r\n\t\t\t\t\"ID_BOM_MEINS\": 3,\r\n\t\t\t\t\"ID_BOM_STLST\": 2,\r\n\t\t\t\t\"ID_BOM_EXSTL\": 4,\r\n\t\t\t\t\"ID_BOM_LABOR\": 3,\r\n\t\t\t\t\"ID_BOM_GROES\": 32,\r\n\t\t\t\t\"ID_BOM_AVOAU\": 3,\r\n\t\t\t\t\"ID_BOM_AUSCH\": 3,\r\n\t\t\t\t\"ID_BOM_RFPNT\": 20,\r\n\t\t\t\t\"ID_BOM_NLFZT\": 3,\r\n\t\t\t\t\"ID_BOM_NLFZV\": 3,\r\n\t\t\t\t\"ID_BOM_NLFMV\": 3,\r\n\t\t\t\t\"ID_BOM_VERTI\": 4,\r\n\t\t\t\t\"ID_BOM_DSPST\": 2,\r\n\t\t\t\t\"ID_BOM_ITSOB\": 2,\r\n\t\t\t\t\"ID_BOM_POTX1\": 40,\r\n\t\t\t\t\"ID_BOM_POTX2\": 40,\r\n\t\t\t\t\"ID_BOM_LGORT\": 4,\r\n\t\t\t\t\"ID_BOM_PRVBE\": 10,\r\n\t\t\t\t\"ID_BOM_IDNRK\": 40,\r\n\t\t\t\t\"ID_BOM_POSTP\": 1,\r\n\t\t\t\t\"ID_BOM_POSNR\": 4,\r\n\t\t\t\t\"ID_BOM_MENGE\": 13,\r\n\t\t\t\t\"ID_BOM_AENNR\": 12,\r\n\t\t\t\t\"ID_BOM_SORTF\": 10,\r\n\t\t\t\t\"ID_BOM_IDENT\": 8,\r\n\t\t\t\t\"ID_BOM_AENRA\": 12,\r\n\t\t\t\t\"ID_BOM_ALPGR\": 2,\r\n\t\t\t\t\"ID_BOM_SGT_CATV\": 40,\r\n\t\t\t\t\"ID_BOM_ERSKZ\": 1,\r\n\t\t\t\t\"ID_BOM_STLBE\": 1\r\n\t\t\t};\r\n\r\n\t\t\tif (oFieldLengthMap[shortId] && vValue.length > oFieldLengthMap[shortId]) {\r\n\t\t\t\tvar iMax = oFieldLengthMap[shortId];\r\n\t\t\t\toInput.setValue(vValue.substring(0, iMax));\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t}\r\n\r\n\t\t\t// Clear description field if exists\r\n\t\t\tvar descriptionField = this.getView().byId(shortId + \"_DES\") || Fragment.byId(\"ID_ITEMLEVEL\", shortId + \"_DES\");\r\n\t\t\tif (descriptionField) {\r\n\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t}\r\n\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tthat.fnBomValidation({\r\n\t\t\t\tgetSource: function() {\r\n\t\t\t\t\treturn oInput;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (oCtx) {\r\n\t\t\t\tvar oModel = oCtx.getModel();\r\n\t\t\t\tvar sPath = oCtx.getPath();\r\n\t\t\t\tvar F4Input = Fragment.byId(\"ID_ITEMLEVEL\", shortId);\r\n\t\t\t\tvar fnMatchHandler = function(match) {\r\n\t\t\t\t\tif (shortId.indexOf(\"ID_BOM_IDNRK\") !== -1) {\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Ktext\", match ? (match.Value2 || \"\") : \"\");\r\n\t\t\t\t\t\tvar vKtext = oModel.getProperty(sPath + \"/Ktext\");\r\n\r\n\t\t\t\t\t\tif (!vKtext) {\r\n\t\t\t\t\t\t\t// Clear Meins\r\n\t\t\t\t\t\t\tvar oData = oModel.getProperty(sPath);\r\n\t\t\t\t\t\t\tif (oData && typeof oData === \"object\") {\r\n\t\t\t\t\t\t\t\tvar aSkipFields = [\"Datub\", \"Datuv\", \"Posnr\", \"Postp\", \"Idnrk\"];\r\n\r\n\t\t\t\t\t\t\t\tvar oNewData = Object.assign({}, oData);\r\n\r\n\t\t\t\t\t\t\t\tObject.keys(oNewData).forEach(function(key) {\r\n\t\t\t\t\t\t\t\t\t// Skip metadata and excluded fields\r\n\t\t\t\t\t\t\t\t\tif (key === \"__metadata\" || aSkipFields.includes(key)) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvar value = oNewData[key];\r\n\r\n\t\t\t\t\t\t\t\t\tif ([\"IDNRK\", \"MENGE\", \"MEINS\", \"POSTP\"].includes(key)) {\r\n\t\t\t\t\t\t\t\t\t\toNewData[key] = \"None\"; // Reset ValueState correctly\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (typeof value === \"boolean\") {\r\n\t\t\t\t\t\t\t\t\t\toNewData[key] = null;\r\n\t\t\t\t\t\t\t\t\t} else if (typeof value === \"string\") {\r\n\t\t\t\t\t\t\t\t\t\toNewData[key] = \"\";\r\n\t\t\t\t\t\t\t\t\t} else if (typeof value === \"number\") {\r\n\t\t\t\t\t\t\t\t\t\toNewData[key] = \"\";\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\toModel.setProperty(sPath, oNewData);\r\n\t\t\t\t\t\t\t\toModel.refresh(true);\r\n\r\n\t\t\t\t\t\t\t\tvar oDescModel = that.getView().getModel(\"JM_LocalDescriptionModel\");\r\n\t\t\t\t\t\t\t\tvar oDescData = oDescModel.getData();\r\n\t\t\t\t\t\t\t\tvar sPosnr = oNewData.Posnr;\r\n\t\t\t\t\t\t\t\tvar aRows = oDescData[sPosnr];\r\n\r\n\t\t\t\t\t\t\t\tif (Array.isArray(aRows)) {\r\n\t\t\t\t\t\t\t\t\tvar aNewDataKeys = Object.keys(oNewData).map(function(k) {\r\n\t\t\t\t\t\t\t\t\t\treturn k.toLowerCase();\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\tvar aFiltered = aRows.filter(function(oRow) {\r\n\t\t\t\t\t\t\t\t\t\tvar sField = oRow.FieldName ? oRow.FieldName.toLowerCase() : \"\";\r\n\t\t\t\t\t\t\t\t\t\treturn !aNewDataKeys.includes(sField);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\toDescData[sPosnr] = aFiltered;\r\n\r\n\t\t\t\t\t\t\t\t\toDescModel.setData(oDescData);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (F4Input instanceof sap.m.Input && F4Input.getShowValueHelp()) {\r\n\t\t\t\t\tthis.fnReadf4Cache(shortId, vValue, \"P\", fnMatchHandler, oCtx);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar oCtrl = this.getView().byId(shortId);\r\n\t\t\t\t\tif (oCtrl instanceof sap.m.Input && oCtrl.getShowValueHelp()) {\r\n\t\t\t\t\t\tthis.fnReadf4Cache(shortId, vValue, \"P\", fnMatchHandler, oCtx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar oCtrl = this.getView().byId(shortId);\r\n\t\t\t\tif (oCtrl instanceof sap.m.Input && oCtrl.getShowValueHelp()) {\r\n\t\t\t\t\tthis.fnReadf4Cache(shortId, vValue, \"P\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(shortId, oCtx);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnReadf4Cache: function(vId, vValue, f4type, callback, oCtx) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar match;\r\n\r\n\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\tif ((f4type !== \"P\" || !results || results.length === 0) && vValue) return;\r\n\t\t\t\tvar foundMatch = null;\r\n\t\t\t\tvar cleanValue = String(vValue).toUpperCase().replace(/^0+/, \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(/^0+/, \"\");\r\n\r\n\t\t\t\tfoundMatch = results.find(function(item) {\r\n\t\t\t\t\tvar val1 = item.Value1.replace(/^0+/, \"\");\r\n\t\t\t\t\treturn val1 === cleanValue;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar descField = that.getView().byId(vId + \"_DES\");\r\n\t\t\t\tvar Desc = vId + \"_DES\";\r\n\t\t\t\tvar FrgDecs = Fragment.byId(\"ID_ITEMLEVEL\", Desc);\r\n\t\t\t\tif (FrgDecs) {\r\n\t\t\t\t\tFrgDecs.setValue(foundMatch ? foundMatch.Value2 : \"\");\r\n\t\t\t\t}\r\n\t\t\t\tvar field = that.getView().byId(vId) || Fragment.byId(\"ID_ITEMLEVEL\", vId);\r\n\r\n\t\t\t\t// Set description if field exists\r\n\t\t\t\tif (descField) {\r\n\t\t\t\t\tdescField.setValue(foundMatch ? foundMatch.Value2 : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar sKey = vId.replace(\"ID_BOM_\", \"\");\r\n\r\n\t\t\t\tvar oModel = that.getView().getModel(\"JM_LocalDescriptionModel\");\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\tvar oData = oModel.getData();\r\n\r\n\t\t\t\t\tif (!oData[sKey]) {\r\n\t\t\t\t\t\toData[sKey] = {\r\n\t\t\t\t\t\t\tvalue: \"\",\r\n\t\t\t\t\t\t\tdesc: \"\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\toData[sKey].value = vValue || \"\";\r\n\t\t\t\t\toData[sKey].desc = foundMatch ? foundMatch.Value2 : \"\";\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (vValue === \"\" || foundMatch) {\r\n\t\t\t\t\tfield.setValueState(\"None\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfield.setValueState(\"Error\");\r\n\t\t\t\t\tfield.setValueStateText(vValue + \" value is not Avalible\");\r\n\t\t\t\t\tif (oCtx) {\r\n\t\t\t\t\t\tvar oModel = oCtx.getModel();\r\n\t\t\t\t\t\tvar sPath = oCtx.getPath();\r\n\t\t\t\t\t\tif (vId === \"ID_BOM_MEINS\") {\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/MEINS\", \"Error\");\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/MEINS_TXT\", vValue + \" value is not Avalible\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (vId === \"ID_BOM_IDNRK\") {\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/IDNRK\", \"Error\");\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/IDNRK_TXT\", vValue + \" value is not Avalible\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (vId === \"ID_BOM_POSTP\") {\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/POSTP\", \"Error\");\r\n\t\t\t\t\t\t\toModel.setProperty(sPath + \"/POSTP_TXT\", vValue + \" value is not Avalible\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback && typeof callback === \"function\") {\r\n\t\t\t\t\tcallback(foundMatch);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tf4descriptionGet: function(vId, value, f4type, fnCallback) {\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar KeyModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tif (KeyModel) {\r\n\t\t\t\tvar Werks = KeyModel.getProperty(\"/Werks\");\r\n\t\t\t}\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: vId,\r\n\t\t\t\tProcess: \"X\",\r\n\t\t\t\tF4Type: f4type\r\n\t\t\t};\r\n\r\n\t\t\tif ([\"ID_BOM_LGORT\", \"ID_BOM_PRVBE\", \"ID_BOM_VERTI\", \"ID_BOM_ITSOB\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t}\r\n\r\n\t\t\tif (vId === \"ID_BOM_IDNRK\") {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t}\r\n\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthat.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnNavBack: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: \"Information\",\r\n\t\t\t\ttext: \"Do you Want to exit this Process? once exit all data will be Refreshed\",\r\n\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"BOM_BACK\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnSaveBack: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tthis.saveBack = true;\r\n\t\t\tthis.fnBomValidation(null, function() {\r\n\t\t\t\tvar oBOMPayload = that.fnSaveBomModels();\r\n\t\t\t\tvar oBomModel = that.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\t\toBomModel.setData(oBOMPayload);\r\n\t\t\t\toBomModel.refresh(true);\r\n\t\t\t\tthat.fnclearLocalModel();\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(that).navTo(\"pv_detail\");\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnBomValidation: function(oEvent, fnSuccessCallback) {\r\n\t\t\tthis.NoError = false;\r\n\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oPayload = this.fnPreparePayload();\r\n\r\n\t\t\t// Header fields\r\n\t\t\tvar oBomStatusField = this.byId(\"ID_BOM_STLST\");\r\n\t\t\tvar oBaseQtyField = this.byId(\"ID_BOM_BMENG\");\r\n\r\n\t\t\t[oBomStatusField, oBaseQtyField].forEach(function(f) {\r\n\t\t\t\tf.setValueState(\"None\");\r\n\t\t\t});\r\n\r\n\t\t\t// coproduct front end validation When save only it trigger\r\n\r\n\t\t\tif (this.saveBack) {\r\n\t\t\t\tvar oTable = this.getView().byId(\"id_bomTable\");\r\n\t\t\t\tvar oTableModel = oTable.getModel(\"JM_BOMTable\");\r\n\t\t\t\tvar aTableData = oTableModel.getProperty(\"/BOMList\");\r\n\t\t\t\tfor (var i = 0; i < aTableData.length; i++) {\r\n\t\t\t\t\tvar item = aTableData[i];\r\n\t\t\t\t\tif (item.Idnrk !== \"\" && item.key === \"\") {\r\n\t\t\t\t\t\tthis.getView().getModel(\"JM_BOMTable\").setProperty(\"/BOMList/\" + i + \"/KZKUP\", \"Error\");\r\n\t\t\t\t\t\tthis.getView().getModel(\"JM_BOMTable\").setProperty(\"/BOMList/\" + i + \"/KZKUP_TXT\", \"please select co - product\" + \" - \" + item.Posnr);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(\"please select co - product\" + \" - \" + item.Posnr, \"Error\", this);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.saveBack = false;\r\n\t\t\t}\r\n\t\t\t// OData Create\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel();\r\n\t\t\toModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar aErrorMsgs = oData.NavReturn_Msg.results.filter(function(e) {\r\n\t\t\t\t\t\treturn e.MsgType === \"E\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// ********************************************\r\n\t\t\t\t\tif (oEvent) {\r\n\t\t\t\t\t\tthat.fnSubmitComponent(oEvent);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// ********************************************\r\n\r\n\t\t\t\t\tif (aErrorMsgs.length === 0) {\r\n\t\t\t\t\t\tthat.NoError = true;\r\n\t\t\t\t\t\tthat.fnResetInputStates();\r\n\t\t\t\t\t\tif (typeof fnSuccessCallback === \"function\") {\r\n\t\t\t\t\t\t\tfnSuccessCallback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Table rows\r\n\t\t\t\t\tthat.NoError = false;\r\n\t\t\t\t\tvar oTable = that.byId(\"id_bomTable\");\r\n\t\t\t\t\tvar aRows = oTable ? oTable.getRows() : [];\r\n\t\t\t\t\tvar oTableModel = oTable.getModel(\"JM_BOMTable\");\r\n\t\t\t\t\taErrorMsgs.forEach(function(item) {\r\n\t\t\t\t\t\tif (item.ItemNo) {\r\n\t\t\t\t\t\t\t// Table-row level errors\r\n\t\t\t\t\t\t\tvar sErrorItemNo = item.ItemNo.slice(-4);\r\n\r\n\t\t\t\t\t\t\tfor (var i = 0; i < aRows.length; i++) {\r\n\t\t\t\t\t\t\t\tvar oCtx = aRows[i].getBindingContext(\"JM_BOMTable\");\r\n\t\t\t\t\t\t\t\tif (!oCtx) continue;\r\n\t\t\t\t\t\t\t\tvar oRowData = oCtx.getObject();\r\n\r\n\t\t\t\t\t\t\t\tif (oRowData.Posnr === sErrorItemNo) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar sField = item.Fnm ? item.Fnm.toUpperCase() : \"\";\r\n\t\t\t\t\t\t\t\t\tif (!sField) continue;\r\n\r\n\t\t\t\t\t\t\t\t\toTableModel.setProperty(oCtx.getPath() + \"/\" + sField, \"Error\");\r\n\t\t\t\t\t\t\t\t\toTableModel.setProperty(oCtx.getPath() + \"/\" + sField + \"_TXT\", item.Message);\r\n\r\n\t\t\t\t\t\t\t\t\tvar oInput = that.fngetTableCellInput(aRows[i], item.Fnm);\r\n\t\t\t\t\t\t\t\t\tif (oInput) {\r\n\t\t\t\t\t\t\t\t\t\t// oInput.focus();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tvar oTable = that.byId(\"id_bomTable\");\r\n\t\t\t\t\t\t\t\t\t\tvar iRowCount = oTable.getBinding(\"rows\").getLength();\r\n\r\n\t\t\t\t\t\t\t\t\t\t// oTable.clearSelection(); \r\n\t\t\t\t\t\t\t\t\t\toTable.addSelectionInterval(0, iRowCount - 1);\r\n\t\t\t\t\t\t\t\t\t\tthat.fnItemDetails({\r\n\t\t\t\t\t\t\t\t\t\t\tgetSource: function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn aRows[i];\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tvar sId = \"ID_BOM_\" + item.Fnm;\r\n\t\t\t\t\t\t\t\t\t\tvar oFragInput = Fragment.byId(\"ID_ITEMLEVEL\", sId);\r\n\t\t\t\t\t\t\t\t\t\tif (oFragInput) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (oFragInput instanceof sap.m.CheckBox) {\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.removeStyleClass(\"cl_opr_checkbx\");\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.addStyleClass(\"cl_checkboxError\");\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.setTooltip(item.Message);\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\t\t\t\t\toFragInput.setValueStateText(item.Message);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Normal header input\r\n\t\t\t\t\t\t\tthat.fnmarkErrorOnField(item.Fnm, item.Message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\terror: function() {\r\n\t\t\t\t\tthat.NoError = false;\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"ErrorSavingBom\"), \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnSubmitComponent: function(oEvent) {\r\n\t\t\tif (oEvent) {\r\n\t\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\t\tif (oInput && typeof oInput.getValue === \"function\") {\r\n\t\t\t\t\tvar InputId = oInput.getId().split(\"--\")[1].split(\"-\")[0];\r\n\t\t\t\t\tif (InputId === \"ID_BOM_IDNRK\") {\r\n\t\t\t\t\t\tvar Matnr = oInput.getValue();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif (Matnr) {\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\t\"AppId\": \"BC\",\r\n\t\t\t\t\t\"Matnr\": Matnr,\r\n\t\t\t\t\t\"Werks\": this.getView().byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\t\"Ind\": \"B\",\r\n\t\t\t\t\t\"MsgTyp\": \"U\",\r\n\t\t\t\t\t\"NavBomHeader\": [],\r\n\t\t\t\t\t\"NavBomItem\": []\r\n\t\t\t\t};\r\n\t\t\t\tvar aOdataModel = this.getOwnerComponent().getModel();\r\n\t\t\t\tvar that = this;\r\n\t\t\t\taOdataModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tif (oData.NavBomItem && oData.NavBomItem.results && oData.NavBomItem.results.length !== 0) {\r\n\t\t\t\t\t\t\tif (oInput && typeof oInput.getValue === \"function\") {\r\n\t\t\t\t\t\t\t\tif (oInput.getValue() === \"\") {\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar oTable = that.getView().byId(\"id_bomTable\");\r\n\t\t\t\t\t\t\tvar aRows = oTable.getRows();\r\n\t\t\t\t\t\t\tvar oMengeInput = null;\r\n\t\t\t\t\t\t\tvar oUOM = null;\r\n\t\t\t\t\t\t\tvar oAsm = null;\r\n\t\t\t\t\t\t\tvar oModel = oTable.getModel(\"JM_BOMTable\");\r\n\t\t\t\t\t\t\tvar oCtx = oInput.getBindingContext(\"JM_BOMTable\");\r\n\t\t\t\t\t\t\tif (!oCtx) return;\r\n\r\n\t\t\t\t\t\t\tfor (var i = 0; i < aRows.length; i++) {\r\n\t\t\t\t\t\t\t\tvar oRowCtx = aRows[i].getBindingContext(\"JM_BOMTable\");\r\n\t\t\t\t\t\t\t\tif (oRowCtx && oRowCtx.getPath() === oCtx.getPath()) {\r\n\t\t\t\t\t\t\t\t\toMengeInput = aRows[i].getCells()[4];\r\n\t\t\t\t\t\t\t\t\toUOM = aRows[i].getCells()[5];\r\n\t\t\t\t\t\t\t\t\toAsm = aRows[i].getCells()[6];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (oUOM) {\r\n\t\t\t\t\t\t\t\tvar oInputInsideVBox = oUOM.getItems()[0]; // VBox -> Input\r\n\t\t\t\t\t\t\t\tif (oInputInsideVBox) {\r\n\t\t\t\t\t\t\t\t\toInputInsideVBox.setValue(oData.NavBomItem.results[0].Meins);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (oAsm) {\r\n\t\t\t\t\t\t\t\tvar oInputInsideVBox = oAsm.getItems()[0]; // VBox -> CheckBox\r\n\t\t\t\t\t\t\t\tif (oInputInsideVBox) {\r\n\t\t\t\t\t\t\t\t\tif (oData.NavBomItem.results[0].Stlkz === 'X') {\r\n\t\t\t\t\t\t\t\t\t\toInputInsideVBox.setSelected(true);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\toInputInsideVBox.setSelected(false);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (that.getView().byId(\"ID_BOM_STLAN\").getValue() === \"1\") {\r\n\t\t\t\t\t\t\t\toModel.getProperty(oCtx.getPath()).Sanfe = true;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toModel.getProperty(oCtx.getPath()).Sanfe = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(oError) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"HTTPReqFailedError\"), \"Error\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfngetComponent: function() {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar aMatnr = this.getView().byId(\"ID_BOM_MATNR\");\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\t\"AppId\": \"BC\",\r\n\t\t\t\t\t\"Matnr\": this.getView().byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\t\"Maktx\": this.getView().byId(\"ID_BOM_MAKTX\").getValue(),\r\n\t\t\t\t\t\"Werks\": this.getView().byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\t\"Ind\": \"B\",\r\n\t\t\t\t\t\"MsgTyp\": \"U\",\r\n\t\t\t\t\t\"NavBomHeader\": [],\r\n\t\t\t\t\t\"NavBomItem\": []\r\n\t\t\t\t};\r\n\t\t\t\tvar aOdataModel = this.getOwnerComponent().getModel();\r\n\t\t\t\tvar that = this;\r\n\t\t\t\taOdataModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tif (aMatnr.getValue() === \"\") {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar oBOMModel = that.getView().getModel(\"JM_BOMModel\");\r\n\t\t\t\t\t\tif (oBOMModel && oData.NavBomItem.results.length > 0) {\r\n\t\t\t\t\t\t\tvar baseQty = oData.NavBomItem.results[0].Meins;\r\n\t\t\t\t\t\t\toBOMModel.setProperty(\"/Bmein\", baseQty);\r\n\t\t\t\t\t\t\toBOMModel.setProperty(\"/Losme\", baseQty); // there no value from backend so set the same unit for lot size\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(oError) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"HTTPReqFailedError\"), \"Error\", that);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\r\n\t\t},\r\n\r\n\t\tfngetTableCellInput: function(oRow, sFnm) {\r\n\t\t\tvar columnMapping = {\r\n\t\t\t\t\"POSNR\": 0, // Item (Link)\r\n\t\t\t\t\"POSTP\": 1, // ICt\r\n\t\t\t\t\"IDNRK\": 2, // Component\r\n\t\t\t\t\"KTEXT\": 3, // Component Desc\r\n\t\t\t\t\"MENGE\": 4, // Quantity\r\n\t\t\t\t\"MEINS\": 5, // UOM\r\n\t\t\t\t\"STLKZ\": 6, // Assembly indicator\r\n\t\t\t\t\"UPSKZ\": 7, // Sub-item indicator\r\n\t\t\t\t\"DATUV\": 8, // Valid From\r\n\t\t\t\t\"DATUB\": 9, // Valid To\r\n\t\t\t\t// \"AENNR\": 10, // Change No.\r\n\t\t\t\t// \"DUMPS\": 11, // Phantom Item\r\n\t\t\t\t\"SORTF\": 12, // Sort String\r\n\t\t\t\t\"LGORT\": 13,\r\n\t\t\t\t\"KZKUP\": 14,\r\n\t\t\t\t\"IDENT\": 15, // Item ID\r\n\t\t\t\t\"AENRA\": 16, // Change No.To\r\n\t\t\t\t// \"ALPGR\": 15, // Group\r\n\t\t\t\t// \"FMENG\": 16, // Fixed Quantity\r\n\t\t\t\t\"LTXPO\": 19, // Long Text\r\n\t\t\t\t\"SGTCMKZ\": 20, // Segmented Maintained\r\n\t\t\t\t\"SGTCATV\": 21, // Seg Value\r\n\t\t\t\t\"OBTSP\": 22 // Object Type\r\n\t\t\t};\r\n\t\t\tvar iIndex = columnMapping[sFnm];\r\n\t\t\tif (iIndex === undefined) return null;\r\n\r\n\t\t\tvar oCell = oRow.getCells()[iIndex];\r\n\t\t\tif (oCell instanceof sap.m.Input) return oCell;\r\n\r\n\t\t\tif (oCell.getItems) {\r\n\t\t\t\tvar aItems = oCell.getItems();\r\n\t\t\t\tfor (var i = 0; i < aItems.length; i++) {\r\n\t\t\t\t\tif (aItems[i] instanceof sap.m.Input) return aItems[i];\r\n\t\t\t\t\tif (aItems[i] instanceof sap.m.Select) {\r\n\t\t\t\t\t\treturn aItems[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tfnmarkErrorOnField: function(sFnm, sMessage) {\r\n\t\t\tvar sId = \"ID_BOM_\" + sFnm;\r\n\t\t\tvar oCtrl = this.byId(sId);\r\n\r\n\t\t\tif (!oCtrl) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\toCtrl = Fragment.byId(\"ID_ITEMLEVEL\", sId);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\toCtrl = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (oCtrl) {\r\n\t\t\t\tif (oCtrl instanceof sap.m.CheckBox) {\r\n\t\t\t\t\tthis.fnSetCheckBoxError(oCtrl, sMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toCtrl.setValueState(\"Error\");\r\n\t\t\t\toCtrl.setValueStateText(sMessage);\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t// oCtrl.focus();\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSetCheckBoxError: function(oCheckBox, sMessage) {\r\n\t\t\tif (oCheckBox) {\r\n\t\t\t\toCheckBox.addStyleClass(\"cl_checkboxError\");\r\n\t\t\t\toCheckBox.setTooltip(sMessage);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnItemDetails: function(oEvent) {\r\n\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"PleaseSelectLineItem\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar aSelectedPaths = [];\r\n\t\t\tfor (var i = 0; i < aSelectedIndices.length; i++) {\r\n\t\t\t\tvar oContext = oTable.getContextByIndex(aSelectedIndices[i]);\r\n\t\t\t\tif (oContext) {\r\n\t\t\t\t\taSelectedPaths.push(oContext.getPath());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._aSelectedPaths = aSelectedPaths;\r\n\r\n\t\t\tvar oRowContext = oEvent.getSource().getBindingContext(\"JM_BOMTable\");\r\n\t\t\tvar sClickedPath = oRowContext.getPath();\r\n\t\t\tvar iClickedRowIndex = sClickedPath.split(\"/\")[2];\r\n\r\n\t\t\tvar iSelectedIndex = -1;\r\n\t\t\tfor (var i = 0; i < this._aSelectedPaths.length; i++) {\r\n\t\t\t\tvar sPath = this._aSelectedPaths[i];\r\n\t\t\t\tif (sPath === oTable.getContextByIndex(iClickedRowIndex).getPath()) {\r\n\t\t\t\t\tiSelectedIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (iSelectedIndex === -1) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"PleaseClickSelectedItem\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._iCurrentIndex = iSelectedIndex;\r\n\r\n\t\t\t// --- Fragment binding ---\r\n\t\t\tif (!this.clrAllfrag) {\r\n\t\t\t\tthis.clrAllfrag = sap.ui.xmlfragment(\"ID_ITEMLEVEL\", \"MANAGED_RECIPE.Fragment.Itemlevel\", this);\r\n\t\t\t\tthis.getView().addDependent(this.clrAllfrag);\r\n\t\t\t}\r\n\r\n\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\tvar oUwlData = oFromUwl.getData();\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tvar sPath = this._aSelectedPaths[this._iCurrentIndex];\r\n\t\t\tthis.clrAllfrag.setBindingContext(oModel.createBindingContext(sPath), \"JM_BOMTable\");\r\n\r\n\t\t\tvar oData = oModel.getProperty(sPath);\r\n\t\t\tFragment.byId(\"ID_ITEMLEVEL\", \"id_itemNumber\")\r\n\t\t\t\t.setText(\"Item Number : \" + oData.Posnr + \" Component : \" + oData.Idnrk + \" - \" + oData.Ktext);\r\n\r\n\t\t\tvar sPosnr = oData.Posnr;\r\n\r\n\t\t\tvar oDescModel = this.getView().getModel(\"JM_LocalDescriptionModel\");\r\n\t\t\tvar oBomModel = this.getView().getModel(\"JM_BOMTable\");\r\n\r\n\t\t\tif (oDescModel && oBomModel) {\r\n\t\t\t\tvar oDescData = oDescModel.getData();\r\n\t\t\t\tvar oBomData = oBomModel.getData();\r\n\r\n\t\t\t\tif (oDescData[sPosnr] && Array.isArray(oDescData[sPosnr])) {\r\n\t\t\t\t\tvar aFields = oDescData[sPosnr];\r\n\t\t\t\t\tvar aBomList = oBomData.BOMList;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < aBomList.length; i++) {\r\n\t\t\t\t\t\tif (aBomList[i].Posnr === sPosnr) {\r\n\r\n\t\t\t\t\t\t\tfor (var j = 0; j < aFields.length; j++) {\r\n\t\t\t\t\t\t\t\tvar oField = aFields[j];\r\n\t\t\t\t\t\t\t\tvar sNewField = oField.FieldName.charAt(0).toUpperCase() +\r\n\t\t\t\t\t\t\t\t\toField.FieldName.slice(1).toLowerCase() + \"Des\";\r\n\t\t\t\t\t\t\t\taBomList[i][sNewField] = oField.desc;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\toBomModel.setData(oBomData);\r\n\t\t\t\t\toBomModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.AppId === \"RX\" && oUwlData.Appid === \"RX\") {\r\n\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tvar aChangeLogData = oChangeLogModel ? oChangeLogModel.getData() : [];\r\n\r\n\t\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0) {\r\n\r\n\t\t\t\t\tvar aChangedItems = aChangeLogData.filter(function(oItem) {\r\n\t\t\t\t\t\treturn oItem.ProcessInd === \"B\" && oItem.ItemNo === sPosnr;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\taChangedItems.forEach(function(oItem) {\r\n\t\t\t\t\t\tvar sFieldId = oItem.FieldId;\r\n\t\t\t\t\t\tif (sFieldId) {\r\n\t\t\t\t\t\t\tvar oControl = that.getView().byId(sFieldId) || sap.ui.core.Fragment.byId(\"ID_ITEMLEVEL\", sFieldId);\r\n\t\t\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\t\t\toControl.addStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.clrAllfrag.open();\r\n\t\t},\r\n\r\n\t\tfnItemSubmit: function() {\r\n\t\t\tvar oView = this.getView();\r\n\r\n\t\t\tvar vErrorState = this.fnCheckErrorState();\r\n\r\n\t\t\tif (!vErrorState) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"CorrectHighLightedFieldsError\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oDescModel = oView.getModel(\"JM_LocalDescriptionModel\");\r\n\t\t\tvar oBomModel = oView.getModel(\"JM_BOMTable\");\r\n\r\n\t\t\t// Create Description model if not existing\r\n\t\t\tif (!oDescModel) {\r\n\t\t\t\toDescModel = new sap.ui.model.json.JSONModel({});\r\n\t\t\t\toView.setModel(oDescModel, \"JM_LocalDescriptionModel\");\r\n\t\t\t}\r\n\r\n\t\t\tif (oBomModel) {\r\n\t\t\t\tvar oBomData = oBomModel.getData();\r\n\t\t\t\tvar aBomList = oBomData.BOMList;\r\n\r\n\t\t\t\tif (Array.isArray(aBomList)) {\r\n\t\t\t\t\t// Existing data from model\r\n\t\t\t\t\tvar oExistingDescData = oDescModel.getData() || {};\r\n\t\t\t\t\tvar oNewDescData = {};\r\n\r\n\t\t\t\t\t// --- Build new data based on BOM items ---\r\n\t\t\t\t\tfor (var i = 0; i < aBomList.length; i++) {\r\n\t\t\t\t\t\tvar oItem = aBomList[i];\r\n\t\t\t\t\t\tvar sPosnr = oItem.Posnr;\r\n\r\n\t\t\t\t\t\t// Preserve existing entry for that item\r\n\t\t\t\t\t\toNewDescData[sPosnr] = oExistingDescData[sPosnr] ? oExistingDescData[sPosnr].slice() : [];\r\n\r\n\t\t\t\t\t\t// Extract all *Des fields\r\n\t\t\t\t\t\tfor (var sField in oItem) {\r\n\t\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(oItem, sField) && sField.endsWith(\"Des\")) {\r\n\t\t\t\t\t\t\t\tvar sBaseField = sField.slice(0, -3);\r\n\t\t\t\t\t\t\t\tvar sFieldName = sBaseField.toUpperCase();\r\n\t\t\t\t\t\t\t\tvar sValue = oItem[sBaseField] || \"\";\r\n\t\t\t\t\t\t\t\tvar sDesc = oItem[sField] || \"\";\r\n\r\n\t\t\t\t\t\t\t\t// Avoid duplicates\r\n\t\t\t\t\t\t\t\tvar bExists = oNewDescData[sPosnr].some(function(obj) {\r\n\t\t\t\t\t\t\t\t\treturn obj.FieldName === sFieldName;\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tif (!bExists) {\r\n\t\t\t\t\t\t\t\t\toNewDescData[sPosnr].push({\r\n\t\t\t\t\t\t\t\t\t\tvalue: sValue,\r\n\t\t\t\t\t\t\t\t\t\tdesc: sDesc,\r\n\t\t\t\t\t\t\t\t\t\tFieldName: sFieldName\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var sKey in oExistingDescData) {\r\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(oExistingDescData, sKey)) {\r\n\t\t\t\t\t\t\tif (isNaN(Number(sKey))) {\r\n\t\t\t\t\t\t\t\toNewDescData[sKey] = oExistingDescData[sKey];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar oUpdatedDescModel = new sap.ui.model.json.JSONModel(oNewDescData);\r\n\t\t\t\t\toView.setModel(oUpdatedDescModel, \"JM_LocalDescriptionModel\");\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnItemFragClose();\r\n\t\t},\r\n\r\n\t\tfnItemFragClose: function() {\r\n\t\t\tif (this.clrAllfrag) {\r\n\t\t\t\tthis.clrAllfrag.close();\r\n\t\t\t\tthis.clrAllfrag.destroy();\r\n\t\t\t\tthis.clrAllfrag = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSaveBomModels: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oView = this.getView();\r\n\r\n\t\t\t// Description Save functionality \r\n\t\t\tvar oLocalDecsModel = this.getView().getModel(\"JM_LocalDescriptionModel\");\r\n\t\t\tif (oLocalDecsModel) {\r\n\t\t\t\tsap.ui.getCore().setModel(oLocalDecsModel, \"JM_DescriptionModel\");\r\n\t\t\t}\r\n\t\t\t// Eoc\r\n\r\n\t\t\tvar BomHeaderModel = this.getView().getModel(\"JM_BOMModel\");\r\n\t\t\tvar BomItemModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tif (BomHeaderModel || BomItemModel) {\r\n\t\t\t\tvar BOMData = BomItemModel.getProperty(\"/BOMList\");\r\n\t\t\t\tvar BOMHeaderData = BomHeaderModel.getData();\r\n\t\t\t\t[BOMHeaderData].forEach(function(oItem) {\r\n\t\t\t\t\t[\"Datuv\"].forEach(function(field) {\r\n\t\t\t\t\t\tvar value = oItem[field];\r\n\t\t\t\t\t\tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t\t\t\t\t\toItem[field] = new Date(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tvar oPayload = {};\r\n\t\t\t\toPayload.NavBomItem = [];\r\n\r\n\t\t\t\tvar oBmeng = BomHeaderModel.getProperty(\"/Bmeng\") || oView.byId(\"ID_BOM_BMENG\").getValue() || null;\r\n\t\t\t\tvar oLosvn = BomHeaderModel.getProperty(\"/Losvn\") || oView.byId(\"ID_BOM_LOSVN\").getValue() || null;\r\n\t\t\t\tvar oLosbs = BomHeaderModel.getProperty(\"/Losbs\") || oView.byId(\"ID_BOM_LOSBS\").getValue() || null;\r\n\r\n\t\t\t\toPayload.NavBomHeader = [{\r\n\t\t\t\t\tBmeng: that.fnToEdmDecimal(oBmeng, 13, 3) || null,\r\n\t\t\t\t\tZtext: BomHeaderModel.getProperty(\"/Ztext\") || oView.byId(\"ID_BOM_ZTEXT\").getValue() || \"\",\r\n\t\t\t\t\tBmein: BomHeaderModel.getProperty(\"/Bmein\") || oView.byId(\"ID_BOM_BMEIN\").getValue() || \"\",\r\n\t\t\t\t\tStktx: BomHeaderModel.getProperty(\"/Stktx\") || oView.byId(\"ID_BOM_STKTX\").getValue() || \"\",\r\n\t\t\t\t\tLosvn: that.fnToEdmDecimal(oLosvn, 13, 3) || null,\r\n\t\t\t\t\tLosbs: that.fnToEdmDecimal(oLosbs, 13, 3) || null,\r\n\t\t\t\t\tLosme: BomHeaderModel.getProperty(\"/Losme\") || oView.byId(\"ID_BOM_LOSME\").getValue() || \"\",\r\n\t\t\t\t\tStlst: BomHeaderModel.getProperty(\"/Stlst\") || oView.byId(\"ID_BOM_STLST\").getValue() || \"\",\r\n\t\t\t\t\tStlbe: BomHeaderModel.getProperty(\"/Stlbe\") || oView.byId(\"ID_BOM_STLBE\").getValue() || \"\",\r\n\t\t\t\t\tLabor: (function() {\r\n\t\t\t\t\t\tvar sLabor = BomHeaderModel.getProperty(\"/Labor\") || oView.byId(\"ID_BOM_LABOR\").getValue() || \"\";\r\n\t\t\t\t\t\tsLabor = sLabor.trim();\r\n\t\t\t\t\t\tif (sLabor !== \"\" && sLabor !== \"0\") {\r\n\t\t\t\t\t\t\tsLabor = sLabor.padStart(3, \"0\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn sLabor;\r\n\t\t\t\t\t})(),\r\n\t\t\t\t\tGroes: BomHeaderModel.getProperty(\"/Groes\") || oView.byId(\"ID_BOM_GROES\").getValue() || \"\",\r\n\t\t\t\t\tStlal: BomHeaderModel.getProperty(\"/Stlal\") || oView.byId(\"ID_BOM_STLAL\").getValue() || \"\",\r\n\t\t\t\t\tStlan: BomHeaderModel.getProperty(\"/Stlan\") || oView.byId(\"ID_BOM_STLAN\").getValue() || \"\",\r\n\t\t\t\t\tTetyp: BomHeaderModel.getProperty(\"/Tetyp\") || oView.byId(\"ID_BOM_TETYP\").getValue() || \"\",\r\n\t\t\t\t\tExstl: BomHeaderModel.getProperty(\"/Exstl\") || oView.byId(\"ID_BOM_EXSTL\").getValue() || \"\",\r\n\t\t\t\t\tDatuv: BomHeaderModel.getProperty(\"/Datuv\") || oView.byId(\"ID_BOM_ADATU\").getDateValue() || null\r\n\t\t\t\t}];\r\n\r\n\t\t\t\tBOMData.forEach(function(oItem) {\r\n\t\t\t\t\t[\"Andat\", \"Datub\", \"Datuv\", \"Aedat\"].forEach(function(field) {\r\n\t\t\t\t\t\tvar value = oItem[field];\r\n\t\t\t\t\t\tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t\t\t\t\t\toItem[field] = new Date(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\tBOMData.forEach(function(item) {\r\n\t\t\t\t\t// if (item.Postp !== \"\") {\r\n\t\t\t\t\toPayload.NavBomItem.push({\r\n\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\tPosnr: item.Posnr || \"\",\r\n\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\tKtext: item.Ktext || \"\",\r\n\t\t\t\t\t\tMenge: that.fnToEdmDecimal(item.Menge, 13, 3) || null,\r\n\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\tSanin: item.Sanin || null,\r\n\t\t\t\t\t\tUpskz: item.Upskz || null,\r\n\t\t\t\t\t\tDatuv: item.Datuv || null,\r\n\t\t\t\t\t\tDatub: item.Datub || null,\r\n\t\t\t\t\t\tAndat: item.Andat || null,\r\n\t\t\t\t\t\tAedat: item.Aedat || null,\r\n\t\t\t\t\t\tSortf: item.Sortf || \"\",\r\n\t\t\t\t\t\tIdent: item.Ident || \"\",\r\n\t\t\t\t\t\tAennr: item.Aennr || \"\",\r\n\t\t\t\t\t\tAenra: item.Aenra || \"\",\r\n\t\t\t\t\t\tAlpgr: item.Alpgr || \"\",\r\n\t\t\t\t\t\tSgtCatv: item.SgtCatv || \"\",\r\n\t\t\t\t\t\tRfpnt: item.Rfpnt || \"\",\r\n\t\t\t\t\t\tSanka: item.Sanka || \"\",\r\n\t\t\t\t\t\tAnnam: item.Annam || \"\",\r\n\t\t\t\t\t\tAenam: item.Aenam || \"\",\r\n\t\t\t\t\t\tFmeng: item.Fmeng || null,\r\n\t\t\t\t\t\tLtxpo: item.Ltxpo ? \"X\" : \"\",\r\n\t\t\t\t\t\tSgtCmkz: item.SgtCmkz ? \"X\" : \"\",\r\n\t\t\t\t\t\tStlkz: item.Stlkz ? \"X\" : \"\",\r\n\t\t\t\t\t\t// Cadpo: item.Cadpo || null,\r\n\t\t\t\t\t\t// Alekz: item.Alekz || null,\r\n\t\t\t\t\t\tSanko: item.Sanko || null,\r\n\t\t\t\t\t\tVerti: item.Verti || \"\",\r\n\t\t\t\t\t\tAvoau: that.fnToEdmDecimal(item.Avoau, 5, 2) || null,\r\n\t\t\t\t\t\tAusch: that.fnToEdmDecimal(item.Ausch, 5, 2) || null,\r\n\t\t\t\t\t\tNetau: item.Netau || null,\r\n\t\t\t\t\t\tRekrs: item.Rekrs || null,\r\n\t\t\t\t\t\tRekri: item.Rekri || null,\r\n\t\t\t\t\t\tKzkup: item.Kzkup || null,\r\n\t\t\t\t\t\tNlfzt: item.Nlfzt || null,\r\n\t\t\t\t\t\tNlfzv: item.Nlfzv || null,\r\n\t\t\t\t\t\tObtsp: item.Obtsp || \"\",\r\n\t\t\t\t\t\tNlfmv: item.Nlfmv || \"\",\r\n\t\t\t\t\t\tDspst: item.Dspst || \"\",\r\n\t\t\t\t\t\tItsob: item.Itsob || \"\",\r\n\t\t\t\t\t\tDumps: item.Dumps || null,\r\n\t\t\t\t\t\tPotx1: item.Potx1 || \"\",\r\n\t\t\t\t\t\tPotx2: item.Potx2 || \"\",\r\n\t\t\t\t\t\tErskz: item.Erskz || \"\",\r\n\t\t\t\t\t\tRvrel: item.Rvrel || \"\",\r\n\t\t\t\t\t\tSanfe: item.Sanfe || null,\r\n\t\t\t\t\t\tBeikz: item.Beikz || \"\",\r\n\t\t\t\t\t\tLgort: item.Lgort || \"\",\r\n\t\t\t\t\t\tPrvbe: item.Prvbe || \"\",\r\n\t\t\t\t\t\tSchgt: item.Schgt || null,\r\n\t\t\t\t\t\tSchkz: item.Schkz || null\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// }\r\n\t\t\t\t}.bind(this));\r\n\r\n\t\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\t\tvar aExisting = oModel.getProperty(\"/NavPV_MaterialCompData\") || [];\r\n\t\t\t\tvar aNew = oPayload.NavBomItem || [];\r\n\r\n\t\t\t\tvar aExistingValid = aExisting.filter(function(item) {\r\n\t\t\t\t\treturn item.Posnr && item.Posnr.trim() !== \"\";\r\n\t\t\t\t});\r\n\t\t\t\tif (aExistingValid.length > 0 && aNew.length > 0) {\r\n\r\n\t\t\t\t\tvar oNewMap = {};\r\n\t\t\t\t\taNew.forEach(function(item) {\r\n\t\t\t\t\t\tvar key = item.Idnrk + \"|\" + item.Posnr;\r\n\t\t\t\t\t\toNewMap[key] = item;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar aUpdated = aExistingValid.filter(function(item) {\r\n\t\t\t\t\t\tvar key = item.Idnrk + \"|\" + item.Posnr;\r\n\t\t\t\t\t\treturn oNewMap.hasOwnProperty(key);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\taNew.forEach(function(item) {\r\n\r\n\t\t\t\t\t\tvar key = item.Idnrk + \"|\" + item.Posnr;\r\n\r\n\t\t\t\t\t\tvar exists = aUpdated.some(function(existing) {\r\n\t\t\t\t\t\t\treturn (existing.Idnrk + \"|\" + existing.Posnr) === key;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (!exists) {\r\n\t\t\t\t\t\t\taUpdated.push({\r\n\t\t\t\t\t\t\t\tPosnr: item.Posnr || \"\",\r\n\t\t\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\t\t\tMenge: item.Menge || \"\",\r\n\t\t\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\t\t\tMaktx: item.Ktext || \"\",\r\n\t\t\t\t\t\t\t\tMatnr: that.getView().byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\taUpdated = aUpdated.filter(function(item) {\r\n\t\t\t\t\t\treturn item.Idnrk && item.Idnrk.trim() !== \"\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\toModel.setProperty(\"/NavPV_MaterialCompData\", aUpdated);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar aUpdated = [];\r\n\t\t\t\t\taNew.forEach(function(item) {\r\n\t\t\t\t\t\taUpdated.push({\r\n\t\t\t\t\t\t\tPosnr: item.Posnr || \"\",\r\n\t\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\t\tMenge: item.Menge || \"\",\r\n\t\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\t\tMaktx: item.Ktext || \"\",\r\n\t\t\t\t\t\t\tMatnr: that.getView().byId(\"ID_BOM_MATNR\").getValue()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\taUpdated = aUpdated.filter(function(item) {\r\n\t\t\t\t\t\treturn item.Idnrk && item.Idnrk.trim() !== \"\";\r\n\t\t\t\t\t});\r\n\t\t\t\t\toModel.setProperty(\"/NavPV_MaterialCompData\", aUpdated);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn oPayload;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnPreparePayload: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar that = this;\r\n\t\t\tvar BomHeaderModel = this.getView().getModel(\"JM_BOMModel\");\r\n\t\t\tvar BomItemModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tif (BomHeaderModel || BomItemModel) {\r\n\t\t\t\tvar aTableData = BomItemModel.getProperty(\"/BOMList\") || [];\r\n\t\t\t\t// Prepare BOM item data\r\n\t\t\t\tvar aFilteredTableData = aTableData.map(function(item) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tPostp: item.Postp || \"\",\r\n\t\t\t\t\t\tPosnr: item.Posnr || \"\",\r\n\t\t\t\t\t\tIdnrk: item.Idnrk || \"\",\r\n\t\t\t\t\t\tKtext: item.Ktext || \"\",\r\n\t\t\t\t\t\tMenge: item.Menge || null,\r\n\t\t\t\t\t\tMeins: item.Meins || \"\",\r\n\t\t\t\t\t\tSanin: item.Sanin || null,\r\n\t\t\t\t\t\tUpskz: item.Upskz || null,\r\n\t\t\t\t\t\tSortf: item.Sortf || \"\",\r\n\t\t\t\t\t\tIdent: item.Ident || \"\",\r\n\t\t\t\t\t\tAennr: item.Aennr || \"\",\r\n\t\t\t\t\t\tAenra: item.Aenra || \"\",\r\n\t\t\t\t\t\tAlpgr: item.Alpgr || \"\",\r\n\t\t\t\t\t\tSgtCatv: item.SgtCatv || \"\",\r\n\t\t\t\t\t\tRfpnt: item.Rfpnt || \"\",\r\n\t\t\t\t\t\tAnnam: item.Annam || \"\",\r\n\t\t\t\t\t\tAenam: item.Aenam || \"\",\r\n\t\t\t\t\t\tSanka: item.Sanka || \"\",\r\n\t\t\t\t\t\tFmeng: item.Fmeng || null,\r\n\t\t\t\t\t\tLtxpo: item.Ltxpo ? \"X\" : \"\",\r\n\t\t\t\t\t\tSgtCmkz: item.SgtCmkz ? \"X\" : \"\",\r\n\t\t\t\t\t\tStlkz: item.Stlkz ? \"X\" : \"\",\r\n\t\t\t\t\t\t// Cadpo: item.Cadpo || null,\r\n\t\t\t\t\t\t// Alekz: item.Alekz || null,\r\n\t\t\t\t\t\tSanko: item.Sanko || null,\r\n\t\t\t\t\t\tVerti: item.Verti || \"\",\r\n\t\t\t\t\t\tAvoau: item.Avoau || null,\r\n\t\t\t\t\t\tAusch: item.Ausch || null,\r\n\t\t\t\t\t\tNetau: item.Netau || null,\r\n\t\t\t\t\t\tRekrs: item.Rekrs || null,\r\n\t\t\t\t\t\tRekri: item.Rekri || null,\r\n\t\t\t\t\t\tKzkup: item.Kzkup || null,\r\n\t\t\t\t\t\tNlfzt: item.Nlfzt || null,\r\n\t\t\t\t\t\tNlfzv: item.Nlfzv || null,\r\n\t\t\t\t\t\tNlfmv: item.Nlfmv || \"\",\r\n\t\t\t\t\t\tDspst: item.Dspst || \"\",\r\n\t\t\t\t\t\tItsob: item.Itsob || \"\",\r\n\t\t\t\t\t\tDumps: item.Dumps || null,\r\n\t\t\t\t\t\tPotx1: item.Potx1 || \"\",\r\n\t\t\t\t\t\tPotx2: item.Potx2 || \"\",\r\n\t\t\t\t\t\tErskz: item.Erskz || \"\",\r\n\t\t\t\t\t\tObtsp: item.Obtsp || \"\",\r\n\t\t\t\t\t\tRvrel: item.Rvrel || \"\",\r\n\t\t\t\t\t\tSanfe: item.Sanfe || null,\r\n\t\t\t\t\t\tBeikz: item.Beikz || \"\",\r\n\t\t\t\t\t\tLgort: item.Lgort || \"\",\r\n\t\t\t\t\t\tPrvbe: item.Prvbe || \"\",\r\n\t\t\t\t\t\tSchgt: item.Schgt || null,\r\n\t\t\t\t\t\tSchkz: item.Schkz || null\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar oBmeng = BomHeaderModel.getProperty(\"/Bmeng\") || oView.byId(\"ID_BOM_BMENG\").getValue() || null;\r\n\t\t\t\tvar oLosvn = BomHeaderModel.getProperty(\"/Losvn\") || oView.byId(\"ID_BOM_LOSVN\").getValue() || null;\r\n\t\t\t\tvar oLosbs = BomHeaderModel.getProperty(\"/Losbs\") || oView.byId(\"ID_BOM_LOSBS\").getValue() || null;\r\n\r\n\t\t\t\tvar BOMHeaderData = BomHeaderModel.getData();\r\n\t\t\t\t[BOMHeaderData].forEach(function(oItem) {\r\n\t\t\t\t\t[\"Datuv\"].forEach(function(field) {\r\n\t\t\t\t\t\tvar value = oItem[field];\r\n\t\t\t\t\t\tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t\t\t\t\t\toItem[field] = new Date(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Prepare BOM header data\r\n\t\t\t\tvar aNavBomHeader = [{\r\n\t\t\t\t\tBmeng: that.fnToEdmDecimal(oBmeng, 13, 3) || null,\r\n\t\t\t\t\tZtext: BomHeaderModel.getProperty(\"/Ztext\") || oView.byId(\"ID_BOM_ZTEXT\").getValue() || \"\",\r\n\t\t\t\t\tBmein: BomHeaderModel.getProperty(\"/Bmein\") || oView.byId(\"ID_BOM_BMEIN\").getValue() || \"\",\r\n\t\t\t\t\tStktx: BomHeaderModel.getProperty(\"/Stktx\") || oView.byId(\"ID_BOM_STKTX\").getValue() || \"\",\r\n\t\t\t\t\tLosvn: that.fnToEdmDecimal(oLosvn, 13, 3) || null,\r\n\t\t\t\t\tLosbs: that.fnToEdmDecimal(oLosbs, 13, 3) || null,\r\n\t\t\t\t\tLosme: BomHeaderModel.getProperty(\"/Losme\") || oView.byId(\"ID_BOM_LOSME\").getValue() || \"\",\r\n\t\t\t\t\tStlst: BomHeaderModel.getProperty(\"/Stlst\") || oView.byId(\"ID_BOM_STLST\").getValue() || \"\",\r\n\t\t\t\t\tStlbe: BomHeaderModel.getProperty(\"/Stlbe\") || oView.byId(\"ID_BOM_STLBE\").getValue() || \"\",\r\n\t\t\t\t\tLabor: (function() {\r\n\t\t\t\t\t\tvar sLabor = BomHeaderModel.getProperty(\"/Labor\") || oView.byId(\"ID_BOM_LABOR\").getValue() || \"\";\r\n\t\t\t\t\t\tsLabor = sLabor.trim();\r\n\t\t\t\t\t\tif (sLabor !== \"\" && sLabor !== \"0\") {\r\n\t\t\t\t\t\t\tsLabor = sLabor.padStart(3, \"0\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn sLabor;\r\n\t\t\t\t\t})(),\r\n\t\t\t\t\tGroes: BomHeaderModel.getProperty(\"/Groes\") || oView.byId(\"ID_BOM_GROES\").getValue() || \"\",\r\n\t\t\t\t\tStlal: BomHeaderModel.getProperty(\"/Stlal\") || oView.byId(\"ID_BOM_STLAL\").getValue() || \"\",\r\n\t\t\t\t\tStlan: BomHeaderModel.getProperty(\"/Stlan\") || oView.byId(\"ID_BOM_STLAN\").getValue() || \"\",\r\n\t\t\t\t\tTetyp: BomHeaderModel.getProperty(\"/Tetyp\") || oView.byId(\"ID_BOM_TETYP\").getValue() || \"\",\r\n\t\t\t\t\tExstl: BomHeaderModel.getProperty(\"/Exstl\") || oView.byId(\"ID_BOM_EXSTL\").getValue() || \"\",\r\n\t\t\t\t\tDatuv: BomHeaderModel.getProperty(\"/Datuv\") || oView.byId(\"ID_BOM_ADATU\").getDateValue() || null\r\n\t\t\t\t}];\r\n\r\n\t\t\t\t// Build Final Payload\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tMatnr: oView.byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\t\tWerks: oView.byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tAppId: \"RC\",\r\n\t\t\t\t\tInd: \"X\",\r\n\t\t\t\t\tNavBomHeader: aNavBomHeader,\r\n\t\t\t\t\tNavBomItem: aFilteredTableData,\r\n\t\t\t\t\tNavReturn_Msg: []\r\n\t\t\t\t};\r\n\t\t\t\treturn oPayload;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnNextItem: function() {\r\n\t\t\tif (this._iCurrentIndex < this._aSelectedPaths.length - 1) {\r\n\t\t\t\tthis._iCurrentIndex++;\r\n\t\t\t\tthis.fnupdateFragmentContext();\r\n\t\t\t} else {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"LastLineItemInfo\"), \"Information\", this);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnPreviousItem: function() {\r\n\t\t\tif (this._iCurrentIndex > 0) {\r\n\t\t\t\tthis._iCurrentIndex--;\r\n\t\t\t\tthis.fnupdateFragmentContext();\r\n\t\t\t} else {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"FirstLineItemInfo\"), \"Information\", this);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnupdateFragmentContext: function() {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tvar sPath = this._aSelectedPaths[this._iCurrentIndex];\r\n\t\t\tvar oData = oModel.getProperty(sPath);\r\n\r\n\t\t\tthis.clrAllfrag.setBindingContext(oModel.createBindingContext(sPath), \"JM_BOMTable\");\r\n\r\n\t\t\tFragment.byId(\"ID_ITEMLEVEL\", \"id_itemNumber\").setText(\"Item Number : \" + oData.Posnr + \" Component : \" + oData.Idnrk +\r\n\t\t\t\t\" - \" + oData.Ktext);\r\n\t\t},\r\n\r\n\t\tfnDeselectAll: function() {\r\n\t\t\tvar oTable = this.getView().byId(\"id_bomTable\");\r\n\t\t\tif (oTable.getSelectedIndices().length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"NoRowSelected\"), \"Information\", this);\r\n\t\t\t}\r\n\t\t\toTable.clearSelection();\r\n\t\t},\r\n\r\n\t\t// fnPressExpand: function() {\r\n\r\n\t\t// \tvar oView = this.getView();\r\n\t\t// \tvar oButton = oView.byId(\"id_ExpandButton\");\r\n\t\t// \tvar oTable = oView.byId(\"id_bomTable\");\r\n\t\t// \tvar oVisibleModel = oView.getModel(\"JMVboxVisibilityModel\");\r\n\t\t// \tvar bExpandMode = oVisibleModel.getProperty(\"/visible\");\r\n\t\t// \toVisibleModel.setProperty(\"/visible\", !bExpandMode);\r\n\t\t// \tif (bExpandMode) {\r\n\t\t// \t\toTable.setVisibleRowCount(11);\r\n\t\t// \t\toButton.setIcon(\"Image/collapse.svg\");\r\n\t\t// \t} else {\r\n\t\t// \t\t// oTable.setVisibleRowCount(5);\r\n\t\t// \t\tif (this.Expandflag) {\r\n\t\t// \t\t\toTable.setVisibleRowCount(10);\r\n\t\t// \t\t} else {\r\n\t\t// \t\t\toTable.setVisibleRowCount(5);\r\n\t\t// \t\t}\r\n\t\t// \t\toButton.setIcon(\"Image/expand.svg\");\r\n\t\t// \t}\r\n\t\t// },\r\n\r\n\t\tfnExpand: function() {\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/visible\", false);\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/rowCount\", 10);\r\n\t\t},\r\n\r\n\t\tfnCollapse: function() {\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/rowCount\", 5);\r\n\t\t\tthis.getView().getModel(\"JM_Visible\").setProperty(\"/visible\", true);\r\n\t\t},\r\n\r\n\t\tfnExpandCollapse: function(oEvent) {\r\n\r\n\t\t\tvar oSrc = oEvent.getSource();\r\n\t\t\tvar id = oSrc.getId().split(\"--\")[1];\r\n\t\t\tvar oVisibleModel = this.getView().getModel(\"JM_Visible\");\r\n\r\n\t\t\tif (oVisibleModel) {\r\n\t\t\t\tvar bCurrent = oVisibleModel.getProperty(\"/BasicVisible\");\r\n\t\t\t\tvar bNew = !bCurrent;\r\n\r\n\t\t\t\toVisibleModel.setProperty(\"/BasicVisible\", bNew);\r\n\t\t\t\toVisibleModel.setProperty(\"/rowCount\", bNew ? 5 : 9);\r\n\r\n\t\t\t\tvar oButton = this.getView().byId(id);\r\n\t\t\t\tif (bNew) {\r\n\t\t\t\t\toButton.removeStyleClass(\"cl_search_rotateImage\");\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\toButton.addStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSubmitConfirmation: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"BOM_BACK\") {\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnClearChangeLog();\r\n\t\t\t\t}\r\n\t\t\t\tthis.fnclearLocalModel();\r\n\t\t\t\tthis.fnResetInputStates();\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"pv_detail\");\r\n\t\t\t} else if (state === \"BOM_DELETE\") {\r\n\t\t\t\tthis.fnDeleteRow();\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnConfirmationFragmentClose: function() {\r\n\t\t\tif (this.oDialog) {\r\n\t\t\t\tthis.oDialog.close();\r\n\t\t\t\tthis.oDialog.destroy(); // if you want destroy after close\r\n\t\t\t\tthis.oDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnBomclose: function() {\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnClearChangeLog();\r\n\t\t\t}\r\n\t\t\tthis.fnclearLocalModel();\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"pv_detail\");\r\n\t\t},\r\n\r\n\t\tfnUpdateChangelog: function(oId, oCtx) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oShortId = oId.split(\"--\").pop();\r\n\t\t\tvar vId = oShortId.split(\"-\")[0];\r\n\r\n\t\t\tvar oControl = this.getView().byId(vId) || Fragment.byId(\"ID_ITEMLEVEL\", vId);\r\n\t\t\tvar newValue;\r\n\r\n\t\t\tif (oControl.getValue) {\r\n\t\t\t\tnewValue = oControl.getValue();\r\n\t\t\t} else if (oControl.getSelected) {\r\n\t\t\t\tnewValue = oControl.getSelected();\r\n\t\t\t} else {\r\n\t\t\t\tnewValue = null; // fallback\r\n\t\t\t}\r\n\r\n\t\t\tvar trimmed = vId.replace(/^ID_BOM_/, \"\");\r\n\r\n\t\t\tvar parts = trimmed.toLowerCase().split(\"_\");\r\n\t\t\tvar ObjectId = parts.map(function(p) {\r\n\t\t\t\treturn p.charAt(0).toUpperCase() + p.slice(1);\r\n\t\t\t}).join(\"\");\r\n\r\n\t\t\tvar oBOMModel = this.getView().getModel(\"JM_BOMModel\");\r\n\t\t\tvar oBOMTableModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tif (!oBOMModel && !oBOMTableModel) return;\r\n\r\n\t\t\tif (oCtx) {\r\n\t\t\t\tvar oModel = oCtx.getModel();\r\n\t\t\t\tvar oNewData = oModel.getProperty(\"/BOMList\") || [];\r\n\t\t\t\tvar sPath = oCtx.getPath();\r\n\t\t\t\tvar index = parseInt(sPath.split('/')[2]);\r\n\t\t\t\tvar oBOMItemData = this.oldItemValue || [];\r\n\t\t\t\toBOMItemData = oBOMItemData.filter(function(item) {\r\n\t\t\t\t\treturn item.Idnrk !== \"\";\r\n\t\t\t\t});\r\n\r\n\t\t\t\tnewValue = oModel.getProperty(sPath + \"/\" + ObjectId);\r\n\r\n\t\t\t\tvar bHasOldData = oBOMItemData.length > index;\r\n\r\n\t\t\t\tif (bHasOldData) {\r\n\t\t\t\t\tvar oldValue = oBOMItemData[index] ? oBOMItemData[index][ObjectId] : \"\";\r\n\t\t\t\t\tvar oPosnr = oBOMItemData[index] ? oBOMItemData[index].Posnr : \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar oldValue = \"\";\r\n\t\t\t\t\tvar oPosnr = oNewData[index] ? oNewData[index].Posnr : \"\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar HeaderName = this.fnGetColumnTooltip(ObjectId);\r\n\t\t\t\tif (!HeaderName) {\r\n\t\t\t\t\tvar oText = Fragment.byId(\"ID_ITEMLEVEL\", vId + \"_TXT\");\r\n\t\t\t\t\tHeaderName = oText ? oText.getText() : ObjectId;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar FieldName = HeaderName + \" - \" + (oPosnr || \"\");\r\n\r\n\t\t\t} else {\r\n\t\t\t\tvar oBOMHeaderData = this.oldHeaderValue || {};\r\n\t\t\t\tif (!oBOMHeaderData.hasOwnProperty(ObjectId)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar oldValue = oBOMHeaderData[ObjectId];\r\n\t\t\t\tvar oText = this.getView().byId(vId + \"_TXT\");\r\n\t\t\t\tvar FieldName = oText ? oText.getText() : ObjectId;\r\n\t\t\t\tvar oPosnr = \"\";\r\n\t\t\t}\r\n\r\n\t\t\tvar gChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!gChangeLogModel) {\r\n\t\t\t\tgChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getOwnerComponent().setModel(gChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLogData = gChangeLogModel.getData();\r\n\r\n\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\toChangeLogData = [];\r\n\t\t\t} else {\r\n\t\t\t\tif (!oCtx) {\r\n\t\t\t\t\tvar aFiltered = oChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ProcessInd === \"B\" && item.ItemNo === \"\" && item.FieldId === vId;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (aFiltered.length > 0) {\r\n\t\t\t\t\t\toldValue = aFiltered[0].OldValue || \"\";\r\n\t\t\t\t\t\toBOMHeaderData[ObjectId] = oldValue;\r\n\t\t\t\t\t\tthis.oldHeaderValue = oBOMHeaderData;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar aFiltered = oChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ProcessInd === \"B\" && item.ItemNo === oPosnr && item.FieldId === vId;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (aFiltered.length > 0) {\r\n\t\t\t\t\t\toldValue = aFiltered[0].OldValue || \"\";\r\n\t\t\t\t\t\tif (oBOMItemData[index]) {\r\n\t\t\t\t\t\t\toBOMItemData[index][ObjectId] = oldValue;\r\n\t\t\t\t\t\t\tthis.oldHeaderValue = oBOMItemData;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!oCtx) {\r\n\t\t\t\tvar idx = oChangeLogData.findIndex(function(item) {\r\n\t\t\t\t\treturn item.FieldId === vId;\r\n\t\t\t\t});\r\n\r\n\t\t\t} else {\r\n\t\t\t\tvar idx = oChangeLogData.findIndex(function(item) {\r\n\t\t\t\t\treturn item.FieldId === vId && item.ItemNo === oPosnr;\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\toldValue = (typeof oldValue === \"boolean\") ? (oldValue ? \"X\" : \"\") : oldValue;\r\n\t\t\tnewValue = (typeof newValue === \"boolean\") ? (newValue ? \"X\" : \"\") : newValue;\r\n\r\n\t\t\tif (oldValue !== newValue) {\r\n\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\toChangeLogData[idx].NewValue = newValue;\r\n\t\t\t\t\toChangeLogData[idx].OldValue = oldValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\t// ScrInd: \"B\",\r\n\t\t\t\t\t\tFieldId: vId || \"\",\r\n\t\t\t\t\t\tProcessDesc: \"BOM\",\r\n\t\t\t\t\t\tItemNo: oPosnr || \"\",\r\n\t\t\t\t\t\tFieldName: FieldName || \"\",\r\n\t\t\t\t\t\tOldValue: oldValue || \"\",\r\n\t\t\t\t\t\tProcessInd: \"B\",\r\n\t\t\t\t\t\tNewValue: newValue || \"\",\r\n\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\toChangeLogData.splice(idx, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgChangeLogModel.setData(oChangeLogData);\r\n\t\t\tgChangeLogModel.refresh(true);\r\n\r\n\t\t},\r\n\r\n\t\tfnChangelog: function() {\r\n\t\t\tif (!this.Changelog) {\r\n\t\t\t\tthis.Changelog = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.Fragment.ChangeLog\", this);\r\n\t\t\t\tthis.getView().addDependent(this.Changelog);\r\n\t\t\t}\r\n\r\n\t\t\tthis.Changelog.open();\r\n\t\t},\r\n\r\n\t\tfnCloseChanLogDialog: function() {\r\n\t\t\tif (this.Changelog) {\r\n\t\t\t\tthis.Changelog.close();\r\n\t\t\t\tthis.Changelog.destroy();\r\n\t\t\t\tthis.Changelog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnInitializeScreen: function() {\r\n\t\t\tvar contextModel = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\r\n\t\t\tif (!Object.keys(contextModel.getData() || {}).length) {\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(\"Recipe BOM Creation - Initiator\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar state = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Level\");\r\n\t\t\tvar tranid = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Transid\");\r\n\t\t\tvar AppId = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Appid\");\r\n\t\t\tvar SendBack = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Sendback\");\r\n\t\t\tvar Progress = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Progress\");\r\n\t\t\tif (state === \"A\") {\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Reviewer - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Approver - \" + tranid;\r\n\t\t\t\t} else if (state === \"R\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else if (state === \"R\") {\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Reviewer - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Approver - \" + tranid;\r\n\t\t\t\t} else if (state === \"R\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else if (state === \"I\") {\r\n\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe BOM Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"I\") {\r\n\t\t\t\t\tif (Progress === \"Complete\") {\r\n\t\t\t\t\t\tstring += \"- Completed Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Inprogress\") {\r\n\t\t\t\t\t\tstring += \"- Inprogress Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Draft\") {\r\n\t\t\t\t\t\tstring += \"- Drafted Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"SendBack\" || SendBack === \"X\") {\r\n\t\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Reject\") {\r\n\t\t\t\t\t\tstring += \"- Rejected Record - \" + tranid;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// No Progress, no SendBack  Default\r\n\t\t\t\t\t\tstring += \"- Initiator - \" + tranid;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else {\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tstring = \"Recipe BOM Change \";\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string + \" - Initiator\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnGetColumnTooltip: function(ObjectId) {\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\t\t\tvar aColumns = oTable.getColumns();\r\n\r\n\t\t\tfor (var i = 0; i < aColumns.length; i++) {\r\n\t\t\t\tvar oTemplate = aColumns[i].getTemplate();\r\n\t\t\t\tif (!oTemplate) continue;\r\n\r\n\t\t\t\tvar oInner;\r\n\t\t\t\tif (oTemplate.isA(\"sap.m.VBox\")) {\r\n\t\t\t\t\tvar aItems = oTemplate.getItems();\r\n\t\t\t\t\tif (aItems && aItems.length > 0) {\r\n\t\t\t\t\t\toInner = aItems[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (oInner) {\r\n\t\t\t\t\tvar oBindInfoText = oInner.getBindingInfo(\"text\");\r\n\t\t\t\t\tvar oBindInfoValue = oInner.getBindingInfo(\"value\");\r\n\r\n\t\t\t\t\tvar sBoundPath = \"\";\r\n\t\t\t\t\tif (oBindInfoText && oBindInfoText.parts && oBindInfoText.parts.length > 0) {\r\n\t\t\t\t\t\tsBoundPath = oBindInfoText.parts[0].path;\r\n\t\t\t\t\t} else if (oBindInfoValue && oBindInfoValue.parts && oBindInfoValue.parts.length > 0) {\r\n\t\t\t\t\t\tsBoundPath = oBindInfoValue.parts[0].path;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (sBoundPath === ObjectId) {\r\n\t\t\t\t\t\tvar oLabel = aColumns[i].getLabel();\r\n\t\t\t\t\t\treturn oLabel ? oLabel.getTooltip() : \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\r\n\t\tfnToEdmDecimal: function(value, totalDigits, decimalPlaces) {\r\n\t\t\tif (value === null || value === undefined || value === \"\") {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar num = parseFloat(value);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar fixedValue = num.toFixed(decimalPlaces);\r\n\t\t\tvar parts = fixedValue.split(\".\");\r\n\t\t\tvar intPart = parts[0];\r\n\t\t\tvar decPart = parts[1] || \"\";\r\n\t\t\tvar maxIntLength = totalDigits - decimalPlaces;\r\n\t\t\tif (intPart.length > maxIntLength) {\r\n\t\t\t\tintPart = intPart.slice(0, maxIntLength);\r\n\t\t\t}\r\n\t\t\tvar result = decimalPlaces > 0 ? intPart + \".\" + decPart : intPart;\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tfnClearChangeLog: function() {\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\t\t\tif (this.OrgChangeLog) {\r\n\t\t\t\toChangeLogModel.setData(this.OrgChangeLog);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnclearLocalModel: function() {\r\n\t\t\tvar aModels = [\r\n\t\t\t\t\"JM_Visible\",\r\n\t\t\t\t\"JM_ContextModel\",\r\n\t\t\t\t\"JM_LocalDescriptionModel\",\r\n\t\t\t\t\"JM_BOMModel\",\r\n\t\t\t\t\"JM_BOMTable\",\r\n\t\t\t\t\"JM_RecipeData\",\r\n\t\t\t\t\"JM_LocChangeLog\"\r\n\t\t\t];\r\n\t\t\tvar that = this;\r\n\t\t\taModels.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = that.getView().getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\tthat.getView().setModel(null, sModelName);\r\n\t\t\t\t\tthat.getView().setModel(undefined, sModelName);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\t\t\tvar oChangeLogModel = oComponent.getModel(\"JM_ChangeLog\");\r\n\t\t\tvar aChangeLogData = oChangeLogModel ? oChangeLogModel.getData() : [];\r\n\r\n\t\t\tvar oContextModel = oComponent.getModel(\"JM_ContextModel\");\r\n\t\t\tvar oUwlData = oContextModel.getData() || {};\r\n\r\n\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0 && oUwlData.Appid === \"RX\") {\r\n\t\t\t\tvar aChangedItems = aChangeLogData.filter(function(item) {\r\n\t\t\t\t\treturn item.ProcessInd === \"B\";\r\n\t\t\t\t});\r\n\r\n\t\t\t\toTable.setRowSettingsTemplate(\r\n\t\t\t\t\tnew sap.ui.table.RowSettings({\r\n\t\t\t\t\t\thighlight: sap.ui.core.IndicationColor.None\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\t\taChangedItems.forEach(function(oItem) {\r\n\t\t\t\t\tvar sFieldId = oItem.FieldId;\r\n\t\t\t\t\tif (!sFieldId) return;\r\n\t\t\t\t\tvar oControl = that.getView().byId(sFieldId);\r\n\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\toControl.removeStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar oFragControl = Fragment.byId(\"ID_ITEMLEVEL\", sFieldId);\r\n\t\t\t\t\t\tif (oFragControl) {\r\n\t\t\t\t\t\t\toFragControl.removeStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (oTable) {\r\n\t\t\t\toTable.clearSelection();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnResetInputStates: function() {\r\n\t\t\tvar oTable = this.byId(\"id_bomTable\");\r\n\t\t\tif (!oTable) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar aRows = oTable.getRows();\r\n\t\t\taRows.forEach(function(oRow) {\r\n\t\t\t\tvar aCells = oRow.getCells();\r\n\t\t\t\taCells.forEach(function(oCell) {\r\n\t\t\t\t\tif (oCell instanceof sap.m.VBox) {\r\n\t\t\t\t\t\toCell.getItems().forEach(function(oItem) {\r\n\t\t\t\t\t\t\tif (oItem instanceof sap.m.Input) {\r\n\t\t\t\t\t\t\t\toItem.setValueState(\"None\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Direct input (not wrapped)\r\n\t\t\t\t\telse if (oCell instanceof sap.m.Input) {\r\n\t\t\t\t\t\toCell.setValueState(\"None\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tfrontEndId.forEach(function(sId) {\r\n\t\t\t\tvar oInput = that.getView().byId(sId) || sap.ui.core.Fragment.byId(\"ID_ITEMLEVEL\", sId);\r\n\r\n\t\t\t\tif (oInput) {\r\n\t\t\t\t\t// Handle CheckBox type\r\n\t\t\t\t\tif (oInput instanceof sap.m.CheckBox) {\r\n\t\t\t\t\t\t// Reset to normal style\r\n\t\t\t\t\t\toInput.removeStyleClass(\"cl_checkboxError\");\r\n\t\t\t\t\t\toInput.addStyleClass(\"cl_opr_checkbx\");\r\n\t\t\t\t\t\toInput.setTooltip(\"\");\r\n\t\t\t\t\t} else if (oInput instanceof sap.m.Input) {\r\n\t\t\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t\t\t\t// oInput.setTooltip(\"\"); \r\n\t\t\t\t\t} else if (oInput.setValueState) {\r\n\t\t\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\tfnCheckErrorState: function() {\r\n\t\t\tvar retMsg = true;\r\n\t\t\tvar oView = this.getView();\r\n\r\n\t\t\tfor (var i = 0; i < frontEndId.length; i++) {\r\n\t\t\t\tvar oCtrl = Fragment.byId(\"ID_ITEMLEVEL\", frontEndId[i]) || oView.byId(frontEndId[i]);\r\n\r\n\t\t\t\tif (!oCtrl) continue;\r\n\r\n\t\t\t\tif (oCtrl.getValueState && oCtrl.getValueState() === \"Error\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (oCtrl instanceof sap.m.CheckBox) {\r\n\t\t\t\t\tif (oCtrl.getValueState && oCtrl.getValueState() === \"Error\") {\r\n\t\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn retMsg;\r\n\t\t},\r\n\r\n\t\t//  logic added by sabarish 20 01 2025\r\n\t\tfnf4prodStlocpress: function(oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar vLength;\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar sModelName = oBindInfo.parts[0].model;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\r\n\t\t\tif (!sModelName || !sFieldPath || !oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\tvar Idnrk = this.getView().getModel(\"JM_BOMTable\").getProperty(sRowPath + \"/Idnrk\");\r\n\t\t\tthis.sRowPath = sRowPath;\r\n\t\t\tif (Idnrk === \"\") {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Component\", \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._selectedFieldEvent = oInput;\r\n\t\t\tthis.prdStrogeLocFlag = true;\r\n\t\t\tvar sIdnrk = this.Idnrk;\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: \"ID_BOM_LGORT\",\r\n\t\t\t\tProcess: \"X\",\r\n\t\t\t\tF4Type: \"P\",\r\n\t\t\t\tFieldNam2: \"WERKS\",\r\n\t\t\t\tFieldNam1: \"MATNR\",\r\n\t\t\t\tValue2: this.getView().byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\tValue1: (/^\\d+$/.test(Idnrk)) ? (\"000000000000000000\" + Idnrk).slice(-18) : Idnrk\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgType === \"I\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.Message, \"Error\", this);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar aResults = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\r\n\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\tvar row = {};\r\n\r\n\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\r\n\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\tthis.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\tif (this.agentFieldFlag) {\r\n\t\t\t\t\t\tvar jsonList = {\r\n\t\t\t\t\t\t\tList: aResults\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar oJsonList = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\t\toJsonList.setData(jsonList);\r\n\t\t\t\t\t\tthis.getView().setModel(oJsonList, \"JM_Agents\");\r\n\t\t\t\t\t\tvLength = aResults.results.length;\r\n\t\t\t\t\t\t// this.agentFieldFlag = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvTitle = this.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\tthis.fnF4fragopen(oEvent, vTitle).open();\r\n\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tfncoProductSelect: function(oEvent) {\r\n\t\t\tvar oSelect = oEvent.getSource();\r\n\t\t\tvar sKey = oSelect.getSelectedKey();\r\n\t\t\toSelect.setValueState(\"None\");\r\n\t\t\toSelect.setValueStateText(\"\");\r\n\t\t\tthis.checkboxFlag = true;\r\n\t\t\t// Get row context correctly\r\n\t\t\tvar oCtx = oSelect.getBindingContext(\"JM_BOMTable\");\r\n\t\t\tif (!oCtx) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar sRowPath = oCtx.getPath();\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\t// Row data\r\n\t\t\tvar oRow = oModel.getProperty(sRowPath);\r\n\r\n\t\t\tif (oRow.Idnrk === \"\") {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Compoenet\", \"Error\", this);\r\n\t\t\t\toSelect.setSelectedKey(\"\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (sKey === \"\") {\r\n\t\t\t\treturn;\r\n\t\t\t} else if (sKey === \"Y\") {\r\n\t\t\t\t// data.Kzkup = true;\r\n\t\t\t\toModel.setProperty(sRowPath + \"/Kzkup\", true);\r\n\t\t\t\tvar oFakeEvent = {\r\n\t\t\t\t\tgetSource: function() {\r\n\t\t\t\t\t\treturn oSelect;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tgetBindingContext: function() {\r\n\t\t\t\t\t\treturn oCtx;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.fnBomValidation(oFakeEvent);\r\n\t\t\t} else if (sKey === \"N\") {\r\n\t\t\t\toModel.setProperty(sRowPath + \"/Kzkup\", false);\r\n\t\t\t\tvar oFakeEvent = {\r\n\t\t\t\t\tgetSource: function() {\r\n\t\t\t\t\t\treturn oSelect;\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tgetBindingContext: function() {\r\n\t\t\t\t\t\treturn oCtx;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.fnBomValidation(oFakeEvent);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfndownload: function() {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tvar aAllData = oModel.getProperty(\"/BOMList\");\r\n\r\n\t\t\t// Column definitions\r\n\t\t\tvar aCols = [{\r\n\t\t\t\tlabel: \"Component\",\r\n\t\t\t\tproperty: \"Idnrk\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Quantity\",\r\n\t\t\t\tproperty: \"Menge\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Sort String\",\r\n\t\t\t\tproperty: \"Sortf\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Stroage Location\",\r\n\t\t\t\tproperty: \"Lgort\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Recursive Allowed\",\r\n\t\t\t\tproperty: \"RekrsTxt\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t}];\r\n\r\n\t\t\t// Export all data\r\n\t\t\tvar oSpreadsheet = new sap.ui.export.Spreadsheet({\r\n\t\t\t\tworkbook: {\r\n\t\t\t\t\tcolumns: aCols,\r\n\t\t\t\t\tautoFilter: false\r\n\t\t\t\t},\r\n\t\t\t\tdataSource: aAllData,\r\n\t\t\t\tfileName: \"BOM_TEMPLATE.xlsx\",\r\n\t\t\t\tworker: false,\r\n\t\t\t\tshowProgress: false\r\n\t\t\t});\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toSpreadsheet.build().then(function() {\r\n\t\t\t\t// ErrorHandler.showCustomSnackbar(i18n.getText(\"downloadComplete_Success\"), \"Success\", that);\r\n\t\t\t}).catch(function(oError) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(oError.message, \"Error\", that);\r\n\t\t\t});\r\n\r\n\t\t},\r\n\t\tfnUpload: function() {\r\n\t\t\tvar oFileUploader = this.byId(\"FileUploaderId\");\r\n\t\t\tif (oFileUploader) {\r\n\t\t\t\tvar oDomRef = oFileUploader.getFocusDomRef();\r\n\t\t\t\tif (oDomRef) {\r\n\t\t\t\t\toDomRef.click(); // Opens file dialog\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnFileSelect: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oFileUploader = this.byId(\"FileUploaderId\");\r\n\t\t\tvar oFile = oEvent.getParameter(\"files\")[0];\r\n\t\t\tif (oFile) {\r\n\t\t\t\tif (oFile.size > 2 * 1024 * 1024) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(\"Maximum File size will be 2MB\", \"Information\", this);\r\n\t\t\t\t\toFileUploader.setValue(\"\"); // Reset to allow re-selection\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\treader.onload = function(e) {\r\n\t\t\t\t\tvar sBase64 = e.target.result.split(\",\")[1];\r\n\t\t\t\t\t// Store temporarily\r\n\t\t\t\t\tvar oModel = that.getView().getModel(\"JMUploadFileModel\");\r\n\t\t\t\t\toModel.setProperty(\"/FileName\", oFile.name);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedFileContent\", sBase64);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedMimeType\", oFile.type);\r\n\t\t\t\t\toModel.setProperty(\"/uploadedFileSize\", oFile.size);\r\n\t\t\t\t\tthat.getView().byId(\"id_fileNameInput\").setValue(oFile.name);\r\n\t\t\t\t};\r\n\t\t\t\treader.readAsDataURL(oFile);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfnExcelUpload: function() {\r\n\t\t\tvar oFileUploader;\r\n\t\t\tvar status = false;\r\n\t\t\tvar oTable = this.getView().byId(\"id_bomTable\");\r\n\t\t\tif (oTable) {\r\n\t\t\t\toTable.clearSelection();\r\n\t\t\t}\r\n\t\t\tvar oMobileModel = this.getView().getModel(\"RoadMapUI\");\r\n\t\t\tif (oMobileModel) {\r\n\t\t\t\tstatus = oMobileModel.getProperty(\"/labelVisible\");\r\n\t\t\t}\r\n\t\t\toFileUploader = this.byId(\"FileUploaderId\");\r\n\t\t\tvar oFile = oFileUploader.oFileUpload.files[0];\r\n\r\n\t\t\tif (!oFile) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"No_file_error\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar that = this;\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\treader.onload = function(event) {\r\n\t\t\t\tvar data = event.target.result;\r\n\t\t\t\tvar workbook = XLSX.read(data, {\r\n\t\t\t\t\ttype: \"binary\"\r\n\t\t\t\t});\r\n\t\t\t\tvar sheetName = workbook.SheetNames[0];\r\n\t\t\t\tvar sheet = workbook.Sheets[sheetName];\r\n\t\t\t\tvar excelData = XLSX.utils.sheet_to_json(sheet);\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tAppId: this.AppId,\r\n\t\t\t\t\tWerks: that.getView().byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\t\tInd: \"B\",\r\n\t\t\t\t\tMsgTyp: \"M\"\r\n\t\t\t\t};\r\n\t\t\t\toPayload.NavBomHeader = [];\r\n\t\t\t\toPayload.NavBomItem = [];\r\n\t\t\t\toPayload.NavDescription = [];\r\n\t\t\t\toPayload.NavBomHeader.push({\r\n\t\t\t\t\tStlan: that.getView().byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\t\tStlal: that.getView().byId(\"ID_BOM_STLAL\").getValue()\r\n\t\t\t\t});\r\n\t\t\t\texcelData.forEach(function(item) {\r\n\t\t\t\t\toPayload.NavBomItem.push({\r\n\t\t\t\t\t\tIdnrk: item.Component || \"\",\r\n\t\t\t\t\t\tMenge: that.fnToEdmDecimal(item.Quantity, 13, 3) || null,\r\n\t\t\t\t\t\tSortf: item[\"Sort String\"] || \"\",\r\n\t\t\t\t\t\tLgort: item[\"Stroage Location\"] ? String(item[\"Stroage Location\"]) : \"\",\r\n\t\t\t\t\t\tUpskz: null,\r\n\t\t\t\t\t\tDatuv: null,\r\n\t\t\t\t\t\tDatub: null,\r\n\t\t\t\t\t\tDumps: null,\r\n\t\t\t\t\t\tAvoau: null,\r\n\t\t\t\t\t\tAusch: null,\r\n\t\t\t\t\t\tFmeng: null,\r\n\t\t\t\t\t\tNetau: null,\r\n\t\t\t\t\t\tRekrs: (item[\"Recursive Allowed\"] === \"X\") ? true : false,\r\n\t\t\t\t\t\tRekri: null,\r\n\t\t\t\t\t\tKzkup: null,\r\n\t\t\t\t\t\tNlfzt: null,\r\n\t\t\t\t\t\tNlfzv: null,\r\n\t\t\t\t\t\tSanko: null,\r\n\t\t\t\t\t\tSanin: null,\r\n\t\t\t\t\t\tSanfe: null,\r\n\t\t\t\t\t\tSchgt: null,\r\n\t\t\t\t\t\tSchkz: null,\r\n\t\t\t\t\t\tAndat: null,\r\n\t\t\t\t\t\tAedat: null\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tvar odataCall = this.getOwnerComponent().getModel();\r\n\t\t\t\todataCall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\toFileUploader.clear();\r\n\t\t\t\t\t\tvar today = new Date();\r\n\t\t\t\t\t\tvar firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\r\n\t\t\t\t\t\tvar oItemData = oData.NavBomItem.results;\r\n\t\t\t\t\t\tvar DescData = oData.NavDescription.results;\r\n\t\t\t\t\t\tfor (var i = 0; i < oItemData.length; i++) {\r\n\t\t\t\t\t\t\tvar data1 = oItemData[i];\r\n\t\t\t\t\t\t\tdata1.ComponentDes = data1.Ktext;\r\n\t\t\t\t\t\t\tdata1.Datuv = firstDay;\r\n\t\t\t\t\t\t\tdata1.Nlfmv = \"\";\r\n\t\t\t\t\t\t\tdata1.Datub = new Date(9999, 11, 31);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// var oItemModel = new JSONModel({\r\n\t\t\t\t\t\t// \tBOMList: oItemData\r\n\t\t\t\t\t\t// });\r\n\t\t\t\t\t\toItemData.forEach(function(item) {\r\n\t\t\t\t\t\t\titem.Stlkz = item.Stlkz === \"X\";\r\n\t\t\t\t\t\t\titem.key = item.Kzkup ? \"Y\" : \"N\";\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.fnsendValidation(oItemData, DescData);\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"ExcelUploadedSuccessfully\"), \"success\", that);\r\n\t\t\t\tthat.getView().byId(\"id_fileNameInput\").setValue(\"\");\r\n\r\n\t\t\t}.bind(this);\r\n\t\t\treader.readAsBinaryString(oFile);\r\n\t\t},\r\n\t\tfnsendValidation: function(oItemData, DescData) {\r\n\t\t\tvar that = this;\r\n\t\t\tthis.oItemData = oItemData;\r\n\t\t\tvar aFilteredTableData = oItemData.map(function(oItem) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tIdnrk: oItem.Idnrk,\r\n\t\t\t\t\tPosnr: oItem.Posnr,\r\n\t\t\t\t\tAvoau: that.fnToEdmDecimal(oItem.Avoau, 5, 2) || null, // added by sabarish 18-12-2025\r\n\t\t\t\t\tPostp: oItem.Postp,\r\n\t\t\t\t\tAusch: that.fnToEdmDecimal(oItem.Ausch, 5, 2) || null, // added by sabarish 18-12-2025,\r\n\t\t\t\t\tStvkn: oItem.Stvkn, // changed by sabarish Itmid -> Stvkn 15-12-2025\r\n\t\t\t\t\tFmeng: oItem.Fmeng,\r\n\t\t\t\t\tSortf: oItem.Sortf,\r\n\t\t\t\t\tNetau: oItem.Netau,\r\n\t\t\t\t\tAlpgr: oItem.Alpgr,\r\n\t\t\t\t\tRfpnt: oItem.Rfpnt,\r\n\t\t\t\t\tRekrs: oItem.Rekrs,\r\n\t\t\t\t\tRekri: oItem.Rekri,\r\n\t\t\t\t\tKzkup: oItem.Kzkup,\r\n\t\t\t\t\tNlfzt: that.fnToEdmDecimal(oItem.Nlfzt, 3, 0) || null, // added by Sabarish 18-12-2025\r\n\t\t\t\t\tNlfzv: that.fnToEdmDecimal(oItem.Nlfzv, 3, 0) || null, // added by Sabarish 18-12-2025\r\n\t\t\t\t\tNlfmv: oItem.Nlfmv,\r\n\t\t\t\t\tVerti: oItem.Verti,\r\n\t\t\t\t\tDspst: oItem.Dspst,\r\n\t\t\t\t\tItsob: oItem.Itsob,\r\n\t\t\t\t\tDumps: oItem.Dumps,\r\n\t\t\t\t\tPotx1: oItem.Potx1,\r\n\t\t\t\t\tPotx2: oItem.Potx2,\r\n\t\t\t\t\tErskz: oItem.Erskz,\r\n\t\t\t\t\tRvrel: oItem.Rvrel,\r\n\t\t\t\t\tSanko: oItem.Sanko,\r\n\t\t\t\t\tSanin: oItem.Sanin,\r\n\t\t\t\t\tSanfe: oItem.Sanfe,\r\n\t\t\t\t\tSanka: oItem.Sanka,\r\n\t\t\t\t\t// Alekz: oItem.Alekz,\r\n\t\t\t\t\t// Cadpo: oItem.Cadpo,\r\n\t\t\t\t\tBeikz: oItem.Beikz,\r\n\t\t\t\t\tLgort: oItem.Lgort,\r\n\t\t\t\t\tPrvbe: oItem.Prvbe,\r\n\t\t\t\t\tSchgt: oItem.Schgt,\r\n\t\t\t\t\tSchkz: oItem.Schkz,\r\n\t\t\t\t\tMenge: that.fnToEdmDecimal(oItem.Menge, 13, 3) || null,\r\n\t\t\t\t\tMeins: oItem.Meins,\r\n\t\t\t\t\tDatuv: oItem.Datuv,\r\n\t\t\t\t\tDatub: oItem.Datub,\r\n\t\t\t\t\tStlkz: oItem.Stlkz ? \"X\" : \"\"\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tvar oView = this.getView();\r\n\r\n\t\t\t// Header navigation \r\n\t\t\tvar aNavBomHeader = [{\r\n\t\t\t\tBmeng: that.fnToEdmDecimal(oView.byId(\"ID_BOM_BMENG\").getValue(), 13, 3) || null,\r\n\t\t\t\tZtext: oView.byId(\"ID_BOM_ZTEXT\").getValue(),\r\n\t\t\t\tBmein: oView.byId(\"ID_BOM_BMEIN\").getValue(),\r\n\t\t\t\tStktx: oView.byId(\"ID_BOM_STKTX\").getValue(),\r\n\t\t\t\tLosvn: oView.byId(\"ID_BOM_LOSVN\").getValue() || null,\r\n\t\t\t\tLosbs: oView.byId(\"ID_BOM_LOSBS\").getValue() || null,\r\n\t\t\t\tLosme: oView.byId(\"ID_BOM_LOSME\").getValue(),\r\n\t\t\t\tStlst: oView.byId(\"ID_BOM_STLST\").getValue(),\r\n\t\t\t\tLabor: oView.byId(\"ID_BOM_LABOR\").getValue(),\r\n\t\t\t\tDatuv: oView.byId(\"ID_BOM_ADATU\").getDateValue() || null,\r\n\t\t\t\tGroes: \"\",\r\n\t\t\t\tTetyp: oView.byId(\"ID_BOM_TETYP\").getValue(),\r\n\t\t\t\tStlan: oView.byId(\"ID_BOM_STLAN\").getValue(),\r\n\t\t\t\tStlal: oView.byId(\"ID_BOM_STLAL\").getValue(),\r\n\r\n\t\t\t}];\r\n\r\n\t\t\t// Item navigation\r\n\t\t\tvar Initiatorpayload = {\r\n\t\t\t\tAppId: this.AppId,\r\n\t\t\t\tMatnr: oView.byId(\"ID_BOM_MATNR\").getValue(),\r\n\t\t\t\tMaktx: oView.byId(\"ID_BOM_MAKTX\").getValue(),\r\n\t\t\t\tWerks: oView.byId(\"ID_BOM_WERKS\").getValue(),\r\n\t\t\t\tInd: \"X\",\r\n\t\t\t\tNavBomHeader: aNavBomHeader,\r\n\t\t\t\tNavBomItem: aFilteredTableData,\r\n\t\t\t\tNavReturn_Msg: []\r\n\t\t\t};\r\n\t\t\tvar ServiceCall = this.getOwnerComponent().getModel();\r\n\t\t\tServiceCall.create(\"/Recipe_HeaderSet\", Initiatorpayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar aAllMsgs = oData.NavReturn_Msg.results;\r\n\t\t\t\t\tvar itemData = oData.NavBomItem.results;\r\n\t\t\t\t\tvar aItemErrors = aAllMsgs.filter(function(oMsg) {\r\n\t\t\t\t\t\treturn oMsg.MsgType === \"E\" && oMsg.ItemNo;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (aItemErrors.length !== 0) {\r\n\t\t\t\t\t\tvar oErrModel = new sap.ui.model.json.JSONModel(aItemErrors);\r\n\t\t\t\t\t\tthis.getView().setModel(oErrModel, \"ErrorMsgModel\");\r\n\t\t\t\t\t\tif (!this._oErrorFrag) {\r\n\t\t\t\t\t\t\tthis._oErrorFrag = sap.ui.xmlfragment(\r\n\t\t\t\t\t\t\t\t\"MANAGED_BOM.Fragment.UploadError\",\r\n\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.getView().addDependent(this._oErrorFrag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._oErrorFrag.open();\r\n\r\n\t\t\t\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\t\t\t\tif (oModel) {\r\n\t\t\t\t\t\t\tvar data = oModel.getProperty(\"/BOMList\");\r\n\t\t\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\t\t\tvar sPath = \"/BOMList/\" + i;\r\n\t\t\t\t\t\t\t\toModel.setProperty(sPath + \"/ComponentDes\", \"\");\r\n\t\t\t\t\t\t\t\toModel.setProperty(sPath + \"/Idnrk\", \"\");\r\n\t\t\t\t\t\t\t\toModel.setProperty(sPath + \"/Datuv\", null);\r\n\t\t\t\t\t\t\t\toModel.setProperty(sPath + \"/Datub\", null);\r\n\t\t\t\t\t\t\t\tthis.fnclearallRow(sPath);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// this.fnAddRow();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar stlan = this.getView().byId(\"ID_BOM_STLAN\").getValue();\r\n\t\t\t\t\t\tvar oBOMModel = this.getView().getModel(\"JM_BOMTable\");\r\n\r\n\t\t\t\t\t\titemData.forEach(function(item) {\r\n\t\t\t\t\t\t\titem.Stlkz = item.Stlkz === \"X\";\r\n\t\t\t\t\t\t\titem.key = item.Kzkup ? \"Y\" : \"N\";\r\n\t\t\t\t\t\t\titem.Sanfe = (stlan === \"1\");\r\n\t\t\t\t\t\t\titem.Ltxpo = item.Ltxpo === \"X\";\r\n\t\t\t\t\t\t\titem.SgtCmkz = item.SgtCmkz === \"X\";\r\n\t\t\t\t\t\t\t// Set Ktext based on matching Idnrk\r\n\t\t\t\t\t\t\tvar oMatch = this.oItemData.find(function(oItem) {\r\n\t\t\t\t\t\t\t\treturn oItem.Idnrk === item.Idnrk;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\titem.Ktext = oMatch ? oMatch.Ktext : \"\";\r\n\t\t\t\t\t\t}.bind(this));\r\n\r\n\t\t\t\t\t\tif (oBOMModel) {\r\n\t\t\t\t\t\t\toBOMModel.setProperty(\"/BOMList\", itemData);\r\n\t\t\t\t\t\t\toBOMModel.refresh(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var i = 0; i < DescData.length; i++) {\r\n\t\t\t\t\t\t\tvar value = DescData[i];\r\n\t\t\t\t\t\t\tvar Model = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\t\t\t\t\tif (Model) {\r\n\t\t\t\t\t\t\t\tModel.setProperty(\"/BOMList/\" + i + \"/LgortDes\", value.Fielddesc);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\t\tfnerrorDialogCancel: function() {\r\n\t\t\tif (this._oErrorFrag) {\r\n\t\t\t\tthis._oErrorFrag.close();\r\n\t\t\t\tthis._oErrorFrag.destroy();\r\n\t\t\t\tthis._oErrorFrag = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tfnDownloadExcel: function() {\r\n\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_BOMTable\");\r\n\t\t\tvar aRows = oModel.getProperty(\"/BOMList\");\r\n\t\t\tvar aFilteredRows = aRows.filter(function(row) {\r\n\t\t\t\treturn row.Idnrk && row.Idnrk.trim() !== \"\";\r\n\t\t\t});\r\n\r\n\t\t\tif (!aFilteredRows || aFilteredRows.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"No BOM data available!\", \"Warning\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar aCols = [{\r\n\t\t\t\tlabel: \"Item\",\r\n\t\t\t\tproperty: \"Posnr\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"ICt\",\r\n\t\t\t\tproperty: \"Postp\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Component\",\r\n\t\t\t\tproperty: \"Idnrk\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Component Description\",\r\n\t\t\t\tproperty: \"ComponentDes\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Quantity\",\r\n\t\t\t\tproperty: \"Menge\",\r\n\t\t\t\ttype: EdmType.Number\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"UOM\",\r\n\t\t\t\tproperty: \"Meins\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Asm\",\r\n\t\t\t\tproperty: \"Stlkz\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Sls\",\r\n\t\t\t\tproperty: \"SIs\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Valid From\",\r\n\t\t\t\tproperty: \"Datuv\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Valid To\",\r\n\t\t\t\tproperty: \"Datub\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Change No\",\r\n\t\t\t\tproperty: \"ChangeNo\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Phantom Item\",\r\n\t\t\t\tproperty: \"Dumps\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Sort String\",\r\n\t\t\t\tproperty: \"Sortf\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Item ID\",\r\n\t\t\t\tproperty: \"Stvkn\", // changed by sabarish Itmid -> Stvkn 15-12-2025\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Change No To\",\r\n\t\t\t\tproperty: \"ChangeNoto\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Group\",\r\n\t\t\t\tproperty: \"Grp\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Fixed Quantity\",\r\n\t\t\t\tproperty: \"Fmeng\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Long Text\",\r\n\t\t\t\tproperty: \"LngText\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Segment Maintained\",\r\n\t\t\t\tproperty: \"SegMaintain\",\r\n\t\t\t\ttype: EdmType.Boolean\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Seg Value\",\r\n\t\t\t\tproperty: \"SegValue\",\r\n\t\t\t\ttype: EdmType.String\r\n\t\t\t}];\r\n\t\t\tvar oSettings = {\r\n\t\t\t\tworkbook: {\r\n\t\t\t\t\tcolumns: aCols\r\n\t\t\t\t},\r\n\t\t\t\tdataSource: aFilteredRows,\r\n\t\t\t\tfileName: \"BOM_Download.xlsx\"\r\n\t\t\t};\r\n\r\n\t\t\tvar oSpreadsheet = new Spreadsheet(oSettings);\r\n\t\t\toSpreadsheet.build().finally(function() {\r\n\t\t\t\toSpreadsheet.destroy();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t});\r\n\r\n});",
		"MANAGED_RECIPE/controller/reci_operations.controller.js": "sap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n], function(Controller, ErrorHandler, FilterOperator, Filter, formatter, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tvar i18n;\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.reci_operations\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\tonInit: function() {\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\tthis.f4Cache = {};\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"reci_operations\").attachPatternMatched(this.fnRouter, this);\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------\r\n\t\t//\t\t\t\tInitial Function logic when page load \r\n\t\t//*-----------------------------------------------------------------------------\r\n\t\tfnRouter: function() {\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar that = this;\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_UserModel\");\r\n\t\t\t\t\tthat.UserName = oData.results[0].Uname;\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").removeStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").addStyleClass(\"cl_list_con\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").addStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").removeStyleClass(\"cl_list_con\");\r\n\r\n\t\t\tvar oKeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\tvar oGobalOperationmodel = this.getOwnerComponent().getModel(\"JM_Operation\");\r\n\t\t\tvar oRecipeModel = this.getOwnerComponent().getModel(\"JM_Recipe\");\r\n\t\t\tif (Object.keys(oKeyDataModel.getData() || {}).length > 0 && Object.keys(oRecipeModel.getData() || {}).length > 0) {\r\n\t\t\t\tif (Object.keys(oGobalOperationmodel.getData() || {}).length > 0) {\r\n\t\t\t\t\tvar vKeyData = oKeyDataModel.getData();\r\n\t\t\t\t\tvar lkeyDataModel = new sap.ui.model.json.JSONModel(vKeyData);\r\n\t\t\t\t\tthis.getView().setModel(lkeyDataModel, \"JM_KeydataModel\"); // local model for the Key data \r\n\t\t\t\t\tthis.AppId = this.getOwnerComponent().getModel(\"JM_KeyData\").getProperty(\"/AppId\");\r\n\r\n\t\t\t\t\tvar vRecipeData = oRecipeModel.getData();\r\n\t\t\t\t\tvar lRecipeModel = new sap.ui.model.json.JSONModel(vRecipeData);\r\n\t\t\t\t\tthis.getView().setModel(lRecipeModel, \"JM_RecipeData\"); // local model for the Recipe Data\r\n\r\n\t\t\t\t\tvar GlobaldescModel = sap.ui.getCore().getModel(\"JM_DescriptionModel\");\r\n\t\t\t\t\tvar oFromUwl = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\t\t\tif (GlobaldescModel && Object.keys(oFromUwl.getData() || {}).length > 0) {\r\n\t\t\t\t\t\tvar descData = GlobaldescModel.getData();\r\n\t\t\t\t\t\tvar descModel = new sap.ui.model.json.JSONModel(descData);\r\n\t\t\t\t\t\tthis.getView().setModel(descModel, \"JM_DescriptionModel\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.Bmsch) {\r\n\t\t\t\t\t\tthis.Bmsch = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Bmsch\");\r\n\t\t\t\t\t\tthis.Meinh = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Plnme\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (this.Bmsch !== this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Bmsch\") ||\r\n\t\t\t\t\t\t\tthis.Meinh !== this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Plnme\")) {\r\n\t\t\t\t\t\t\tthis.fnUpdateBaseQuantiy();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.fnInitilizeTableRevApr();\r\n\t\t\t\t\tthis.fnInitializeScreen();\r\n\r\n\t\t\t\t\tif (this.Ind === \"D\" || this.Ind === \"T\") {\r\n\t\t\t\t\t\tthis.getView().byId(\"changelog\").setVisible(false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\t\tvar Appid = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Appid\");\r\n\t\t\t\t\tif (Object.keys(oChangeLogModel.getData() || {}).length > 0) {\r\n\t\t\t\t\t\t// Get data and create a deep copy\r\n\t\t\t\t\t\tvar existingData = oChangeLogModel ? JSON.parse(JSON.stringify(oChangeLogModel.getData())) : [];\r\n\t\t\t\t\t\tthis.OrgChangeLog = JSON.parse(JSON.stringify(existingData));\r\n\t\t\t\t\t\t// Check if model has some data and AppId === \"RX\"\r\n\t\t\t\t\t\tif (existingData && existingData.length > 0 && Appid === \"RX\") {\r\n\t\t\t\t\t\t\tthis.fnsetIndicationforChangedData(existingData);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.OrgChangeLog = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.fnSetUserField();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (oKeyDataModel && oRecipeModel) {\r\n\t\t\t\t\t\tvKeyData = oKeyDataModel.getData();\r\n\t\t\t\t\t\tlkeyDataModel = new sap.ui.model.json.JSONModel(vKeyData);\r\n\t\t\t\t\t\tthis.getView().setModel(lkeyDataModel, \"JM_KeydataModel\"); // local model for the Key data \r\n\r\n\t\t\t\t\t\tvRecipeData = oRecipeModel.getData();\r\n\t\t\t\t\t\tlRecipeModel = new sap.ui.model.json.JSONModel(vRecipeData);\r\n\t\t\t\t\t\tthis.getView().setModel(lRecipeModel, \"JM_RecipeData\"); // local model for the Recipe Data\r\n\t\t\t\t\t\tthis.AppId = this.getOwnerComponent().getModel(\"JM_KeyData\").getProperty(\"/AppId\");\r\n\r\n\t\t\t\t\t\tthis.fnCreateTenRowData();\r\n\t\t\t\t\t\tthis.fnSetUserField();\r\n\t\t\t\t\t\tthis.getView().byId(\"id_title\").setText(i18n.getText(\"opeartionTitle\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnHighlightinputfield: function(ChangedData) {\r\n\t\t\t// Loop through filtered data and highlight the matching controls\r\n\t\t\tChangedData.forEach(function(item) {\r\n\t\t\t\tvar sFieldId = item.FieldId; // get FieldId from each object\r\n\t\t\t\tif (sFieldId) {\r\n\t\t\t\t\t// Find the control using the FieldId\r\n\t\t\t\t\tvar oControl = this.byId(sFieldId);\r\n\t\t\t\t\t// Add highlight class if control exists\r\n\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\toControl.addStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)); // keep controller context\r\n\t\t},\r\n\r\n\t\tfnsetIndicationforChangedData: function(ChangedData) {\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar oTable = this.getView().byId(\"id_OperationTable\");\r\n\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tvar aChangeLogData = oChangeLogModel ? oChangeLogModel.getData() : [];\r\n\t\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0) {\r\n\t\t\t\t\tvar aChangedItems = aChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ProcessInd === \"O\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar aChangedItemNos = aChangedItems\r\n\t\t\t\t\t\t.filter(function(oItem) {\r\n\t\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.map(function(oItem) {\r\n\t\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Apply row-level highlight using RowSettings\r\n\t\t\t\t\toTable.setRowSettingsTemplate(\r\n\t\t\t\t\t\tnew sap.ui.table.RowSettings({\r\n\t\t\t\t\t\t\thighlight: {\r\n\t\t\t\t\t\t\t\tpath: \"JM_ReciOperations>Vornr\",\r\n\t\t\t\t\t\t\t\tformatter: function(sPosnr) {\r\n\t\t\t\t\t\t\t\t\tif (aChangedItemNos.includes(sPosnr)) {\r\n\t\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.Indication06; // Highlight color\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.None;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnClearChangeLog: function() {\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tvar aChangeLogData = oChangeLogModel ? oChangeLogModel.getData() : [];\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\t\t\tvar oContextModel = oComponent.getModel(\"JM_ContextModel\");\r\n\t\t\tvar oUwlData = oContextModel.getData() || {};\r\n\r\n\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0 && oUwlData.Appid === \"RX\") {\r\n\t\t\t\toTable.getRows().forEach(function(oRow) {\r\n\t\t\t\t\toRow.removeStyleClass(\"cl_HighLightRow\");\r\n\t\t\t\t\toRow.getCells().forEach(function(oCell) {\r\n\t\t\t\t\t\toCell.removeStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// if (!oChangeLogModel) {\r\n\t\t\t// \toChangeLogModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t// \tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t// }\r\n\t\t\t// if (this.OrgChangeLog) {\r\n\t\t\t// \toChangeLogModel.setData(this.OrgChangeLog);\r\n\t\t\t// }\r\n\t\t},\r\n\r\n\t\tfnCreateTenRowData: function() {\r\n\t\t\tthis.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tthis.Werks = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\");\r\n\t\t\tthis.getView().getModel(\"JM_RecipeData\");\r\n\r\n\t\t\t//Don't update Base quantity if the Resouce is present in the table and check the this.Bmsch is not equal\r\n\t\t\tif (!this.Bmsch) {\r\n\t\t\t\tthis.Bmsch = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Bmsch\");\r\n\t\t\t\tthis.Meinh = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Plnme\");\r\n\t\t\t} else {\r\n\t\t\t\tif (this.Bmsch !== this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Bmsch\") ||\r\n\t\t\t\t\tthis.Meinh !== this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Plnme\")) {\r\n\t\t\t\t\tthis.fnUpdateBaseQuantiy();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Create the JSON model\r\n\t\t\tvar oOperationModel = new sap.ui.model.json.JSONModel();\r\n\r\n\t\t\t// Create editable model\r\n\t\t\tvar oEditableModel = new sap.ui.model.json.JSONModel();\r\n\t\t\tvar editableData = {};\r\n\r\n\t\t\t// Load 10 data for Vornr table\r\n\t\t\tvar tableData = [];\r\n\t\t\tvar currentDate = new Date();\r\n\t\t\tvar endDate = new Date(9999, 11, 31); // 31.12.9999\r\n\t\t\tfor (var i = 1; i <= 10; i++) {\r\n\t\t\t\tvar vornr = (i * 10).toString().padStart(4, \"0\"); // Generates 0010, 0020, ...\r\n\t\t\t\ttableData.push({\r\n\t\t\t\t\tVornr: vornr, //operation\r\n\t\t\t\t\tPhflg: false, //phase\r\n\t\t\t\t\tPvznr: \"\", //sup_operation\r\n\t\t\t\t\tPhseq: \"\", //Destination\r\n\t\t\t\t\tArbpl: \"\", //Resource\r\n\t\t\t\t\tSteus: \"PI01\", //control key\r\n\t\t\t\t\tTxtkz: false,\r\n\t\t\t\t\tKtsch: \"\",\r\n\t\t\t\t\tLtxa1: \"\",\r\n\t\t\t\t\tTxtsp: \"\",\r\n\t\t\t\t\tCkselkz: \"X\",\r\n\t\t\t\t\tKlakz: false,\r\n\t\t\t\t\tBezkz: false,\r\n\t\t\t\t\tBmsch: this.Bmsch, //Base Quantity\r\n\t\t\t\t\tMeinh: this.Meinh, // Unit of Measures\r\n\t\t\t\t\tVgw01: \"\",\r\n\t\t\t\t\tVge01: \"\",\r\n\t\t\t\t\tLar01: \"\",\r\n\t\t\t\t\tVgw02: \"\",\r\n\t\t\t\t\tVge02: \"\",\r\n\t\t\t\t\tLar02: \"\",\r\n\t\t\t\t\tVgw03: \"\",\r\n\t\t\t\t\tVge03: \"\",\r\n\t\t\t\t\tLar03: \"\",\r\n\t\t\t\t\tVgw04: \"\",\r\n\t\t\t\t\tVge04: \"\",\r\n\t\t\t\t\tLar04: \"\",\r\n\t\t\t\t\tVgw05: \"\",\r\n\t\t\t\t\tVge05: \"\",\r\n\t\t\t\t\tLar05: \"\",\r\n\t\t\t\t\tVgw06: \"\",\r\n\t\t\t\t\tVge06: \"\",\r\n\t\t\t\t\tLar06: \"\",\r\n\t\t\t\t\tDdehn: false,\r\n\t\t\t\t\tWerks: this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\"), //Plant\r\n\t\t\t\t\tAennr: \"\", // Change Number\r\n\t\t\t\t\tDatuv: currentDate, //valid from\r\n\t\t\t\t\tDatub: endDate, // valid to\r\n\t\t\t\t\tUmrez: this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Umrez\"), // charge Quantity\r\n\t\t\t\t\tUmren: this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Umren\"), // Operation Quantity\r\n\t\t\t\t\tUsr00: \"\", // user fields\r\n\t\t\t\t\tUsr01: \"\", // user fields\r\n\t\t\t\t\tUsr02: \"\",\r\n\t\t\t\t\tUsr03: \"\",\r\n\t\t\t\t\tUsr04: \"\",\r\n\t\t\t\t\tUse04: \"\",\r\n\t\t\t\t\tUsr05: \"\",\r\n\t\t\t\t\tUse05: \"\",\r\n\t\t\t\t\tUsr06: \"\",\r\n\t\t\t\t\tUse06: \"\",\r\n\t\t\t\t\tUsr07: \"\",\r\n\t\t\t\t\tUse07: \"\",\r\n\t\t\t\t\tUsr08: \"\",\r\n\t\t\t\t\tUsr09: \"\",\r\n\t\t\t\t\tUsr10: false,\r\n\t\t\t\t\tUsr11: false,\r\n\t\t\t\t\tSlwid: \"\", //Key word ID for user-defined fields\r\n\t\t\t\t\tLoanz: \"\",\r\n\t\t\t\t\tLoart: \"\",\r\n\t\t\t\t\tLogrp: \"\",\r\n\t\t\t\t\tRsanz: \"\",\r\n\t\t\t\t\tPrz01: \"\",\r\n\t\t\t\t\tRasch: \"\",\r\n\t\t\t\t\tRfgrp: \"\",\r\n\t\t\t\t\tRfsch: \"\",\r\n\t\t\t\t\tQlkapar: \"\",\r\n\t\t\t\t\tAnzma: \"\",\r\n\t\t\t\t\tQpart: \"\",\r\n\t\t\t\t\tInfnr: \"\",\r\n\t\t\t\t\tEkorg: \"\",\r\n\t\t\t\t\tEbeln: \"\",\r\n\t\t\t\t\tEbelp: \"\",\r\n\t\t\t\t\tSortl: \"\",\r\n\t\t\t\t\tPlifz: \"\",\r\n\t\t\t\t\tMatkl: \"\",\r\n\t\t\t\t\tEkgrp: \"\",\r\n\t\t\t\t\tLifnr: \"\",\r\n\t\t\t\t\tPeinh: \"\",\r\n\t\t\t\t\tSakto: \"\",\r\n\t\t\t\t\tFrdlb: false,\r\n\t\t\t\t\tPreis: \"\",\r\n\t\t\t\t\tWaers: \"\",\r\n\t\t\t\t\tQlSearch: \"\",\r\n\t\t\t\t\tQsel1: true,\r\n\t\t\t\t\tQsel2: false,\r\n\t\t\t\t\tQsel3: false,\r\n\t\t\t\t\tVgtl1: \"\",\r\n\t\t\t\t\tVgtl2: \"\",\r\n\t\t\t\t\tVgtl3: \"\",\r\n\t\t\t\t\tVgtl4: \"\",\r\n\t\t\t\t\tVgtl5: \"\",\r\n\t\t\t\t\tVgtl6: \"\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\teditableData[vornr] = {\r\n\t\t\t\t\tVornr: \"nonEdit\", // Opeartion\r\n\t\t\t\t\tPhflg: \"Edit\", //phase\r\n\t\t\t\t\tPvznr: \"Edit\", //sup_operation\r\n\t\t\t\t\tPhseq: \"Edit\", //Destination\r\n\t\t\t\t\tArbpl: \"Edit\", //Resource\r\n\t\t\t\t\tCkselkz: \"nonEdit\", // Relevany to costing\r\n\t\t\t\t\tDdehn: \"nonEdit\", //flex\r\n\t\t\t\t\tMeinh: \"Edit\",\r\n\t\t\t\t\tBmsch: \"Edit\",\r\n\t\t\t\t\tKtsch: \"Edit\",\r\n\t\t\t\t\tLtxa1: \"Edit\",\r\n\t\t\t\t\tSteus: \"Edit\",\r\n\t\t\t\t\tVgw01: \"nonEdit\",\r\n\t\t\t\t\tVge01: \"nonEdit\",\r\n\t\t\t\t\tLar01: \"nonEdit\",\r\n\t\t\t\t\tVgw02: \"nonEdit\",\r\n\t\t\t\t\tVge02: \"nonEdit\",\r\n\t\t\t\t\tLar02: \"nonEdit\",\r\n\t\t\t\t\tVgw03: \"nonEdit\",\r\n\t\t\t\t\tVge03: \"nonEdit\",\r\n\t\t\t\t\tLar03: \"nonEdit\",\r\n\t\t\t\t\tVgw04: \"nonEdit\",\r\n\t\t\t\t\tVge04: \"nonEdit\",\r\n\t\t\t\t\tLar04: \"nonEdit\",\r\n\t\t\t\t\tVgw05: \"nonEdit\",\r\n\t\t\t\t\tVge05: \"nonEdit\",\r\n\t\t\t\t\tLar05: \"nonEdit\",\r\n\t\t\t\t\tVgw06: \"nonEdit\",\r\n\t\t\t\t\tVge06: \"nonEdit\",\r\n\t\t\t\t\tLar06: \"nonEdit\"\r\n\t\t\t\t};\r\n\t\t\t\toOperationModel.setData({\r\n\t\t\t\t\tOperations: tableData\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oOperationModel, \"JM_ReciOperations\"); // local model for reci Operation data\r\n\t\t\t}\r\n\t\t\toEditableModel.setData(editableData);\r\n\t\t\tthis.getView().setModel(oEditableModel, \"JM_EditableModel\"); // local model for the editable non editable properties\r\n\t\t},\r\n\r\n\t\tfnSetUserField: function() {\r\n\t\t\t// 1. Create a new JSON model with default data\r\n\t\t\tvar Model = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tVisible: false\r\n\t\t\t});\r\n\r\n\t\t\t// 2. Assign it to the view with the name \"JM_UFTemplate\"\r\n\t\t\tthis.getView().setModel(Model, \"JM_UFTemplate\");\r\n\r\n\t\t\t//Call entity for User Fields\r\n\t\t\tvar oInitiator = this.getOwnerComponent().getModel();\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tMatnr: this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Matnr\"),\r\n\t\t\t\tInd: \"G\"\r\n\t\t\t};\r\n\t\t\toPayload.NavRecipeBasic = [];\r\n\t\t\toPayload.NavRecipeComments = [];\r\n\t\t\toPayload.NavRecipeAttachment = [];\r\n\t\t\toPayload.NavUserInput = [];\r\n\t\t\tbusyDialog.open();\r\n\t\t\toInitiator.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData && oData.NavUserInput && oData.NavUserInput.results && oData.NavUserInput.results.length > 0) {\r\n\t\t\t\t\t\tvar oUserFieldRes = oData.NavUserInput.results;\r\n\t\t\t\t\t\tvar oUFModel = [];\r\n\t\t\t\t\t\tthis.oUFVisibleModel = {};\r\n\t\t\t\t\t\toUFModel.push({\r\n\t\t\t\t\t\t\tKey: \"\",\r\n\t\t\t\t\t\t\ttext: \" \"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfor (var j = 0; j < oUserFieldRes.length; j++) {\r\n\t\t\t\t\t\t\tvar data = oUserFieldRes[j];\r\n\t\t\t\t\t\t\tvar oCreaterUF = {\r\n\t\t\t\t\t\t\t\tKey: data.Slwid,\r\n\t\t\t\t\t\t\t\ttext: data.Ktext\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\toUFModel.push(oCreaterUF);\r\n\t\t\t\t\t\t\tthis.oUFVisibleModel[data.Slwid] = {\r\n\t\t\t\t\t\t\t\tSwrt0: data.Swrt0,\r\n\t\t\t\t\t\t\t\tSwrt1: data.Swrt1,\r\n\t\t\t\t\t\t\t\tSwrt2: data.Swrt2,\r\n\t\t\t\t\t\t\t\tSwrt3: data.Swrt3,\r\n\t\t\t\t\t\t\t\tSwrt4: data.Swrt4,\r\n\t\t\t\t\t\t\t\tSwrt5: data.Swrt5,\r\n\t\t\t\t\t\t\t\tSwrt6: data.Swrt6,\r\n\t\t\t\t\t\t\t\tSwrt7: data.Swrt7,\r\n\t\t\t\t\t\t\t\tSwrt8: data.Swrt8,\r\n\t\t\t\t\t\t\t\tSwrt9: data.Swrt9,\r\n\t\t\t\t\t\t\t\tSwrt10: data.Swrt10,\r\n\t\t\t\t\t\t\t\tSwrt11: data.Swrt11\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar UFJsonModel = new sap.ui.model.json.JSONModel(oUFModel);\r\n\t\t\t\t\t\tthis.getView().setModel(UFJsonModel, \"JM_UFModel\"); // local model\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// Reviwer Logic to set the table field \r\n\t\tfnInitilizeTableRevApr: function() {\r\n\t\t\tvar oGlobalOperationdata = this.getOwnerComponent().getModel(\"JM_Operation\");\r\n\t\t\tvar Ind = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Ind\");\r\n\t\t\tthis.Werks = this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\");\r\n\t\t\tvar tableData = [];\r\n\t\t\tvar editableData = {};\r\n\r\n\t\t\t// Create the JSON model\r\n\t\t\tvar oOperationModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t// Create editable model\r\n\t\t\tvar oEditableModel = new sap.ui.model.json.JSONModel();\r\n\r\n\t\t\tvar OpeartionData = JSON.parse(JSON.stringify(oGlobalOperationdata.getData().NavRecipe_Operation));\r\n\t\t\tfor (var i = 0; i < OpeartionData.length; i++) {\r\n\r\n\t\t\t\tOpeartionData[i].Klakz = (OpeartionData[i].Klakz === \"X\") ? true : false;\r\n\t\t\t\tOpeartionData[i].Qsel1 = (OpeartionData[i].Qsel1 === \"X\") ? true : false;\r\n\t\t\t\tOpeartionData[i].Qsel2 = (OpeartionData[i].Qsel2 === \"X\") ? true : false;\r\n\t\t\t\tOpeartionData[i].Qsel3 = (OpeartionData[i].Qsel3 === \"X\") ? true : false;\r\n\t\t\t\tOpeartionData[i].Frdlb = (OpeartionData[i].Frdlb === \"X\") ? true : false;\r\n\r\n\t\t\t\ttableData.push(OpeartionData[i]);\r\n\t\t\t\tif (OpeartionData[i].Phflg === true) {\r\n\t\t\t\t\teditableData[OpeartionData[i].Vornr] = {\r\n\t\t\t\t\t\tVornr: \"nonEdit\", // Opeartion\r\n\t\t\t\t\t\tPhflg: \"Edit\", //phase\r\n\t\t\t\t\t\tPvznr: \"Edit\", //sup_operation\r\n\t\t\t\t\t\tPhseq: \"Edit\", //Destination\r\n\t\t\t\t\t\tArbpl: \"nonEdit\", //Resource\r\n\t\t\t\t\t\tCkselkz: \"Edit\", // Relevany to costing\r\n\t\t\t\t\t\tDdehn: \"Edit\", //flex\r\n\t\t\t\t\t\tLtxa1: \"Edit\",\r\n\t\t\t\t\t\tMeinh: \"Edit\",\r\n\t\t\t\t\t\tBmsch: \"Edit\",\r\n\t\t\t\t\t\tKtsch: \"Edit\",\r\n\t\t\t\t\t\tSteus: \"Edit\",\r\n\t\t\t\t\t\tVgw01: \"Edit\",\r\n\t\t\t\t\t\tVge01: \"Edit\",\r\n\t\t\t\t\t\tLar01: \"Edit\",\r\n\t\t\t\t\t\tVgw02: \"Edit\",\r\n\t\t\t\t\t\tVge02: \"Edit\",\r\n\t\t\t\t\t\tLar02: \"Edit\",\r\n\t\t\t\t\t\tVgw03: \"Edit\",\r\n\t\t\t\t\t\tVge03: \"Edit\",\r\n\t\t\t\t\t\tLar03: \"Edit\",\r\n\t\t\t\t\t\tVgw04: \"Edit\",\r\n\t\t\t\t\t\tVge04: \"Edit\",\r\n\t\t\t\t\t\tLar04: \"Edit\",\r\n\t\t\t\t\t\tVgw05: \"Edit\",\r\n\t\t\t\t\t\tVge05: \"Edit\",\r\n\t\t\t\t\t\tLar05: \"Edit\",\r\n\t\t\t\t\t\tVgw06: \"Edit\",\r\n\t\t\t\t\t\tVge06: \"Edit\",\r\n\t\t\t\t\t\tLar06: \"Edit\"\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditableData[OpeartionData[i].Vornr] = {\r\n\t\t\t\t\t\tVornr: \"nonEdit\", // Opeartion\r\n\t\t\t\t\t\tPhflg: \"nonEdit\", //phase\r\n\t\t\t\t\t\tPvznr: \"nonEdit\", //sup_operation\r\n\t\t\t\t\t\tPhseq: \"nonEdit\", //Destination\r\n\t\t\t\t\t\tArbpl: \"Edit\", //Resource\r\n\t\t\t\t\t\tDdehn: \"nonEdit\", //flex\r\n\t\t\t\t\t\tVgw01: \"nonEdit\",\r\n\t\t\t\t\t\tVge01: \"nonEdit\",\r\n\t\t\t\t\t\tLar01: \"nonEdit\",\r\n\t\t\t\t\t\tVgw02: \"nonEdit\",\r\n\t\t\t\t\t\tLtxa1: \"Edit\",\r\n\t\t\t\t\t\tMeinh: \"Edit\",\r\n\t\t\t\t\t\tBmsch: \"Edit\",\r\n\t\t\t\t\t\tSteus: \"Edit\",\r\n\t\t\t\t\t\tKtsch: \"Edit\",\r\n\t\t\t\t\t\tCkselkz: \"nonEdit\", // Relevany to costing\r\n\t\t\t\t\t\tVge02: \"nonEdit\",\r\n\t\t\t\t\t\tLar02: \"nonEdit\",\r\n\t\t\t\t\t\tVgw03: \"nonEdit\",\r\n\t\t\t\t\t\tVge03: \"nonEdit\",\r\n\t\t\t\t\t\tLar03: \"nonEdit\",\r\n\t\t\t\t\t\tVgw04: \"nonEdit\",\r\n\t\t\t\t\t\tVge04: \"nonEdit\",\r\n\t\t\t\t\t\tLar04: \"nonEdit\",\r\n\t\t\t\t\t\tVgw05: \"nonEdit\",\r\n\t\t\t\t\t\tVge05: \"nonEdit\",\r\n\t\t\t\t\t\tLar05: \"nonEdit\",\r\n\t\t\t\t\t\tVgw06: \"nonEdit\",\r\n\t\t\t\t\t\tVge06: \"nonEdit\",\r\n\t\t\t\t\t\tLar06: \"nonEdit\"\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\toOperationModel.setData({\r\n\t\t\t\t\tOperations: tableData\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(oOperationModel, \"JM_ReciOperations\"); // local model setting for recipe Operation\r\n\t\t\t\t// Deep copy to avoid reference sharing\r\n\t\t\t\tvar oOperationCopy = new sap.ui.model.json.JSONModel(\r\n\t\t\t\t\tJSON.parse(JSON.stringify(oOperationModel.getData()))\r\n\t\t\t\t);\r\n\r\n\t\t\t\tvar oOriginalData = this.getOwnerComponent()\r\n\t\t\t\t\t.getModel(\"JM_InitialDatas\")\r\n\t\t\t\t\t.getProperty(\"/NavRecipe_Operation/results\");\r\n\t\t\t\t// Create a deep copy (completely independent of the source)\r\n\t\t\t\toOperationCopy = JSON.parse(JSON.stringify({\r\n\t\t\t\t\tOperations: oOriginalData\r\n\t\t\t\t}));\r\n\r\n\t\t\t\t// Set it as a separate model (unlinked to the original)\r\n\t\t\t\tvar oNewModel = new sap.ui.model.json.JSONModel(oOperationCopy);\r\n\t\t\t\tthis.getView().setModel(oNewModel, \"JM_OperationInitialModel\");\r\n\t\t\t}\r\n\r\n\t\t\toEditableModel.setData(editableData);\r\n\t\t\tthis.getView().setModel(oEditableModel, \"JM_EditableModel\"); // local editable model \r\n\r\n\t\t\tif (OpeartionData.length === 0) {\r\n\t\t\t\tthis.fnCreateTenRowData();\r\n\t\t\t} else {\r\n\t\t\t\tif (Ind !== \"T\") {\r\n\t\t\t\t\tvar rowLength = 10 - OpeartionData.length;\r\n\t\t\t\t\tfor (var j = 0; j < rowLength; j++) {\r\n\t\t\t\t\t\tthis.fnAddRow();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Ind === \"T\") {\r\n\t\t\t\t\t\tthis.fnMakaAllnonEdit();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnMakaAllnonEdit: function() {\r\n\t\t\tvar oEditableModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\tvar oData = oEditableModel.getData();\r\n\r\n\t\t\tfor (var sKey in oData) {\r\n\t\t\t\tif (oData.hasOwnProperty(sKey)) {\r\n\t\t\t\t\tvar oInnerObj = oData[sKey];\r\n\t\t\t\t\tfor (var sField in oInnerObj) {\r\n\t\t\t\t\t\tif (oInnerObj.hasOwnProperty(sField)) {\r\n\t\t\t\t\t\t\toInnerObj[sField] = \"nonEdit\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\toEditableModel.refresh(true);\r\n\t\t},\r\n\r\n\t\t// upadte base quantity column without any created data\r\n\t\tfnUpdateBaseQuantiy: function() {\r\n\t\t\tvar oOperationModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oData = oOperationModel.getData().Operations; // Access Operations array\r\n\t\t\tvar newBmsch = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Bmsch\");\r\n\t\t\tvar newMeinh = this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Plnme\");\r\n\t\t\tthis.Bmsch = newBmsch;\r\n\t\t\tthis.Meinh = newMeinh;\r\n\t\t\toData.forEach(function(aData) {\r\n\t\t\t\tif (aData.Arbpl === \"\") {\r\n\t\t\t\t\taData.Bmsch = newBmsch; // update base quantity\r\n\t\t\t\t\taData.Meinh = newMeinh; // update base quantity\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// refresh model to reflect changes in UI\r\n\t\t\toOperationModel.refresh(true);\r\n\t\t},\r\n\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\t\t//\t\tFunction for F4 Event (added by sabarish babu 07-10-2025)\r\n\t\t// *-------------------------------------------------------------------------------------\r\n\r\n\t\t// view F4 press function trigger\r\n\t\tfnF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.parentId = oEvent.getSource().getParent();\r\n\t\t\tvar vMaintainedId = id.split(\"-\")[0];\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar sModelName = oBindInfo.parts[0].model;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\r\n\t\t\tif (!sModelName || !sFieldPath || !oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\tvar sFullPath = sRowPath + \"/\" + sFieldPath; // full path to update value\r\n\r\n\t\t\tthis.Vornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Vornr\");\r\n\t\t\tthis.selectedF4path = sFullPath;\r\n\t\t\tthis.ModelName = sModelName;\r\n\t\t\tif (this.selectedField.split(\"-\")[0] === \"ID_OPER_KTSCH\") {\r\n\t\t\t\tvar vResource = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Arbpl\");\r\n\t\t\t\tif (vResource === \"\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"EnterResource\"), \"Error\", this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.bindTextF4model(\"P\", vMaintainedId, \"X\", oEvent);\r\n\t\t},\r\n\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar item = oContext.getProperty(\"col1\"); // Value (e.g., 'IN')\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\");\r\n\r\n\t\t\tif (this.fragmentFlag) {\r\n\t\t\t\tthis.f4fragItempress(this.selectedField, item, item1);\r\n\t\t\t\tthis.fragmentFlag = false;\r\n\t\t\t\tthis.fnAfterCloseFragment();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.getView().byId(this.selectedField).setValue(item);\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\r\n\t\t\tif (this.selectedField.split(\"-\")[0] === \"ID_OPER_ARBPL\") {\r\n\t\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\t\tthis.getView().byId(this.selectedField).setValueStateText(\"\");\r\n\t\t\t\tthis.fnResourceItemPress(item);\r\n\t\t\t\tthis.fnClearErrorState(this.selectedF4path.split(\"/\").slice(0, -1).join(\"/\"), this.selectedF4path);\r\n\t\t\t}\r\n\t\t\tif (this.selectedField.split(\"-\")[0] === \"ID_OPER_PHSEQ\") {\r\n\t\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\t\tthis.getView().byId(this.selectedField).setValueStateText(\"\");\r\n\t\t\t\tthis.fndestinationItemPress();\r\n\t\t\t\tthis.fnClearErrorState(this.selectedF4path.split(\"/\").slice(0, -1).join(\"/\"), this.selectedF4path);\r\n\t\t\t}\r\n\t\t\tif (this.selectedField.split(\"-\")[0] === \"ID_OPER_KTSCH\") {\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\tvar selectedpath = this.selectedF4path.substring(0, this.selectedF4path.lastIndexOf(\"/\"));\r\n\t\t\t\t\toModel.setProperty(selectedpath + \"/Ltxa1\", item1);\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar vtriggeredCell = this.selectedF4path;\r\n\t\t\t\tvar sRowPath = vtriggeredCell.substring(0, vtriggeredCell.lastIndexOf(\"/\"));\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, item);\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\t// fragment F4 press trigger\r\n\t\tfnFragF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = oEvent.getSource().getId();\r\n\t\t\tthis.fragmentFlag = true;\r\n\t\t\tif (id === \"ID_OPER_INFNR_F\") {\r\n\t\t\t\tthis.bindTextF4model(\"P\", id, \"X\", oEvent);\r\n\t\t\t} else {\r\n\t\t\t\tthis.bindTextF4model(\"P\", id, \"X\", oEvent);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tf4fragItempress: function(id, val, desc) {\r\n\t\t\tvar inputField = this.getView().byId(id);\r\n\t\t\tvar descField = this.getView().byId(id + \"_DES\");\r\n\t\t\tif (descField) {\r\n\t\t\t\tinputField.setValue(val);\r\n\t\t\t\tdescField.setValue(desc);\r\n\t\t\t} else {\r\n\t\t\t\tinputField.setValue(val);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.selectedField.split(\"--\")[1] === \"ID_OPER_INFNR_F\") {\r\n\t\t\t\tthis.getView().byId(\"ID_OPER_EKORG_F\").setValue(desc);\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_EKORG_F\", desc);\r\n\t\t\t\t}\r\n\t\t\t\tthis.fnCallBackenUpdateInfoRec(val, desc);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.selectedField.split(\"--\")[1] === \"ID_OPER_EBELP_F\") {\r\n\t\t\t\tthis.getView().byId(\"ID_OPER_EBELN_F\").setValue(desc);\r\n\t\t\t}\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangeLogforFragment(id.split(\"--\")[1], val);\r\n\t\t\t}\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\r\n\t\t\tthis.selectedField = undefined;\r\n\t\t},\r\n\r\n\t\tfnCallBackenUpdateInfoRec: function(Infnr, Ekorg) {\r\n\t\t\tvar servicecall = this.getOwnerComponent().getModel();\r\n\t\t\tvar oPayload = {};\r\n\t\t\toPayload.Ind = \"T\";\r\n\t\t\toPayload.NavRecipe_Operation = [{\r\n\t\t\t\tWerks: this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\"),\r\n\t\t\t\tInfnr: Infnr,\r\n\t\t\t\tEkorg: Ekorg\r\n\t\t\t}];\r\n\t\t\toPayload.NavDescription = [];\r\n\t\t\tservicecall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar result = oData.NavRecipe_Operation.results[0];\r\n\t\t\t\t\tvar Description = oData.NavDescription.results;\r\n\t\t\t\t\tvar DialogOperationModel = this.getView().getModel(\"JM_ReciOperationsDialog\");\r\n\t\t\t\t\tif (DialogOperationModel) {\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Sortl\", result.Sortl);\r\n\t\t\t\t\t\tif (result.Sortl !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_SORTL_F\", result.Sortl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Matkl\", result.Matkl);\r\n\t\t\t\t\t\tif (result.Matkl !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_MATKL_F\", result.Matkl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Ekgrp\", result.Ekgrp);\r\n\t\t\t\t\t\tif (result.Ekgrp !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_EKGRP_F\", result.Ekgrp);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Lifnr\", result.Lifnr);\r\n\t\t\t\t\t\tif (result.Lifnr !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_LIFNR_F\", result.Lifnr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Plifz\", result.Plifz);\r\n\t\t\t\t\t\tif (result.Plifz !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_PLIFZ_F\", result.Plifz);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Peinh\", result.Peinh);\r\n\t\t\t\t\t\tif (result.Peinh !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_PEINH_F\", result.Peinh);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Preis\", result.Preis);\r\n\t\t\t\t\t\tif (result.Preis !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_PREIS_F\", result.Preis);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tDialogOperationModel.setProperty(\"/Waers\", result.Waers);\r\n\t\t\t\t\t\tif (result.Waers !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangeLogforFragment(\"ID_OPER_WAERS_F\", result.Waers);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < Description.length; i++) {\r\n\t\t\t\t\t\tvar id = \"ID_OPER_\" + Description[i].Fieldname + \"_F_DES\";\r\n\t\t\t\t\t\tthis.getView().byId(id).setValue(Description[i].Fielddesc);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t// update the resource value for created phase\r\n\t\tfnUpdateResourceforPhase: function(Vornr, value) {\r\n\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oData = oOperModel.getData(); // entire model data\r\n\t\t\tvar aOperations = oData.Operations; // the array of operations\r\n\t\t\tvar sIndex = [];\r\n\t\t\tif (aOperations && aOperations.length > 0) {\r\n\t\t\t\tfor (var i = 0; i < aOperations.length; i++) {\r\n\t\t\t\t\tvar operationData = aOperations[i];\r\n\t\t\t\t\tif (operationData.Pvznr === Vornr && operationData.Phflg === true) {\r\n\t\t\t\t\t\tvar sRowpath = \"/Operations/\" + i;\r\n\t\t\t\t\t\tvar triggeredCell = \"/Operations/\" + i + \"/Arbpl\";\r\n\r\n\t\t\t\t\t\tvar vArbpl = value;\r\n\t\t\t\t\t\toperationData.Arbpl = value;\r\n\t\t\t\t\t\tthis.fnClearErrorState(sRowpath, sRowpath + \"/Pvznr\");\r\n\t\t\t\t\t\tsIndex.push(i);\r\n\t\t\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\t\t\tthis.fnUpdateChangelog(sRowpath, triggeredCell, vArbpl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Set back only the Operations array\r\n\t\t\toOperModel.setProperty(\"/Operations\", aOperations);\r\n\r\n\t\t\tfor (var j = 0; j < sIndex.length; j++) {\r\n\t\t\t\tvar index = sIndex[j];\r\n\t\t\t\tsRowpath = \"/Operations/\" + index;\r\n\t\t\t\tthis.fngetStandardValue(sRowpath);\r\n\t\t\t\tthis.batch = true;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// to open the F4 fragment\r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\t// to close the F4 fragment\r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\t// F4 Search Field logic\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar aFilters = [];\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\t// to get the F4 data and bind to model\r\n\t\tbindTextF4model: function(SearchHelp, sitem, process, oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar vLength;\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar that = this;\r\n\t\t\tvar filter = [];\r\n\t\t\tthat.sitem = sitem;\r\n\t\t\t// var ftype = new Filter(\"F4Type\", FilterOperator.EQ, SearchHelp);\r\n\t\t\t// var sitem1 = new Filter(\"FieldId\", FilterOperator.EQ, sitem);\r\n\t\t\t// var process1 = new Filter(\"Process\", FilterOperator.EQ, process);\r\n\t\t\t// filter.push(ftype);\r\n\t\t\t// filter.push(sitem1);\r\n\t\t\t// filter.push(process1);\r\n\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\tvar omodel1 = that.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tbusyDialog.open();\r\n\t\t\tomodel1.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tfilters: filter,\r\n\t\t\t\tsuccess: function(odata, Response) {\r\n\t\t\t\t\tif(odata.MsgType === \"I\"){\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(odata.Message, \"Error\", that);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar aResults = odata.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\t\tif (that.selectedField.split(\"-\")[0] === \"ID_OPER_PHSEQ\") {\r\n\t\t\t\t\t\t\taResults = aResults.filter(function(item) {\r\n\t\t\t\t\t\t\t\treturn item.Value3 === that.Werks;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvLength = odata.NavSerchResult.results.length;\r\n\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//filter by plant for Destination field \r\n\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\tthat.getView().getModel(\"JM_F4Model\"); // local model\r\n\t\t\t\t\t\tvTitle = that.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\tfnReadf4Cache: function(vId, vValue, f4type, oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar match;\r\n\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\tif (f4type === \"P\" || f4type === \"X\") {\r\n\t\t\t\t\tif (that.selectedField === \"KID_RECI_MATNR\") {\r\n\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\treturn item.Value1.replace(/^0+/, \"\") === vValue.toUpperCase();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\treturn item.Value1 === vValue.toUpperCase();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\tif (!that.fragLiveChangeFlag) {\r\n\t\t\t\t\t\t\tif (that.selectedField && that.selectedField.split(\"-\")[0] === \"ID_OPER_KTSCH\" && that.oNextInput) {\r\n\t\t\t\t\t\t\t\tthat.oNextInput.setValue(match.Value2);\r\n\t\t\t\t\t\t\t\tthat.oNextInput = undefined;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar parts = vId.split(\"_\"); // split by underscore\r\n\t\t\t\t\t\t\t\tvar lastPart = parts[parts.length - 2]; // take the last part\r\n\t\t\t\t\t\t\t\tvar fieldname = lastPart.charAt(0) + lastPart.slice(1).toLowerCase() + \"Des\";\r\n\t\t\t\t\t\t\t\tvar oDialogModel = that.getView().getModel(\"JM_ReciOperationsDialog\");\r\n\t\t\t\t\t\t\t\tif (oDialogModel) {\r\n\t\t\t\t\t\t\t\t\toDialogModel.setProperty(\"/\" + fieldname, match.Value2);\r\n\t\t\t\t\t\t\t\t\toDialogModel.refresh(true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.getView().byId(vId).setValue(match.Value1);\r\n\t\t\t\t\t\t\tvar desField = that.getView().byId(vId + \"_DES\");\r\n\t\t\t\t\t\t\tif (desField) {\r\n\t\t\t\t\t\t\t\tdesField.setValue(match.Value2);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdesField.setValue(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparts = vId.split(\"_\"); // split by underscore\r\n\t\t\t\t\t\tlastPart = parts[parts.length - 2]; // take the last part\r\n\t\t\t\t\t\tfieldname = lastPart.charAt(0) + lastPart.slice(1).toLowerCase() + \"Des\";\r\n\t\t\t\t\t\tif (that.fragLiveChangeFlag) {\r\n\t\t\t\t\t\t\toDialogModel = that.getView().getModel(\"JM_ReciOperationsDialog\");\r\n\t\t\t\t\t\t\tif (oDialogModel) {\r\n\t\t\t\t\t\t\t\toDialogModel.setProperty(\"/\" + fieldname, \"\");\r\n\t\t\t\t\t\t\t\toDialogModel.refresh(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar length = that.fnCheckDatavalidation(vId, vValue);\r\n\t\t\t\tif (length === 0 && vValue !== \"\" && that.selectedField) {\r\n\t\t\t\t\tif (!that.fragLiveChangeFlag) {\r\n\t\t\t\t\t\tthat.fnSetErrorState(that.selectedF4path.split(\"/\").slice(0, -1).join(\"/\"), that.selectedF4path);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"Error\");\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueStateText(vValue + \" value is not Avalible\");\r\n\t\t\t\t\tthat.selectedField = undefined;\r\n\t\t\t\t\tthat.fragLiveChangeFlag = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (that.selectedField) {\r\n\t\t\t\t\t\tif (!that.fragLiveChangeFlag) {\r\n\t\t\t\t\t\t\tthat.fnClearErrorState(that.selectedF4path.split(\"/\").slice(0, -1).join(\"/\"), that.selectedF4path);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"None\");\r\n\t\t\t\t\t\tthat.fragLiveChangeFlag = false;\r\n\t\t\t\t\t\tthat.selectedField = undefined;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// get Description from Backend\r\n\t\tf4descriptionGet: function(vId, value, f4type, fnCallback) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar filter;\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\r\n\t\t\t// filter = [\r\n\t\t\t// \tnew sap.ui.model.Filter(\"F4Type\", sap.ui.model.FilterOperator.EQ, f4type),\r\n\t\t\t// \tnew sap.ui.model.Filter(\"FieldId\", sap.ui.model.FilterOperator.EQ, vId),\r\n\t\t\t// \tnew sap.ui.model.Filter(\"Process\", sap.ui.model.FilterOperator.EQ, \"A\")\r\n\t\t\t// ];\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: vId,\r\n\t\t\t\tF4Type: f4type,\r\n\t\t\t\tProcess: \"X\"\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tfilters: filter,\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthat.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tPhase logic\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnPhaseSelect: function(oEvent) {\r\n\t\t\tvar oCheckBox = oEvent.getSource();\r\n\t\t\tvar oBindInfo = oCheckBox.getBindingInfo(\"selected\");\r\n\t\t\tif (oBindInfo) {\r\n\t\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\t\tvar sModelName = oBindInfo.parts[0].model;\r\n\t\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\r\n\t\t\t\tif (!sModelName || !sFieldPath || !oContext) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\t\tvar oMainModel = this.getView().getModel(sModelName);\r\n\t\t\t\tvar vVornr = oMainModel.getProperty(sRowPath + \"/Vornr\");\r\n\t\t\t\t// Get selected state\r\n\t\t\t\tvar bSelected = oEvent.getParameter(\"selected\");\r\n\t\t\t\t// Access your editable model\r\n\t\t\t\tvar oEditModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\t\tif (!oEditModel) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// Set property based on checkbox selection\r\n\t\t\t\tif (bSelected) {\r\n\t\t\t\t\toEditModel.setProperty(\"/\" + vVornr + \"/Arbpl\", \"nonEdit\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toEditModel.setProperty(\"/\" + vVornr + \"/Arbpl\", \"Edit\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\toEditModel.updateBindings(true);\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, bSelected);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tSup Operation logic Handling (Live Change, Submit)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnSupOperationLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oEvent.getSource().getValue();\r\n\t\t\tthis.selectedField = id;\r\n\r\n\t\t\t// parent Error State Clear\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\"); // Input State clear\r\n\t\t\tthis.fnNumberFieldValidation(oEvent);\r\n\r\n\t\t\tvar oRow = oEvent.getSource().getParent();\r\n\t\t\tvar oTableRow = oRow.getParent();\r\n\t\t\tvar aCells = oTableRow.getCells();\r\n\t\t\tvar iCurrentCellIndex = aCells.indexOf(oEvent.getSource().getParent());\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Pvznr\");\r\n\r\n\t\t\tif (vValue === \"\" && aCells[iCurrentCellIndex + 1].getItems()[0].getValue() === \"\") {\r\n\t\t\t\tthis.fnRemovePhaseState(sRowPath);\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (vValue.length === 4) {\r\n\t\t\t\t// check if supOperation is present or not\r\n\t\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\").getData();\r\n\t\t\t\tthis.operationId = [];\r\n\t\t\t\t// check that Operations array exists\r\n\t\t\t\tif (oOperModel && oOperModel.Operations && oOperModel.Operations.length > 0) {\r\n\t\t\t\t\tfor (var i = 0; i < oOperModel.Operations.length; i++) {\r\n\t\t\t\t\t\tvar item = oOperModel.Operations[i];\r\n\t\t\t\t\t\t// only push Vornr where Arbpl has value\r\n\t\t\t\t\t\tif (item.Arbpl && item.Arbpl !== \"\" && !item.Phflg) {\r\n\t\t\t\t\t\t\tthis.operationId.push(item.Vornr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.operationId.indexOf(vValue) === -1) {\r\n\t\t\t\t\toInput = this.getView().byId(this.selectedField);\r\n\t\t\t\t\toInput.setValueState(\"Error\");\r\n\t\t\t\t\toInput.setValueStateText(i18n.getText(\"enterExistingOperationNumber\"));\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"enterExistingOperationNumber\"), \"Error\", this);\r\n\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Pvznr\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//check destination of that take next input\r\n\t\t\t\t\tif (iCurrentCellIndex !== -1 && iCurrentCellIndex + 1 < aCells.length) {\r\n\t\t\t\t\t\tvar oDestinationCell = aCells[iCurrentCellIndex + 1];\r\n\t\t\t\t\t\tvar oDestinationInput = oDestinationCell.getItems ? oDestinationCell.getItems()[0] : oDestinationCell;\r\n\t\t\t\t\t\tif (oDestinationInput && oDestinationInput.getValue) {\r\n\t\t\t\t\t\t\tvar destinationValue = oDestinationInput.getValue();\r\n\t\t\t\t\t\t\tif (destinationValue === \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Phseq\");\r\n\t\t\t\t\t\t\t\toDestinationInput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\toDestinationInput.focus();\r\n\t\t\t\t\t\t\t\toDestinationInput.setValueStateText(i18n.getText(\"enterControlRecipeDestination\", [vValue]));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar fromOperation = vValue;\r\n\t\t\t\t\t\t\t\tvar toOperation = aCells[iCurrentCellIndex - 2].getItems()[0].getValue();\r\n\t\t\t\t\t\t\t\tthis.fnUpdatePhaseRow(fromOperation, toOperation, sRowPath);\r\n\t\t\t\t\t\t\t\tthis.fngetStandardValue(sRowPath);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnUpdateChangelog: function(sRowPath, vTriggeredCell, vValue) {\r\n\t\t\tvar sField = vTriggeredCell.split(\"/\").pop(); // \"Pvznr\"\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tvar aColumns = oTable.getColumns();\r\n\r\n\t\t\tvar iColIndex = -1;\r\n\t\t\tvar sColLabel = \"\";\r\n\r\n\t\t\taColumns.forEach(function(oColumn, index) {\r\n\t\t\t\tvar sFilterProp = oColumn.getFilterProperty();\r\n\t\t\t\tif (sFilterProp === sField) {\r\n\t\t\t\t\tiColIndex = index;\r\n\t\t\t\t\tsColLabel = oColumn.getLabel().getText();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (iColIndex === -1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oInitialModel = this.getView().getModel(\"JM_OperationInitialModel\");\r\n\r\n\t\t\t// Each row has a unique operation number (Vornr)\r\n\t\t\tvar vVornr = oInitialModel.getProperty(sRowPath + \"/Vornr\") || \"\";\r\n\r\n\t\t\tif (vVornr === \"\") {\r\n\t\t\t\tvar notInitialModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\r\n\t\t\t\tif (notInitialModel) {\r\n\t\t\t\t\tvar newRow = JSON.parse(JSON.stringify(notInitialModel.getProperty(sRowPath)));\r\n\t\t\t\t\tvVornr = newRow.Vornr || \"\";\r\n\t\t\t\t\tnewRow[sField] = \"\";\r\n\t\t\t\t\toInitialModel.setProperty(sRowPath, newRow);\r\n\t\t\t\t\toInitialModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sFieldName = vTriggeredCell.split(\"/\").pop();\r\n\t\t\tvar newValue = vValue;\r\n\t\t\tvar oldValue = oInitialModel.getProperty(vTriggeredCell);\r\n\r\n\t\t\t// Build a unique ID for each field in a row\r\n\t\t\tvar sUniqueId = \"O|\" + vVornr + \"|\" + sFieldName;\r\n\r\n\t\t\t// Get or create the ChangeLog model\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\r\n\t\t\t// Get or create the ChangeLog local model\r\n\t\t\tvar oChangeLocalModel = this.getView().getModel(\"JM_ChangeLogBackup\");\r\n\t\t\tif (!oChangeLocalModel) {\r\n\t\t\t\toChangeLocalModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getView().setModel(oChangeLocalModel, \"JM_ChangeLogBackup\");\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLogData = oChangeLogModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\toChangeLogData = [];\r\n\t\t\t} else {\r\n\t\t\t\tthis.prviousArray = oChangeLogData;\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLocalData = oChangeLocalModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLocalData)) {\r\n\t\t\t\toChangeLocalData = [];\r\n\t\t\t} else {\r\n\t\t\t\tthis.prviousArray = oChangeLogData;\r\n\t\t\t}\r\n\r\n\t\t\tfunction normalizeBoolean(val) {\r\n\t\t\t\tif (typeof val === \"boolean\") {\r\n\t\t\t\t\treturn val ? \"X\" : \"\";\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\r\n\t\t\t// Apply before comparison\r\n\t\t\toldValue = normalizeBoolean(oldValue);\r\n\t\t\tnewValue = normalizeBoolean(newValue);\r\n\r\n\t\t\t// Find existing entry in main changelog\r\n\t\t\tvar idxMain = -1;\r\n\t\t\tfor (var i = 0; i < oChangeLogData.length; i++) {\r\n\t\t\t\tif (oChangeLogData[i].UniqueId === sUniqueId) {\r\n\t\t\t\t\tidxMain = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Find existing entry in local changelog\r\n\t\t\tvar idxLocal = -1;\r\n\t\t\tfor (i = 0; i < oChangeLocalData.length; i++) {\r\n\t\t\t\tif (oChangeLocalData[i].UniqueId === sUniqueId) {\r\n\t\t\t\t\tidxLocal = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Add, update, or remove change log entry\r\n\t\t\tif (oldValue !== newValue) {\r\n\t\t\t\tif (idxMain === -1) {\r\n\t\t\t\t\t// Add new change record\r\n\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\tUniqueId: sUniqueId,\r\n\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\tFieldId: sFieldName,\r\n\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\tProcessDesc: \"Operation\",\r\n\t\t\t\t\t\tFieldName: sColLabel + \" - \" + vVornr,\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\t\tChangedBy: this.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLogData[idxMain].NewValue = newValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (idxLocal === -1) {\r\n\t\t\t\t\toChangeLocalData.push({\r\n\t\t\t\t\t\tUniqueId: sUniqueId,\r\n\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\tFieldId: sFieldName,\r\n\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\tProcessDesc: \"Operation\",\r\n\t\t\t\t\t\tFieldName: sColLabel + \" - \" + vVornr,\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLocalData[idxLocal].NewValue = newValue;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Remove entry if reverted to original value\r\n\t\t\t\tif (idxMain !== -1) {\r\n\t\t\t\t\toChangeLogData.splice(idxMain, 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (idxLocal !== -1) {\r\n\t\t\t\t\toChangeLocalData.splice(idxLocal, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update and refresh models\r\n\t\t\toChangeLogModel.setData(oChangeLogData);\r\n\t\t\toChangeLogModel.refresh(true);\r\n\r\n\t\t\toChangeLocalModel.setData(oChangeLocalData);\r\n\t\t\toChangeLocalModel.refresh(true);\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tFragment common Live change action \r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnFragLivechange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\r\n\t\t\t// Convert input to uppercase (for text fields)\r\n\t\t\toInput.setValue(vValue);\r\n\r\n\t\t\tthis.selectedField = id;\r\n\t\t\toInput.setValueState(\"None\"); // reset previous error\r\n\t\t\tthis.fragLiveChangeFlag = true;\r\n\t\t\tvar desId = this.getView().byId(id + \"_DES\");\r\n\t\t\tif (desId) {\r\n\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase(), \"P\");\r\n\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangeLogforFragment(id, vValue);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnUpdateChangeLogforFragment: function(vId, newvalue) {\r\n\r\n\t\t\tvar sFieldId = vId;\r\n\t\t\tvar readableName = sFieldId.replace(/^ID_OPER_/, \"\").replace(/_F$/, \"\");\r\n\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tvar iSelectedIndex = oTable.getSelectedIndex();\r\n\t\t\tvar sRowPath = \"/Operations/\" + iSelectedIndex;\r\n\r\n\t\t\t// Convert to PascalCase (first letter uppercase)\r\n\t\t\treadableName = readableName.toLowerCase().replace(/(?:^|_)([a-z])/g, function(match, group1) {\r\n\t\t\t\treturn group1.toUpperCase();\r\n\t\t\t});\r\n\r\n\t\t\tvar oInitialModel = this.getView().getModel(\"JM_OperationInitialModel\");\r\n\t\t\tvar vVornr = \"\";\r\n\t\t\tvar oldValue = \"\";\r\n\t\t\tvar newValue = newvalue;\r\n\r\n\t\t\tif (oInitialModel) {\r\n\t\t\t\tvVornr = oInitialModel.getProperty(sRowPath + \"/Vornr\");\r\n\t\t\t\toldValue = oInitialModel.getProperty(sRowPath + \"/\" + readableName);\r\n\t\t\t}\r\n\r\n\t\t\tfunction normalizeValue(val) {\r\n\t\t\t\tif (val === null || val === undefined) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof val === \"number\" && val === 0) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof val === \"string\") {\r\n\t\t\t\t\tval = val.trim();\r\n\t\t\t\t\tif (/^0+(\\.0+)?$/.test(val)) {\r\n\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\r\n\t\t\toldValue = normalizeValue(oldValue);\r\n\t\t\tnewValue = normalizeValue(newValue);\r\n\r\n\t\t\t// Build a unique ID for each field in a row\r\n\t\t\tvar sUniqueId = \"O|\" + vVornr + \"|\" + readableName;\r\n\t\t\tvar labelMap = {\r\n\t\t\t\t\"ID_OPER_VGW01_F\": \"1st Std Value\",\r\n\t\t\t\t\"ID_OPER_VGW02_F\": \"2nd Std Value\",\r\n\t\t\t\t\"ID_OPER_VGW03_F\": \"3rd Std Value\",\r\n\t\t\t\t\"ID_OPER_VGW04_F\": \"4th Std Value\",\r\n\t\t\t\t\"ID_OPER_VGW05_F\": \"5th Std Value\",\r\n\t\t\t\t\"ID_OPER_VGW06_F\": \"6th Std Value\",\r\n\t\t\t\t\"ID_OPER_VGE01_F\": \"1st Std Value Unit\",\r\n\t\t\t\t\"ID_OPER_VGE02_F\": \"2nd Std Value Unit\",\r\n\t\t\t\t\"ID_OPER_VGE03_F\": \"3rd Std Value Unit\",\r\n\t\t\t\t\"ID_OPER_VGE04_F\": \"4th Std Value Unit\",\r\n\t\t\t\t\"ID_OPER_VGE05_F\": \"5th Std Value Unit\",\r\n\t\t\t\t\"ID_OPER_VGE06_F\": \"6th Std Value Unit\",\r\n\t\t\t\t\"LAR01\": \"Activity Type\",\r\n\t\t\t\t\"ID_OPER_USR04\": this.getView().byId(\"ID_OPER_USTEXT01\").getText() + \"Value\",\r\n\t\t\t\t\"ID_RECI_USE04\": this.getView().byId(\"ID_OPER_USTEXT01\").getText() + \"Unit\",\r\n\t\t\t\t\"ID_OPER_USR05\": this.getView().byId(\"ID_OPER_USTEXT02\").getText() + \"Value\",\r\n\t\t\t\t\"ID_RECI_USE05\": this.getView().byId(\"ID_OPER_USTEXT02\").getText() + \"Unit\",\r\n\t\t\t\t\"ID_OPER_USR06\": this.getView().byId(\"ID_OPER_USTEXT03\").getText() + \"Value\",\r\n\t\t\t\t\"ID_RECI_USE06\": this.getView().byId(\"ID_OPER_USTEXT03\").getText() + \"Unit\",\r\n\t\t\t\t\"ID_OPER_USR07\": this.getView().byId(\"ID_OPER_USTEXT04\").getText() + \"Value\",\r\n\t\t\t\t\"ID_RECI_USE07\": this.getView().byId(\"ID_OPER_USTEXT04\").getText() + \"Unit\"\r\n\t\t\t};\r\n\t\t\tvar string = labelMap[vId] || \"\";\r\n\r\n\t\t\t// Get or create the ChangeLog model\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\r\n\t\t\t// Get or create the ChangeLog local model\r\n\t\t\tvar oChangeLocalModel = this.getView().getModel(\"JM_ChangeLogBackup\");\r\n\t\t\tif (!oChangeLocalModel) {\r\n\t\t\t\toChangeLocalModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getView().setModel(oChangeLocalModel, \"JM_ChangeLogBackup\");\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLogData = oChangeLogModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\toChangeLogData = [];\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLocalData = oChangeLocalModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLocalData)) {\r\n\t\t\t\toChangeLocalData = [];\r\n\t\t\t}\r\n\r\n\t\t\t// Find existing entry in main changelog\r\n\t\t\tvar idxMain = -1;\r\n\t\t\tfor (var i = 0; i < oChangeLogData.length; i++) {\r\n\t\t\t\tif (oChangeLogData[i].UniqueId === sUniqueId) {\r\n\t\t\t\t\tidxMain = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Find existing entry in local changelog\r\n\t\t\tvar idxLocal = -1;\r\n\t\t\tfor (var j = 0; j < oChangeLocalData.length; j++) {\r\n\t\t\t\tif (oChangeLocalData[j].UniqueId === sUniqueId) {\r\n\t\t\t\t\tidxLocal = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Add, update, or remove change log entry\r\n\t\t\tif (oldValue !== newValue) {\r\n\t\t\t\tif (idxMain === -1) {\r\n\t\t\t\t\t// Add new change record\r\n\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\tUniqueId: sUniqueId,\r\n\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\tProcessDesc: \"Operation\",\r\n\t\t\t\t\t\tFieldName: (string === \"\") ? this.getView().byId(vId + \"_TXT\").getText() + \" - \" + vVornr : string,\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\t\tIndicator: \"X\",\r\n\t\t\t\t\t\tChangedBy: this.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Update existing entry\r\n\t\t\t\t\toChangeLogData[idxMain].NewValue = newValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (idxLocal === -1) {\r\n\t\t\t\t\toChangeLocalData.push({\r\n\t\t\t\t\t\tUniqueId: sUniqueId,\r\n\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\tProcessDesc: \"Operation\",\r\n\t\t\t\t\t\tFieldName: (string === \"\") ? this.getView().byId(vId + \"_TXT\").getText() + \" - \" + vVornr : string,\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\t\tChangedBy: this.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLocalData[idxLocal].NewValue = newValue;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Remove entry if reverted to original value\r\n\t\t\t\tif (idxMain !== -1) {\r\n\t\t\t\t\tthis.removedArray = [oChangeLogData[idxMain]];\r\n\t\t\t\t\toChangeLogData.splice(idxMain, 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (idxLocal !== -1) {\r\n\t\t\t\t\toChangeLocalData.splice(idxLocal, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update and refresh models\r\n\t\t\toChangeLogModel.setData(oChangeLogData);\r\n\t\t\toChangeLogModel.refresh(true);\r\n\r\n\t\t\toChangeLocalModel.setData(oChangeLocalData);\r\n\t\t\toChangeLocalModel.refresh(true);\r\n\r\n\t\t},\r\n\r\n\t\tfnUpdatePhaseRow: function(operaionfield, toOperation, selectedRow) {\r\n\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oData = oOperModel.getData();\r\n\t\t\tvar fromOperData = null;\r\n\t\t\tif (oData && oData.Operations && oData.Operations.length > 0) {\r\n\t\t\t\tfor (var i = 0; i < oData.Operations.length; i++) {\r\n\t\t\t\t\tif (oData.Operations[i].Vornr === operaionfield) {\r\n\t\t\t\t\t\tfromOperData = oData.Operations[i];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (fromOperData) {\r\n\t\t\t\t\tfor (var j = 0; j < oData.Operations.length; j++) {\r\n\t\t\t\t\t\tif (oData.Operations[j].Vornr === toOperation) {\r\n\t\t\t\t\t\t\toData.Operations[j].Phflg = true;\r\n\t\t\t\t\t\t\toData.Operations[j].Arbpl = fromOperData.Arbpl;\r\n\r\n\t\t\t\t\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(selectedRow + \"/Vornr\");\r\n\t\t\t\t\t\t\tvar oModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\t\t\t\t\tif (oModel) {\r\n\t\t\t\t\t\t\t\tfor (i = 1; i <= 6; i++) {\r\n\t\t\t\t\t\t\t\t\tvar stdValue = \"/Vgw0\" + i;\r\n\t\t\t\t\t\t\t\t\tvar stdUnit = \"/Vge0\" + i;\r\n\t\t\t\t\t\t\t\t\tvar ActTyp = \"/Lar0\" + i;\r\n\t\t\t\t\t\t\t\t\toModel.setProperty(\"/\" + vVornr + stdValue, \"Edit\");\r\n\t\t\t\t\t\t\t\t\toModel.setProperty(\"/\" + vVornr + stdUnit, \"Edit\");\r\n\t\t\t\t\t\t\t\t\toModel.setProperty(\"/\" + vVornr + ActTyp, \"Edit\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Arbpl\", \"nonEdit\");\r\n\t\t\t\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Ckselkz\", \"Edit\");\r\n\t\t\t\t\t\t\t\toModel.updateBindings(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar triggeredCell = selectedRow + \"/Arbpl\";\r\n\t\t\t\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\t\t\t\tthis.fnUpdateChangelog(selectedRow, triggeredCell, fromOperData.Arbpl);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\toOperModel.setData(oData);\r\n\t\t},\r\n\r\n\t\tfnRemovePhaseState: function(rowPath) {\r\n\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(rowPath + \"/Vornr\");\r\n\t\t\tvar bindedData = this.getView().getModel(\"JM_ReciOperations\").getProperty(rowPath);\r\n\t\t\tbindedData.Phflg = false;\r\n\t\t\tbindedData.Vge01 = \"\";\r\n\t\t\tbindedData.Vge02 = \"\";\r\n\t\t\tbindedData.Vge03 = \"\";\r\n\t\t\tbindedData.Vge04 = \"\";\r\n\t\t\tbindedData.Vge05 = \"\";\r\n\t\t\tbindedData.Vge06 = \"\";\r\n\t\t\tbindedData.Vgw01 = \"\";\r\n\t\t\tbindedData.Vgw02 = \"\";\r\n\t\t\tbindedData.Vgw03 = \"\";\r\n\t\t\tbindedData.Vgw04 = \"\";\r\n\t\t\tbindedData.Vgw05 = \"\";\r\n\t\t\tbindedData.Vgw06 = \"\";\r\n\t\t\tbindedData.Lar01 = \"\";\r\n\t\t\tbindedData.Lar02 = \"\";\r\n\t\t\tbindedData.Lar03 = \"\";\r\n\t\t\tbindedData.Lar04 = \"\";\r\n\t\t\tbindedData.Lar05 = \"\";\r\n\t\t\tbindedData.Lar06 = \"\";\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\tif (oModel) {\r\n\t\t\t\tfor (var i = 1; i <= 6; i++) {\r\n\t\t\t\t\tvar stdValue = \"/Vgw0\" + i;\r\n\t\t\t\t\tvar stdUnit = \"/Vge0\" + i;\r\n\t\t\t\t\tvar ActTyp = \"/Lar0\" + i;\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + stdValue, \"nonEdit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + stdUnit, \"nonEdit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + ActTyp, \"nonEdit\");\r\n\t\t\t\t}\r\n\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Arbpl\", \"Edit\");\r\n\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phseq\", \"Edit\");\r\n\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Pvznr\", \"Edit\");\r\n\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phflg\", \"Edit\");\r\n\t\t\t\toModel.updateBindings(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfngetStandardValue: function(rowPath) {\r\n\t\t\tvar oModelData = this.getView().getModel(\"JM_ReciOperations\").getProperty(rowPath);\r\n\t\t\tvar oDeepCopy = JSON.parse(JSON.stringify(oModelData));\r\n\t\t\tvar payload = {\r\n\t\t\t\tInd: \"T\"\r\n\t\t\t};\r\n\t\t\tvar oCorrectedData = this.fnModifyPayload(oDeepCopy);\r\n\t\t\tpayload.NavRecipe_Operation = [oCorrectedData];\r\n\t\t\tpayload.NavReturn_Msg = [];\r\n\t\t\tvar ServiceCall = this.getOwnerComponent().getModel();\r\n\r\n\t\t\tvar boolean = true;\r\n\t\t\tif (this.batch) {\r\n\t\t\t\tboolean = false;\r\n\t\t\t}\r\n\r\n\t\t\tServiceCall.setUseBatch(boolean);\r\n\r\n\t\t\tServiceCall.create(\"/Recipe_HeaderSet\", payload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oPayload = oData.NavRecipe_Operation.results[0];\r\n\t\t\t\t\tvar id = rowPath.split(\"/\")[2];\r\n\t\t\t\t\toModelData = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\t\tvar oModeldata1 = this.getView().getModel(\"JM_ReciOperations\").getProperty(rowPath);\r\n\t\t\t\t\tvar sBasePath = \"/Operations/\" + id + \"/\";\r\n\t\t\t\t\tvar aFields = [\"Vgtl\", \"Vge\", \"Vgw\", \"Lar\"];\r\n\r\n\t\t\t\t\tfor (var i = 0; i < aFields.length; i++) {\r\n\t\t\t\t\t\tvar sFieldGroup = aFields[i];\r\n\t\t\t\t\t\t// Loop through suffixes 16\r\n\t\t\t\t\t\tfor (var j = 1; j <= 6; j++) {\r\n\t\t\t\t\t\t\tvar sField;\r\n\t\t\t\t\t\t\t// For Vgtl  no leading zero (Vgtl1..Vgtl6)\r\n\t\t\t\t\t\t\tif (sFieldGroup === \"Vgtl\") {\r\n\t\t\t\t\t\t\t\tsField = sFieldGroup + j;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// For others  use leading zero (Vge01..Vge06)\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tsField = sFieldGroup + (\"0\" + j).slice(-2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Copy only if exists in payload\r\n\t\t\t\t\t\t\tif (oPayload.hasOwnProperty(sField)) {\r\n\t\t\t\t\t\t\t\toModelData.setProperty(sBasePath + sField, oPayload[sField]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar data = oModeldata1;\r\n\t\t\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + id + \"/Vornr\");\r\n\t\t\t\t\tvar oModel1 = this.getView().getModel(\"JM_EditableModel\");\r\n\r\n\t\t\t\t\t// Loop through 1 to 6\r\n\t\t\t\t\tfor (var k = 1; k <= 6; k++) {\r\n\t\t\t\t\t\tvar sIndex = (\"0\" + k).slice(-2); // \"01\"..\"06\"\r\n\t\t\t\t\t\tvar vgtlField = \"Vgtl\" + k;\r\n\t\t\t\t\t\tif (data[vgtlField] === \"\") {\r\n\t\t\t\t\t\t\t[\"Vge\", \"Vgw\", \"Lar\"].forEach(function(prefix) {\r\n\t\t\t\t\t\t\t\toModel1.setProperty(\"/\" + vVornr + \"/\" + prefix + sIndex, \"nonEdit\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t[\"Vge\", \"Vgw\", \"Lar\"].forEach(function(prefix) {\r\n\t\t\t\t\t\t\t\toModel1.setProperty(\"/\" + vVornr + \"/\" + prefix + sIndex, \"Edit\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\toModel1.refresh(true);\r\n\t\t\t\t\toModelData.refresh(true);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// ServiceCall.setUseBatch(bOldBatch);\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tDestination logic Handling (Live Change, Submit)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnDestinationLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oEvent.getSource().getValue();\r\n\t\t\tthis.selectedField = id;\r\n\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\"); // Input State clear\r\n\t\t\tthis.fnNumberFieldValidation(oEvent);\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Phseq\");\r\n\r\n\t\t\tvar oRow = oEvent.getSource().getParent();\r\n\t\t\tvar oTableRow = oRow.getParent();\r\n\t\t\tvar aCells = oTableRow.getCells();\r\n\t\t\tvar iCurrentCellIndex = aCells.indexOf(oEvent.getSource().getParent());\r\n\r\n\t\t\tif (vValue === \"\" && aCells[iCurrentCellIndex - 1].getItems()[0].getValue() === \"\") {\r\n\t\t\t\tthis.fnRemovePhaseState(sRowPath);\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnReadf4Destination(\"ID_OPER_PHSEQ\", vValue, \"P\").then(function(flag) {\r\n\t\t\t\tif (flag) {\r\n\t\t\t\t\tif (vValue.length === 2) {\r\n\t\t\t\t\t\t//check destination of that take next input\r\n\t\t\t\t\t\tif (iCurrentCellIndex !== -1 && iCurrentCellIndex - 1 < aCells.length) {\r\n\t\t\t\t\t\t\tvar oSupOperationCell = aCells[iCurrentCellIndex - 1];\r\n\t\t\t\t\t\t\tvar oSupOperationInput = oSupOperationCell.getItems ? oSupOperationCell.getItems()[0] : oSupOperationCell;\r\n\t\t\t\t\t\t\tif (oSupOperationInput && oSupOperationInput.getValue) {\r\n\t\t\t\t\t\t\t\tvar supOpeationValue = oSupOperationInput.getValue();\r\n\t\t\t\t\t\t\t\tif (supOpeationValue === \"\") {\r\n\t\t\t\t\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Pvznr\");\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.focus();\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.setValueStateText(i18n.getText(\"enterControlRecipeDestination\", [vValue]));\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar fromOperation = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Pvznr\");\r\n\t\t\t\t\t\t\t\t\tvar toOperation = aCells[iCurrentCellIndex - 3].getItems()[0].getValue();\r\n\t\t\t\t\t\t\t\t\tthis.fnUpdatePhaseRow(fromOperation, toOperation, sRowPath);\r\n\t\t\t\t\t\t\t\t\tthis.fngetStandardValue(sRowPath);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (vValue.length === 2) {\r\n\t\t\t\t\t\toInput = this.getView().byId(this.selectedField);\r\n\t\t\t\t\t\toInput.setValueState(\"Error\");\r\n\t\t\t\t\t\toInput.setValueStateText(i18n.getText(\"validDestination\"));\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"validDestination\"), \"Error\", this);\r\n\t\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Phseq\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}.bind(this));\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfndestinationItemPress: function() {\r\n\t\t\tvar path = this.selectedF4path;\r\n\t\t\tvar sBasePath = path.substring(0, path.lastIndexOf(\"/\"));\r\n\t\t\tvar fromOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sBasePath + \"/Pvznr\");\r\n\t\t\tvar toOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sBasePath + \"/Vornr\");\r\n\t\t\tif (fromOpeartion === \"\") {\r\n\t\t\t\tthis.fnSetErrorState(sBasePath, sBasePath + \"/Pvznr\");\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"EnterSupOperation\"), \"Error\", this);\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnUpdatePhaseRow(fromOpeartion, toOpeartion, sBasePath);\r\n\t\t\t\tthis.fngetStandardValue(sBasePath);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnReadf4Destination: function(vId, vValue, f4type) {\r\n\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\tvar that = this;\r\n\r\n\t\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\t\t// Filter based on Plant\r\n\t\t\t\t\tresults = results.filter(function(item) {\r\n\t\t\t\t\t\treturn item.Value3 === that.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar match = results.find(function(item) {\r\n\t\t\t\t\t\treturn item.Value1 === vValue;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresolve(!!match);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\tResource field logic handling (Live change, Submit, select item from F4)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnResourceLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\t// var parent = oInput.getParent();\r\n\t\t\tvar id = oInput.getId().split(\"-\")[2];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\r\n\t\t\tvar oRow = oEvent.getSource().getParent();\r\n\t\t\tvar oTableRow = oRow.getParent();\r\n\t\t\tvar aCells = oTableRow.getCells();\r\n\t\t\tvar iCurrentCellIndex = aCells.indexOf(oEvent.getSource().getParent());\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\t\t\tthis.selectedF4path = sRowPath;\r\n\r\n\t\t\tvar fromOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Pvznr\");\r\n\t\t\tvar toOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Vornr\");\r\n\t\t\tvar Vornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Vornr\");\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/\" + sFieldPath);\r\n\r\n\t\t\toInput.setValue(vValue);\r\n\t\t\tif (vValue === \"\") {\r\n\t\t\t\tthis.fnRemovePhaseState(sRowPath);\r\n\t\t\t\tthis.fnCheckSupOperationValidation(sRowPath, Vornr);\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnReadf4Resource(id, vValue, \"P\", oEvent).then(function(flag) {\r\n\t\t\t\tif (flag) {\r\n\t\t\t\t\tif (iCurrentCellIndex !== -1 && iCurrentCellIndex - 1 < aCells.length) {\r\n\t\t\t\t\t\tvar oDestinationCell = aCells[iCurrentCellIndex - 1];\r\n\t\t\t\t\t\tvar oDestinationInput = oDestinationCell.getItems ? oDestinationCell.getItems()[0] : oDestinationCell;\r\n\t\t\t\t\t\tvar oSupOperationCell = aCells[iCurrentCellIndex - 2];\r\n\t\t\t\t\t\tvar oSupOperationInput = oSupOperationCell.getItems ? oSupOperationCell.getItems()[0] : oSupOperationCell;\r\n\r\n\t\t\t\t\t\tif (oDestinationInput && oDestinationInput.getValue() && oDestinationInput.getValue() !== \"\" && oSupOperationInput.getValue() ===\r\n\t\t\t\t\t\t\t\"\") {\r\n\t\t\t\t\t\t\tvar destinationValue = oDestinationInput.getValue();\r\n\t\t\t\t\t\t\tif (destinationValue !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Pvznr\");\r\n\t\t\t\t\t\t\t\toSupOperationInput.setValueState(\"None\");\r\n\t\t\t\t\t\t\t\tthis.fnclearDestinationMakeNonedit();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (oSupOperationInput.getValue() !== \"\" && oDestinationInput !== \"\") {\r\n\t\t\t\t\t\t\tthis.fnCheckSupOperation(oSupOperationInput.getValue()).then(function(state) {\r\n\t\t\t\t\t\t\t\tif (!state) {\r\n\t\t\t\t\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Pvznr\");\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Phseq\");\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.focus();\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.setValueStateText(i18n.getText(\"enterControlRecipeDestination\", [oSupOperationInput.getValue()]));\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/\" + sFieldPath);\r\n\t\t\t\t\t\t\t\t\toSupOperationInput.setValueState(\"None\");\r\n\t\t\t\t\t\t\t\t\tsap.ui.getCore().applyChanges();\r\n\t\t\t\t\t\t\t\t\tthis.fnUpdatePhaseRow(fromOpeartion, toOpeartion, sRowPath);\r\n\t\t\t\t\t\t\t\t\tthis.fngetStandardValue(sRowPath);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.fnValidateArbplBackend(vValue, sRowPath).then(function(state) {\r\n\t\t\t\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/\" + sFieldPath);\r\n\t\t\t\t\t\t\t\t\tthis.fnmakeNonEditDependentFields();\r\n\t\t\t\t\t\t\t\t\tthis.fnUpdateResourceforPhase(Vornr, vValue);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCheckSupOperationValidation: function(sRowpath, Vornr) {\r\n\t\t\tvar oOperationModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tif (!oOperationModel) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar operationData = oOperationModel.getProperty(\"/Operations\") || [];\r\n\t\t\tvar oTable = this.getView().byId(\"id_OperationTable\");\r\n\t\t\tfor (var i = 0; i < operationData.length; i++) {\r\n\t\t\t\tvar data = operationData[i];\r\n\t\t\t\tif (data.Pvznr === Vornr) {\r\n\t\t\t\t\tvar row = oTable.getRows()[i];\r\n\t\t\t\t\tif (!row) continue;\r\n\t\t\t\t\tvar cells = row.getCells();\r\n\t\t\t\t\tif (cells.length > 2) {\r\n\t\t\t\t\t\tvar vBox = cells[2];\r\n\t\t\t\t\t\tif (vBox) {\r\n\t\t\t\t\t\t\t// vBox.addStyleClass(\"cl_errorState\"); // corrected class name\r\n\t\t\t\t\t\t\tthis.fnSetErrorState(\"/Operations/\" + i, \"/Operations/\" + i + \"/Pvznr\");\r\n\t\t\t\t\t\t\tvar input = vBox.getItems ? vBox.getItems()[0] : null;\r\n\t\t\t\t\t\t\tif (input) {\r\n\t\t\t\t\t\t\t\tinput.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\tinput.setValueStateText(i18n.getText(\"enterExistingOperationNumber\"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnResourceItemPress: function(item) {\r\n\t\t\tvar sRowPath = this.selectedF4path.split(\"/\").slice(0, -1).join(\"/\");\r\n\t\t\tvar index = sRowPath.split(\"/\")[2];\r\n\t\t\tvar oDestinationInput = this.getView().byId(\"ID_OPER_PHSEQ\");\r\n\t\t\tvar supoperationValue = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Pvznr\");\r\n\t\t\tvar destinationValue = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Phseq\");\r\n\t\t\tvar oSupOperationInput = this.getView().byId(\"PVZNR\");\r\n\r\n\t\t\tvar fromOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Pvznr\");\r\n\t\t\tvar toOpeartion = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Vornr\");\r\n\t\t\tvar Vornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Vornr\");\r\n\r\n\t\t\tif (oDestinationInput && supoperationValue === \"\" && destinationValue !== \"\") {\r\n\t\t\t\tif (destinationValue !== \"\") {\r\n\t\t\t\t\tthis.fnClearErrorState(\"/Operations/\" + index, \"Opeartions/\" + index + \"/Pvznr\");\r\n\t\t\t\t\tthis.fnClearErrorState(\"/Operations/\" + index, \"Opeartions/\" + index + \"/Phseq\");\r\n\t\t\t\t\tthis.fnclearDestinationMakeNonedit();\r\n\t\t\t\t}\r\n\t\t\t} else if (supoperationValue !== \"\" && destinationValue !== \"\") {\r\n\t\t\t\tthis.fnCheckSupOperation(supoperationValue).then(function(state) {\r\n\t\t\t\t\tif (!state) {\r\n\t\t\t\t\t\tthis.fnSetErrorState(\"/Operations/\" + index, \"Opeartions/\" + index + \"/Pvznr\");\r\n\t\t\t\t\t\toSupOperationInput.setValueState(\"Error\");\r\n\t\t\t\t\t\tthis.fnClearErrorState(\"/Operations/\" + index, \"Opeartions/\" + index + \"/Phseq\");\r\n\t\t\t\t\t\toSupOperationInput.focus();\r\n\t\t\t\t\t\toSupOperationInput.setValueStateText(i18n.getText(\"enterControlRecipeDestination\", [supoperationValue]));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.fnClearErrorState(\"/Operations/\" + index, \"Opeartions/\" + index + \"/Pvznr\");\r\n\t\t\t\t\t\toSupOperationInput.setValueState(\"None\");\r\n\t\t\t\t\t\tsap.ui.getCore().applyChanges();\r\n\t\t\t\t\t\tthis.fnUpdatePhaseRow(fromOpeartion, toOpeartion, sRowPath);\r\n\t\t\t\t\t\tthis.fngetStandardValue(sRowPath);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this));\r\n\t\t\t} else {\r\n\t\t\t\tthis.fnValidateArbplBackend(item, sRowPath).then(function(state) {\r\n\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\tthis.fnmakeNonEditDependentFields();\r\n\t\t\t\t\t\tthis.fnUpdateResourceforPhase(Vornr, item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this));\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnValidateArbplBackend: function(vValue, sRowPath) {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar oPayload = {\r\n\t\t\t\t\tInd: \"O\"\r\n\t\t\t\t};\r\n\t\t\t\toPayload.NavRecipe_Operation = [{\r\n\t\t\t\t\tArbpl: vValue,\r\n\t\t\t\t\tWerks: this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Werks\"),\r\n\t\t\t\t\tBmsch: this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Bmsch\"),\r\n\t\t\t\t\tUmrez: this.fnToEdmDecimal(this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Umrez\"), 5, 0),\r\n\t\t\t\t\tUmren: this.fnToEdmDecimal(this.getView().getModel(\"JM_ReciOperations\").getProperty(sRowPath + \"/Umren\"), 5, 0)\r\n\t\t\t\t}];\r\n\t\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\t\tvar ServiceCall = this.getOwnerComponent().getModel();\r\n\t\t\t\tServiceCall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tif (oData.MsgType !== \"E\") {\r\n\t\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tResolve(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tReject(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\r\n\t\t},\r\n\r\n\t\tfnCheckSupOperation: function(vValue) {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\").getData();\r\n\t\t\t\tthis.operationId = [];\r\n\t\t\t\t// check that Operations array exists\r\n\t\t\t\tif (oOperModel && oOperModel.Operations && oOperModel.Operations.length > 0) {\r\n\t\t\t\t\tfor (var i = 0; i < oOperModel.Operations.length; i++) {\r\n\t\t\t\t\t\tvar item = oOperModel.Operations[i];\r\n\t\t\t\t\t\t// only push Vornr where Arbpl has value\r\n\t\t\t\t\t\tif (item.Arbpl && item.Arbpl !== \"\" && !item.Phflg) {\r\n\t\t\t\t\t\t\tthis.operationId.push(item.Vornr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.operationId.indexOf(vValue) === -1) {\r\n\t\t\t\t\tResolve(false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tResolve(true);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnclearDestinationMakeNonedit: function(sRowpath) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: \"Information\",\r\n\t\t\t\ttext: i18n.getText(\"assignedCRDAutoDeletion\"),\r\n\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"DEL_DESTINATION\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\"); // local model\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnReadf4Resource: function(vId, vValue, f4type) {\r\n\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\tvar that = this;\r\n\r\n\t\t\t\tvar updateDesc = function(results) {\r\n\r\n\t\t\t\t\tvar match = results.find(function(item) {\r\n\t\t\t\t\t\treturn item.Value1 === vValue;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresolve(!!match);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t confirmation close and submit button functionlaties\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnConfirmationFragmentClose: function() {\r\n\t\t\tif (this.oDialog) {\r\n\t\t\t\tthis.oDialog.close();\r\n\t\t\t\tthis.oDialog.destroy(); // if you want destroy after close\r\n\t\t\t\tthis.oDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSubmitConfirmation: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"DEL_DESTINATION\") {\r\n\t\t\t\tvar vSelectedRow = this.selectedF4path.split(\"/\")[2];\r\n\t\t\t\tthis.getView().getModel(\"JM_ReciOperations\").setProperty(\"/Operations/\" + vSelectedRow + \"/Phseq\", \"\");\r\n\t\t\t\tthis.getView().getModel(\"JM_ReciOperations\").setProperty(\"/Operations/\" + vSelectedRow + \"/Pvznr\", \"\");\r\n\t\t\t\tthis.fnmakeNonEditDependentFields();\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t}\r\n\t\t\tif (state === \"CLOSE_OPER_DIALOG\") {\r\n\t\t\t\tthis.fnUpdatechangelogDefaultData();\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (state === \"DELETEROW\") {\r\n\t\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\t\t\t\tvar indexValue = [];\r\n\t\t\t\tindexValue.push(aSelectedIndices);\r\n\t\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"msgSelectRowToRemove\"), \"Error\", this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\tvar aData = oModel.getProperty(\"/Operations\");\r\n\t\t\t\tvar aSelectedVornr = [];\r\n\r\n\t\t\t\taData.forEach(function(val, index) {\r\n\t\t\t\t\tif (aSelectedIndices.includes(index)) {\r\n\t\t\t\t\t\taSelectedVornr.push(val.Vornr);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\taData.forEach(function(item, index) {\r\n\t\t\t\t\tif (aSelectedVornr.includes(item.Pvznr) && !aSelectedIndices.includes(index)) {\r\n\t\t\t\t\t\tindexValue[0].push(index);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tindexValue[0].sort(function(a, b) {\r\n\t\t\t\t\treturn b - a;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.onDeleteOperation(indexValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tindexValue[0].forEach(function(iIndex) {\r\n\t\t\t\t\taData.splice(iIndex, 1);\r\n\t\t\t\t});\r\n\t\t\t\toModel.setProperty(\"/Operations\", aData);\r\n\t\t\t\toModel.refresh();\r\n\t\t\t\toModel.updateBindings(true);\r\n\t\t\t\toTable.clearSelection();\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t}\r\n\t\t\tif (state === \"BACK\") {\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t\tthis.fnNavBack();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDeleteOperation: function(aDeletedIndexes) {\r\n\t\t\tvar that = this;\r\n\t\t\tif (!aDeletedIndexes || aDeletedIndexes.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Flatten nested index array if needed\r\n\t\t\tif (Array.isArray(aDeletedIndexes[0])) {\r\n\t\t\t\taDeletedIndexes = aDeletedIndexes[0];\r\n\t\t\t}\r\n\r\n\t\t\t// Models\r\n\t\t\tvar oInitialModel = this.getOwnerComponent().getModel(\"JM_InitialDatas\");\r\n\t\t\tvar aInitialData = oInitialModel.getProperty(\"/NavRecipe_Operation/results\") || [];\r\n\r\n\t\t\tvar oCurrentModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar aCurrentOps = oCurrentModel.getProperty(\"/Operations\") || [];\r\n\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tvar aChangeLogData = oChangeLogModel.getData();\r\n\t\t\tif (!Array.isArray(aChangeLogData)) {\r\n\t\t\t\taChangeLogData = [];\r\n\t\t\t}\r\n\r\n\t\t\taDeletedIndexes.forEach(function(iIndex) {\r\n\t\t\t\tvar oItem = aCurrentOps[iIndex];\r\n\t\t\t\tif (!oItem) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar vVornr = oItem.Vornr || \"\";\r\n\t\t\t\tvar vArbpl = oItem.Arbpl || \"\";\r\n\t\t\t\tvar vPvznr = oItem.Pvznr || \"\";\r\n\t\t\t\tvar vPhseq = oItem.Phseq || \"\";\r\n\t\t\t\tif (!vVornr) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\taChangeLogData = aChangeLogData.filter(function(entry) {\r\n\t\t\t\t\treturn !(entry.UniqueId && entry.UniqueId.indexOf(\"O|\" + vVornr + \"|\") === 0);\r\n\t\t\t\t});\r\n\t\t\t\tvar bExistsInInitial = aInitialData.some(function(oInit) {\r\n\t\t\t\t\treturn oInit.Vornr === vVornr;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (bExistsInInitial) {\r\n\t\t\t\t\taChangeLogData.push({\r\n\t\t\t\t\t\tUniqueId: \"O|\" + vVornr + \"|Arbpl\",\r\n\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\tFieldId: \"Arbpl\",\r\n\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\tProcessDesc: i18n.getText(\"Operations\"),\r\n\t\t\t\t\t\tFieldName: i18n.getText(\"ResourceDeleted\", vVornr),\r\n\t\t\t\t\t\tOldValue: vArbpl,\r\n\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (vPvznr) {\r\n\t\t\t\t\t\taChangeLogData.push({\r\n\t\t\t\t\t\t\tUniqueId: \"O|\" + vVornr + \"|Pvznr\",\r\n\t\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\t\tFieldId: \"Pvznr\",\r\n\t\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\t\tProcessDesc: i18n.getText(\"Operations\"),\r\n\t\t\t\t\t\t\tFieldName: i18n.getText(\"SupOperationDeleted\", vVornr),\r\n\t\t\t\t\t\t\tOldValue: vPvznr,\r\n\t\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (vPhseq) {\r\n\t\t\t\t\t\taChangeLogData.push({\r\n\t\t\t\t\t\t\tUniqueId: \"O|\" + vVornr + \"|Phflg\",\r\n\t\t\t\t\t\t\tItemNo: vVornr,\r\n\t\t\t\t\t\t\tFieldId: \"Phflg\",\r\n\t\t\t\t\t\t\tProcessInd: \"O\",\r\n\t\t\t\t\t\t\tProcessDesc: i18n.getText(\"Operations\"),\r\n\t\t\t\t\t\t\tFieldName: i18n.getText(\"DestinationDeleted\", vVornr),\r\n\t\t\t\t\t\t\tOldValue: vPhseq,\r\n\t\t\t\t\t\t\tNewValue: \"DELETED\",\r\n\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\toChangeLogModel.setData(aChangeLogData);\r\n\t\t\toChangeLogModel.refresh(true);\r\n\t\t},\r\n\r\n\t\tfnUpdatechangelogDefaultData: function() {\r\n\t\t\tvar oMainModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oMainModel) {\r\n\t\t\t\toMainModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\tthis.getOwnerComponent().setModel(oMainModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\t\t\tif (this.OrgChangeLog) {\r\n\t\t\t\toMainModel.setData(this.OrgChangeLog);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnmakeNonEditDependentFields: function() {\r\n\t\t\tvar vSelectedRow = this.selectedF4path.split(\"/\")[2];\r\n\t\t\tvar vSelectedField = this.selectedF4path.split(\"/\")[3];\r\n\r\n\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + vSelectedRow + \"/Vornr\");\r\n\t\t\tvar vArbpl = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + vSelectedRow + \"/\" + vSelectedField);\r\n\t\t\tthis.getView().getModel(\"JM_ReciOperations\").setProperty(\"/Operations/\" + vSelectedRow + \"/Ckselkz\", \"\");\r\n\r\n\t\t\tif (vArbpl !== \"\") {\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phflg\", \"nonEdit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Pvznr\", \"nonEdit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phseq\", \"nonEdit\");\r\n\t\t\t\t\toModel.updateBindings(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tStandard Key Text Logic Handling\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\tfnStdKeyTextLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar parentId = oInput.getParent();\r\n\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\tthis.selectedF4path = sRowPath + \"/\" + sFieldPath;\r\n\t\t\tthis.selectedField = id;\r\n\r\n\t\t\tvar Model = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tif (Model) {\r\n\t\t\t\tvar vArbpl = Model.getProperty(sRowPath + \"/Arbpl\");\r\n\t\t\t\tif (vArbpl === \"\") {\r\n\t\t\t\t\toInput.setValue(\"\");\r\n\t\t\t\t\tthis.fnSetErrorState(sRowPath, sRowPath + \"/Arbpl\");\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"EnterResource\"), \"Error\", this);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Arbpl\");\r\n\t\t\t\t\tvar oRow = oEvent.getSource().getParent(); // VBox or HBox inside the table cell\r\n\t\t\t\t\tvar oTableRow = oRow.getParent(); // TableRow or ColumnListItem\r\n\t\t\t\t\tvar aCells = oTableRow.getCells();\r\n\t\t\t\t\tvar iCurrentCellIndex = aCells.indexOf(oEvent.getSource().getParent());\r\n\t\t\t\t\tif (iCurrentCellIndex !== -1 && iCurrentCellIndex + 1 < aCells.length) {\r\n\t\t\t\t\t\tvar oNextCell = aCells[iCurrentCellIndex + 1];\r\n\t\t\t\t\t\tvar oNextInput = oNextCell.getItems ? oNextCell.getItems()[0] : oNextCell; // handle VBox with Input inside\r\n\t\t\t\t\t\tthis.oNextInput = oNextInput;\r\n\t\t\t\t\t\tif (oNextInput && oNextInput.getValue() !== \"\" && vValue === \"\") {\r\n\t\t\t\t\t\t\toNextInput.setValue(\"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Convert input to uppercase (for text fields)\r\n\t\t\t\t\toInput.setValue(vValue);\r\n\t\t\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/Ktsch\");\r\n\r\n\t\t\t\t\tthis.fnReadf4Cache(id.split(\"-\")[0], vValue, \"P\");\r\n\t\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tOpeation Unit live Change Logic Handling\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\tfnOpeartionUnitLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\r\n\t\t\t// Convert input to uppercase (for text fields)\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\toInput.setValue(vValue);\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.selectedF4path = sRowPath + \"/\" + sFieldPath;\r\n\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/\" + sFieldPath);\r\n\t\t\tthis.fnReadf4Cache(id.split(\"-\")[0], vValue, \"P\");\r\n\t\t},\r\n\r\n\t\tfnActivtystdUnitLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\t// Convert input to uppercase (for text fields)\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\toInput.setValue(vValue);\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.selectedF4path = sRowPath + \"/\" + sFieldPath;\r\n\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + \"/\" + sFieldPath);\r\n\r\n\t\t\tthis.fnReadf4Cache(id.split(\"-\")[0], vValue, \"P\");\r\n\t\t},\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tto Open the Operation Dialog function\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnOperationDialog: function(oEvent) {\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tvar oTableModel = oTable.getModel(\"JM_ReciOperations\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices(); // returns array of selected indices\r\n\t\t\tvar aTableData = oTableModel.getProperty(\"/Operations\");\r\n\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectRow\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (aSelectedIndices.length > 1) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectOnlyOneLine\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Get the selected row data\r\n\t\t\tvar iSelectedIndex = aSelectedIndices[0];\r\n\t\t\tvar oSelectedRow = aTableData[iSelectedIndex];\r\n\r\n\t\t\tif (!oSelectedRow.Arbpl && !oSelectedRow.Pvznr) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectOnlyCreatedRecords\"), \"Information\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar that = this;\r\n\t\t\tif (!that.duplicateDialog) {\r\n\t\t\t\tthat.duplicateDialog = sap.ui.xmlfragment(that.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.reci_operations\", // Fragment name\r\n\t\t\t\t\tthat // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthat.getView().addDependent(that.duplicateDialog);\r\n\t\t\t}\r\n\t\t\tvar sPath = oTable.getContextByIndex(aSelectedIndices).getPath();\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oModeldata = JSON.parse(JSON.stringify(oModel.getProperty(sPath)));\r\n\t\t\tvar oDialogModel = new sap.ui.model.json.JSONModel(oModeldata);\r\n\t\t\tthis.getView().setModel(oDialogModel, \"JM_ReciOperationsDialog\");\r\n\t\t\toDialogModel.refresh(true);\r\n\r\n\t\t\tvar descriptionModel = this.getView().getModel(\"JM_DescriptionModel\");\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tvar Appid = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Appid\");\r\n\t\t\tif (Object.keys(oChangeLogModel.getData() || {}).length > 0 && Appid === \"RX\") {\r\n\t\t\t\t// Get data and create a deep copy\r\n\t\t\t\tvar existingData = oChangeLogModel ? JSON.parse(JSON.stringify(oChangeLogModel.getData())) : [];\r\n\t\t\t\t// Check if model has some data and AppId === \"RX\"\r\n\t\t\t\tif (existingData && existingData.length > 0 && this.AppId === \"RX\") {\r\n\t\t\t\t\texistingData = existingData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ItemNo === oModeldata.Vornr;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.fnHighlightinputfield(existingData);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (descriptionModel) {\r\n\t\t\t\tvar descriptionData = descriptionModel.getData();\r\n\t\t\t\tvar itemNumber = oModeldata.Vornr;\r\n\t\t\t\tif (descriptionData[itemNumber]) {\r\n\t\t\t\t\tvar data = descriptionData[itemNumber];\r\n\t\t\t\t\tdata.forEach(function(item) {\r\n\t\t\t\t\t\t// Case 1: FieldName = \"CKSELKZ\"\r\n\t\t\t\t\t\tif ([\"CKSELKZ\", \"STATU\", \"MATKL\", \"EKGRP\", \"LIFNR\", \"SAKTO\", \"WAERS\"].includes(item.FieldName)) {\r\n\t\t\t\t\t\t\tvar desId = \"ID_OPER_\" + item.FieldName + \"_F_DES\";\r\n\t\t\t\t\t\t\tvar oInput = this.getView().byId(desId);\r\n\t\t\t\t\t\t\tif (oInput) {\r\n\t\t\t\t\t\t\t\toInput.setValue(item.desc || \"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Qpart\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_QPART_F\", oModel.getProperty(sPath + \"/Qpart\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Matkl\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_MATKL_F\", oModel.getProperty(sPath + \"/Qpart\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Ekgrp\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_EKGRP_F\", oModel.getProperty(sPath + \"/Ekgrp\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Lifnr\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_LIFNR_F\", oModel.getProperty(sPath + \"/Lifnr\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Sakto\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_SAKTO_F\", oModel.getProperty(sPath + \"/Sakto\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oModel.getProperty(sPath + \"/Ckselkz\") !== \"\") {\r\n\t\t\t\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_CKSELKZ_F\", oModel.getProperty(sPath + \"/Ckselkz\"), \"P\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Qpart\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_QPART_F\", oModel.getProperty(sPath + \"/Qpart\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Matkl\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_MATKL_F\", oModel.getProperty(sPath + \"/Qpart\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Ekgrp\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_EKGRP_F\", oModel.getProperty(sPath + \"/Ekgrp\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Lifnr\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_LIFNR_F\", oModel.getProperty(sPath + \"/Lifnr\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Sakto\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_SAKTO_F\", oModel.getProperty(sPath + \"/Sakto\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t\tif (oModel.getProperty(sPath + \"/Ckselkz\") !== \"\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(\"ID_OPER_CKSELKZ_F\", oModel.getProperty(sPath + \"/Ckselkz\"), \"P\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.firstTymUF = true;\r\n\t\t\tthis.fnUserFields();\r\n\t\t\tthat.duplicateDialog.open();\r\n\t\t},\r\n\r\n\t\tfncloseDialog: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: i18n.getText(\"Information\"),\r\n\t\t\t\ttext: i18n.getText(\"DiscardChangesOnCancel\"),\r\n\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"CLOSE_OPER_DIALOG\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\t\tfnDialogClose: function() {\r\n\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t on Save and Back press in Operation Dialog functionalities\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnNavtoOperaHeader: function() {\r\n\t\t\tvar changedData = this.getView().getModel(\"JM_ReciOperationsDialog\").getData();\r\n\t\t\tchangedData.Klakz = (changedData.Klakz === true) ? \"X\" : \"\";\r\n\t\t\tchangedData.Qsel1 = (changedData.Qsel1 === true) ? \"X\" : \"\";\r\n\t\t\tchangedData.Qsel2 = (changedData.Qsel2 === true) ? \"X\" : \"\";\r\n\t\t\tchangedData.Qsel3 = (changedData.Qsel3 === true) ? \"X\" : \"\";\r\n\t\t\tchangedData.Frdlb = (changedData.Frdlb === true) ? \"X\" : \"\";\r\n\t\t\tchangedData.Vgw01 = this.fnToEdmDecimal(changedData.Vgw01, 9, 3);\r\n\t\t\tchangedData.Vgw02 = this.fnToEdmDecimal(changedData.Vgw02, 9, 3);\r\n\t\t\tchangedData.Vgw03 = this.fnToEdmDecimal(changedData.Vgw03, 9, 3);\r\n\t\t\tchangedData.Vgw04 = this.fnToEdmDecimal(changedData.Vgw04, 9, 3);\r\n\t\t\tchangedData.Vgw05 = this.fnToEdmDecimal(changedData.Vgw05, 9, 3);\r\n\t\t\tchangedData.Vgw06 = this.fnToEdmDecimal(changedData.Vgw06, 9, 3);\r\n\t\t\tchangedData.Loanz = this.fnToEdmDecimal(changedData.Loanz, 3, 0);\r\n\t\t\tchangedData.Preis = this.fnToEdmDecimal(changedData.Preis, 9, 3);\r\n\t\t\tchangedData.Plifz = this.fnToEdmDecimal(changedData.Plifz, 3, 0);\r\n\t\t\tchangedData.Datuv = changedData.Datuv;\r\n\t\t\tchangedData.Datub = changedData.Datub;\r\n\t\t\tchangedData.Usr08 = changedData.Usr08 ? this.fntoEdmDateTime(changedData.Usr08) : null;\r\n\t\t\tchangedData.Usr09 = changedData.Usr09 ? this.fntoEdmDateTime(changedData.Usr09) : null;\r\n\t\t\tchangedData.Umrez = this.fnToEdmDecimal(changedData.Umrez, 5, 0);\r\n\t\t\tchangedData.Peinh = this.fnToEdmDecimal(changedData.Peinh, 5, 0);\r\n\t\t\tchangedData.Umren = this.fnToEdmDecimal(changedData.Umren, 5, 0);\r\n\t\t\tchangedData.Usr04 = this.fnToEdmDecimal(changedData.Usr04, 13, 3);\r\n\t\t\tchangedData.Usr05 = this.fnToEdmDecimal(changedData.Usr05, 13, 3);\r\n\t\t\tchangedData.Usr06 = this.fnToEdmDecimal(changedData.Usr06, 13, 3);\r\n\t\t\tchangedData.Anzma = this.fnToEdmDecimal(changedData.Anzma, 5, 2);\r\n\t\t\tchangedData.Usr07 = this.fnToEdmDecimal(changedData.Usr07, 13, 3);\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel();\r\n\t\t\tvar oPayload = {\r\n\t\t\t\t\"Ind\": \"O\"\r\n\t\t\t};\r\n\t\t\t// Deep copy of changedData (so original remains intact)\r\n\t\t\tvar oChangedCopy = JSON.parse(JSON.stringify(changedData));\r\n\t\t\toPayload.NavRecipe_Operation = [oChangedCopy];\r\n\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\t// Now safely remove description fields\r\n\t\t\toPayload.NavRecipe_Operation.forEach(function(oItem) {\r\n\t\t\t\t[\"Datub\", \"Datuv\", \"Usr08\", \"Usr09\"].forEach(function(field) {\r\n\t\t\t\t\tvar value = oItem[field];\r\n\t\t\t\t\tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t\t\t\t\toItem[field] = new Date(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tObject.keys(oPayload.NavRecipe_Operation[0]).forEach(function(key) {\r\n\t\t\t\tif (key.endsWith(\"Des\")) {\r\n\t\t\t\t\tdelete oPayload.NavRecipe_Operation[0][key];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbusyDialog.open();\r\n\t\t\toModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar first = oData.NavReturn_Msg.results[0].MsgType;\r\n\t\t\t\t\tif (oData.NavReturn_Msg && oData.NavReturn_Msg.results && oData.NavReturn_Msg.results.length > 0 && first !== \"S\") {\r\n\t\t\t\t\t\tvar aMessages = oData.NavReturn_Msg.results;\r\n\t\t\t\t\t\tvar sFirstMsg = aMessages[0].Message;\r\n\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sFirstMsg, \"Error\", this);\r\n\t\t\t\t\t\tfor (var i = 0; i < aMessages.length; i++) {\r\n\t\t\t\t\t\t\tvar oMsg = aMessages[i];\r\n\t\t\t\t\t\t\tvar sId = \"ID_OPER_\" + oMsg.Fnm + \"_F\";\r\n\r\n\t\t\t\t\t\t\tvar oControl = this.getView().byId(sId);\r\n\t\t\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\t\t\tif (sId === \"ID_OPER_FRDLB_F\") {\r\n\t\t\t\t\t\t\t\t\toControl.addStyleClass(\"cl_checkboxError\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (oControl.setValueState) {\r\n\t\t\t\t\t\t\t\t\t\toControl.setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oControl.setValueStateText) {\r\n\t\t\t\t\t\t\t\t\t\toControl.setValueStateText(oMsg.Message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.fnAftersuccess(changedData);\r\n\t\t\t\t\t\tthis.fnSaveChangeLogFragment();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnSaveChangeLogFragment: function() {\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tvar oChangeLocalModel = this.getView().getModel(\"JM_ChangeLogBackup\");\r\n\r\n\t\t\tif (!oChangeLogModel || !oChangeLocalModel) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar aMainData = oChangeLogModel.getData() || [];\r\n\t\t\tvar aLocalData = oChangeLocalModel.getData() || [];\r\n\r\n\t\t\t// Deep copy of main data to avoid side effects\r\n\t\t\tvar aMergedData = JSON.parse(JSON.stringify(aMainData));\r\n\r\n\t\t\tfor (var i = 0; i < aLocalData.length; i++) {\r\n\t\t\t\tvar localEntry = aLocalData[i];\r\n\t\t\t\tvar found = false;\r\n\r\n\t\t\t\t// Check if entry already exists in main model by UniqueId\r\n\t\t\t\tfor (var j = 0; j < aMergedData.length; j++) {\r\n\t\t\t\t\tif (aMergedData[j].UniqueId === localEntry.UniqueId) {\r\n\t\t\t\t\t\taMergedData[j].NewValue = localEntry.NewValue;\r\n\t\t\t\t\t\taMergedData[j].OldValue = localEntry.OldValue;\r\n\t\t\t\t\t\taMergedData[j].FrgInd = localEntry.FrgInd; // Keep \"X\"\r\n\t\t\t\t\t\tfound = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!found) {\r\n\t\t\t\t\taMergedData.push(localEntry);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\toChangeLogModel.setData(aMergedData);\r\n\t\t\toChangeLogModel.refresh(true);\r\n\t\t\toChangeLocalModel.setData([]);\r\n\t\t\toChangeLocalModel.refresh(true);\r\n\t\t},\r\n\r\n\t\tfnAftersuccess: function(changedData) {\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tchangedData.Klakz = (changedData.Klakz === \"X\") ? true : false;\r\n\t\t\tchangedData.Qsel1 = (changedData.Qsel1 === \"X\") ? true : false;\r\n\t\t\tchangedData.Qsel2 = (changedData.Qsel2 === \"X\") ? true : false;\r\n\t\t\tchangedData.Qsel3 = (changedData.Qsel3 === \"X\") ? true : false;\r\n\t\t\tchangedData.Frdlb = (changedData.Frdlb === \"X\") ? true : false;\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices(); // array\r\n\t\t\tvar sPath = oTable.getContextByIndex(aSelectedIndices[0]).getPath(); // take first selected\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\toModel.setProperty(sPath, changedData);\r\n\t\t\toModel.refresh(true);\r\n\t\t\tvar Vornr = changedData.Vornr;\r\n\t\t\tthis.fnUpdateOtherDataforPhase(Vornr, changedData);\r\n\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnUpdateOtherDataforPhase: function(Vornr, Data) {\r\n\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oData = oOperModel.getData(); // entire model data\r\n\t\t\tvar aOperations = oData.Operations; // the array of operations\r\n\r\n\t\t\tif (aOperations && aOperations.length > 0) {\r\n\t\t\t\tfor (var i = 0; i < aOperations.length; i++) {\r\n\t\t\t\t\tvar operationData = aOperations[i];\r\n\t\t\t\t\tif (operationData.Pvznr === Vornr && operationData.Phflg === true) {\r\n\t\t\t\t\t\toperationData.Steus = Data.Steus;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Set back only the Operations array\r\n\t\t\toOperModel.setProperty(\"/Operations\", aOperations);\r\n\t\t\toOperModel.refresh(true);\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tTable filter button Logic handling(Customize table, wrap text)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnCustomTable: function(oEvent) {\r\n\t\t\tvar oButton = oEvent.getSource();\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oList = new sap.m.List({\r\n\t\t\t\titems: [\r\n\t\t\t\t\tnew sap.m.StandardListItem({\r\n\t\t\t\t\t\ttitle: \"Customize\",\r\n\t\t\t\t\t\ttype: \"Active\",\r\n\t\t\t\t\t\ticon: \"Image/customize.svg\",\r\n\t\t\t\t\t\tpress: that.fnCustomize.bind(that)\r\n\t\t\t\t\t}).addStyleClass(\"cl_uwl_customizefilterlistitem\")\r\n\r\n\t\t\t\t\t// new sap.m.StandardListItem({\r\n\t\t\t\t\t// \ttitle: that.textWrap ? \"Clip Text\" : \"Wrap Text\",\r\n\t\t\t\t\t// \ttype: \"Active\",\r\n\t\t\t\t\t// \ticon: \"Image/Warptext.svg\"\r\n\t\t\t\t\t// }).addStyleClass(\"cl_uwl_wrapfilterlistitem\")\r\n\t\t\t\t]\r\n\t\t\t}).addStyleClass(\"cl_uwl_filterlistitem\");\r\n\r\n\t\t\tvar oClrButton = new sap.m.Button({\r\n\t\t\t\ttext: \"Clear\",\r\n\t\t\t\ticon: \"Image/Clearall.svg\",\r\n\t\t\t\tpress: function() {\r\n\t\t\t\t\tvar oTable = that.getView().byId(\"id_OperationTable\");\r\n\t\t\t\t\tvar aColumns = oTable.getColumns();\r\n\r\n\t\t\t\t\taColumns.forEach(function(oColumn) {\r\n\t\t\t\t\t\t// Clear filters\r\n\t\t\t\t\t\toTable.filter(oColumn, \"\");\r\n\r\n\t\t\t\t\t\t// Clear sorting\r\n\t\t\t\t\t\toColumn.setSorted(false);\r\n\t\t\t\t\t\toColumn.setSortOrder(null);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Remove sorters from binding\r\n\t\t\t\t\toTable.getBinding(\"rows\").sort(null);\r\n\t\t\t\t}\r\n\t\t\t}).addStyleClass(\"cl_primaryButton\");\r\n\r\n\t\t\tvar oPopover = new sap.m.Popover({\r\n\t\t\t\tplacement: sap.m.PlacementType.Bottom,\r\n\t\t\t\toffsetX: 54,\r\n\t\t\t\tcontent: new sap.m.VBox({\r\n\t\t\t\t\titems: [oList],\r\n\t\t\t\t\tjustifyContent: \"Center\",\r\n\t\t\t\t\talignItems: \"Center\"\r\n\t\t\t\t}),\r\n\t\t\t\tfooter: new sap.m.Bar({\r\n\t\t\t\t\tcontentMiddle: [oClrButton]\r\n\t\t\t\t})\r\n\t\t\t});\r\n\r\n\t\t\toPopover.addStyleClass(\"cl_uwl_PopOver sapUiSizeCompact\");\r\n\t\t\toPopover.openBy(oButton);\r\n\t\t},\r\n\r\n\t\tfnCustomize: function(oEvent) {\r\n\t\t\tvar vFinalBinding = [];\r\n\t\t\tvar vSelectedIndex = [];\r\n\t\t\tvar vColumnArray = this.getView().byId('id_OperationTable').getColumns();\r\n\t\t\tfor (var i = 0; i < vColumnArray.length; i++) {\r\n\t\t\t\tvFinalBinding.push({\r\n\t\t\t\t\tCName: vColumnArray[i].getLabel().getText(),\r\n\t\t\t\t\tCId: vColumnArray[i].getId().split('--').pop(),\r\n\t\t\t\t\tVisible: vColumnArray[i].getVisible(),\r\n\t\t\t\t\tIsFixed: i < 6\r\n\t\t\t\t});\r\n\t\t\t\tif (vColumnArray[i].getVisible()) {\r\n\t\t\t\t\tvSelectedIndex.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oVisibleModel = new sap.ui.model.json.JSONModel(vFinalBinding);\r\n\t\t\tthis.getView().setModel(oVisibleModel, \"JMColumn\");\r\n\r\n\t\t\tif (!this.Customzie) {\r\n\t\t\t\tthis.Customzie = sap.ui.xmlfragment(\"MANAGED_RECIPE.Fragment.customize_table\", this);\r\n\t\t\t\tthis.getView().addDependent(this.Customzie);\r\n\t\t\t}\r\n\t\t\tthis.Customzie.open();\r\n\t\t\tvar vItems = sap.ui.getCore().byId(\"id_columnSel\").getItems();\r\n\t\t\tthis.vSelectedIndex = vSelectedIndex; //Added for live filter functionaity\r\n\t\t\tthis.vItems = vItems; //Added for live filter functionaity\r\n\t\t\tif (vSelectedIndex.length === vItems.length) {\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").setSelected(true);\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\tsap.ui.getCore().byId(\"id_checkselect\").addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\t\t\tfor (i = 0; i < vSelectedIndex.length; i++) {\r\n\t\t\t\tvItems[vSelectedIndex[i]].getContent()[0].getContent()[0].removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\tvItems[vSelectedIndex[i]].getContent()[0].getContent()[0].addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t}\r\n\r\n\t\t\tfor (var j = 0; j < vItems.length; j++) {\r\n\t\t\t\tvar oItemCtx = vItems[j].getBindingContext(\"JMColumn\");\r\n\t\t\t\tvar bIsFixed = oItemCtx.getProperty(\"IsFixed\");\r\n\t\t\t\tif (bIsFixed) {\r\n\t\t\t\t\tvar oCheckBox = vItems[j].getContent()[0].getContent()[0];\r\n\t\t\t\t\toCheckBox.setSelected(true); // Always selected\r\n\t\t\t\t\toCheckBox.setEnabled(false); // Disable deselection\r\n\t\t\t\t\toCheckBox.addStyleClass(\"cl_fixed_checkbox\"); // Optional visual style\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//Apply column selection to the table\r\n\t\tfnApplyCustomizeColumn: function() {\r\n\t\t\tvar vColumnModel = this.getView().getModel(\"JMColumn\");\r\n\t\t\tvar vColumnArray = [];\r\n\t\t\tif (vColumnModel !== undefined) {\r\n\t\t\t\tvColumnModel.updateBindings(true);\r\n\t\t\t\tvColumnArray = vColumnModel.getData();\r\n\t\t\t}\r\n\t\t\tvar vAllFalse = vColumnArray.every(function(oItem) {\r\n\t\t\t\treturn oItem.Visible === false;\r\n\t\t\t});\r\n\t\t\tif (vAllFalse === true) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"ColumnSelectionMandatory\"), \"Warning\", this);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0; i < vColumnArray.length; i++) {\r\n\t\t\t\t\tthis.getView().byId(\"id_OperationTable\").getColumns()[i].setVisible(vColumnArray[i].Visible);\r\n\t\t\t\t}\r\n\t\t\t\tthis.fnCancel();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// Selection Mode\r\n\t\tfnCheckSel: function(oEvent) {\r\n\t\t\tif (!oEvent.getSource().getSelected()) {\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_checkbox\");\r\n\t\t\t} else {\r\n\r\n\t\t\t\toEvent.getSource().removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\toEvent.getSource().addStyleClass(\"cl_checkboxSel\");\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Select All\r\n\t\tfnCheckSelAll: function(oEvent) {\r\n\t\t\tvar oModel = this.getView().getModel(\"JMColumn\");\r\n\t\t\tvar aData = oModel.getData() || [];\r\n\t\t\tvar bSelectAll = !!oEvent.getSource().getSelected();\r\n\t\t\tvar oList = sap.ui.getCore().byId(\"id_columnSel\");\r\n\r\n\t\t\t// Update model data: ensure IsFixed and Visible\r\n\t\t\taData.forEach(function(item, i) {\r\n\t\t\t\titem.IsFixed = item.IsFixed === true || item.isFixed === true || i < 6;\r\n\t\t\t\titem.Visible = item.IsFixed || bSelectAll;\r\n\t\t\t});\r\n\r\n\t\t\toModel.setData(aData);\r\n\t\t\toModel.refresh(true);\r\n\r\n\t\t\t// Update fragment checkboxes\r\n\t\t\tif (oList) {\r\n\t\t\t\toList.getItems().forEach(function(oListItem, j) {\r\n\t\t\t\t\tvar oChk = oListItem.getContent()[0].getContent()[0];\r\n\t\t\t\t\tvar oRow = oListItem.getBindingContext(\"JMColumn\").getObject() || aData[j];\r\n\r\n\t\t\t\t\tif (oRow) {\r\n\t\t\t\t\t\toChk.setEnabled(!oRow.IsFixed);\r\n\t\t\t\t\t\toChk.setSelected(oRow.Visible);\r\n\t\t\t\t\t\toChk.removeStyleClass(oRow.Visible ? \"cl_checkbox\" : \"cl_checkboxSel\");\r\n\t\t\t\t\t\toChk.addStyleClass(oRow.Visible ? \"cl_checkboxSel\" : \"cl_checkbox\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Keep \"Select All\" checkbox consistent\r\n\t\t\tvar totalNonFixed = 0;\r\n\t\t\tvar selectedNonFixed = 0;\r\n\r\n\t\t\tfor (var i = 0; i < aData.length; i++) {\r\n\t\t\t\tif (!aData[i].IsFixed) {\r\n\t\t\t\t\ttotalNonFixed++;\r\n\t\t\t\t\tif (aData[i].Visible) {\r\n\t\t\t\t\t\tselectedNonFixed++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar oSelectAllChk = oEvent.getSource();\r\n\t\t\tvar isAllSelected = totalNonFixed > 0 && selectedNonFixed === totalNonFixed;\r\n\t\t\toSelectAllChk.setSelected(isAllSelected);\r\n\t\t\toSelectAllChk.removeStyleClass(isAllSelected ? \"cl_checkbox\" : \"cl_checkboxSel\");\r\n\t\t\toSelectAllChk.addStyleClass(isAllSelected ? \"cl_checkboxSel\" : \"cl_checkbox\");\r\n\t\t},\r\n\r\n\t\t// Close the popup\r\n\t\tfnCancel: function() {\r\n\t\t\tthis.Customzie.close();\r\n\t\t\tthis.Customzie.destroy();\r\n\t\t\tthis.Customzie = null;\r\n\t\t},\r\n\r\n\t\t// Filter Column Selection\r\n\t\tfnColumnFilter: function(oEvent) {\r\n\t\t\tvar vQuery = oEvent.getParameter(\"newValue\").toLowerCase();\r\n\r\n\t\t\t// Get the list\r\n\t\t\tvar vList = sap.ui.getCore().byId(\"id_columnSel\");\r\n\t\t\tvar vBinding = vList.getBinding(\"items\");\r\n\r\n\t\t\t// Apply filter\r\n\t\t\tif (vQuery) {\r\n\t\t\t\tvar oFilter = new sap.ui.model.Filter({\r\n\t\t\t\t\tpath: \"CName\",\r\n\t\t\t\t\toperator: sap.ui.model.FilterOperator.Contains,\r\n\t\t\t\t\tvalue1: vQuery,\r\n\t\t\t\t\tcaseSensitive: false\r\n\t\t\t\t});\r\n\t\t\t\tvBinding.filter([oFilter]);\r\n\t\t\t} else {\r\n\t\t\t\tvBinding.filter([]); // Reset filter\r\n\t\t\t}\r\n\r\n\t\t\t// After filtering, reapply CSS for selected and fixed checkboxes\r\n\t\t\tvar aItems = vList.getItems();\r\n\t\t\tfor (var i = 0; i < aItems.length; i++) {\r\n\t\t\t\tvar oItemCtx = aItems[i].getBindingContext(\"JMColumn\");\r\n\t\t\t\tvar oChk = aItems[i].getContent()[0].getContent()[0]; // checkbox\r\n\t\t\t\tvar bVisible = oItemCtx.getProperty(\"Visible\");\r\n\t\t\t\tvar bIsFixed = oItemCtx.getProperty(\"IsFixed\");\r\n\r\n\t\t\t\t// Remove any previous classes\r\n\t\t\t\toChk.removeStyleClass(\"cl_checkbox\");\r\n\t\t\t\toChk.removeStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\toChk.removeStyleClass(\"cl_fixed_checkbox\");\r\n\r\n\t\t\t\tif (bIsFixed) {\r\n\t\t\t\t\toChk.setSelected(true);\r\n\t\t\t\t\toChk.setEnabled(false);\r\n\t\t\t\t\toChk.addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\t} else if (bVisible) {\r\n\t\t\t\t\toChk.setSelected(true);\r\n\t\t\t\t\toChk.setEnabled(true);\r\n\t\t\t\t\toChk.addStyleClass(\"cl_checkboxSel\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChk.setSelected(false);\r\n\t\t\t\t\toChk.setEnabled(true);\r\n\t\t\t\t\toChk.addStyleClass(\"cl_checkbox\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar totalNonFixed = 0,\r\n\t\t\t\tselectedNonFixed = 0;\r\n\t\t\tvar aData = this.getView().getModel(\"JMColumn\").getData() || [];\r\n\t\t\tfor (var j = 0; j < aData.length; j++) {\r\n\t\t\t\tif (!aData[j].IsFixed) {\r\n\t\t\t\t\ttotalNonFixed++;\r\n\t\t\t\t\tif (aData[j].Visible) selectedNonFixed++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oSelectAllChk = sap.ui.getCore().byId('id_checkselect');\r\n\t\t\tvar isAllSelected = totalNonFixed > 0 && selectedNonFixed === totalNonFixed;\r\n\t\t\toSelectAllChk.setSelected(isAllSelected);\r\n\t\t\toSelectAllChk.removeStyleClass(isAllSelected ? \"cl_checkbox\" : \"cl_checkboxSel\");\r\n\t\t\toSelectAllChk.addStyleClass(isAllSelected ? \"cl_checkboxSel\" : \"cl_checkbox\");\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tFunction table Header button (Delete, Add, deselect, Search)\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnDeselectAll: function() {\r\n\t\t\tvar oTable = this.getView().byId(\"id_OperationTable\");\r\n\t\t\tif (oTable.getSelectedIndices().length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"No row selected\", \"Warning\", this);\r\n\t\t\t}\r\n\t\t\toTable.clearSelection();\r\n\t\t},\r\n\r\n\t\tfnFilterDBTable: function(oEvent) {\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().trim().toLowerCase();\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"rows\");\r\n\r\n\t\t\tif (!oBinding) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar aFilters = [];\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"Vornr\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"Description\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"Destination\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\tfnDeleteRow: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\t\t\tvar indexValue = [];\r\n\t\t\tindexValue.push(aSelectedIndices);\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"Please select a row to remove\", \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: i18n.getText(\"Information\"),\r\n\t\t\t\ttext: i18n.getText(\"DeleteRecordPhaseWarning\"),\r\n\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"DELETEROW\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnAddRow: function() {\r\n\t\t\tvar oOperModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tvar oEditableModel = this.getView().getModel(\"JM_EditableModel\");\r\n\r\n\t\t\tif (oOperModel && oEditableModel) {\r\n\t\t\t\tvar oData = oOperModel.getProperty(\"/Operations\") || [];\r\n\t\t\t\tvar lastVornor = Number(oData[oData.length - 1].Vornr);\r\n\t\t\t\tvar editableData = oEditableModel.getData() || {};\r\n\r\n\t\t\t\t// Get current date object\r\n\t\t\t\tvar currentDate = new Date();\r\n\t\t\t\tvar endDate = new Date(9999, 11, 31); // 31.12.9999\r\n\r\n\t\t\t\t// New row data\r\n\t\t\t\tvar newVornr = String(lastVornor + 10).padStart(4, \"0\");\r\n\t\t\t\tvar newRow = {\r\n\t\t\t\t\tVornr: newVornr, //operation\r\n\t\t\t\t\tPhflg: false, //phase\r\n\t\t\t\t\tPvznr: \"\", //sup_operation\r\n\t\t\t\t\tPhseq: \"\", //Destination\r\n\t\t\t\t\tArbpl: \"\", //Resource\r\n\t\t\t\t\tSteus: \"PI01\", //control key\r\n\t\t\t\t\tTxtkz: false,\r\n\t\t\t\t\tKtsch: \"\",\r\n\t\t\t\t\tLtxa1: \"\",\r\n\t\t\t\t\tTxtsp: \"\",\r\n\t\t\t\t\tCkselkz: \"X\",\r\n\t\t\t\t\tKlakz: false,\r\n\t\t\t\t\tBezkz: false,\r\n\t\t\t\t\tBmsch: this.Bmsch, //Base Quantity\r\n\t\t\t\t\tMeinh: this.Meinh, // Unit of Measures\r\n\t\t\t\t\tVgw01: \"\",\r\n\t\t\t\t\tVge01: \"\",\r\n\t\t\t\t\tLar01: \"\",\r\n\t\t\t\t\tVgw02: \"\",\r\n\t\t\t\t\tVge02: \"\",\r\n\t\t\t\t\tLar02: \"\",\r\n\t\t\t\t\tVgw03: \"\",\r\n\t\t\t\t\tVge03: \"\",\r\n\t\t\t\t\tLar03: \"\",\r\n\t\t\t\t\tVgw04: \"\",\r\n\t\t\t\t\tVge04: \"\",\r\n\t\t\t\t\tLar04: \"\",\r\n\t\t\t\t\tVgw05: \"\",\r\n\t\t\t\t\tVge05: \"\",\r\n\t\t\t\t\tLar05: \"\",\r\n\t\t\t\t\tVgw06: \"\",\r\n\t\t\t\t\tVge06: \"\",\r\n\t\t\t\t\tLar06: \"\",\r\n\t\t\t\t\tDdehn: false,\r\n\t\t\t\t\tWerks: this.getView().getModel(\"JM_KeydataModel\").getProperty(\"/Werks\"), //Plant\r\n\t\t\t\t\tAennr: \"\", // Change Number\r\n\t\t\t\t\tDatuv: currentDate, //valid from\r\n\t\t\t\t\tDatub: endDate, // valid to\r\n\t\t\t\t\tUmrez: this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Umrez\"), // charge Quantity\r\n\t\t\t\t\tUmren: this.getView().getModel(\"JM_RecipeData\").getProperty(\"/Umren\"), // Operation Quantity\r\n\t\t\t\t\tUsr00: \"\", // user fields\r\n\t\t\t\t\tUsr01: \"\", // user fields\r\n\t\t\t\t\tUsr02: \"\",\r\n\t\t\t\t\tUsr03: \"\",\r\n\t\t\t\t\tUsr04: \"\",\r\n\t\t\t\t\tUse04: \"\",\r\n\t\t\t\t\tUsr05: \"\",\r\n\t\t\t\t\tUse05: \"\",\r\n\t\t\t\t\tUsr06: \"\",\r\n\t\t\t\t\tUse06: \"\",\r\n\t\t\t\t\tUsr07: \"\",\r\n\t\t\t\t\tUse07: \"\",\r\n\t\t\t\t\tUsr08: \"\",\r\n\t\t\t\t\tUsr09: \"\",\r\n\t\t\t\t\tUsr10: false,\r\n\t\t\t\t\tUsr11: false,\r\n\t\t\t\t\tSlwid: \"\", //Key word ID for user-defined fields\r\n\t\t\t\t\tLoanz: \"\",\r\n\t\t\t\t\tLoart: \"\",\r\n\t\t\t\t\tLogrp: \"\",\r\n\t\t\t\t\tRsanz: \"\",\r\n\t\t\t\t\tPrz01: \"\",\r\n\t\t\t\t\tRasch: \"\",\r\n\t\t\t\t\tRfgrp: \"\",\r\n\t\t\t\t\tRfsch: \"\",\r\n\t\t\t\t\tQlkapar: \"\",\r\n\t\t\t\t\tAnzma: \"\",\r\n\t\t\t\t\tQpart: \"\",\r\n\t\t\t\t\tInfnr: \"\",\r\n\t\t\t\t\tEkorg: \"\",\r\n\t\t\t\t\tEbeln: \"\",\r\n\t\t\t\t\tEbelp: \"\",\r\n\t\t\t\t\tSortl: \"\",\r\n\t\t\t\t\tPlifz: \"\",\r\n\t\t\t\t\tMatkl: \"\",\r\n\t\t\t\t\tEkgrp: \"\",\r\n\t\t\t\t\tLifnr: \"\",\r\n\t\t\t\t\tPeinh: \"\",\r\n\t\t\t\t\tSakto: \"\",\r\n\t\t\t\t\tFrdlb: false,\r\n\t\t\t\t\tPreis: \"\",\r\n\t\t\t\t\tWaers: \"\",\r\n\t\t\t\t\tQlSearch: \"\",\r\n\t\t\t\t\tQsel1: true,\r\n\t\t\t\t\tQsel2: false,\r\n\t\t\t\t\tQsel3: false,\r\n\t\t\t\t\tVgtl1: \"\",\r\n\t\t\t\t\tVgtl2: \"\",\r\n\t\t\t\t\tVgtl3: \"\",\r\n\t\t\t\t\tVgtl4: \"\",\r\n\t\t\t\t\tVgtl5: \"\",\r\n\t\t\t\t\tVgtl6: \"\"\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Add to operations array\r\n\t\t\t\toData.push(newRow);\r\n\r\n\t\t\t\t// Update editable model for this new Vornr\r\n\t\t\t\teditableData[newVornr] = {\r\n\t\t\t\t\tVornr: \"nonEdit\", // Opeartion\r\n\t\t\t\t\tPhflg: \"Edit\", //phase\r\n\t\t\t\t\tPvznr: \"Edit\", //sup_operation\r\n\t\t\t\t\tPhseq: \"Edit\", //Destination\r\n\t\t\t\t\tArbpl: \"Edit\", //Resource\r\n\t\t\t\t\tCkselkz: \"nonEdit\", // Relevany to costing\r\n\t\t\t\t\tDdehn: \"nonEdit\", //flex\r\n\t\t\t\t\tMeinh: \"Edit\",\r\n\t\t\t\t\tBmsch: \"Edit\",\r\n\t\t\t\t\tKtsch: \"Edit\",\r\n\t\t\t\t\tLtxa1: \"Edit\",\r\n\t\t\t\t\tSteus: \"Edit\",\r\n\t\t\t\t\tVgw01: \"nonEdit\",\r\n\t\t\t\t\tVge01: \"nonEdit\",\r\n\t\t\t\t\tLar01: \"nonEdit\",\r\n\t\t\t\t\tVgw02: \"nonEdit\",\r\n\t\t\t\t\tVge02: \"nonEdit\",\r\n\t\t\t\t\tLar02: \"nonEdit\",\r\n\t\t\t\t\tVgw03: \"nonEdit\",\r\n\t\t\t\t\tVge03: \"nonEdit\",\r\n\t\t\t\t\tLar03: \"nonEdit\",\r\n\t\t\t\t\tVgw04: \"nonEdit\",\r\n\t\t\t\t\tVge04: \"nonEdit\",\r\n\t\t\t\t\tLar04: \"nonEdit\",\r\n\t\t\t\t\tVgw05: \"nonEdit\",\r\n\t\t\t\t\tVge05: \"nonEdit\",\r\n\t\t\t\t\tLar05: \"nonEdit\",\r\n\t\t\t\t\tVgw06: \"nonEdit\",\r\n\t\t\t\t\tVge06: \"nonEdit\",\r\n\t\t\t\t\tLar06: \"nonEdit\"\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Set back to models\r\n\t\t\t\toOperModel.setProperty(\"/Operations\", oData);\r\n\t\t\t\toOperModel.refresh(true);\r\n\r\n\t\t\t\toEditableModel.setData(editableData);\r\n\t\t\t\toEditableModel.refresh(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t\tUser field tab actions logics\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnUserFields: function() {\r\n\t\t\tvar sUFfields = this.getView().byId(\"id_userfield\").getSelectedKey();\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_UFTemplate\");\r\n\t\t\tswitch (sUFfields) {\r\n\t\t\t\tcase \"\":\r\n\t\t\t\t\toModel.setProperty(\"/Visible\", false);\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"0000001\":\r\n\t\t\t\t\toModel.setProperty(\"/Visible\", true);\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t\tif (this.oUFVisibleModel[\"0000001\"]) {\r\n\t\t\t\t\t\tvar data = this.oUFVisibleModel[\"0000001\"];\r\n\t\t\t\t\t\tvar oSetModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tSwrt0: data.Swrt0,\r\n\t\t\t\t\t\t\tSwrt1: data.Swrt1,\r\n\t\t\t\t\t\t\tSwrt2: data.Swrt2,\r\n\t\t\t\t\t\t\tSwrt3: data.Swrt3,\r\n\t\t\t\t\t\t\tSwrt4: data.Swrt4,\r\n\t\t\t\t\t\t\tSwrt5: data.Swrt5,\r\n\t\t\t\t\t\t\tSwrt6: data.Swrt6,\r\n\t\t\t\t\t\t\tSwrt7: data.Swrt7,\r\n\t\t\t\t\t\t\tSwrt8: data.Swrt8,\r\n\t\t\t\t\t\t\tSwrt9: data.Swrt9,\r\n\t\t\t\t\t\t\tSwrt10: data.Swrt10,\r\n\t\t\t\t\t\t\tSwrt11: data.Swrt11\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.getView().setModel(oSetModel, \"JM_UFTextTemplate\"); // local Model\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.firstTymUF) {\r\n\t\t\t\t\t\tthis.clearUserfieldValues();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.firstTymUF = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"WCM\":\r\n\t\t\t\t\toModel.setProperty(\"/Visible\", true);\r\n\t\t\t\t\toModel.refresh(true);\r\n\t\t\t\t\tif (this.oUFVisibleModel[\"WCM\"]) {\r\n\t\t\t\t\t\tdata = this.oUFVisibleModel[\"WCM\"];\r\n\t\t\t\t\t\toSetModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\tSwrt0: data.Swrt0,\r\n\t\t\t\t\t\t\tSwrt1: data.Swrt1,\r\n\t\t\t\t\t\t\tSwrt2: data.Swrt2,\r\n\t\t\t\t\t\t\tSwrt3: data.Swrt3,\r\n\t\t\t\t\t\t\tSwrt4: data.Swrt4,\r\n\t\t\t\t\t\t\tSwrt5: data.Swrt5,\r\n\t\t\t\t\t\t\tSwrt6: data.Swrt6,\r\n\t\t\t\t\t\t\tSwrt7: data.Swrt7,\r\n\t\t\t\t\t\t\tSwrt8: data.Swrt8,\r\n\t\t\t\t\t\t\tSwrt9: data.Swrt9,\r\n\t\t\t\t\t\t\tSwrt10: data.Swrt10,\r\n\t\t\t\t\t\t\tSwrt11: data.Swrt11\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.getView().setModel(oSetModel, \"JM_UFTextTemplate\"); // Local model\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.firstTymUF) {\r\n\t\t\t\t\t\tthis.clearUserfieldValues();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.firstTymUF = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tclearUserfieldValues: function() {\r\n\t\t\tvar opeartionDialogModel = this.getView().getModel(\"JM_ReciOperationsDialog\");\r\n\t\t\tif (opeartionDialogModel) {\r\n\t\t\t\t// var data = opeartionDialogModel.getData();\r\n\t\t\t\tfor (var i = 0; i < 10; i++) {\r\n\t\t\t\t\tvar filed = \"Usr\" + String(i).padStart(2, \"0\");\r\n\t\t\t\t\topeartionDialogModel.setProperty(\"/\" + filed, \"\");\r\n\t\t\t\t\topeartionDialogModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t\tSave and Navigate to Initiator screen \r\n\t\t// *----------------------------------------------------------------------------------------\r\n\r\n\t\tfnsaveOperation: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tthis.fnCheckValidation().then(function(state) {\r\n\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\tvar oPayload = that.fnCreatePayload();\r\n\t\t\t\t\t\tfor (var i = 0; i < oPayload.NavRecipe_Operation.length; i++) {\r\n\t\t\t\t\t\t\tObject.keys(oPayload.NavRecipe_Operation[i]).forEach(function(key) {\r\n\t\t\t\t\t\t\t\tif (key.endsWith(\"Des\")) {\r\n\t\t\t\t\t\t\t\t\tdelete oPayload.NavRecipe_Operation[i][key];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.fncheckValdation(oPayload);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(function(message) {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(message, \"Error\", that);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tfnCheckValidation: function() {\r\n\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\tvar EditableModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\t\tvar data = EditableModel ? EditableModel.getData() : {};\r\n\t\t\t\tvar errorIndex = -1;\r\n\t\t\t\tvar outerKey = null;\r\n\t\t\t\tvar errorKey = null;\r\n\t\t\t\tvar keys = Object.keys(data);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar k = keys[i];\r\n\t\t\t\t\tvar obj = data[k];\r\n\t\t\t\t\tfor (var f in obj) {\r\n\t\t\t\t\t\tif (obj.hasOwnProperty(f)) {\r\n\t\t\t\t\t\t\tif (obj[f] === \"Error\") {\r\n\t\t\t\t\t\t\t\terrorIndex = i;\r\n\t\t\t\t\t\t\t\touterKey = k;\r\n\t\t\t\t\t\t\t\terrorKey = f;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (errorIndex !== -1) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar message = \"\";\r\n\t\t\t\t// ---- FOUND ERROR  REJECT ----\r\n\t\t\t\tif (errorIndex !== -1) { // <-- FIXED CONDITION\r\n\t\t\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\t\t\tvar aRows = oTable.getRows();\r\n\t\t\t\t\tvar oRow = aRows[errorIndex];\r\n\t\t\t\t\tvar aCells = oRow.getCells();\r\n\t\t\t\t\tfor (var c = 0; c < aCells.length; c++) {\r\n\t\t\t\t\t\tvar cell = aCells[c];\r\n\t\t\t\t\t\tif (cell.getItems &&\r\n\t\t\t\t\t\t\tcell.getItems()[0] &&\r\n\t\t\t\t\t\t\tcell.getItems()[0].getValueState() === \"Error\") {\r\n\t\t\t\t\t\t\tmessage = cell.getItems()[0].getValueStateText();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmessage = (message === \"\") ? \"Validation Error\" : message;\r\n\t\t\t\t\treject(message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// ---- NO ERRORS ----\r\n\t\t\t\tresolve(true);\r\n\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tfnCreatePayload: function() {\r\n\t\t\tthis.fnClearChangedFlag();\r\n\t\t\tvar vOparationData = JSON.parse(\r\n\t\t\t\tJSON.stringify(this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations\"))\r\n\t\t\t);\r\n\t\t\tvar oPayload = {};\r\n\t\t\toPayload.NavRecipe_Operation = [];\r\n\r\n\t\t\t// Loop through all operation data\r\n\t\t\tvOparationData.forEach(function(data) {\r\n\t\t\t\t// Include only if at least one key field is not empty\r\n\t\t\t\tif (data.Arbpl !== \"\") {\r\n\t\t\t\t\tdata.Klakz = (data.Klakz === true) ? \"X\" : \"\";\r\n\t\t\t\t\tdata.Qsel1 = (data.Qsel1 === true) ? \"X\" : \"\";\r\n\t\t\t\t\tdata.Qsel2 = (data.Qsel2 === true) ? \"X\" : \"\";\r\n\t\t\t\t\tdata.Qsel3 = (data.Qsel3 === true) ? \"X\" : \"\";\r\n\t\t\t\t\tdata.Frdlb = (data.Frdlb === true) ? \"X\" : \"\";\r\n\t\t\t\t\tdata.Vgw01 = this.fnToEdmDecimal(data.Vgw01, 9, 3);\r\n\t\t\t\t\tdata.Vgw02 = this.fnToEdmDecimal(data.Vgw02, 9, 3);\r\n\t\t\t\t\tdata.Vgw03 = this.fnToEdmDecimal(data.Vgw03, 9, 3);\r\n\t\t\t\t\tdata.Vgw04 = this.fnToEdmDecimal(data.Vgw04, 9, 3);\r\n\t\t\t\t\tdata.Vgw05 = this.fnToEdmDecimal(data.Vgw05, 9, 3);\r\n\t\t\t\t\tdata.Vgw06 = this.fnToEdmDecimal(data.Vgw06, 9, 3);\r\n\t\t\t\t\tdata.Loanz = this.fnToEdmDecimal(data.Loanz, 3, 0);\r\n\t\t\t\t\tdata.Preis = this.fnToEdmDecimal(data.Preis, 9, 3);\r\n\t\t\t\t\tdata.Plifz = this.fnToEdmDecimal(data.Plifz, 3, 0);\r\n\t\t\t\t\tdata.Datuv = this.fntoEdmDateTime(data.Datuv);\r\n\t\t\t\t\tdata.Datub = this.fntoEdmDateTime(data.Datub);\r\n\t\t\t\t\tdata.Usr08 = data.Usr08 ? this.fntoEdmDateTime(data.Usr08) : null;\r\n\t\t\t\t\tdata.Usr09 = data.Usr09 ? this.fntoEdmDateTime(data.Usr09) : null;\r\n\t\t\t\t\tdata.Umrez = this.fnToEdmDecimal(data.Umrez, 5, 0);\r\n\t\t\t\t\tdata.Peinh = this.fnToEdmDecimal(data.Peinh, 5, 0);\r\n\t\t\t\t\tdata.Umren = this.fnToEdmDecimal(data.Umren, 5, 0);\r\n\t\t\t\t\tdata.Usr04 = this.fnToEdmDecimal(data.Usr04, 13, 3);\r\n\t\t\t\t\tdata.Usr05 = this.fnToEdmDecimal(data.Usr05, 13, 3);\r\n\t\t\t\t\tdata.Usr06 = this.fnToEdmDecimal(data.Usr06, 13, 3);\r\n\t\t\t\t\tdata.Usr07 = this.fnToEdmDecimal(data.Usr07, 13, 3);\r\n\t\t\t\t\tdata.Anzma = this.fnToEdmDecimal(data.Anzma, 5, 2);\r\n\t\t\t\t\toPayload.NavRecipe_Operation.push(data);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\r\n\t\t\treturn oPayload;\r\n\t\t},\r\n\t\tfnClearChangedFlag: function() {\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\tif (!oModel) return;\r\n\r\n\t\t\tvar aRows = oModel.getProperty(\"/Operations\") || [];\r\n\r\n\t\t\t// Remove the 'Changed' property from each row\r\n\t\t\tfor (var i = 0; i < aRows.length; i++) {\r\n\t\t\t\tif (aRows[i].hasOwnProperty(\"Changed\")) {\r\n\t\t\t\t\tdelete aRows[i].Changed;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update and refresh model bindings\r\n\t\t\toModel.setProperty(\"/Operations\", aRows);\r\n\t\t\toModel.refresh(true);\r\n\t\t},\r\n\r\n\t\tfnToEdmDecimal: function(value, totalDigits, decimalPlaces) {\r\n\t\t\tif (value === null || value === undefined || value === \"\") {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar num = parseFloat(value);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar fixedValue = num.toFixed(decimalPlaces);\r\n\t\t\tvar parts = fixedValue.split(\".\");\r\n\t\t\tvar intPart = parts[0];\r\n\t\t\tvar decPart = parts[1] || \"\";\r\n\t\t\tvar maxIntLength = totalDigits - decimalPlaces;\r\n\t\t\tif (intPart.length > maxIntLength) {\r\n\t\t\t\tintPart = intPart.slice(0, maxIntLength);\r\n\t\t\t}\r\n\t\t\tvar result = decimalPlaces > 0 ? intPart + \".\" + decPart : intPart;\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\t// fntoEdmDateTime: function(vValue) {\r\n\t\t// \tvar value = vValue;\r\n\t\t// \tif (typeof value === \"string\" && value.endsWith(\"Z\")) {\r\n\t\t// \t\treturn new Date(value);\r\n\t\t// \t}\r\n\t\t// \t// if (!vValue) {\r\n\t\t// \t// \treturn \"\";\r\n\t\t// \t// }\r\n\t\t// \t// // Ensure it's a valid Date object\r\n\t\t// \t// var oDate = new Date(vValue);\r\n\t\t// \t// // Handle invalid or timezone-shifted dates\r\n\t\t// \t// if (isNaN(oDate.getTime())) {\r\n\t\t// \t// \treturn vValue; // fallback\r\n\t\t// \t// }\r\n\t\t// \t// var oDateFormat = sap.ui.core.format.DateFormat.getDateTimeInstance({\r\n\t\t// \t// \tpattern: \"dd.MM.yyyy\",\r\n\t\t// \t// \tUTC: true // prevent timezone offset\r\n\t\t// \t// });\r\n\t\t// \t// return oDateFormat.format(oDate);\r\n\r\n\t\t// },\r\n\t\tfntoEdmDateTime: function(vValue) {\r\n\r\n\t\t\t// case 1: String ending with Z (UTC)\r\n\t\t\tif (typeof vValue === \"string\" && vValue.endsWith(\"Z\")) {\r\n\t\t\t\treturn new Date(vValue);\r\n\t\t\t}\r\n\r\n\t\t\t// case 2: Local date string like \"Fri Dec 31 9999 05:30:00 GMT+0530...\"\r\n\t\t\tif (typeof vValue === \"string\") {\r\n\t\t\t\treturn new Date(vValue);\r\n\t\t\t}\r\n\r\n\t\t\t// case 3: Already a Date object\r\n\t\t\tif (vValue instanceof Date) {\r\n\t\t\t\treturn vValue;\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tfncheckValdation: function(oPayload) {\r\n\t\t\toPayload.Ind = \"O\";\r\n\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\tvar serviceCall = this.getOwnerComponent().getModel();\r\n\t\t\tserviceCall.setUseBatch(false);\r\n\r\n\t\t\tbusyDialog.open();\r\n\t\t\tserviceCall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgTyp === \"E\") {\r\n\r\n\t\t\t\t\t\tvar ErrorPopUp = oData.NavReturn_Msg.results[0].Message;\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(ErrorPopUp, \"Error\", this);\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < oData.NavReturn_Msg.results.length; i++) {\r\n\t\t\t\t\t\t\tvar data = oData.NavReturn_Msg.results[i];\r\n\t\t\t\t\t\t\tvar oTable = this.byId(\"id_OperationTable\");\r\n\t\t\t\t\t\t\tvar oModel = oTable.getModel(\"JM_ReciOperations\"); // your table model\r\n\t\t\t\t\t\t\tvar aData = oModel.getProperty(\"/Operations\");\r\n\t\t\t\t\t\t\tvar searchValue = data.ItemNo;\r\n\r\n\t\t\t\t\t\t\tvar iIndex = aData.findIndex(function(item) {\r\n\t\t\t\t\t\t\t\treturn item.Vornr === searchValue; // <-- change field name as needed\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tif (iIndex !== -1) {\r\n\t\t\t\t\t\t\t\tvar sFieldName = data.Fnm.charAt(0).toUpperCase() + data.Fnm.slice(1).toLowerCase();\r\n\t\t\t\t\t\t\t\tthis.fnSetErrorState(\"/Operations/\" + iIndex, \"/Operations/\" + iIndex + \"/\" + sFieldName);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.fnClearChangeLog();\r\n\t\t\t\t\t\tvar oOperationData = {\r\n\t\t\t\t\t\t\tNavRecipe_Operation: oPayload.NavRecipe_Operation\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar oRecipeData = this.getOwnerComponent().getModel(\"JM_Operation\");\r\n\t\t\t\t\t\toRecipeData.setData(oOperationData); // replaces the data\r\n\t\t\t\t\t\toRecipeData.refresh(true); // updates the bindings\r\n\r\n\t\t\t\t\t\tvar oView = this.getView();\r\n\r\n\t\t\t\t\t\tvar aGlobalModels = [\r\n\t\t\t\t\t\t\t\"JM_EditableModel\",\r\n\t\t\t\t\t\t\t\"JM_ReciOperations\"\r\n\t\t\t\t\t\t];\r\n\r\n\t\t\t\t\t\taGlobalModels.forEach(function(sModelName) {\r\n\t\t\t\t\t\t\t// --- Clear from View level ---\r\n\t\t\t\t\t\t\tvar oViewModel = oView.getModel(sModelName);\r\n\t\t\t\t\t\t\tif (oViewModel) {\r\n\t\t\t\t\t\t\t\toViewModel.destroy(); // free memory\r\n\t\t\t\t\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel({}), sModelName);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// ----------------------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\tLogic for F4 check the field value is present or not in the field\r\n\t\t// ----------------------------------------------------------------------------------------------------\r\n\r\n\t\tfnCheckDatavalidation: function(id, value) {\r\n\t\t\tvar data = this.f4Cache[id];\r\n\t\t\tif (!data || !Array.isArray(data)) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tvar sQuery = value ? value.toUpperCase() : \"\";\r\n\t\t\tvar aMatched = [];\r\n\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taMatched = data.filter(function(item) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t(item.Value1 && item.Value1.toUpperCase().includes(sQuery))\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Return matched length\r\n\t\t\treturn aMatched.length;\r\n\t\t},\r\n\r\n\t\tfnQuanDataElementValidation: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tthis.selectedField = id;\r\n\r\n\t\t\toInput.setValueState(\"None\"); // Reset previous error\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + sFieldPath);\r\n\t\t\tvar inputType = oInput.getType();\r\n\t\t\tif (inputType === \"Number\") {\r\n\t\t\t\tvar maxLength = oInput.getMaxLength();\r\n\t\t\t\tvar hasDot = vValue.indexOf(\".\") !== -1;\r\n\r\n\t\t\t\t// Allowed chars: digits and single dot\r\n\t\t\t\tvValue = vValue.replace(/[^0-9.]/g, \"\");\r\n\r\n\t\t\t\t// Keep only the first dot\r\n\t\t\t\tvar firstDotIndex = vValue.indexOf(\".\");\r\n\t\t\t\tif (firstDotIndex !== -1) {\r\n\t\t\t\t\tvar parts = vValue.split(\".\");\r\n\t\t\t\t\tvar integerPart = parts[0];\r\n\t\t\t\t\tvar decimalPart = parts[1] ? parts[1].substring(0, 3) : \"\"; // limit to 3 decimals\r\n\t\t\t\t\tvValue = integerPart + (decimalPart ? \".\" + decimalPart : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Remove trailing dot if it exists\r\n\t\t\t\tif (vValue.charAt(vValue.length - 1) === \".\") {\r\n\t\t\t\t\tvValue = vValue.substring(0, vValue.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Determine effective max length\r\n\t\t\t\tvar effectiveMaxLength = hasDot ? maxLength + 1 : maxLength;\r\n\t\t\t\t// Prevent input if limit reached\r\n\t\t\t\tif (vValue.length > effectiveMaxLength) {\r\n\t\t\t\t\tvValue = vValue.substring(0, effectiveMaxLength);\r\n\t\t\t\t}\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnQuanDataElementValidation2Dec: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tthis.selectedField = id;\r\n\r\n\t\t\toInput.setValueState(\"None\"); // Reset previous error\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\tthis.fnClearErrorState(sRowPath, sRowPath + sFieldPath);\r\n\r\n\t\t\tvar inputType = oInput.getType();\r\n\t\t\tif (inputType === \"Number\") {\r\n\t\t\t\tvar maxLength = oInput.getMaxLength();\r\n\t\t\t\tvar hasDot = vValue.indexOf(\".\") !== -1;\r\n\r\n\t\t\t\t// Allowed chars: digits and single dot\r\n\t\t\t\tvValue = vValue.replace(/[^0-9.]/g, \"\");\r\n\r\n\t\t\t\t// Keep only the first dot\r\n\t\t\t\tvar firstDotIndex = vValue.indexOf(\".\");\r\n\t\t\t\tif (firstDotIndex !== -1) {\r\n\t\t\t\t\tvar parts = vValue.split(\".\");\r\n\t\t\t\t\tvar integerPart = parts[0];\r\n\t\t\t\t\tvar decimalPart = parts[1] ? parts[1].substring(0, 2) : \"\"; // limit to 3 decimals\r\n\t\t\t\t\tvValue = integerPart + (decimalPart ? \".\" + decimalPart : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Remove trailing dot if it exists\r\n\t\t\t\tif (vValue.charAt(vValue.length - 1) === \".\") {\r\n\t\t\t\t\tvValue = vValue.substring(0, vValue.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Determine effective max length\r\n\t\t\t\tvar effectiveMaxLength = hasDot ? maxLength + 1 : maxLength;\r\n\t\t\t\t// Prevent input if limit reached\r\n\t\t\t\tif (vValue.length > effectiveMaxLength) {\r\n\t\t\t\t\tvValue = vValue.substring(0, effectiveMaxLength);\r\n\t\t\t\t}\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnNumberFieldValidation: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar vValue = oInput.getValue();\r\n\t\t\tvar maxLength = oInput.getMaxLength(); // e.g., 10\r\n\r\n\t\t\tvar oBindInfo = oInput.getBindingInfo(\"value\");\r\n\t\t\tvar oContext = oBindInfo.binding.oContext;\r\n\t\t\tvar sFieldPath = oBindInfo.parts[0].path;\r\n\t\t\tvar sRowPath = oContext.getPath(); // e.g., \"/rows/0\"\r\n\r\n\t\t\t// Reset previous error\r\n\t\t\toInput.setValueState(\"None\");\r\n\r\n\t\t\t// Remove non-digit characters\r\n\t\t\tvar cleaned = vValue.replace(/[^0-9]/g, \"\");\r\n\r\n\t\t\t// Trim to maxLength if exceeded\r\n\t\t\tif (cleaned.length > maxLength) {\r\n\t\t\t\tcleaned = cleaned.substring(0, maxLength);\r\n\t\t\t}\r\n\r\n\t\t\t// Update input\r\n\t\t\toInput.setValue(cleaned);\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar vtriggeredCell = sRowPath + \"/\" + sFieldPath;\r\n\t\t\t\tthis.fnUpdateChangelog(sRowPath, vtriggeredCell, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnQuanDataElementValidationFrag: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tvar parent = oInput.getParent();\r\n\t\t\tparent.removeStyleClass(\"cl_errorState\"); // reset previous error\r\n\t\t\toInput.setValueState(\"None\"); // Reset previous error\r\n\r\n\t\t\tvar inputType = oInput.getType();\r\n\t\t\tif (inputType === \"Number\") {\r\n\t\t\t\tvar maxLength = oInput.getMaxLength();\r\n\t\t\t\tvar hasDot = vValue.indexOf(\".\") !== -1;\r\n\r\n\t\t\t\t// Allowed chars: digits and single dot\r\n\t\t\t\tvValue = vValue.replace(/[^0-9.]/g, \"\");\r\n\r\n\t\t\t\t// Keep only the first dot\r\n\t\t\t\tvar firstDotIndex = vValue.indexOf(\".\");\r\n\t\t\t\tif (firstDotIndex !== -1) {\r\n\t\t\t\t\tvar parts = vValue.split(\".\");\r\n\t\t\t\t\tvar integerPart = parts[0];\r\n\t\t\t\t\tvar decimalPart = parts[1] ? parts[1].substring(0, 3) : \"\"; // limit to 3 decimals\r\n\t\t\t\t\tvValue = integerPart + (decimalPart ? \".\" + decimalPart : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Remove trailing dot if it exists\r\n\t\t\t\tif (vValue.charAt(vValue.length - 1) === \".\") {\r\n\t\t\t\t\tvValue = vValue.substring(0, vValue.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Determine effective max length\r\n\t\t\t\tvar effectiveMaxLength = hasDot ? maxLength + 1 : maxLength;\r\n\t\t\t\t// Prevent input if limit reached\r\n\t\t\t\tif (vValue.length > effectiveMaxLength) {\r\n\t\t\t\t\tvValue = vValue.substring(0, effectiveMaxLength);\r\n\t\t\t\t}\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangeLogforFragment(id, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnQuanDataElementValidation2DecFrag: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oInput.getValue().toUpperCase();\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tvar parent = oInput.getParent();\r\n\t\t\tparent.removeStyleClass(\"cl_errorState\"); // reset previous error\r\n\t\t\toInput.setValueState(\"None\"); // Reset previous error\r\n\r\n\t\t\tvar inputType = oInput.getType();\r\n\t\t\tif (inputType === \"Number\") {\r\n\t\t\t\tvar maxLength = oInput.getMaxLength();\r\n\t\t\t\tvar hasDot = vValue.indexOf(\".\") !== -1;\r\n\r\n\t\t\t\t// Allowed chars: digits and single dot\r\n\t\t\t\tvValue = vValue.replace(/[^0-9.]/g, \"\");\r\n\r\n\t\t\t\t// Keep only the first dot\r\n\t\t\t\tvar firstDotIndex = vValue.indexOf(\".\");\r\n\t\t\t\tif (firstDotIndex !== -1) {\r\n\t\t\t\t\tvar parts = vValue.split(\".\");\r\n\t\t\t\t\tvar integerPart = parts[0];\r\n\t\t\t\t\tvar decimalPart = parts[1] ? parts[1].substring(0, 2) : \"\"; // limit to 3 decimals\r\n\t\t\t\t\tvValue = integerPart + (decimalPart ? \".\" + decimalPart : \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Remove trailing dot if it exists\r\n\t\t\t\tif (vValue.charAt(vValue.length - 1) === \".\") {\r\n\t\t\t\t\tvValue = vValue.substring(0, vValue.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Determine effective max length\r\n\t\t\t\tvar effectiveMaxLength = hasDot ? maxLength + 1 : maxLength;\r\n\t\t\t\t// Prevent input if limit reached\r\n\t\t\t\tif (vValue.length > effectiveMaxLength) {\r\n\t\t\t\t\tvValue = vValue.substring(0, effectiveMaxLength);\r\n\t\t\t\t}\r\n\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t}\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangeLogforFragment(id, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnNumberFieldValidationFrag: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar vValue = oInput.getValue();\r\n\t\t\tvar id = oInput.getId().split(\"--\")[1];\r\n\t\t\tvar maxLength = oInput.getMaxLength(); // e.g., 10\r\n\r\n\t\t\t// Reset previous error\r\n\t\t\toInput.setValueState(\"None\");\r\n\r\n\t\t\t// Remove non-digit characters\r\n\t\t\tvar cleaned = vValue.replace(/[^0-9]/g, \"\");\r\n\r\n\t\t\t// Trim to maxLength if exceeded\r\n\t\t\tif (cleaned.length > maxLength) {\r\n\t\t\t\tcleaned = cleaned.substring(0, maxLength);\r\n\t\t\t}\r\n\r\n\t\t\t// Update input\r\n\t\t\toInput.setValue(cleaned);\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangeLogforFragment(id, vValue);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnmakeEditDependentFields: function() {\r\n\t\t\tvar vSelectedRow = this.selectedF4path.split(\"/\")[2];\r\n\t\t\tvar vSelectedField = this.selectedF4path.split(\"/\")[3];\r\n\r\n\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + vSelectedRow + \"/Vornr\");\r\n\t\t\tvar vArbpl = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + vSelectedRow + \"/\" + vSelectedField);\r\n\t\t\tthis.getView().getModel(\"JM_ReciOperations\").setProperty(\"/Operations/\" + vSelectedRow + \"/Ckselkz\", \"\");\r\n\r\n\t\t\tif (vArbpl !== \"\") {\r\n\t\t\t\tvar oModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phflg\", \"Edit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Pvznr\", \"Edit\");\r\n\t\t\t\t\toModel.setProperty(\"/\" + vVornr + \"/Phseq\", \"Edit\");\r\n\t\t\t\t\toModel.updateBindings(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// ----------------------------------------------------------------------- added by sabarish for to navigation back and Cancel button\r\n\t\tfnCancelback: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar aModelsToDestroy = [\r\n\t\t\t\t\"JM_KeydataModel\",\r\n\t\t\t\t\"JM_RecipeData\",\r\n\t\t\t\t\"JM_UFModel\",\r\n\t\t\t\t\"JM_F4Model\",\r\n\t\t\t\t\"JM_Popup\",\r\n\t\t\t\t\"JM_UFTextTemplate\"\r\n\t\t\t];\r\n\r\n\t\t\taModelsToDestroy.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = oView.getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.destroy();\r\n\t\t\t\t\toView.setModel(null, sModelName);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnClearLogFunction();\r\n\t\t\t}\r\n\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t},\r\n\r\n\t\tfnClearLogFunction: function() {\r\n\t\t\t// Changed by srikanth\r\n\t\t\tvar oMainModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oMainModel) {\r\n\t\t\t\toMainModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\tthis.getOwnerComponent().setModel(oMainModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\t\t\tif (this.OrgChangeLog) {\r\n\t\t\t\toMainModel.setData(this.OrgChangeLog);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnBackConfirmation: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: i18n.getText(\"Information\"),\r\n\t\t\t\ttext: i18n.getText(\"UnsavedChangesLeaveConfirm\"),\r\n\t\t\t\tnegativeButton: \"No\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Yes\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"BACK\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnNavBack: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar aModelsToDestroy = [\r\n\t\t\t\t\"JM_KeydataModel\",\r\n\t\t\t\t\"JM_RecipeData\",\r\n\t\t\t\t\"JM_UFModel\",\r\n\t\t\t\t\"JM_F4Model\",\r\n\t\t\t\t\"JM_Popup\",\r\n\t\t\t\t\"JM_UFTextTemplate\"\r\n\t\t\t];\r\n\r\n\t\t\taModelsToDestroy.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = oView.getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.destroy();\r\n\t\t\t\t\toView.setModel(null, sModelName);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t},\r\n\r\n\t\tfnconvertCheckbox: function() {\r\n\t\t\tvar vOparationData = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations\");\r\n\t\t\tvar oPayload = {};\r\n\t\t\toPayload.NavRecipe_Operation = [];\r\n\r\n\t\t\t// Loop through all operation data\r\n\t\t\tvOparationData.forEach(function(data) {\r\n\t\t\t\t// Include only if at least one key field is not empty\r\n\t\t\t\tif (data.Arbpl !== \"\") {\r\n\t\t\t\t\tdata.Klakz = (data.Klakz === \"X\") ? true : false;\r\n\t\t\t\t\tdata.Qsel1 = (data.Qsel1 === \"X\") ? true : false;\r\n\t\t\t\t\tdata.Qsel2 = (data.Qsel2 === \"X\") ? true : false;\r\n\t\t\t\t\tdata.Qsel3 = (data.Qsel3 === \"X\") ? true : false;\r\n\t\t\t\t\tdata.Frdlb = (data.Frdlb === \"X\") ? true : false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnGetStandarFieldValues: function() {\r\n\t\t\tvar id = this.selectedF4path.split(\"/\")[2];\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tInd: \"T\"\r\n\t\t\t};\r\n\t\t\tvar oModelData = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + id);\r\n\t\t\tvar oCopy = JSON.parse(JSON.stringify(oModelData));\r\n\t\t\tvar oCorrectedData = this.fnModifyPayload(oCopy);\r\n\t\t\toPayload.NavRecipe_Operation = [oCorrectedData];\r\n\t\t\tvar serviceCall = this.getOwnerComponent().getModel();\r\n\r\n\t\t\toPayload.NavReturn_Msg = [];\r\n\t\t\tbusyDialog.open();\r\n\t\t\tserviceCall.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\r\n\t\t\t\t\toPayload = oData.NavRecipe_Operation.results[0];\r\n\t\t\t\t\tid = this.selectedF4path.split(\"/\")[2];\r\n\t\t\t\t\toModelData = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\t\tvar oModelData1 = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + id);\r\n\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl1\", oPayload.Vgtl1);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl2\", oPayload.Vgtl2);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl3\", oPayload.Vgtl3);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl4\", oPayload.Vgtl4);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl5\", oPayload.Vgtl5);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgtl6\", oPayload.Vgtl6);\r\n\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge01\", oPayload.Vge01);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge02\", oPayload.Vge02);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge03\", oPayload.Vge03);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge04\", oPayload.Vge04);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge05\", oPayload.Vge05);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vge06\", oPayload.Vge06);\r\n\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw01\", oPayload.Vgw01);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw02\", oPayload.Vgw02);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw03\", oPayload.Vgw03);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw04\", oPayload.Vgw04);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw05\", oPayload.Vgw05);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Vgw06\", oPayload.Vgw06);\r\n\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar01\", oPayload.Lar01);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar02\", oPayload.Lar02);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar03\", oPayload.Lar03);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar04\", oPayload.Lar04);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar05\", oPayload.Lar05);\r\n\t\t\t\t\toModelData.setProperty(\"/Operations/\" + id + \"/Lar06\", oPayload.Lar06);\r\n\r\n\t\t\t\t\toModelData.updateBindings(true);\r\n\r\n\t\t\t\t\tthis.fnNonEditStandardValues(oModelData1);\r\n\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnModifyPayload: function(payload) {\r\n\t\t\tdelete payload.Klakz;\r\n\t\t\tdelete payload.Qsel1;\r\n\t\t\tdelete payload.Qsel2;\r\n\t\t\tdelete payload.Qsel3;\r\n\t\t\tdelete payload.Frdlb;\r\n\t\t\tdelete payload.Ddehn;\r\n\t\t\tpayload.Vgw01 = this.fnToEdmDecimal(payload.Vgw01, 9, 3);\r\n\t\t\tpayload.Vgw02 = this.fnToEdmDecimal(payload.Vgw02, 9, 3);\r\n\t\t\tpayload.Vgw03 = this.fnToEdmDecimal(payload.Vgw03, 9, 3);\r\n\t\t\tpayload.Vgw04 = this.fnToEdmDecimal(payload.Vgw04, 9, 3);\r\n\t\t\tpayload.Vgw05 = this.fnToEdmDecimal(payload.Vgw05, 9, 3);\r\n\t\t\tpayload.Vgw06 = this.fnToEdmDecimal(payload.Vgw06, 9, 3);\r\n\t\t\tpayload.Loanz = this.fnToEdmDecimal(payload.Loanz, 3, 0);\r\n\t\t\tpayload.Preis = this.fnToEdmDecimal(payload.Preis, 3, 0);\r\n\t\t\tpayload.Plifz = this.fnToEdmDecimal(payload.Plifz, 3, 0);\r\n\t\t\tpayload.Datuv = this.fntoEdmDateTime(payload.Datuv);\r\n\t\t\tpayload.Datub = this.fntoEdmDateTime(payload.Datub);\r\n\t\t\tpayload.Umrez = this.fnToEdmDecimal(payload.Umrez, 5, 0);\r\n\t\t\tpayload.Umren = this.fnToEdmDecimal(payload.Umren, 5, 0);\r\n\t\t\tpayload.Peinh = this.fnToEdmDecimal(payload.Peinh, 5, 0);\r\n\t\t\tpayload.Usr04 = this.fnToEdmDecimal(payload.Usr04, 13, 3);\r\n\t\t\tpayload.Usr05 = this.fnToEdmDecimal(payload.Usr05, 13, 3);\r\n\t\t\tpayload.Usr06 = this.fnToEdmDecimal(payload.Usr06, 13, 3);\r\n\t\t\tpayload.Usr07 = this.fnToEdmDecimal(payload.Usr07, 13, 3);\r\n\t\t\tpayload.Anzma = this.fnToEdmDecimal(payload.Anzma, 5, 2);\r\n\t\t\tpayload.Usr08 = null;\r\n\t\t\tpayload.Usr09 = null;\r\n\t\t\treturn payload;\r\n\t\t},\r\n\r\n\t\tfnNonEditStandardValues: function(oModel) {\r\n\t\t\tvar data = oModel;\r\n\t\t\tvar id = this.selectedF4path.split(\"/\")[2];\r\n\t\t\tvar vVornr = this.getView().getModel(\"JM_ReciOperations\").getProperty(\"/Operations/\" + id + \"/Vornr\");\r\n\t\t\tvar oModel1 = this.getView().getModel(\"JM_EditableModel\");\r\n\r\n\t\t\t// Loop through 1 to 6\r\n\t\t\tfor (var i = 1; i <= 6; i++) {\r\n\t\t\t\tvar sIndex = (\"0\" + i).slice(-2); // \"01\"..\"06\"\r\n\t\t\t\tvar vgtlField = \"Vgtl\" + i;\r\n\t\t\t\tif (data[vgtlField] === \"\") {\r\n\t\t\t\t\t[\"Vge\", \"Vgw\", \"Lar\"].forEach(function(prefix) {\r\n\t\t\t\t\t\toModel1.setProperty(\"/\" + vVornr + \"/\" + prefix + sIndex, \"nonEdit\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnFocusTargetField: function(sTargetId) {\r\n\t\t\t// Define your tab ID mappings\r\n\t\t\tvar ID_STD_VALUES = [\r\n\t\t\t\t\"ID_OPER_VGW01_F\", \"ID_OPER_VGE01_F\",\r\n\t\t\t\t\"ID_OPER_VGW02_F\", \"ID_OPER_VGE02_F\",\r\n\t\t\t\t\"ID_OPER_VGW03_F\", \"ID_OPER_VGE03_F\",\r\n\t\t\t\t\"ID_OPER_VGW04_F\", \"ID_OPER_VGE04_F\",\r\n\t\t\t\t\"ID_OPER_VGW05_F\", \"ID_OPER_VGE05_F\",\r\n\t\t\t\t\"ID_OPER_VGW06_F\", \"ID_OPER_VGE06_F\"\r\n\t\t\t];\r\n\r\n\t\t\tvar ID_GEN_VALUES = [\r\n\t\t\t\t\"ID_OPER_CKSELKZ_F\",\r\n\t\t\t\t\"ID_OPER_QPART_F\",\r\n\t\t\t\t\"ID_OPER_INFNR_F\",\r\n\t\t\t\t\"ID_OPER_EKORG_F\",\r\n\t\t\t\t\"ID_OPER_EBELN_F\",\r\n\t\t\t\t\"ID_OPER_EBELP_F\",\r\n\t\t\t\t\"ID_OPER_MATKL_F\",\r\n\t\t\t\t\"ID_OPER_EKGRP_F\",\r\n\t\t\t\t\"ID_OPER_LIFNR_F\",\r\n\t\t\t\t\"ID_OPER_SAKTO_F\",\r\n\t\t\t\t\"ID_OPER_WAERS_F\"\r\n\t\t\t];\r\n\r\n\t\t\tvar oIconTabBar = this.byId(\"id_icontabbar\");\r\n\t\t\tvar sSelectedKey = \"\";\r\n\r\n\t\t\t// Use indexOf() instead of includes()\r\n\t\t\tif (ID_STD_VALUES.indexOf(sTargetId) !== -1) {\r\n\t\t\t\tsSelectedKey = \"ID_STD_VALUES\"; // tab key for Standard Values\r\n\t\t\t} else if (ID_GEN_VALUES.indexOf(sTargetId) !== -1) {\r\n\t\t\t\tsSelectedKey = \"ID_GEN_VALUES\"; // tab key for General Values\r\n\t\t\t}\r\n\r\n\t\t\tif (sSelectedKey) {\r\n\t\t\t\toIconTabBar.setSelectedKey(sSelectedKey);\r\n\r\n\t\t\t\t// Wait for UI to render before focusing\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tvar oTargetControl = this.byId(sTargetId);\r\n\t\t\t\t\tif (oTargetControl) {\r\n\t\t\t\t\t\toTargetControl.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this), 300);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnback: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar aModelsToDestroy = [\r\n\t\t\t\t\"JM_KeydataModel\",\r\n\t\t\t\t\"JM_RecipeData\",\r\n\t\t\t\t\"JM_UFModel\",\r\n\t\t\t\t\"JM_F4Model\",\r\n\t\t\t\t\"JM_Popup\",\r\n\t\t\t\t\"JM_UFTextTemplate\"\r\n\t\t\t];\r\n\r\n\t\t\taModelsToDestroy.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = oView.getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\toModel.destroy();\r\n\t\t\t\t\toView.setModel(null, sModelName);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t},\r\n\t\t//*-----------------------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\t Change Log Functionlalites\r\n\t\t// *----------------------------------------------------------------------------------------\r\n\t\tfnChangelog: function() {\r\n\t\t\tif (!this.Changelog) {\r\n\t\t\t\tthis.Changelog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ChangeLog\", // Fragment name\r\n\t\t\t\t\tthis // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.Changelog);\r\n\t\t\t}\r\n\r\n\t\t\tthis.Changelog.open();\r\n\t\t},\r\n\t\tfnCloseChanLogDialog: function() {\r\n\t\t\tif (this.Changelog) {\r\n\t\t\t\tthis.Changelog.close();\r\n\t\t\t\tthis.Changelog.destroy();\r\n\t\t\t\tthis.Changelog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSetErrorState: function(RowPath, triggerdpath) {\r\n\t\t\tvar Field = triggerdpath.split(\"/\").pop();\r\n\t\t\tvar EditableModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\tif (EditableModel) {\r\n\t\t\t\tvar OperationsModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\tif (OperationsModel) {\r\n\t\t\t\t\tvar vVornr = OperationsModel.getProperty(RowPath + \"/Vornr\");\r\n\t\t\t\t}\r\n\t\t\t\tEditableModel.setProperty(\"/\" + vVornr + \"/\" + Field, \"Error\");\r\n\t\t\t\tEditableModel.refresh(true);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfnClearErrorState: function(sRowPath, triggerdpath) {\r\n\t\t\tvar Field = triggerdpath.split(\"/\").pop();\r\n\t\t\tvar EditableModel = this.getView().getModel(\"JM_EditableModel\");\r\n\t\t\tif (EditableModel) {\r\n\t\t\t\tvar OperationsModel = this.getView().getModel(\"JM_ReciOperations\");\r\n\t\t\t\tif (OperationsModel) {\r\n\t\t\t\t\tvar vVornr = OperationsModel.getProperty(sRowPath + \"/Vornr\");\r\n\t\t\t\t}\r\n\t\t\t\tEditableModel.setProperty(\"/\" + vVornr + \"/\" + Field, \"nonError\");\r\n\t\t\t\tEditableModel.refresh(true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnInitializeScreen: function() {\r\n\t\t\tvar oContextModel = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\t\t\tvar oData = oContextModel.getData() || {};\r\n\r\n\t\t\t// If no context  default title\r\n\t\t\tif (!Object.keys(oData).length) {\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(\"Recipe Creation - Initiator\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar state = oData.Level;\r\n\t\t\tvar tranid = oData.Transid;\r\n\t\t\tvar AppId = oData.Appid;\r\n\t\t\tvar SendBack = oData.Sendback;\r\n\t\t\tvar Progress = oData.Progress;\r\n\t\t\tvar string = \"\";\r\n\r\n\t\t\t// Helper to set base title\r\n\t\t\tfunction getBase(AppId1) {\r\n\t\t\t\tif (AppId1 === \"RC\") {\r\n\t\t\t\t\treturn \"Recipe Opeartion Creation \";\r\n\t\t\t\t}\r\n\t\t\t\tif (AppId1 === \"RX\") {\r\n\t\t\t\t\treturn \"Recipe Change \";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"Recipe Operation Change \";\r\n\t\t\t}\r\n\r\n\t\t\t// ------- State A or R -------\r\n\t\t\tif (state === \"A\" || state === \"R\") {\r\n\t\t\t\tstring = getBase(AppId);\r\n\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Reviewer - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Approver - \" + tranid;\r\n\t\t\t\t} else if (SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// ------- State I -------\r\n\t\t\tif (state === \"I\") {\r\n\t\t\t\tvar footerBtnModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\tsendBack: false,\r\n\t\t\t\t\tReject: false,\r\n\t\t\t\t\tDraft: false\r\n\t\t\t\t});\r\n\t\t\t\tthis.getView().setModel(footerBtnModel, \"JM_FooterBtnModel\");\r\n\r\n\t\t\t\tstring = getBase(AppId);\r\n\r\n\t\t\t\tif (Progress === \"Complete\") {\r\n\t\t\t\t\tstring += \"- Completed Record - \" + tranid;\r\n\t\t\t\t} else if (Progress === \"Inprogress\") {\r\n\t\t\t\t\tstring += \"- Inprogress Record - \" + tranid;\r\n\t\t\t\t} else if (Progress === \"Draft\") {\r\n\t\t\t\t\tstring += \"- Drafted Record - \" + tranid;\r\n\t\t\t\t} else if (Progress === \"SendBack\" || SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t} else if (Progress === \"Reject\") {\r\n\t\t\t\t\tstring += \"- Rejected Record - \" + tranid;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstring += \"- Initiator - \" + tranid;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// ------- Other states -------\r\n\t\t\tstring = \"Recipe Operation Change - Initiator\";\r\n\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t}\r\n\r\n\t});\r\n\r\n});",
		"MANAGED_RECIPE/controller/pv_detail.controller.js": "sap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n\r\n], function(Controller, ErrorHandler, FilterOperator, Filter, formatter, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\tvar TransId;\r\n\tvar i18n;\r\n\r\n\tvar frontEndId = [\"ID_PV_BSTMI\", \"ID_PV_BSTMA\", \"ID_PV_ADATU\", \"ID_PV_BDATU\",\r\n\t\t\"ID_PV_CSPLT\", \"ID_PV_MDV01\", \"ID_PV_MDV02\", \"ID_PV_PNGUID\", \"ID_PV_MATKO\",\r\n\t\t\"ID_PV_VERTO\", \"ID_PV_ELPRO\", \"ID_PV_EWM_LGNUM\", \"ID_PV_ALORT\",\r\n\t\t\"ID_PV_UCMAT\", \"ID_PV_EWM_LGPLA\", \"ID_PV_TSA_PRVBE\", \"ID_PV_PRVBE\",\r\n\t\t\"ID_PV_TEXT1\", \"ID_PV_SERKZ\", \"ID_PV_MKSP\"\r\n\t];\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.pv_detail\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\tonInit: function() {\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"pv_detail\").attachPatternMatched(this.fnRouter, this);\r\n\t\t\tthis.f4Cache = {};\r\n\t\t},\r\n\r\n\t\tfnRouter: function() {\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\t\t\t// ********************* i18n MODEL ************************\r\n\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\t// **********************************************************\r\n\r\n\t\t\tvar that = this;\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\r\n\t\t\tvar oKeyDataModel = oComponent.getModel(\"JM_KeyData\");\r\n\t\t\tvar oGlobalProductionModel = oComponent.getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oGlobalOperationModel = oComponent.getModel(\"JM_Operation\");\r\n\t\t\tvar oRecipeModel = oComponent.getModel(\"JM_Recipe\");\r\n\t\t\tvar oContextModel = oComponent.getModel(\"JM_ContextModel\");\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel('JMConfig');\r\n\t\t\tbusyDialog.open();\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_UserModel\");\r\n\t\t\t\t\tthat.UserName = oData.results[0].Uname;\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.AppId = oKeyDataModel.getProperty(\"/AppId\");\r\n\t\t\tthis.finalCheck = false;\r\n\t\t\tthis.aErrorIds = [];\r\n\r\n\t\t\tvar oKeyData = oKeyDataModel.getData() || {};\r\n\t\t\tvar oRecipeData = oRecipeModel.getData() || {};\r\n\r\n\t\t\t// --- Key Data & Recipe Check ---\r\n\t\t\tif (Object.keys(oKeyData).length > 0 && Object.keys(oRecipeData).length > 0) {\r\n\t\t\t\tvar oHBoxBOM = oView.byId(\"ID_BOMIND\");\r\n\t\t\t\tvar oBtnBOM = oView.byId(\"ID_BOMIND_BTN\");\r\n\t\t\t\toHBoxBOM.setVisible(true);\r\n\r\n\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(oKeyData), \"JM_KeydataModel\");\r\n\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(oRecipeData), \"JM_RecipeData\");\r\n\r\n\t\t\t\tif (Object.keys(oGlobalOperationModel.getData() || {}).length > 0) {\r\n\t\t\t\t\tvar OperationData = oGlobalOperationModel.getData();\r\n\t\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(OperationData), \"JM_OperationsData\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\toBtnBOM.removeStyleClass(\"cl_IndicatorS cl_IndicatorP cl_IndicatorR\");\r\n\t\t\t\toBtnBOM.setIcon(\"Image/IndicatorP.svg\");\r\n\t\t\t\toBtnBOM.setText(\"Pending\");\r\n\t\t\t\toBtnBOM.setType(\"Emphasized\");\r\n\t\t\t\toBtnBOM.addStyleClass(\"cl_IndicatorP\");\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oUwlData = oContextModel.getData() || {};\r\n\t\t\tvar oTable = oView.byId(\"idMaterialComTable\");\r\n\t\t\t// --- UWL Context Handling ---\r\n\t\t\tif (Object.keys(oUwlData).length > 0) {\r\n\t\t\t\tthis.fnhandleUWLScenario(oUwlData, oKeyDataModel, oGlobalProductionModel, oGlobalOperationModel, oTable);\r\n\t\t\t} else {\r\n\t\t\t\t// Default Path (no UWL data)\r\n\t\t\t\tthis.fnInitializeScreen();\r\n\t\t\t\tthis.fnsetInitialModel();\r\n\t\t\t}\r\n\r\n\t\t\tthis.hasGlobalValue = true;\r\n\t\t\tthis.fnSetProductVersionIndicator();\r\n\t\t\t// *************** Change Log highlight logic ***************\r\n\t\t\tthis.fnChangeLogHighlighter(oUwlData, oTable);\r\n\r\n\t\t},\r\n\r\n\t\tfnhandleUWLScenario: function(oUwlData, oKeyDataModel, oGlobalProductionModel, oGlobalOperationModel, oTable) {\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tTransId = oUwlData.Transid;\r\n\t\t\toView.setModel(new sap.ui.model.json.JSONModel(oUwlData), \"JM_ContextModel\");\r\n\t\t\tthis.fnInitializeScreen();\r\n\t\t\tvar oDescModel = sap.ui.getCore().getModel(\"JM_DescriptionModel\");\r\n\t\t\tif (oKeyDataModel && oGlobalProductionModel && oGlobalOperationModel && oDescModel) {\r\n\t\t\t\tvar KeyData = oKeyDataModel.getData();\r\n\t\t\t\tvar ProdVersionData = oGlobalProductionModel.getData();\r\n\t\t\t\tvar aOperationData = oGlobalOperationModel.getData().NavRecipe_Operation;\r\n\t\t\t\tvar aDescData = oDescModel.getData();\r\n\r\n\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(KeyData), \"JM_KeydataModel\");\r\n\r\n\t\t\t\tif (!oView.getModel(\"JM_DescriptionModel\")) {\r\n\t\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(aDescData), \"JM_DescriptionModel\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (ProdVersionData.NavPV_BasicFields && ProdVersionData.NavPV_BasicFields.length > 0 ||\r\n\t\t\t\t\tProdVersionData.NavPV_MaterialCompData && ProdVersionData.NavPV_MaterialCompData.length > 0) {\r\n\r\n\t\t\t\t\tvar basicData = ProdVersionData.NavPV_BasicFields[0];\r\n\t\t\t\t\tbasicData.Mksp = basicData.Mksp || \"0\";\r\n\t\t\t\t\tObject.keys(basicData).forEach(function(key) {\r\n\t\t\t\t\t\tProdVersionData[key] = basicData[key];\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (ProdVersionData.NavPV_MaterialCompData.length <= 10) {\r\n\t\t\t\t\t\toTable.setVisibleRowCount(ProdVersionData.NavPV_MaterialCompData.length);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toTable.setVisibleRowCount(10);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// var oPvData = JSON.parse(JSON.stringify(ProdVersionData));\r\n\t\t\t\t\tvar oPvData = jQuery.extend(true, {}, ProdVersionData);\r\n\t\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(oPvData), \"JM_ProductionModel\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toComponent.setModel(new sap.ui.model.json.JSONModel({}), \"JM_ProductionVrsn\");\r\n\t\t\t\t\tthis.fnsetInitialModel();\r\n\t\t\t\t}\r\n\t\t\t\t// var oOprData = JSON.parse(JSON.stringify(aOperationData));\r\n\t\t\t\tvar oOprData = jQuery.extend(true, [], aOperationData);\r\n\t\t\t\tvar oOperationsDataModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\"NavRecipe_Operation\": oOprData\r\n\t\t\t\t});\r\n\t\t\t\toView.setModel(oOperationsDataModel, \"JM_OperationsData\");\r\n\t\t\t\tsap.ui.getCore().setModel(oOperationsDataModel, \"JM_ComponentMaterial\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnsetInitialModel: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oTable = oView.byId(\"idMaterialComTable\");\r\n\r\n\t\t\tvar oPvModel = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oPvData = oPvModel.getData() || {};\r\n\r\n\t\t\tvar oRecipeModel = oView.getModel(\"JM_RecipeData\");\r\n\t\t\tvar oKeyDataModel = oView.getModel(\"JM_KeydataModel\");\r\n\r\n\t\t\t// -------------------------\r\n\t\t\t// CASE 1: NEW MODEL (EMPTY)\r\n\t\t\t// -------------------------\r\n\t\t\tif (Object.keys(oPvData).length === 0) {\r\n\r\n\t\t\t\tvar oNewModel = {\r\n\t\t\t\t\tVerid: \"\",\r\n\t\t\t\t\tMksp: \"0\",\r\n\t\t\t\t\tBstmi: oRecipeModel.getProperty(\"/Losvn\"),\r\n\t\t\t\t\tBstma: oRecipeModel.getProperty(\"/Losbs\"),\r\n\t\t\t\t\tAdatu: \"\",\r\n\t\t\t\t\tBdatu: \"\",\r\n\t\t\t\t\tPlnty: \"\",\r\n\t\t\t\t\tPlnnr: \"\",\r\n\t\t\t\t\tAlnal: \"\",\r\n\t\t\t\t\tStlal: \"\",\r\n\t\t\t\t\tStlan: \"\",\r\n\t\t\t\t\tCsplt: \"\",\r\n\t\t\t\t\tSerkz: null,\r\n\t\t\t\t\tMdv01: \"\",\r\n\t\t\t\t\tMdv02: \"\",\r\n\t\t\t\t\tPnguid: null,\r\n\t\t\t\t\tText1: oKeyDataModel.getProperty(\"/Maktx\"),\r\n\t\t\t\t\tNavPV_MaterialCompData: []\r\n\t\t\t\t};\r\n\r\n\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(oNewModel), \"JM_ProductionModel\");\r\n\t\t\t\toTable.setVisibleRowCount(6);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// --------------------------------------------\r\n\t\t\t\t// CASE 2: EXISTING MODEL  CLEAN MATERIAL ITEMS\r\n\t\t\t\t// --------------------------------------------\r\n\t\t\t\tvar aCompList = oPvData.NavPV_MaterialCompData || [];\r\n\r\n\t\t\t\taCompList = aCompList.filter(function(item) {\r\n\t\t\t\t\treturn item.Idnrk && item.Idnrk.trim() !== \"\";\r\n\t\t\t\t});\r\n\r\n\t\t\t\toPvData.Text1 = oKeyDataModel.getProperty(\"/Maktx\");\r\n\t\t\t\toPvData.NavPV_MaterialCompData = aCompList;\r\n\t\t\t\tvar sPvData = jQuery.extend(true, {}, oPvData);\r\n\t\t\t\toView.setModel(new sap.ui.model.json.JSONModel(sPvData), \"JM_ProductionModel\");\r\n\r\n\t\t\t\toTable.setVisibleRowCount(aCompList.length);\r\n\r\n\t\t\t\t// BOM Button UI update\r\n\t\t\t\tif (aCompList.length > 0) {\r\n\t\t\t\t\tthis.fnsetIndicator(oView, \"ID_BOMIND\", \"ID_BOMIND_BTN\", \"Success\");\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// -------------------------\r\n\t\t\t// DATE HANDLING SECTION\r\n\t\t\t// -------------------------\r\n\t\t\tvar oValidTo = oView.byId(\"ID_PV_BDATU\");\r\n\t\t\toValidTo.setDateValue(new Date(9999, 11, 31));\r\n\r\n\t\t\tvar oValidFrom = oView.byId(\"ID_PV_ADATU\");\r\n\t\t\tvar today = new Date();\r\n\t\t\ttoday.setHours(5, 30, 0, 0);\r\n\t\t\toValidFrom.setDateValue(today);\r\n\t\t},\r\n\r\n\t\tfnInitializeScreen: function() {\r\n\t\t\tvar contextModel = this.getOwnerComponent().getModel(\"JM_ContextModel\");\r\n\r\n\t\t\tif (!Object.keys(contextModel.getData() || {}).length) {\r\n\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(\"Recipe Production Version Creation - Initiator\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar state = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Level\");\r\n\t\t\tvar tranid = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Transid\");\r\n\t\t\tvar AppId = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Appid\");\r\n\t\t\tvar SendBack = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Sendback\");\r\n\t\t\tvar Progress = this.getOwnerComponent().getModel(\"JM_ContextModel\").getProperty(\"/Progress\");\r\n\r\n\t\t\tif (state === \"A\") {\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Reviewer - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Approver - \" + tranid;\r\n\t\t\t\t} else if (state === \"R\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else if (state === \"R\") {\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"R\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Reviewer - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack !== \"X\") {\r\n\t\t\t\t\tstring += \"- Approver - \" + tranid;\r\n\t\t\t\t} else if (state === \"R\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t} else if (state === \"A\" && SendBack === \"X\") {\r\n\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else if (state === \"I\") {\r\n\r\n\t\t\t\tvar string = \"\";\r\n\t\t\t\tif (AppId === \"RC\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Creation \";\r\n\t\t\t\t} else if (AppId === \"RX\") {\r\n\t\t\t\t\tstring = \"Recipe Production Version Change \";\r\n\t\t\t\t}\r\n\t\t\t\tif (state === \"I\") {\r\n\t\t\t\t\tif (Progress === \"Complete\") {\r\n\t\t\t\t\t\tstring += \"- Completed Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Inprogress\") {\r\n\t\t\t\t\t\tstring += \"- Inprogress Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Draft\") {\r\n\t\t\t\t\t\tstring += \"- Drafted Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"SendBack\" || SendBack === \"X\") {\r\n\t\t\t\t\t\tstring += \"- Send Back Record - \" + tranid;\r\n\t\t\t\t\t} else if (Progress === \"Reject\") {\r\n\t\t\t\t\t\tstring += \"- Rejected Record - \" + tranid;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// No Progress, no SendBack  Default\r\n\t\t\t\t\t\tstring += \"- Initiator - \" + tranid;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string);\r\n\t\t\t} else {\r\n\t\t\t\tvar string = \"\";\r\n\r\n\t\t\t\tstring = \"Recipe Production Version Change \";\r\n\r\n\t\t\t\tthis.getView().byId(\"id_title\").setText(string + \" - Initiator\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnChangeLogHighlighter: function(oUwlData, oTable) {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tvar aChangeLogData = (oChangeLogModel && Array.isArray(oChangeLogModel.getData())) ? oChangeLogModel.getData() : [];\r\n\t\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0 && oUwlData.Appid === \"RX\") {\r\n\r\n\t\t\t\t\tthis.OrgChangeLog = JSON.parse(JSON.stringify(aChangeLogData));\r\n\r\n\t\t\t\t\tvar aChangedItems = aChangeLogData.filter(function(item) {\r\n\t\t\t\t\t\treturn item.ProcessInd === \"P\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar aChangedItemNos = aChangedItems.filter(function(oItem) {\r\n\t\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.map(function(oItem) {\r\n\t\t\t\t\t\t\treturn oItem.ItemNo;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Apply row-level highlight using RowSettings\r\n\t\t\t\t\toTable.setRowSettingsTemplate(\r\n\t\t\t\t\t\tnew sap.ui.table.RowSettings({\r\n\t\t\t\t\t\t\thighlight: {\r\n\t\t\t\t\t\t\t\tpath: \"JM_ProductionModel>Posnr\",\r\n\t\t\t\t\t\t\t\tformatter: function(sPosnr) {\r\n\t\t\t\t\t\t\t\t\tif (aChangedItemNos.includes(sPosnr)) {\r\n\t\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.Indication06; // Highlight color\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn sap.ui.core.IndicationColor.None;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\taChangedItems.forEach(function(oItem) {\r\n\t\t\t\t\t\t\tif (!oItem.ItemNo && oItem.FieldId) {\r\n\t\t\t\t\t\t\t\tvar oControl = oView.byId(oItem.FieldId);\r\n\t\t\t\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\t\t\t\toControl.addStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, 200);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.OrgChangeLog = JSON.parse(JSON.stringify(aChangeLogData));\r\n\t\t\t\t}\r\n\t\t\t\tvar ProductionModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\t\tif (ProductionModel) {\r\n\t\t\t\t\tif (!this.oldValue) {\r\n\t\t\t\t\t\tthis.oldValue = JSON.parse(JSON.stringify(ProductionModel.getData()));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// F4 fucntionalities\r\n\r\n\t\tfnF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.bindTextF4model(\"P\", id, \"X\", oEvent);\r\n\t\t},\r\n\r\n\t\tbindTextF4model: function(SearchHelp, sitem, process, oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar KeyModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tif (KeyModel) {\r\n\t\t\t\tvar Werks = KeyModel.getProperty(\"/Werks\");\r\n\t\t\t\tvar Matnr = KeyModel.getProperty(\"/Matnr\");\r\n\t\t\t}\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp\r\n\t\t\t};\r\n\r\n\t\t\tif ([\"ID_PV_VERID\", \"ID_PV_STLAL\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"MATNR\";\r\n\t\t\t\toPayload.Value1 =(/^\\d+$/.test(Matnr)) ? (\"000000000000000000\" + Matnr).slice(-18) : Matnr;\r\n\t\t\t\toPayload.FieldNam2 = \"WERKS\";\r\n\t\t\t\toPayload.Value2 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t} else if ([\"ID_PV_ELPRO\", \"ID_PV_ALORT\", \"ID_PV_PRVBE\", \"ID_PV_TSA_PRVBE\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t}\r\n\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgType === \"I\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.Message, \"Error\", that);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar aResults = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (!aResults.length) return;\r\n\r\n\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", that);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// --- Build Labels ---\r\n\t\t\t\t\tvar oLabels = {\r\n\t\t\t\t\t\tcol1: oFirst.Label1 || \"Key\",\r\n\t\t\t\t\t\tcol2: oFirst.Label2 || \"\",\r\n\t\t\t\t\t\tcol3: oFirst.Label3 || \"\",\r\n\t\t\t\t\t\tcol4: oFirst.Label4 || \"\"\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// --- Build Rows ---\r\n\t\t\t\t\tvar aFormattedRows = aResults.map(function(item) {\r\n\t\t\t\t\t\tvar row = {\r\n\t\t\t\t\t\t\tcol1: oLabels.col1 ? item.Value1 : \"\",\r\n\t\t\t\t\t\t\tcol2: oLabels.col2 ? item.Value2 : \"\",\r\n\t\t\t\t\t\t\tcol3: oLabels.col3 ? item.Value3 : \"\",\r\n\t\t\t\t\t\t\tcol4: oLabels.col4 ? item.Value4 : \"\"\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// Remove leading zeros for Material fields\r\n\t\t\t\t\t\t[\"col1\", \"col4\"].forEach(function(key) {\r\n\t\t\t\t\t\t\tif (oLabels[key] === \"Material\" && row[key]) {\r\n\t\t\t\t\t\t\t\trow[key] = row[key].replace(/^0+/, \"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn row;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\r\n\t\t\t\t\tvar oCtrl = sap.ui.getCore().byId(that.sitem + \"_TXT\");\r\n\t\t\t\t\tvar vTitle = \"\";\r\n\r\n\t\t\t\t\tif (oCtrl && oCtrl.getText) {\r\n\t\t\t\t\t\tvTitle = oCtrl.getText() + \" (\" + aFormattedRows.length + \")\";\r\n\t\t\t\t\t} else if (oLabels.col1) {\r\n\t\t\t\t\t\tvTitle = oLabels.col1 + \" (\" + aFormattedRows.length + \")\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvTitle = \"List (\" + aFormattedRows.length + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t},\r\n\t\t\t\terror: function() {\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tthis.hasGlobalValue = false;\r\n\t\t\tthis.fnSetProductVersionIndicator();\r\n\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar item = oContext.getProperty(\"col1\");\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\");\r\n\r\n\t\t\tthis.getView().byId(this.selectedField).setValue(item);\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\tvar sDesField = this.getView().byId(this.selectedField + \"_DES\");\r\n\t\t\tvar BOMUsage = this.getView().byId(\"ID_PV_STLAN\");\r\n\t\t\tif (sDesField) {\r\n\t\t\t\tsDesField.setValue(item1);\r\n\t\t\t\tsDesField.setValueState(\"None\");\r\n\t\t\t}\r\n\t\t\tif (this.selectedField === \"ID_PV_STLAL\") {\r\n\t\t\t\tBOMUsage.setValue(item1);\r\n\t\t\t\tBOMUsage.setValueState(\"None\");\r\n\t\t\t\tthis.hasGlobalValue = false;\r\n\t\t\t\tthis.fnSetProductVersionIndicator();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.selectedField === \"ID_PV_STLAN\" || this.selectedField === \"ID_PV_STLAL\") {\r\n\t\t\t\tvar pvModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\t\tif (pvModel) {\r\n\t\t\t\t\tpvModel.setProperty(\"/NavPV_MaterialCompData\", []); // reset to empty array\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oComponentModel = sap.ui.getCore().getModel(\"JM_ComponentMaterial\");\r\n\t\t\t\tif (oComponentModel) {\r\n\t\t\t\t\toComponentModel.setData([]);\r\n\t\t\t\t\toComponentModel.refresh(true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oTable = this.getView().byId(\"idMaterialComTable\");\r\n\t\t\t\toTable.setVisibleRowCount(6);\r\n\t\t\t\tthis.fnsetIndicator(oView, \"ID_BOMIND\", \"ID_BOMIND_BTN\", \"Pending\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(this.selectedField);\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) return;\r\n\t\t\tvar aFilters = [];\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\tfnCheckBoxLiveChange: function(oEvent) {\r\n\t\t\tvar oCheckBox = oEvent.getSource();\r\n\t\t\tvar oCtx = oCheckBox.getBindingContext(\"JM_ProductionModel\");\r\n\r\n\t\t\t// Create a fake event object similar to Input liveChange\r\n\t\t\tvar oFakeEvent = {\r\n\t\t\t\tgetSource: function() {\r\n\t\t\t\t\treturn oCheckBox;\r\n\t\t\t\t},\r\n\t\t\t\tgetParameter: function() {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvalue: oCheckBox.getSelected() ? \"X\" : \"\"\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tgetBindingContext: function() {\r\n\t\t\t\t\treturn oCtx;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Call your existing fnLiveChange\r\n\t\t\tthis.fnLiveChange(oFakeEvent);\r\n\t\t},\r\n\r\n\t\tfnComboBoxLiveChange: function(oEvent) {\r\n\t\t\tvar oComboBox = oEvent.getSource();\r\n\t\t\tvar oCtx = oComboBox.getBindingContext(\"JM_ProductionModel\");\r\n\t\t\tvar oFakeEvent = {\r\n\t\t\t\tgetSource: function() {\r\n\t\t\t\t\treturn oComboBox;\r\n\t\t\t\t},\r\n\t\t\t\tgetParameter: function(sParam) {\r\n\r\n\t\t\t\t\tif (sParam === \"value\") {\r\n\t\t\t\t\t\treturn oComboBox.getSelectedKey();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t},\r\n\t\t\t\tgetBindingContext: function() {\r\n\t\t\t\t\treturn oCtx;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.fnLiveChange(oFakeEvent);\r\n\t\t},\r\n\r\n\t\tfnDateLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\toInput.setValueState(\"None\");\r\n\t\t\toInput.setValueStateText(\"\");\r\n\t\t},\r\n\r\n\t\tfnLiveChange: function(oEvent) {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tthis.hasGlobalValue = false;\r\n\t\t\tthis.fnSetProductVersionIndicator();\r\n\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar fieldId = oInput.getId();\r\n\t\t\tvar id = fieldId.split(\"--\")[1];\r\n\t\t\tvar vValue = \"\";\r\n\t\t\tif (typeof oInput.getValue === \"function\") {\r\n\t\t\t\tvValue = oInput.getValue().toUpperCase();\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t\t// oInput.setValueState(\"None\");\r\n\t\t\t} else if (typeof oInput.getSelectedKey === \"function\") {\r\n\t\t\t\tvValue = oInput.getSelectedKey().toUpperCase();\r\n\t\t\t} else if (typeof oInput.getSelected === \"function\") {\r\n\t\t\t\tvValue = oInput.getSelected() ? \"X\" : \"\";\r\n\t\t\t} else {\r\n\t\t\t\tvValue = \"\";\r\n\t\t\t}\r\n\r\n\t\t\tvar oFieldLengthMap = {\r\n\t\t\t\t\"ID_PV_BSTMI\": 13,\r\n\t\t\t\t\"ID_PV_BSTMA\": 13,\r\n\t\t\t\t\"ID_PV_ADATU\": 8,\r\n\t\t\t\t\"ID_PV_BDATU\": 8,\r\n\t\t\t\t\"ID_PV_PLNNR\": 8,\r\n\t\t\t\t\"ID_PV_ALNAL\": 2,\r\n\t\t\t\t\"ID_PV_STLAL\": 2,\r\n\t\t\t\t\"ID_PV_STLAN\": 1,\r\n\t\t\t\t\"ID_PV_CSPLT\": 4,\r\n\t\t\t\t\"ID_PV_SERKZ\": 1,\r\n\t\t\t\t\"ID_PV_MDV01\": 8,\r\n\t\t\t\t\"ID_PV_MDV02\": 8,\r\n\t\t\t\t\"ID_PV_PNGUID\": 16,\r\n\t\t\t\t\"ID_PV_MATNR\": 40,\r\n\t\t\t\t\"ID_PV_WERKS\": 4,\r\n\t\t\t\t\"ID_PV_VERID\": 4,\r\n\t\t\t\t\"ID_PV_PRVBE\": 10,\r\n\t\t\t\t\"ID_PV_TSA_PRVBE\": 10,\r\n\t\t\t\t\"ID_PV_EWM_LGPLA\": 18,\r\n\t\t\t\t\"ID_PV_MATKO\": 40,\r\n\t\t\t\t\"ID_PV_VERTO\": 4,\r\n\t\t\t\t\"ID_PV_ELPRO\": 4,\r\n\t\t\t\t\"ID_PV_EWM_LGNUM\": 4,\r\n\t\t\t\t\"ID_PV_ALORT\": 4,\r\n\t\t\t\t\"ID_PV_UCMAT\": 40\r\n\t\t\t};\r\n\r\n\t\t\tif (oFieldLengthMap[id] && vValue.length > oFieldLengthMap[id]) {\r\n\t\t\t\tvar iMax = oFieldLengthMap[id];\r\n\t\t\t\tvValue = vValue.substring(0, iMax);\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t}\r\n\t\t\tif (id === \"ID_PV_STLAN\" || id === \"ID_PV_STLAL\") {\r\n\t\t\t\tvar pvModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\t\tif (pvModel) {\r\n\t\t\t\t\tpvModel.setProperty(\"/NavPV_MaterialCompData\", []); // reset to empty array\r\n\t\t\t\t}\r\n\t\t\t\tvar BomModel = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\t\tvar oBomData = BomModel.getData();\r\n\t\t\t\tif (oBomData && Object.keys(oBomData).length > 0) {\r\n\t\t\t\t\tBomModel.setData({}); // clears all data\r\n\t\t\t\t\tBomModel.refresh(true);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"MaterialDataClearInfo\"), \"information\", this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oTable = this.getView().byId(\"idMaterialComTable\");\r\n\t\t\t\toTable.setVisibleRowCount(6);\r\n\t\t\t\tthis.fnsetIndicator(oView, \"ID_BOMIND\", \"ID_BOMIND_BTN\", \"Pending\");\r\n\t\t\t}\r\n\t\t\t// oInput.setValue(vValue);\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tvar descriptionField = this.getView().byId(this.selectedField + \"_DES\");\r\n\t\t\tif (descriptionField) {\r\n\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t}\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\");\r\n\t\t\tvar oControl = this.getView().byId(id);\r\n\r\n\t\t\tif (oControl.getShowValueHelp && typeof oControl.getShowValueHelp === \"function\") {\r\n\t\t\t\tvar hasF4Search = oControl.getShowValueHelp();\r\n\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase(), \"P\", hasF4Search);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnUpdateChangelog(id);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnReadf4Cache: function(vId, vValue, f4type, IsSearchHelp) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar match, descriptionField;\r\n\r\n\t\t\tfunction updateDesc(results) {\r\n\t\t\t\tif (f4type === \"P\" && IsSearchHelp && vValue !== \"\") {\r\n\r\n\t\t\t\t\tvValue = vValue.replace(/^0+/, \"\");\r\n\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\treturn item.Value1.replace(/^0+/, \"\") === vValue.toUpperCase();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"None\");\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(match.Value2);\r\n\t\t\t\t\t\t\tdescriptionField.setValueState(\"None\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (that.selectedField === \"ID_PV_STLAL\") {\r\n\t\t\t\t\t\t\tvar BomUsage = that.getView().byId(\"ID_PV_STLAN\");\r\n\t\t\t\t\t\t\tif (BomUsage) {\r\n\t\t\t\t\t\t\t\tBomUsage.setValue(match.Value2);\r\n\t\t\t\t\t\t\t\tBomUsage.setValueState(\"None\");\r\n\t\t\t\t\t\t\t\tthat.hasGlobalValue = false;\r\n\t\t\t\t\t\t\t\tthat.fnSetProductVersionIndicator();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (that.selectedField === \"ID_PV_VERID\") {\r\n\t\t\t\t\t\t\tvar verId = that.getView().byId(that.selectedField);\r\n\t\t\t\t\t\t\tverId.setValueState(\"Error\");\r\n\t\t\t\t\t\t\tverId.setValueStateText(vValue + \" Already Exist\");\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (that.selectedField === \"ID_PV_STLAL\") {\r\n\t\t\t\t\t\t\tvar BomUsage = that.getView().byId(\"ID_PV_STLAN\");\r\n\t\t\t\t\t\t\tif (BomUsage) {\r\n\t\t\t\t\t\t\t\tBomUsage.setValue(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar fieldCtrl = that.getView().byId(that.selectedField);\r\n\r\n\t\t\t\t\t\tif (that.selectedField === \"ID_PV_STLAL\" || that.selectedField === \"ID_PV_VERID\") {\r\n\t\t\t\t\t\t\tfieldCtrl.setValueState(\"None\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfieldCtrl.setValueState(\"Error\");\r\n\t\t\t\t\t\t\tfieldCtrl.setValueStateText(vValue + \" value is not Avalible\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tf4descriptionGet: function(vId, value, f4type, fnCallback) {\r\n\t\t\tvar that = this;\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tvar KeyModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tif (KeyModel) {\r\n\t\t\t\tvar Werks = KeyModel.getProperty(\"/Werks\");\r\n\t\t\t\tvar Matnr = KeyModel.getProperty(\"/Matnr\");\r\n\t\t\t}\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: vId,\r\n\t\t\t\tProcess: \"X\",\r\n\t\t\t\tF4Type: f4type\r\n\t\t\t};\r\n\r\n\t\t\tif ([\"ID_PV_VERID\", \"ID_PV_STLAL\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"MATNR\";\r\n\t\t\t\toPayload.Value1 = (/^\\d+$/.test(Matnr)) ? (\"000000000000000000\" + Matnr).slice(-18) : Matnr;\r\n\t\t\t\toPayload.FieldNam2 = \"WERKS\";\r\n\t\t\t\toPayload.Value2 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t} else if ([\"ID_PV_ELPRO\", \"ID_PV_ALORT\", \"ID_PV_PRVBE\", \"ID_PV_TSA_PRVBE\"].includes(that.selectedField)) {\r\n\t\t\t\toPayload.FieldNam1 = \"WERKS\";\r\n\t\t\t\toPayload.Value1 = Werks.toString().padStart(4, \"0\");\r\n\t\t\t}\r\n\r\n\t\t\toPayload.NavSerchResult = [];\r\n\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthat.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnNavBom: function() {\r\n\t\t\tthis.finalCheck = false;\r\n\t\t\tthis.fnPvValidation();\r\n\t\t},\r\n\r\n\t\tfnPvValidation: function() {\r\n\r\n\t\t\tvar that = this,\r\n\t\t\t\toView = this.getView(),\r\n\t\t\t\toModel = this.getOwnerComponent().getModel(),\r\n\t\t\t\toProductionModel = oView.getModel(\"JM_ProductionModel\"),\r\n\t\t\t\toKeyDataModel = oView.getModel(\"JM_KeydataModel\"),\r\n\t\t\t\toContextModel = this.getOwnerComponent().getModel(\"JM_ContextModel\"),\r\n\t\t\t\toGlobalBomModel = this.getOwnerComponent().getModel(\"JM_Bom\"),\r\n\t\t\t\tMsgType = \"I\",\r\n\t\t\t\tPnguid = oProductionModel.getProperty(\"/Pnguid\");\r\n\r\n\t\t\tif (!this.fnCheckMandatoryFields()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.finalCheck === false && this.aErrorIds && this.aErrorIds.length > 0) {\r\n\t\t\t\tvar aAllowedIds = [\"ID_PV_BSTMI\", \"ID_PV_BSTMA\"];\r\n\t\t\t\tvar bOnlyAllowed = this.aErrorIds.every(function(id) {\r\n\t\t\t\t\treturn aAllowedIds.includes(id);\r\n\t\t\t\t});\r\n\t\t\t\tif (bOnlyAllowed) {\r\n\t\t\t\t\tthis.fnSubmitPvData();\r\n\t\t\t\t\tthis.fnResetInputStates();\r\n\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(that).navTo(\"bom_detail\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar vErrorState = this.fnCheckErrorState();\r\n\r\n\t\t\tif (!vErrorState) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"CorrectHighLightedFieldsError\"), \"Error\", that);\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// --- Determine MsgType from Context Model ---\r\n\t\t\tif (oContextModel) {\r\n\t\t\t\tvar oUwlData = oContextModel.getData();\r\n\t\t\t\tif (oUwlData && (Array.isArray(oUwlData) ? oUwlData.length > 0 : Object.keys(oUwlData).length > 0)) {\r\n\t\t\t\t\tvar sState = oContextModel.getProperty(\"/Level\");\r\n\t\t\t\t\tif (sState === \"A\" || sState === \"R\" || sState === \"I\" || oUwlData.Ind === \"D\" || oUwlData.Sendback === \"X\") {\r\n\t\t\t\t\t\tMsgType = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (oUwlData.Ind === \"T\") {\r\n\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(that).navTo(\"bom_detail\");\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// --- Reset PNGUID ---\r\n\t\t\tif (Pnguid) {\r\n\t\t\t\tPnguid = null;\r\n\t\t\t\toView.byId(\"ID_PV_PNGUID\").setValue(null);\r\n\t\t\t}\r\n\r\n\t\t\t// --- Extract BOM Header data ---\r\n\t\t\tvar oBOMData = oGlobalBomModel.getData() || {};\r\n\t\t\tvar BstmiBom = null,\r\n\t\t\t\tBstmaBom = null;\r\n\r\n\t\t\tif (oBOMData.NavBomHeader && oBOMData.NavBomHeader.length > 0) {\r\n\t\t\t\tBstmiBom = oBOMData.NavBomHeader[0].Losvn;\r\n\t\t\t\tBstmaBom = oBOMData.NavBomHeader[0].Losbs;\r\n\t\t\t}\r\n\r\n\t\t\tfunction setTimeTo0530(oDate) {\r\n\t\t\t\tif (!oDate) return null;\r\n\t\t\t\toDate.setHours(5, 30, 0, 0);\r\n\t\t\t\treturn new Date(oDate.getTime() - (oDate.getTimezoneOffset() * 60000));\r\n\t\t\t}\r\n\r\n\t\t\tvar oAdatu = oView.byId(\"ID_PV_ADATU\").getDateValue() || oProductionModel.getProperty(\"/Adatu\") || null;\r\n\t\t\tvar oBdatu = oView.byId(\"ID_PV_BDATU\").getDateValue() || oProductionModel.getProperty(\"/Bdatu\") || null;\r\n\t\t\tvar adjustedAdatu = setTimeTo0530(oAdatu);\r\n\t\t\tvar adjustedBdatu = setTimeTo0530(oBdatu);\r\n\r\n\t\t\tvar sMksp = oView.byId(\"ID_PV_MKSP\").getSelectedKey();\r\n\r\n\t\t\tif (sMksp === \"0\") {\r\n\t\t\t\tsMksp = \"\";\r\n\t\t\t}\r\n\t\t\toProductionModel.setProperty(\"/Mksp\", sMksp);\r\n\r\n\t\t\t// --- Payload Preparation ---\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tInd: \"V\",\r\n\t\t\t\tTransid: TransId || \"\",\r\n\t\t\t\tMsgTyp: MsgType,\r\n\t\t\t\tAppId: this.AppId || \"RC\",\r\n\t\t\t\tMatnr: oKeyDataModel.getProperty(\"/Matnr\") || \"\",\r\n\t\t\t\tWerks: oKeyDataModel.getProperty(\"/Werks\") || \"\",\r\n\t\t\t\tNavPV_BasicFields: [{\r\n\t\t\t\t\tBstmi: this.fnToEdmDecimal(oProductionModel.getProperty(\"/Bstmi\"), 13, 3) || null,\r\n\t\t\t\t\tBstma: this.fnToEdmDecimal(oProductionModel.getProperty(\"/Bstma\"), 13, 3) || null,\r\n\t\t\t\t\tPlnnr: oProductionModel.getProperty(\"/Plnnr\") || \"\",\r\n\t\t\t\t\tAlnal: oProductionModel.getProperty(\"/Alnal\") || \"\",\r\n\t\t\t\t\tStlal: oProductionModel.getProperty(\"/Stlal\") || \"\",\r\n\t\t\t\t\tStlan: oProductionModel.getProperty(\"/Stlan\") || \"\",\r\n\t\t\t\t\tCsplt: oProductionModel.getProperty(\"/Csplt\") || \"\",\r\n\t\t\t\t\tMdv01: oProductionModel.getProperty(\"/Mdv01\") || \"\",\r\n\t\t\t\t\tMdv02: oProductionModel.getProperty(\"/Mdv02\") || \"\",\r\n\t\t\t\t\tPnguid: Pnguid || null,\r\n\t\t\t\t\tVerid: oProductionModel.getProperty(\"/Verid\") || \"\",\r\n\t\t\t\t\tAdatu: adjustedAdatu || null,\r\n\t\t\t\t\tBdatu: adjustedBdatu || null,\r\n\t\t\t\t\tPlnty: oView.byId(\"ID_PV_PLNTY\").getSelectedKey() || oProductionModel.getProperty(\"/Plnty\") || \"\",\r\n\t\t\t\t\tMksp: oProductionModel.getProperty(\"/Mksp\") || \"\",\r\n\t\t\t\t\tBstmiBom: BstmiBom || null,\r\n\t\t\t\t\tBstmaBom: BstmaBom || null,\r\n\t\t\t\t\tSerkz: oProductionModel.getProperty(\"/Serkz\") || null,\r\n\t\t\t\t\tElpro: oProductionModel.getProperty(\"/Elpro\") || \"\",\r\n\t\t\t\t\tPrvbe: oProductionModel.getProperty(\"/Prvbe\") || \"\",\r\n\t\t\t\t\tAlort: oProductionModel.getProperty(\"/Alort\") || \"\",\r\n\t\t\t\t\tVerto: oProductionModel.getProperty(\"/Verto\") || \"\",\r\n\t\t\t\t}],\r\n\t\t\t\tNavReturn_Msg: []\r\n\t\t\t};\r\n\t\t\tbusyDialog.open();\r\n\t\t\toModel.create(\"/Recipe_HeaderSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tthat.fnhandleValidationResponse(oData, oView);\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", that);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tfnhandleValidationResponse: function(oData, oView) {\r\n\t\t\tvar that = this,\r\n\t\t\t\taResults = oData.NavReturn_Msg.results || [],\r\n\t\t\t\taErrorMsgs = aResults.filter(function(m) {\r\n\t\t\t\t\treturn m.MsgType === \"E\";\r\n\t\t\t\t});\r\n\r\n\t\t\tthis.aErrorIds = [];\r\n\r\n\t\t\t// --- Error case ---\r\n\t\t\tif (aErrorMsgs.length > 0) {\r\n\t\t\t\taErrorMsgs.forEach(function(m) {\r\n\t\t\t\t\tvar sId = \"ID_PV_\" + m.Fnm;\r\n\t\t\t\t\tthat.aErrorIds.push(sId);\r\n\t\t\t\t\tvar oField = oView.byId(sId);\r\n\t\t\t\t\tif (oField) {\r\n\t\t\t\t\t\tif (oField instanceof sap.m.CheckBox) {\r\n\t\t\t\t\t\t\toField.removeStyleClass(\"cl_opr_checkbx\");\r\n\t\t\t\t\t\t\toField.addStyleClass(\"cl_checkboxError\");\r\n\t\t\t\t\t\t\toField.setTooltip(m.Message);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Handle Input, DatePicker, etc.\r\n\t\t\t\t\t\t\toField.setValueState(\"Error\");\r\n\t\t\t\t\t\t\toField.setValueStateText(m.Message);\r\n\t\t\t\t\t\t\toField.focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sId === \"ID_PV_VERID\") {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(m.Message, \"Error\", that);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthat.fnsetIndicator(oView, \"ID_BOMIND\", \"ID_BOMIND_BTN\", \"Error\");\r\n\t\t\t\tthat.fnsetIndicator(oView, \"ID_PVIND\", \"ID_PVIND_BTN\", \"Error\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthat.aErrorIds = [];\r\n\r\n\t\t\t// --- Success case ---\r\n\t\t\tvar Stlal = oView.byId(\"ID_PV_STLAL\").getValue() || \"\",\r\n\t\t\t\tStlan = oView.byId(\"ID_PV_STLAN\").getValue() || \"\";\r\n\r\n\t\t\tthat.fnSubmitPvData();\r\n\r\n\t\t\tvar oWfparm = that.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oWfparmData = oWfparm.getData();\r\n\t\t\toWfparmData.Stlal = Stlal;\r\n\t\t\toWfparmData.Stlan = Stlan;\r\n\t\t\toWfparm.setData(oWfparmData);\r\n\t\t\toWfparm.refresh(true);\r\n\r\n\t\t\tthat.fnsetIndicator(oView, \"ID_BOMIND\", \"ID_BOMIND_BTN\", \"Success\");\r\n\t\t\tthat.fnsetIndicator(oView, \"ID_PVIND\", \"ID_PVIND_BTN\", \"Success\");\r\n\r\n\t\t\tthat.fnclearLocalModel();\r\n\t\t\tif (that.finalCheck === true) {\r\n\t\t\t\tthat.finalCheck = false;\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(that).navTo(\"reci_initiator\");\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(that).navTo(\"bom_detail\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnsetIndicator: function(oView, sHBoxId, sBtnId, sStatus) {\r\n\t\t\tvar oHBox = oView.byId(sHBoxId),\r\n\t\t\t\toBtn = oView.byId(sBtnId);\r\n\r\n\t\t\toHBox.setVisible(true);\r\n\t\t\toBtn.removeStyleClass(\"cl_IndicatorS cl_IndicatorP cl_IndicatorR\");\r\n\r\n\t\t\tif (sStatus === \"Success\") {\r\n\t\t\t\toBtn.setIcon(\"Image/IndicatorS.svg\");\r\n\t\t\t\toBtn.setText(\"Success\");\r\n\t\t\t\toBtn.setType(\"Emphasized\");\r\n\t\t\t\toBtn.addStyleClass(\"cl_IndicatorS\");\r\n\t\t\t} else if (sStatus === \"Error\") {\r\n\t\t\t\toBtn.setIcon(\"Image/IndicatorR.svg\");\r\n\t\t\t\toBtn.setText(\"Error\");\r\n\t\t\t\toBtn.setType(\"Emphasized\");\r\n\t\t\t\toBtn.addStyleClass(\"cl_IndicatorR\");\r\n\t\t\t} else if (sStatus === \"Pending\") {\r\n\t\t\t\toBtn.setIcon(\"Image/IndicatorP.svg\");\r\n\t\t\t\toBtn.setText(\"Pending\");\r\n\t\t\t\toBtn.setType(\"Emphasized\");\r\n\t\t\t\toBtn.addStyleClass(\"cl_IndicatorP\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSubmitPvData: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar ProductionModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\tvar KeyDataModel = this.getView().getModel(\"JM_KeydataModel\");\r\n\t\t\tvar opvModel = {};\r\n\t\t\tvar sMksp = this.getView().byId(\"ID_PV_MKSP\").getSelectedKey();\r\n\t\t\tif (sMksp === \"0\") {\r\n\t\t\t\tsMksp = \"\";\r\n\t\t\t}\r\n\t\t\tProductionModel.setProperty(\"/Mksp\", sMksp);\r\n\r\n\t\t\topvModel.NavPV_BasicFields = [{\r\n\t\t\t\tBstmi: this.fnToEdmDecimal(ProductionModel.getProperty(\"/Bstmi\"), 13, 3),\r\n\t\t\t\tBstma: this.fnToEdmDecimal(ProductionModel.getProperty(\"/Bstma\"), 13, 3),\r\n\t\t\t\tPlnnr: ProductionModel.getProperty(\"/Plnnr\") || \"\",\r\n\t\t\t\tAlnal: ProductionModel.getProperty(\"/Alnal\") || \"\",\r\n\t\t\t\tStlal: ProductionModel.getProperty(\"/Stlal\") || \"\",\r\n\t\t\t\tStlan: ProductionModel.getProperty(\"/Stlan\") || \"\",\r\n\t\t\t\tCsplt: ProductionModel.getProperty(\"/Csplt\") || \"\",\r\n\t\t\t\tMdv01: ProductionModel.getProperty(\"/Mdv01\") || \"\",\r\n\t\t\t\tMdv02: ProductionModel.getProperty(\"/Mdv02\") || \"\",\r\n\t\t\t\tPnguid: ProductionModel.getProperty(\"/Pnguid\") || null,\r\n\t\t\t\tVerid: ProductionModel.getProperty(\"/Verid\") || \"\",\r\n\t\t\t\tMatnr: KeyDataModel.getProperty(\"/Matnr\") || \"\",\r\n\t\t\t\tWerks: KeyDataModel.getProperty(\"/Werks\") || \"\",\r\n\t\t\t\tAdatu: this.getView().byId(\"ID_PV_ADATU\").getDateValue() || ProductionModel.getProperty(\"/Adatu\") || null,\r\n\t\t\t\tBdatu: this.getView().byId(\"ID_PV_BDATU\").getDateValue() || ProductionModel.getProperty(\"/Bdatu\") || null,\r\n\t\t\t\tPlnty: this.getView().byId(\"ID_PV_PLNTY\").getSelectedKey() || ProductionModel.getProperty(\"/Plnty\") || \"\",\r\n\t\t\t\tMksp: ProductionModel.getProperty(\"/Mksp\") || \"\",\r\n\t\t\t\tText1: ProductionModel.getProperty(\"/Text1\") || \"\",\r\n\t\t\t\tEwmLgnum: ProductionModel.getProperty(\"/EwmLgnum\") || \"\",\r\n\t\t\t\tEwmLgpla: ProductionModel.getProperty(\"/EwmLgpla\") || \"\",\r\n\t\t\t\tTsaPrvbe: ProductionModel.getProperty(\"/TsaPrvbe\") || \"\",\r\n\t\t\t\tVerto: ProductionModel.getProperty(\"/Verto\") || \"\",\r\n\t\t\t\tAlort: ProductionModel.getProperty(\"/Alort\") || \"\",\r\n\t\t\t\tUcmat: ProductionModel.getProperty(\"/Ucmat\") || \"\",\r\n\t\t\t\tElpro: ProductionModel.getProperty(\"/Elpro\") || \"\",\r\n\t\t\t\tMatko: ProductionModel.getProperty(\"/Matko\") || \"\",\r\n\t\t\t\tPrvbe: ProductionModel.getProperty(\"/Prvbe\") || \"\",\r\n\t\t\t\tSerkz: ProductionModel.getProperty(\"/Serkz\") || null\r\n\t\t\t}];\r\n\r\n\t\t\tvar oTable = this.getView().byId(\"idMaterialComTable\");\r\n\t\t\tvar aTableRows = oTable.getRows();\r\n\t\t\tvar materialComponents = [];\r\n\r\n\t\t\taTableRows.forEach(function(oRow) {\r\n\t\t\t\tvar oCells = oRow.getCells();\r\n\t\t\t\tmaterialComponents.push({\r\n\t\t\t\t\tIdnrk: oCells[0].getText(), // Component\r\n\t\t\t\t\tVornr: oCells[1].getText(), // Activity\r\n\t\t\t\t\tPhflg: oCells[2].getSelected(), // IndPhase\r\n\t\t\t\t\tPvznr: oCells[3].getText(), // SupOperation\r\n\t\t\t\t\tLtxa1: oCells[4].getText(), // Operation Short Text\r\n\t\t\t\t\tMenge: that.fnToEdmDecimal(oCells[5].getText(), 13, 3),\r\n\t\t\t\t\tMeins: oCells[6].getText(), // UOM\r\n\t\t\t\t\tRgekz: oCells[7].getSelected(), // Backflush\r\n\t\t\t\t\tMaktx: oCells[8].getText(), // Item Description\r\n\t\t\t\t\tPosnr: oCells[9].getText(), // Item Number\r\n\t\t\t\t\tPostp: oCells[10].getText(), // Item Category\r\n\t\t\t\t\tMatnr: oCells[11].getText() // Material\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\topvModel.NavPV_MaterialCompData = materialComponents;\r\n\t\t\topvModel.Text1 = ProductionModel.getProperty(\"/Text1\") || \"\";\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\toModel.setData(opvModel);\r\n\t\t\toModel.refresh(true);\r\n\r\n\t\t\tvar oModelData = oModel.getData();\r\n\t\t\tif (oModelData.NavPV_BasicFields && oModelData.NavPV_BasicFields.length > 0) {\r\n\t\t\t\tvar basicData = oModelData.NavPV_BasicFields[0];\r\n\r\n\t\t\t\tObject.keys(basicData).forEach(function(key) {\r\n\t\t\t\t\toModelData[key] = basicData[key];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Navigate initiator\r\n\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\toWfparm.setData(oModelData); // replaces the data\r\n\t\t\toWfparm.refresh(true); // updates the bindings\r\n\r\n\t\t\tvar lchangeLogModel = this.getView().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (lchangeLogModel) {\r\n\t\t\t\tvar lChangeData = lchangeLogModel.getData();\r\n\t\t\t\tvar gchangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tif (gchangeLogModel) {\r\n\t\t\t\t\tgchangeLogModel.setData(lChangeData);\r\n\t\t\t\t\tgchangeLogModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSaveBack: function() {\r\n\t\t\tif (!this.fnCheckMandatoryFields()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar vErrorState = this.fnCheckErrorState();\r\n\t\t\tif (vErrorState) {\r\n\t\t\t\tvar pvModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\t\tif (pvModel) {\r\n\t\t\t\t\tvar ComponentData = pvModel.getProperty(\"/NavPV_MaterialCompData\");\r\n\t\t\t\t\tif (!Array.isArray(ComponentData) || ComponentData.length === 0) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"MaterialComponentEmptyError\"), \"Error\", this);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.finalCheck = true;\r\n\t\t\t\tthis.fnPvValidation();\r\n\t\t\t} else {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"CorrectHighLightedFieldsError\"), \"Error\", this);\r\n\t\t\t\tbusyDialog.close();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnNavBack: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: \"Information\",\r\n\t\t\t\ttext: \"Do you Want to exit this Process? once exit all data will be Refreshed\",\r\n\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"PV_BACK\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnSubmitConfirmation: function() {\r\n\t\t\tvar state = this.getView().getModel(\"JM_Popup\").getProperty(\"/Indicator\");\r\n\t\t\tif (state === \"PV_BACK\") {\r\n\t\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\t\tthis.fnclearMaterialAssign();\r\n\t\t\t\t\tthis.fnClearChangeLog();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.fnclearLocalModel();\r\n\t\t\t\tthis.fnResetInputStates();\r\n\t\t\t\tthis.getView().byId(\"ID_PV_TEXT1\").setValue(\"\");\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t\t} else if (state === \"PV_DELETE\") {\r\n\t\t\t\tthis.fnDeleteRow();\r\n\t\t\t\tthis.fnConfirmationFragmentClose();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnConfirmationFragmentClose: function() {\r\n\t\t\tif (this.oDialog) {\r\n\t\t\t\tthis.oDialog.close();\r\n\t\t\t\tthis.oDialog.destroy(); // if you want destroy after close\r\n\t\t\t\tthis.oDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnOperationDetails: function() {\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar iSelectedIndex = oTable.getSelectedIndex();\r\n\t\t\tif (iSelectedIndex < 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"Please select a material component\", \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar vTitle = \"Choose Operation\";\r\n\r\n\t\t\tif (!this.OperFrag) {\r\n\t\t\t\tthis.OperFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.OperationList\", this);\r\n\t\t\t\tthis.getView().addDependent(this.OperFrag);\r\n\t\t\t}\r\n\t\t\tthis.OperFrag.setTitle(vTitle);\r\n\t\t\tthis.OperFrag.open();\r\n\r\n\t\t},\r\n\r\n\t\tfnOprItempress: function(oEvent) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_OperationsData\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar Vornr = oContext.getProperty(\"Vornr\");\r\n\t\t\tvar Phflg = oContext.getProperty(\"Phflg\");\r\n\t\t\tvar Pvznr = oContext.getProperty(\"Pvznr\");\r\n\t\t\tvar Ltxa1 = oContext.getProperty(\"Ltxa1\");\r\n\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\r\n\t\t\tif (!aSelectedIndices.length) {\r\n\t\t\t\treturn; // No selection\r\n\t\t\t}\r\n\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tvar gChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\r\n\t\t\t\tif (!gChangeLogModel) {\r\n\t\t\t\t\tgChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\t\tthis.getOwnerComponent().setModel(gChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar aGlobalChangeLog = gChangeLogModel.getData() || [];\r\n\r\n\t\t\t\taSelectedIndices.forEach(function(iIndex) {\r\n\t\t\t\t\tvar oCompContext = oTable.getContextByIndex(iIndex);\r\n\t\t\t\t\tif (oCompContext) {\r\n\t\t\t\t\t\tvar sPath = oCompContext.getPath();\r\n\t\t\t\t\t\tvar sItemNo = oModel.getProperty(sPath + \"/Posnr\") || \"\";\r\n\r\n\t\t\t\t\t\tvar aFiltered = aGlobalChangeLog.filter(function(item) {\r\n\t\t\t\t\t\t\treturn item.ProcessInd === \"P\" && item.ItemNo !== \"\";\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// Further filter by the specific ItemNo\r\n\t\t\t\t\t\tvar aItemChanges = aFiltered.filter(function(item) {\r\n\t\t\t\t\t\t\treturn item.ItemNo === sItemNo;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (aItemChanges && aItemChanges.length > 0) {\r\n\t\t\t\t\t\t\tvar oOldData = {\r\n\t\t\t\t\t\t\t\tVornr: (function() {\r\n\t\t\t\t\t\t\t\t\tvar oEntry = aItemChanges.find(function(i) {\r\n\t\t\t\t\t\t\t\t\t\treturn i.FieldId === \"ID_PV_VORNR\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn oEntry ? oEntry.OldValue : \"\";\r\n\t\t\t\t\t\t\t\t})(),\r\n\r\n\t\t\t\t\t\t\t\tPhflg: (function() {\r\n\t\t\t\t\t\t\t\t\tvar oEntry = aItemChanges.find(function(i) {\r\n\t\t\t\t\t\t\t\t\t\treturn i.FieldId === \"ID_PV_PHFLG\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn oEntry && oEntry.OldValue === \"X\" ? \"X\" : \"\";\r\n\t\t\t\t\t\t\t\t})(),\r\n\r\n\t\t\t\t\t\t\t\tPvznr: (function() {\r\n\t\t\t\t\t\t\t\t\tvar oEntry = aItemChanges.find(function(i) {\r\n\t\t\t\t\t\t\t\t\t\treturn i.FieldId === \"ID_PV_PVZNR\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn oEntry ? oEntry.OldValue : \"\";\r\n\t\t\t\t\t\t\t\t})(),\r\n\r\n\t\t\t\t\t\t\t\tLtxa1: (function() {\r\n\t\t\t\t\t\t\t\t\tvar oEntry = aItemChanges.find(function(i) {\r\n\t\t\t\t\t\t\t\t\t\treturn i.FieldId === \"ID_PV_LTXA1\";\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn oEntry ? oEntry.OldValue : \"\";\r\n\t\t\t\t\t\t\t\t})()\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\taGlobalChangeLog = aGlobalChangeLog.filter(function(item) {\r\n\t\t\t\t\t\t\t\treturn !(item.ItemNo === sItemNo && item.ProcessInd === \"P\");\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar oOldData = {\r\n\t\t\t\t\t\t\t\tVornr: oModel.getProperty(sPath + \"/Vornr\"),\r\n\t\t\t\t\t\t\t\tPhflg: oModel.getProperty(sPath + \"/Phflg\") ? \"X\" : \"\",\r\n\t\t\t\t\t\t\t\tPvznr: oModel.getProperty(sPath + \"/Pvznr\"),\r\n\t\t\t\t\t\t\t\tLtxa1: oModel.getProperty(sPath + \"/Ltxa1\")\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Update model with new values\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Vornr\", Vornr);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Phflg\", Phflg);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Pvznr\", Pvznr);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Ltxa1\", Ltxa1);\r\n\r\n\t\t\t\t\t\tvar oNewData = {\r\n\t\t\t\t\t\t\tVornr: Vornr,\r\n\t\t\t\t\t\t\tPhflg: Phflg ? \"X\" : \"\",\r\n\t\t\t\t\t\t\tPvznr: Pvznr,\r\n\t\t\t\t\t\t\tLtxa1: Ltxa1\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// --- Compare and Log Changes ---\r\n\t\t\t\t\t\tObject.keys(oNewData).forEach(function(key) {\r\n\t\t\t\t\t\t\tvar oldVal = oOldData[key];\r\n\t\t\t\t\t\t\tvar newVal = oNewData[key];\r\n\r\n\t\t\t\t\t\t\tif (oldVal !== newVal) {\r\n\t\t\t\t\t\t\t\tvar sFieldId = \"ID_PV_\" + key.toUpperCase(); // FieldId mapping\r\n\t\t\t\t\t\t\t\tvar oFieldName = that.fnGetColumnTooltip(key);\r\n\t\t\t\t\t\t\t\tvar oEntry = {\r\n\t\t\t\t\t\t\t\t\tProcessInd: \"P\",\r\n\t\t\t\t\t\t\t\t\tFieldId: sFieldId,\r\n\t\t\t\t\t\t\t\t\tProcessDesc: \"Production Version\",\r\n\t\t\t\t\t\t\t\t\tFieldName: oFieldName + \" - \" + sItemNo,\r\n\t\t\t\t\t\t\t\t\tItemNo: sItemNo,\r\n\t\t\t\t\t\t\t\t\tOldValue: oldVal || \"\",\r\n\t\t\t\t\t\t\t\t\tNewValue: newVal || \"\",\r\n\t\t\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\t// --- Update or Insert in Global ChangeLog ---\r\n\t\t\t\t\t\t\t\tvar iGlobalIndex = aGlobalChangeLog.findIndex(function(item) {\r\n\t\t\t\t\t\t\t\t\treturn item.FieldId === sFieldId && item.ItemNo === sItemNo;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif (iGlobalIndex > -1) {\r\n\t\t\t\t\t\t\t\t\taGlobalChangeLog[iGlobalIndex] = oEntry; // update existing\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\taGlobalChangeLog.push(oEntry); // add new\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// --- Update Models ---\r\n\t\t\t\tgChangeLogModel.setData(aGlobalChangeLog);\r\n\t\t\t\tgChangeLogModel.refresh(true);\r\n\r\n\t\t\t} else {\r\n\t\t\t\taSelectedIndices.forEach(function(iIndex) {\r\n\t\t\t\t\tvar oCompContext = oTable.getContextByIndex(iIndex);\r\n\t\t\t\t\tif (oCompContext) {\r\n\t\t\t\t\t\tvar sPath = oCompContext.getPath();\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Vornr\", Vornr);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Phflg\", Phflg);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Pvznr\", Pvznr);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Ltxa1\", Ltxa1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.fnOperCancel();\r\n\t\t},\r\n\r\n\t\tfnOperCancel: function(oEvent) {\r\n\t\t\tthis.OperFrag.close();\r\n\t\t\tthis.OperFrag.destroy();\r\n\t\t\tthis.OperFrag = null;\r\n\t\t},\r\n\r\n\t\tfnDeleteFrag: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectMaterialComponentError\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar oPopupModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\ttitle: \"Information\",\r\n\t\t\t\ttext: \"Do you want to delete selected rows ?\",\r\n\t\t\t\tnegativeButton: \"Cancel\",\r\n\t\t\t\tnegativeIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Cancel.svg\",\r\n\t\t\t\tpositiveButton: \"Proceed\",\r\n\t\t\t\tpositiveIcon: that.getView().getModel(\"JM_ImageModel\").getProperty(\"/path\") + \"Apply.svg\",\r\n\t\t\t\tIndicator: \"PV_DELETE\"\r\n\t\t\t});\r\n\t\t\t// Set model with name\r\n\t\t\tthis.getView().setModel(oPopupModel, \"JM_Popup\");\r\n\t\t\tif (!this.oDialog) {\r\n\t\t\t\tthis.oDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ConfirmationExit\", // Fragment path\r\n\t\t\t\t\tthis\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.oDialog);\r\n\t\t\t}\r\n\t\t\tthis.oDialog.open();\r\n\t\t},\r\n\r\n\t\tfnDeleteRow: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar aSelectedIndices = oTable.getSelectedIndices();\r\n\r\n\t\t\tif (aSelectedIndices.length === 0) {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"SelectMaterialComponentError\"), \"Error\", this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\r\n\t\t\t// --- If Change Log required ---\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\r\n\t\t\t\tvar gChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\t\tif (!gChangeLogModel) {\r\n\t\t\t\t\tgChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\t\tthis.getOwnerComponent().setModel(gChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar aGlobalChangeLog = gChangeLogModel.getData() || [];\r\n\r\n\t\t\t\t// --- For each selected row ---\r\n\t\t\t\taSelectedIndices.forEach(function(iIndex) {\r\n\t\t\t\t\tvar oContext = oTable.getContextByIndex(iIndex);\r\n\t\t\t\t\tif (oContext) {\r\n\t\t\t\t\t\tvar sPath = oContext.getPath();\r\n\r\n\t\t\t\t\t\t// Old values before delete\r\n\t\t\t\t\t\tvar oOldData = {\r\n\t\t\t\t\t\t\tVornr: oModel.getProperty(sPath + \"/Vornr\") || \"\",\r\n\t\t\t\t\t\t\tPhflg: oModel.getProperty(sPath + \"/Phflg\") ? \"X\" : \"\",\r\n\t\t\t\t\t\t\tPvznr: oModel.getProperty(sPath + \"/Pvznr\") || \"\",\r\n\t\t\t\t\t\t\tLtxa1: oModel.getProperty(sPath + \"/Ltxa1\") || \"\"\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// Clear values\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Vornr\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Phflg\", false);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Pvznr\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Arbpl\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Ltxa1\", \"\");\r\n\r\n\t\t\t\t\t\t// New (cleared) values\r\n\t\t\t\t\t\tvar oNewData = {\r\n\t\t\t\t\t\t\tVornr: \"\",\r\n\t\t\t\t\t\t\tPhflg: \"\",\r\n\t\t\t\t\t\t\tPvznr: \"\",\r\n\t\t\t\t\t\t\tLtxa1: \"\"\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// Compare and record in change log\r\n\t\t\t\t\t\tObject.keys(oOldData).forEach(function(key) {\r\n\t\t\t\t\t\t\tvar oldVal = oOldData[key];\r\n\t\t\t\t\t\t\tvar newVal = oNewData[key];\r\n\r\n\t\t\t\t\t\t\tif (oldVal !== newVal) {\r\n\t\t\t\t\t\t\t\tvar sFieldId = \"ID_PV_\" + key.toUpperCase();\r\n\t\t\t\t\t\t\t\tvar sItemNo = oModel.getProperty(sPath + \"/Posnr\") || \"\";\r\n\r\n\t\t\t\t\t\t\t\t// Remove any existing log for same field\r\n\t\t\t\t\t\t\t\taGlobalChangeLog = aGlobalChangeLog.filter(function(item) {\r\n\t\t\t\t\t\t\t\t\treturn item.FieldId !== sFieldId || item.ItemNo !== sItemNo;\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tvar oFieldName = that.fnGetColumnTooltip(key);\r\n\t\t\t\t\t\t\t\tvar oEntry = {\r\n\t\t\t\t\t\t\t\t\tProcessInd: \"P\",\r\n\t\t\t\t\t\t\t\t\tFieldId: sFieldId,\r\n\t\t\t\t\t\t\t\t\tProcessDesc: \"Production Version\",\r\n\t\t\t\t\t\t\t\t\tFieldName: \"Deleted -  \" + oFieldName + \" - \" + sItemNo,\r\n\t\t\t\t\t\t\t\t\tItemNo: sItemNo,\r\n\t\t\t\t\t\t\t\t\tOldValue: oldVal || \"\",\r\n\t\t\t\t\t\t\t\t\tNewValue: newVal || \"\",\r\n\t\t\t\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\t\t\t\tChangedOn: new Date()\r\n\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\taGlobalChangeLog.push(oEntry);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// --- Update both Change Log Models ---\r\n\t\t\t\tgChangeLogModel.setData(aGlobalChangeLog);\r\n\t\t\t\tgChangeLogModel.refresh(true);\r\n\t\t\t}\r\n\r\n\t\t\t// --- For non-RX app, just clear values ---\r\n\t\t\telse {\r\n\t\t\t\taSelectedIndices.forEach(function(iIndex) {\r\n\t\t\t\t\tvar oContext = oTable.getContextByIndex(iIndex);\r\n\t\t\t\t\tif (oContext) {\r\n\t\t\t\t\t\tvar sPath = oContext.getPath();\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Vornr\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Phflg\", false);\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Pvznr\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Arbpl\", \"\");\r\n\t\t\t\t\t\toModel.setProperty(sPath + \"/Ltxa1\", \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"MaterialDataClearInfo\"), \"information\", this);\r\n\t\t},\r\n\r\n\t\tfnChangelog: function() {\r\n\t\t\tif (!this.Changelog) {\r\n\t\t\t\tthis.Changelog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.ChangeLog\", // Fragment name\r\n\t\t\t\t\tthis // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.Changelog);\r\n\t\t\t}\r\n\r\n\t\t\tthis.Changelog.open();\r\n\t\t},\r\n\r\n\t\tfnUpdateChangelog: function(vId) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar oControl = this.getView().byId(vId);\r\n\t\t\tvar newValue;\r\n\r\n\t\t\tif (oControl.getValue) {\r\n\t\t\t\tnewValue = oControl.getValue();\r\n\t\t\t} else if (oControl.getSelected) {\r\n\t\t\t\tnewValue = oControl.getSelected();\r\n\t\t\t} else {\r\n\t\t\t\tnewValue = null; // fallback\r\n\t\t\t}\r\n\r\n\t\t\tvar trimmed = vId.replace(/^ID_PV_/, \"\");\r\n\r\n\t\t\tvar parts = trimmed.toLowerCase().split(\"_\");\r\n\t\t\tvar ObjectId = parts.map(function(p) {\r\n\t\t\t\treturn p.charAt(0).toUpperCase() + p.slice(1);\r\n\t\t\t}).join(\"\");\r\n\r\n\t\t\tvar oRecipeInitialDataModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\t\t\tif (!oRecipeInitialDataModel) return;\r\n\r\n\t\t\tvar oRecipeData = this.oldValue;\r\n\r\n\t\t\tif (!oRecipeData.hasOwnProperty(ObjectId)) return;\r\n\r\n\t\t\tvar oldValue = oRecipeData[ObjectId];\r\n\r\n\t\t\tvar gChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!gChangeLogModel) {\r\n\t\t\t\tgChangeLogModel = new sap.ui.model.json.JSONModel([]);\r\n\t\t\t\tthis.getOwnerComponent().setModel(gChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\r\n\t\t\tvar oChangeLogData = gChangeLogModel.getData();\r\n\t\t\tif (!Array.isArray(oChangeLogData)) {\r\n\t\t\t\toChangeLogData = [];\r\n\t\t\t} else {\r\n\t\t\t\tvar aFiltered = oChangeLogData.filter(function(item) {\r\n\t\t\t\t\treturn item.ProcessInd === \"P\" && item.ItemNo === \"\" && item.FieldId === vId;\r\n\t\t\t\t});\r\n\t\t\t\tif (aFiltered.length > 0) {\r\n\t\t\t\t\toldValue = aFiltered[0].OldValue || \"\";\r\n\t\t\t\t\toRecipeData[ObjectId] = oldValue;\r\n\t\t\t\t\tthis.oldValue = oRecipeData;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar idx = oChangeLogData.findIndex(function(item) {\r\n\t\t\t\treturn item.FieldId === vId;\r\n\t\t\t});\r\n\r\n\t\t\toldValue = (typeof oldValue === \"boolean\") ? (oldValue ? \"X\" : \"\") : oldValue;\r\n\t\t\tnewValue = (typeof newValue === \"boolean\") ? (newValue ? \"X\" : \"\") : newValue;\r\n\r\n\t\t\tif (oldValue !== newValue) {\r\n\t\t\t\tif (idx === -1) {\r\n\t\t\t\t\toChangeLogData.push({\r\n\t\t\t\t\t\tProcessInd: \"P\",\r\n\t\t\t\t\t\tFieldId: vId,\r\n\t\t\t\t\t\tProcessDesc: \"Production Version\",\r\n\t\t\t\t\t\tFieldName: this.getView().byId(vId + \"_TXT\").getText(),\r\n\t\t\t\t\t\tItemNo: \"\",\r\n\t\t\t\t\t\tOldValue: oldValue,\r\n\t\t\t\t\t\tNewValue: newValue,\r\n\t\t\t\t\t\tChangedBy: that.UserName,\r\n\t\t\t\t\t\tChangedOn: new Date()\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\toChangeLogData[idx].NewValue = newValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\toChangeLogData.splice(idx, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tgChangeLogModel.setData(oChangeLogData);\r\n\t\t\tgChangeLogModel.refresh(true);\r\n\r\n\t\t},\r\n\r\n\t\tfnGetColumnTooltip: function(ObjectId) {\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar aColumns = oTable.getColumns();\r\n\r\n\t\t\tfor (var i = 0; i < aColumns.length; i++) {\r\n\t\t\t\tvar oTemplate = aColumns[i].getTemplate();\r\n\t\t\t\tif (!oTemplate) continue;\r\n\r\n\t\t\t\tvar sBoundPath = \"\";\r\n\r\n\t\t\t\tif (oTemplate.isA(\"sap.m.VBox\")) {\r\n\t\t\t\t\tvar aItems = oTemplate.getItems();\r\n\t\t\t\t\tif (aItems && aItems.length > 0) {\r\n\t\t\t\t\t\toTemplate = aItems[0]; // take inner control\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar aPossibleProps = [\"text\", \"value\", \"selected\", \"state\"];\r\n\t\t\t\tfor (var j = 0; j < aPossibleProps.length; j++) {\r\n\t\t\t\t\tvar sProp = aPossibleProps[j];\r\n\t\t\t\t\tvar oBindInfo = oTemplate.getBindingInfo(sProp);\r\n\t\t\t\t\tif (oBindInfo && oBindInfo.parts && oBindInfo.parts.length > 0) {\r\n\t\t\t\t\t\tsBoundPath = oBindInfo.parts[0].path;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sBoundPath === ObjectId) {\r\n\t\t\t\t\tvar oLabel = aColumns[i].getLabel();\r\n\t\t\t\t\treturn oLabel ? oLabel.getTooltip() : \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\r\n\t\tfnCloseChanLogDialog: function() {\r\n\t\t\tif (this.Changelog) {\r\n\t\t\t\tthis.Changelog.close();\r\n\t\t\t\tthis.Changelog.destroy();\r\n\t\t\t\tthis.Changelog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnExpandCollapse: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar GridVisibleState = this.getView().byId(id + \"_GRID\").getVisible();\r\n\t\t\tvar PannelHead = this.getView().byId(id + \"_HEADER\");\r\n\t\t\tif (GridVisibleState) {\r\n\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(false);\r\n\t\t\t\tthis.getView().byId(id).addStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHead\");\r\n\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.getView().byId(id + \"_GRID\").setVisible(true);\r\n\t\t\t\tPannelHead.removeStyleClass(\"cl_pannelHeadSS\");\r\n\t\t\t\tthis.getView().byId(id).removeStyleClass(\"cl_search_rotateImage\");\r\n\t\t\t\tPannelHead.addStyleClass(\"cl_pannelHead\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCheckMandatoryFields: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar mandatoryFields = [{\r\n\t\t\t\tid: \"ID_PV_VERID\",\r\n\t\t\t\tname: \"Product Version\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"ID_PV_STLAL\",\r\n\t\t\t\tname: \"Alternative BOM\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"ID_PV_STLAN\",\r\n\t\t\t\tname: \"BOM Usage\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"ID_PV_TEXT1\",\r\n\t\t\t\tname: \"Product Version Description\"\r\n\t\t\t}];\r\n\r\n\t\t\tvar emptyFields = [];\r\n\t\t\tfor (var i = 0; i < mandatoryFields.length; i++) {\r\n\t\t\t\tvar value = this.getView().byId(mandatoryFields[i].id).getValue();\r\n\t\t\t\tif (value === \"\") {\r\n\t\t\t\t\temptyFields.push(mandatoryFields[i]);\r\n\t\t\t\t\tthis.getView().byId(mandatoryFields[i].id).setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(mandatoryFields[i].id).setValueStateText(mandatoryFields[i].name + \" is Mandatory\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getView().byId(mandatoryFields[i].id).setValueState(\"None\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (emptyFields.length > 0) {\r\n\t\t\t\tif (emptyFields.length === 1) {\r\n\t\t\t\t\tfor (var j = 0; j < emptyFields.length; j++) {\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"MandatoryFieldError\", [emptyFields[j].name]), \"Error\", this);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"PleaseEnterMandatoryFields\"), \"Error\", this);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tfnToEdmDecimal: function(value, totalDigits, decimalPlaces) {\r\n\t\t\tif (value === null || value === undefined || value === \"\") {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar num = parseFloat(value);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\treturn decimalPlaces > 0 ? \"0.\" + \"0\".repeat(decimalPlaces) : \"0\";\r\n\t\t\t}\r\n\t\t\tvar fixedValue = num.toFixed(decimalPlaces);\r\n\t\t\tvar parts = fixedValue.split(\".\");\r\n\t\t\tvar intPart = parts[0];\r\n\t\t\tvar decPart = parts[1] || \"\";\r\n\t\t\tvar maxIntLength = totalDigits - decimalPlaces;\r\n\t\t\tif (intPart.length > maxIntLength) {\r\n\t\t\t\tintPart = intPart.slice(0, maxIntLength);\r\n\t\t\t}\r\n\t\t\tvar result = decimalPlaces > 0 ? intPart + \".\" + decPart : intPart;\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tfnCheckErrorState: function() {\r\n\t\t\tvar retMsg = true;\r\n\t\t\tfor (var i = 0; i < frontEndId.length; i++) {\r\n\t\t\t\tif (this.getView().byId(frontEndId[i]).getValueState() === \"Error\") {\r\n\t\t\t\t\tretMsg = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn retMsg;\r\n\t\t},\r\n\r\n\t\tfnResetInputStates: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tfrontEndId.forEach(function(sId) {\r\n\t\t\t\tvar oInput = that.getView().byId(sId) || sap.ui.core.Fragment.byId(\"ID_ITEMLEVEL\", sId);\r\n\t\t\t\tif (oInput) {\r\n\t\t\t\t\t// Handle CheckBox type\r\n\t\t\t\t\tif (oInput instanceof sap.m.CheckBox) {\r\n\t\t\t\t\t\toInput.removeStyleClass(\"cl_checkboxError\");\r\n\t\t\t\t\t\toInput.addStyleClass(\"cl_opr_checkbx\");\r\n\t\t\t\t\t\toInput.setTooltip(\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Handle Input type\r\n\t\t\t\t\telse if (oInput instanceof sap.m.Input) {\r\n\t\t\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t\t\t\toInput.setTooltip(\"\");\r\n\t\t\t\t\t} else if (oInput.setValueState) {\r\n\t\t\t\t\t\toInput.setValueState(\"None\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\tfnclearLocalModel: function() {\r\n\t\t\tTransId = \"\";\r\n\t\t\tvar aModels = [\"JM_ContextModel\", \"JM_LocChangeLog\", \"JM_DescriptionModel\", \"JM_ProductionModel\", \"JM_RecipeData\",\r\n\t\t\t\t\"JM_KeydataModel\"\r\n\t\t\t];\r\n\t\t\tvar that = this;\r\n\t\t\taModels.forEach(function(sModelName) {\r\n\t\t\t\tvar oModel = that.getView().getModel(sModelName);\r\n\t\t\t\tif (oModel) {\r\n\t\t\t\t\tthat.getView().setModel(null, sModelName);\r\n\t\t\t\t\tthat.getView().setModel(undefined, sModelName);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar oTable = this.byId(\"idMaterialComTable\");\r\n\t\t\tvar oComponent = this.getOwnerComponent();\r\n\t\t\tvar oChangeLogModel = oComponent.getModel(\"JM_ChangeLog\");\r\n\t\t\tvar aChangeLogData = oChangeLogModel ? oChangeLogModel.getData() : [];\r\n\t\t\tvar oContextModel = oComponent.getModel(\"JM_ContextModel\");\r\n\t\t\tvar oUwlData = oContextModel.getData() || {};\r\n\t\t\tif (Array.isArray(aChangeLogData) && aChangeLogData.length > 0 && oUwlData.Appid === \"RX\") {\r\n\r\n\t\t\t\tvar aChangedItems = oChangeLogModel.getData().filter(function(item) {\r\n\t\t\t\t\treturn item.ProcessInd === \"P\";\r\n\t\t\t\t});\r\n\r\n\t\t\t\toTable.setRowSettingsTemplate(\r\n\t\t\t\t\tnew sap.ui.table.RowSettings({\r\n\t\t\t\t\t\thighlight: sap.ui.core.IndicationColor.None\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\taChangedItems.forEach(function(oItem) {\r\n\t\t\t\t\tvar sFieldId = oItem.FieldId;\r\n\t\t\t\t\tif (!sFieldId) return;\r\n\r\n\t\t\t\t\tvar oControl = that.getView().byId(sFieldId);\r\n\t\t\t\t\tif (oControl) {\r\n\t\t\t\t\t\toControl.removeStyleClass(\"cl_HighLightInput\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (oTable) {\r\n\t\t\t\toTable.clearSelection();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfnClearChangeLog: function() {\r\n\t\t\tvar oChangeLogModel = this.getOwnerComponent().getModel(\"JM_ChangeLog\");\r\n\t\t\tif (!oChangeLogModel) {\r\n\t\t\t\toChangeLogModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\tthis.getOwnerComponent().setModel(oChangeLogModel, \"JM_ChangeLog\");\r\n\t\t\t}\r\n\t\t\tif (this.OrgChangeLog) {\r\n\t\t\t\toChangeLogModel.setData(this.OrgChangeLog);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnclose: function() {\r\n\t\t\tif (this.AppId === \"RX\") {\r\n\t\t\t\tthis.fnClearChangeLog();\r\n\t\t\t}\r\n\t\t\tthis.fnclearMaterialAssign();\r\n\t\t\tthis.fnclearLocalModel();\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t},\r\n\r\n\t\tfnclearMaterialAssign: function() {\r\n\t\t\tvar oGlobalModel = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oProdModel = this.getView().getModel(\"JM_ProductionModel\");\r\n\r\n\t\t\tif (oGlobalModel && oProdModel) {\r\n\t\t\t\tvar glb = oGlobalModel.getData();\r\n\t\t\t\tvar pv = oProdModel.getData();\r\n\r\n\t\t\t\tif (glb.NavPV_MaterialCompData && pv.NavPV_MaterialCompData) {\r\n\t\t\t\t\tvar aCleanedData = pv.NavPV_MaterialCompData.filter(function(pvItem) {\r\n\t\t\t\t\t\tvar glbItem = glb.NavPV_MaterialCompData.find(function(g) {\r\n\t\t\t\t\t\t\treturn g.Idnrk === pvItem.Idnrk;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn glbItem && glbItem.Vornr && glbItem.Vornr.trim() !== \"\";\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tpv.NavPV_MaterialCompData = aCleanedData;\r\n\t\t\t\t\toProdModel.setData(pv);\r\n\t\t\t\t\toProdModel.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnSetProductVersionIndicator: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JM_ProductionVrsn\");\r\n\t\t\tvar oProdModel = oView.getModel(\"JM_ProductionModel\");\r\n\t\t\tvar oGlobalBomModel = this.getOwnerComponent().getModel(\"JM_Bom\");\r\n\t\t\tvar that = this;\r\n\r\n\t\t\t// Get data arrays\r\n\t\t\tvar aMatCompData = oProdModel.getProperty(\"/NavPV_MaterialCompData\") || [];\r\n\t\t\tvar aBomItemData = oGlobalBomModel.getProperty(\"/NavBomItem\") || [];\r\n\r\n\t\t\t// Mandatory fields config\r\n\t\t\tvar aMandatoryFields = [{\r\n\t\t\t\tkey: \"Verid\",\r\n\t\t\t\tid: \"ID_PV_VERID\",\r\n\t\t\t\tname: \"Product Version\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"Stlal\",\r\n\t\t\t\tid: \"ID_PV_STLAL\",\r\n\t\t\t\tname: \"Alternative BOM\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"Stlan\",\r\n\t\t\t\tid: \"ID_PV_STLAN\",\r\n\t\t\t\tname: \"BOM Usage\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"Text1\",\r\n\t\t\t\tid: \"ID_PV_TEXT1\",\r\n\t\t\t\tname: \"Product Version Description\"\r\n\t\t\t}];\r\n\r\n\t\t\t// Determine empty fields\r\n\t\t\tvar aEmptyFields = aMandatoryFields.filter(function(f) {\r\n\t\t\t\tvar sValue = \"\";\r\n\r\n\t\t\t\tif (oModel && that.hasGlobalValue) {\r\n\t\t\t\t\tsValue = oModel.getProperty(\"/\" + f.key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar oInput = oView.byId(f.id);\r\n\t\t\t\t\tsValue = oInput ? oInput.getValue() : \"\";\r\n\t\t\t\t}\r\n\t\t\t\treturn !sValue || sValue.toString().trim() === \"\";\r\n\t\t\t});\r\n\r\n\t\t\t// -------- Helper: set indicator --------\r\n\t\t\tfunction updateIndicator(hboxId, btnId, isSuccess) {\r\n\t\t\t\tvar oHBox = oView.byId(hboxId);\r\n\t\t\t\tvar oBtn = oView.byId(btnId);\r\n\r\n\t\t\t\tif (!oHBox || !oBtn) return;\r\n\r\n\t\t\t\toHBox.setVisible(true);\r\n\t\t\t\toBtn.removeStyleClass(\"cl_IndicatorS cl_IndicatorP cl_IndicatorR\");\r\n\r\n\t\t\t\tif (isSuccess) {\r\n\t\t\t\t\toBtn.setIcon(\"Image/IndicatorS.svg\");\r\n\t\t\t\t\toBtn.setText(\"Success\");\r\n\t\t\t\t\toBtn.setType(\"Accept\");\r\n\t\t\t\t\toBtn.addStyleClass(\"cl_IndicatorS\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toBtn.setIcon(\"Image/IndicatorP.svg\");\r\n\t\t\t\t\toBtn.setText(\"Pending\");\r\n\t\t\t\t\toBtn.setType(\"Emphasized\");\r\n\t\t\t\t\toBtn.addStyleClass(\"cl_IndicatorP\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Product Version indicator\r\n\t\t\tupdateIndicator(\"ID_PVIND\", \"ID_PVIND_BTN\", aEmptyFields.length === 0);\r\n\r\n\t\t\t// BOM indicator\r\n\t\t\tupdateIndicator(\"ID_BOMIND\", \"ID_BOMIND_BTN\", aMatCompData.length > 0 && aBomItemData.length > 0);\r\n\t\t}\r\n\r\n\t});\r\n\r\n});",
		"MANAGED_RECIPE/controller/reci_keydata.controller.js": "sap.ui.define([\r\n\t\"sap/ui/core/mvc/Controller\",\r\n\t\"MANAGED_RECIPE/controller/ErrorHandler\",\r\n\t\"MANAGED_RECIPE/Formatter/formatter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n], function(Controller, ErrorHandler, formatter, FilterOperator, Filter, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tvar busyDialog = new sap.m.BusyDialog();\r\n\tvar i18n;\r\n\r\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.reci_keydata\", {\r\n\t\tformatter: formatter,\r\n\r\n\t\t// on Intial Load of page/view\t\r\n\t\tonInit: function() {\r\n\t\t\tthis.f4Cache = {};\r\n\r\n\t\t\t// ********************* IMAGE MODEL ************************\r\n\t\t\tvar vPathImage = jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/Image/\";\r\n\t\t\tvar oImageModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\tpath: vPathImage\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(oImageModel, \"JM_ImageModel\");\r\n\r\n\t\t\t// **********************************************************\r\n\r\n\t\t\tvar i18nModel = new ResourceModel({\r\n\t\t\t\tbundleName: \"MANAGED_RECIPE.i18n.i18n\"\r\n\t\t\t});\r\n\t\t\tthis.getView().setModel(i18nModel, \"i18n\");\r\n\r\n\t\t\ti18n = this.getView().getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\tthis.oRouter = this.getOwnerComponent().getRouter(this);\r\n\t\t\tthis.oRouter.getRoute(\"reci_keydata\").attachPatternMatched(this.fnRouter, this);\r\n\t\t},\r\n\r\n\t\t// on Every time load of page/view\r\n\t\tfnRouter: function() {\r\n\r\n\t\t\t// var oVisModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t// \tlabelVisible: true\r\n\t\t\t// });\r\n\t\t\t// this.getView().setModel(oVisModel, \"RoadMapUI\");\r\n\t\t\t// sap.ui.Device.resize.attachHandler(this._onResize, this);\r\n\t\t\t// this._onResize();\r\n\r\n\t\t\t// css change for navigation bar\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").removeStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_dashBoard_h\").addStyleClass(\"cl_list_con\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").addStyleClass(\"cl_listhighlight\");\r\n\t\t\t// this.getView().byId(\"id_appList_h\").removeStyleClass(\"cl_list_con\");\r\n\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\toModel.read(\"/UsernameSet\", {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar oJsonModel = new sap.ui.model.json.JSONModel();\r\n\t\t\t\t\toJsonModel.setData(oData.results);\r\n\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_UserModel\"); // local model\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t\tvar oParmModel = this.getOwnerComponent().getModel(\"JM_WfParm\"); // getting data from global model\r\n\t\t\tvar oKeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\"); // getting data from global model\r\n\t\t\tthis.Appid = this.getOwnerComponent().getModel(\"JM_KeyData\").getProperty(\"/AppId\");\r\n\t\t\tif (!this.Appid) {\r\n\t\t\t\tthis.Appid = \"RC\";\r\n\t\t\t}\r\n\t\t\tif (Object.keys(oParmModel.getData() || {}).length > 0 || this.Appid === \"RX\") {\r\n\t\t\t\tthis.fnSetParmdata(this.Appid).then(function(status) {\r\n\t\t\t\t\tif (status) {\r\n\t\t\t\t\t\tif (this.Appid === \"RX\") {\r\n\t\t\t\t\t\t\t// change title\r\n\t\t\t\t\t\t\tthis.getView().byId(\"id_title\").setText(i18n.getText(\"RXKeyData\"));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.getView().byId(\"id_title\").setText(i18n.getText(\"RCKeyData\"));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.getView().setModel(oParmModel, \"JM_ParmModel\"); // local model values\r\n\t\t\t\t\t\tif (!Object.keys(oKeyDataModel.getData() || {}).length > 0) {\r\n\t\t\t\t\t\t\tvar KeyDataModel = {\r\n\t\t\t\t\t\t\t\tMatnr: \"\",\r\n\t\t\t\t\t\t\t\tMaktx: \"\",\r\n\t\t\t\t\t\t\t\tWerks: \"\",\r\n\t\t\t\t\t\t\t\tWerksDes: \"\",\r\n\t\t\t\t\t\t\t\tProfile: \"\",\r\n\t\t\t\t\t\t\t\tProfileDes: \"\",\r\n\t\t\t\t\t\t\t\tReciDes: \"\",\r\n\t\t\t\t\t\t\t\tAppId: this.Appid\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\t\t\t\t\toWfparm.setData(KeyDataModel); // replaces the data\r\n\t\t\t\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this));\r\n\r\n\t\t\t} else {\r\n\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// *---------------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tContinue button press in key data\r\n\t\t// *---------------------------------------------------------------------------\r\n\r\n\t\tfnContinue: function(oEvent) {\r\n\t\t\tvar vMaterial = this.getView().byId(\"KID_RECI_MATNR\").getValue();\r\n\t\t\tvar vPlant = this.getView().byId(\"KID_RECI_WERKS\").getValue();\r\n\t\t\tvar vProfile = this.getView().byId(\"KID_RECI_PROFID_STD\").getValue();\r\n\t\t\tvar vReciDes = this.getView().byId(\"KID_RECI_RECIDES\").getValue();\r\n\t\t\tvar retMsg = true;\r\n\t\t\tif (vMaterial === \"\" && vPlant === \"\" && vProfile === \"\" && vReciDes === \"\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Mandatory Fields\", \"Error\", this);\r\n\t\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"Error\");\r\n\t\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueState(\"Error\");\r\n\t\t\t}\r\n\t\t\tif (vPlant === \"\" || this.getView().byId(\"KID_RECI_WERKS\").getValueState() === \"Error\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tif (this.getView().byId(\"KID_RECI_WERKS\").getValueState() === \"Error\") {\r\n\t\t\t\t\tvar valueStateMessage = this.getView().byId(\"KID_RECI_WERKS\").getValueStateText();\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(valueStateMessage, \"Error\", this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueStateText(\"Enter Plant\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vProfile === \"\" || this.getView().byId(\"KID_RECI_PROFID_STD\").getValueState() === \"Error\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tif (this.getView().byId(\"KID_RECI_PROFID_STD\").getValueState() === \"Error\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Mandatory Fields\", \"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueStateText(\"Enter Valid Profile\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueStateText(\"Enter Profile\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vMaterial === \"\" || this.getView().byId(\"KID_RECI_MATNR\").getValueState() === \"Error\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tif (this.getView().byId(\"KID_RECI_MATNR\").getValueState() === \"Error\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Mandatory Fields\", \"Error\", this);\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueStateText(\"Enter Valid Material Number\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueStateText(\"Enter Material Number\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vReciDes === \"\" || this.getView().byId(\"KID_RECI_RECIDES\").getValueState() === \"Error\") {\r\n\t\t\t\tretMsg = false;\r\n\t\t\t\tif (this.getView().byId(\"KID_RECI_RECIDES\").getValueState() === \"Error\") {\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(\"Please Enter Mandatory Fields\", \"Error\", this);\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueStateText(\"Enter Valid Recipe Decription\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueState(\"Error\");\r\n\t\t\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueStateText(\"Enter Recipe Decription\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (retMsg) {\r\n\t\t\t\tthis.fnSetParmdata(this.Appid).then(function(Status) {\r\n\t\t\t\t\tif (Status) {\r\n\t\t\t\t\t\tvar oGlobalPam = {};\r\n\t\t\t\t\t\tvar oWFparamData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t\t\t\tvar cleanedParamData = {};\r\n\t\t\t\t\t\tObject.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\t\t\t\tvar field = this.byId(oWFparamData[key]);\r\n\t\t\t\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\toGlobalPam = cleanedParamData;\r\n\t\t\t\t\t\tif (this.Appid !== \"RX\") {\r\n\t\t\t\t\t\t\tthis.fnCheckDuplicate();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.fnCheckParmChangeProcess().then(function(flag) {\r\n\t\t\t\t\t\t\t\tif (flag) {\r\n\t\t\t\t\t\t\t\t\toGlobalPam = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\t\t\t\toGlobalPam.setData({}); // clear\r\n\t\t\t\t\t\t\t\t\toGlobalPam.refresh(true);\r\n\t\t\t\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(\"WorkFlow not maintained\", \"Error\", this);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}.bind(this));\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfnCheckParmChangeProcess: function() {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar oKeyDataEntity = this.getOwnerComponent().getModel();\r\n\t\t\t\tvar KeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\").getData();\r\n\r\n\t\t\t\t// var oGlobalparmData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t\t// var Parmmodel = JSON.parse(JSON.stringify(oGlobalparmData)); // Deep copy\r\n\t\t\t\tvar Parmmodel;\r\n\r\n\t\t\t\tvar oWFparamData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t\tvar cleanedParamData = {};\r\n\t\t\t\tObject.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\t\tvar field = this.byId(oWFparamData[key]);\r\n\t\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\tParmmodel = cleanedParamData;\r\n\r\n\t\t\t\tParmmodel.Matnr = KeyDataModel.Matnr;\r\n\t\t\t\tParmmodel.Werks = KeyDataModel.Werks;\r\n\t\t\t\tParmmodel.Ind = \"V\";\r\n\t\t\t\tParmmodel.Nav_Duplicate = [];\r\n\t\t\t\tParmmodel.AppId = \"RX\";\r\n\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toKeyDataEntity.create(\"/Recipe_Key_dataSet\", Parmmodel, {\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tif (oData.MsgTyp === \"S\") {\r\n\t\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tResolve(false);\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tLive Change Actions\r\n\t\t// *-----------------------------------------------------------------------\r\n\r\n\t\t// live change process for all fields\r\n\t\tfnLiveChange: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tvar vValue = oEvent.getSource().getValue();\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\");\r\n\r\n\t\t\tif (id === \"KID_RECI_RECIDES\") {\r\n\t\t\t\toInput.setValue(vValue);\r\n\t\t\t} else {\r\n\t\t\t\toInput.setValue(vValue.toUpperCase());\r\n\t\t\t\tif (id === \"KID_RECI_MATNR\") {\r\n\t\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase().replace(/^0+/, \"\"), \"P\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fnReadf4Cache(id, vValue.toUpperCase(), \"P\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Validate the material plant and field\r\n\t\tfnValidateMaterialPlant: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.getView().byId(id).setValueState(\"None\");\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\tif (id === \"KID_RECI_MATNR\" && !this.Error) {\r\n\t\t\t\tvar vPlant = this.getView().byId(\"KID_RECI_WERKS\").getValue();\r\n\t\t\t\tthis.fnValidatePlant(vPlant);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// validate the plant field\r\n\t\tfnValidatePlant: function(plant) {\r\n\t\t\tvar KeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\").getData();\r\n\t\t\tthis.fnSetParmdata(this.Appid).then(function(Status) {\r\n\t\t\t\tif (Status) {\r\n\t\t\t\t\tvar Parmmodel = {};\r\n\t\t\t\t\tvar oWFparamData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t\t\tvar cleanedParamData = {};\r\n\t\t\t\t\tObject.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\t\t\t// var fieldId = oWFparamData[key].split(\"_\")[1];\r\n\t\t\t\t\t\t\t// fieldId = \"KID_RECI_\" + fieldId;\r\n\t\t\t\t\t\t\tvar field = this.byId(oWFparamData[key]);\r\n\t\t\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\tParmmodel = cleanedParamData;\r\n\t\t\t\t\tParmmodel.AppId = this.Appid;\r\n\t\t\t\t\tParmmodel.Matnr = KeyDataModel.Matnr;\r\n\t\t\t\t\tParmmodel.Werks = KeyDataModel.Werks;\r\n\t\t\t\t\tParmmodel.Ind = \"V\";\r\n\t\t\t\t\tParmmodel.Nav_Duplicate = [];\r\n\t\t\t\t\tvar serviceCall = this.getOwnerComponent().getModel();\r\n\t\t\t\t\tserviceCall.create(\"/Recipe_Key_dataSet\", Parmmodel, {\r\n\t\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\t\tif (oData.MsgTyp === \"E\") {\r\n\t\t\t\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"Error\");\r\n\t\t\t\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueStateText(oData.MsgLine);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"None\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t\t// var oWFparamModel = this.getView().getModel(\"JM_ParmModel\");\r\n\t\t\t// var oWFparamData = JSON.parse(JSON.stringify(oWFparamModel.getData()));\r\n\t\t\t// var cleanedParamData = {};\r\n\t\t\t// Object.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t// \tif (key.endsWith(\"Id\")) {\r\n\t\t\t// \t\tvar newKey = key.slice(0, -2);\r\n\t\t\t// \t\tvar fieldId = oWFparamData[key].split(\"_\")[1];\r\n\t\t\t// \t\tfieldId = \"KID_RECI_\" + fieldId;\r\n\t\t\t// \t\tvar field = this.byId(fieldId);\r\n\t\t\t// \t\tvar fieldValue = \"\";\r\n\t\t\t// \t\tif (field && field.getValue) {\r\n\t\t\t// \t\t\tfieldValue = field.getValue();\r\n\t\t\t// \t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// }, this);\r\n\r\n\t\t\t// if (Object.keys(cleanedParamData).length === 0) {\r\n\t\t\t// this.fnSetParmdata(this.Appid).then(function(Status) {\r\n\t\t\t// \t// Parmmodel = \r\n\t\t\t// \tif (Status) {\r\n\t\t\t// \t\tvar oWFparamData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\t// \t\tvar cleanedParamData = {};\r\n\t\t\t// \t\tObject.keys(oWFparamData).forEach(function(key) {\r\n\t\t\t// \t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t// \t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t// \t\t\t\tvar fieldId = oWFparamData[key].split(\"_\")[1];\r\n\t\t\t// \t\t\t\tfieldId = \"KID_RECI_\" + fieldId;\r\n\t\t\t// \t\t\t\tvar field = this.byId(fieldId);\r\n\t\t\t// \t\t\t\tvar fieldValue = \"\";\r\n\t\t\t// \t\t\t\tif (field && field.getValue) {\r\n\t\t\t// \t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t// \t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t// \t\t\t\t}\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}, this);\r\n\r\n\t\t\t// \t}\r\n\t\t\t// }.bind(this));\r\n\r\n\t\t},\r\n\r\n\t\t// to check the date wheather is avalible in F4 or not\r\n\t\tfnCheckDatavalidation: function(id, value) {\r\n\t\t\tvar data = this.f4Cache[id];\r\n\t\t\tif (!data || !Array.isArray(data)) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tvar sQuery = value ? value.toUpperCase() : \"\";\r\n\t\t\tvar aMatched = [];\r\n\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taMatched = data.filter(function(item) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t(item.Value1 && item.Value1.toUpperCase().includes(sQuery))\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Return matched length\r\n\t\t\treturn aMatched.length;\r\n\t\t},\r\n\r\n\t\t// the and match the description from the F4Cahce\r\n\t\tfnReadf4Cache: function(vId, vValue, f4type) {\r\n\t\t\tvar that = this;\r\n\t\t\tvar match;\r\n\t\t\tvar descriptionField;\r\n\t\t\tvar updateDesc = function(results) {\r\n\t\t\t\tif (f4type === \"P\" || f4type === \"X\") {\r\n\t\t\t\t\tvar aResults = results[0];\r\n\t\t\t\t\tif (aResults.DomvalueL !== \"\") {\r\n\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\treturn item.DomvalueL === vValue.toUpperCase();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\t\tthat.fnUpdateF4fields(vId, vValue, match.Ddtext);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.fnUpdateF4fields(vId, vValue, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Default: match Value1/Value2 as usual\r\n\t\t\t\t\t\tif (that.selectedField === \"KID_RECI_MATNR\") {\r\n\t\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\t\treturn item.Value1.replace(/^0+/, \"\") === vValue.toUpperCase();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmatch = results.find(function(item) {\r\n\t\t\t\t\t\t\t\treturn item.Value1 === vValue.toUpperCase();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\t\tdescriptionField.setValue(match.Value2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdescriptionField = that.getView().byId(that.selectedField + \"_DES\");\r\n\t\t\t\t\t\t\tif (descriptionField) {\r\n\t\t\t\t\t\t\t\tdescriptionField.setValue(\"\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar length = that.fnCheckDatavalidation(that.selectedField, vValue);\r\n\t\t\t\tif (length === 0 && vValue !== \"\") {\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"Error\");\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueStateText(vValue + \" value is not Avalible\");\r\n\t\t\t\t\tthat.Error = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthat.getView().byId(that.selectedField).setValueState(\"None\");\r\n\t\t\t\t\tthat.Error = false;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (this.f4Cache[vId]) {\r\n\t\t\t\tupdateDesc(this.f4Cache[vId]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.f4descriptionGet(vId, vValue, f4type, function(results) {\r\n\t\t\t\t\tthat.f4Cache[vId] = results;\r\n\t\t\t\t\tupdateDesc(results);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// to get the f4 Description field\r\n\t\tf4descriptionGet: function(vId, value, f4type, fnCallback) {\r\n\t\t\tvar that = this;\r\n\t\t\t// var filter;\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: vId,\r\n\t\t\t\tF4Type: f4type,\r\n\t\t\t\tProcess: \"K\"\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tvar oModel = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\toModel.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tthat.f4Cache[vId] = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (fnCallback) {\r\n\t\t\t\t\t\tfnCallback(oData.NavSerchResult.results);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tf4 function logic\r\n\t\t// *-----------------------------------------------------------------------\r\n\r\n\t\t// when plant f4 press\r\n\t\tfnPlantF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tvar vMaterial = this.getView().byId(\"KID_RECI_MATNR\").getValue();\r\n\t\t\tif (vMaterial === \"\") {\r\n\t\t\t\tErrorHandler.showCustomSnackbar(i18n.getText(\"EnterMatError\"), \"Error\");\r\n\t\t\t} else {\r\n\t\t\t\t// var Matnr = this.getView().byId(\"KID_BOM_MATNR\").getValue();\r\n\t\t\t\tvMaterial = isNaN(vMaterial) ? vMaterial : vMaterial.padStart(18, \"0\");\r\n\t\t\t\tthis.fnBindFilterTextF4model(\"P\", \"KID_RECI_WERKS_MAT\", \"K\", vMaterial, oEvent);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// bind the plant filtered data\r\n\t\tfnBindFilterTextF4model: function(SearchHelp, sitem, process, material, oEvent) {\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar vLength;\r\n\t\t\tthis.sitem = sitem;\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp,\r\n\t\t\t\tFieldNam1: \"MATNR\",\r\n\t\t\t\tValue1: material\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tvar serviceCall = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tbusyDialog.open();\r\n\t\t\tserviceCall.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tvar aResults = oData.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\t\tif (oFirst && (oFirst.DomvalueL || oFirst.Ddtext)) {\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\toLabels.col1 = \"Key\";\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1) {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.DomvalueL;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Ddtext;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.DomvalueL3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.DomvalueL4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = sap.ui.getCore().byId(this.sitem + \"_TXT\").getText() + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tthis.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvLength = oData.NavSerchResult.results.length;\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.selectedField === \"KID_RECI_PROFID_STD\") {\r\n\t\t\t\t\t\t\t\taResults\r\n\t\t\t\t\t\t\t\t\t.filter(function(item) {\r\n\t\t\t\t\t\t\t\t\t\treturn item.Value3 === \"C\"; // only keep items where Value3 is \"C\"\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.forEach(function(item) {\r\n\t\t\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col1 === \"Material\") {\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1 ? item.Value1.replace(/^0+/, \"\") : item.Value1;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tthis.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = this.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tthis.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// common f4 press for all fields\r\n\t\tfnF4press: function(oEvent) {\r\n\t\t\tvar id = oEvent.getSource().getId().split(\"--\")[1];\r\n\t\t\tthis.selectedField = id;\r\n\t\t\tthis.bindTextF4model(\"P\", id, \"K\", oEvent);\r\n\t\t},\r\n\r\n\t\t// common f4 bind the data to the JM_F4model\r\n\t\tbindTextF4model: function(SearchHelp, sitem, process, oEvent) {\r\n\t\t\tvar oJsonModel;\r\n\t\t\tvar vTitle;\r\n\t\t\tvar oLabels = {};\r\n\t\t\tvar vLength;\r\n\t\t\tvar aFormattedRows = [];\r\n\t\t\tvar that = this;\r\n\t\t\tvar oPayload = {\r\n\t\t\t\tFieldId: sitem,\r\n\t\t\t\tProcess: process,\r\n\t\t\t\tF4Type: SearchHelp\r\n\t\t\t};\r\n\t\t\toPayload.NavSerchResult = [];\r\n\t\t\tbusyDialog.open();\r\n\t\t\tvar omodel1 = that.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\tomodel1.create(\"/SearchHelpSet\", oPayload, {\r\n\t\t\t\t// filters: filter,\r\n\t\t\t\tsuccess: function(odata, Response) {\r\n\t\t\t\t\tvar aResults = odata.NavSerchResult.results;\r\n\t\t\t\t\tif (aResults.length > 0) {\r\n\t\t\t\t\t\tvar oFirst = aResults[0];\r\n\t\t\t\t\t\tif (oFirst && (oFirst.DomvalueL || oFirst.Ddtext)) {\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvLength = aResults.length;\r\n\t\t\t\t\t\t\toLabels.col1 = \"Key\";\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\tif (oLabels.col1) {\r\n\t\t\t\t\t\t\t\t\trow.col1 = item.DomvalueL;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\trow.col2 = item.Ddtext;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\trow.col3 = item.DomvalueL3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\trow.col4 = item.DomvalueL4;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = sap.ui.getCore().byId(that.sitem + \"_TXT\").getText() + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvLength = odata.NavSerchResult.results.length;\r\n\t\t\t\t\t\t\tif (oFirst.MsgType === \"I\" || oFirst.MsgType === \"E\") {\r\n\t\t\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oFirst.Message, \"Error\", this);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label1) {\r\n\t\t\t\t\t\t\t\toLabels.col1 = oFirst.Label1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label2) {\r\n\t\t\t\t\t\t\t\toLabels.col2 = oFirst.Label2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label3) {\r\n\t\t\t\t\t\t\t\toLabels.col3 = oFirst.Label3;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (oFirst.Label4) {\r\n\t\t\t\t\t\t\t\toLabels.col4 = oFirst.Label4;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (that.selectedField === \"KID_RECI_PROFID_STD\") {\r\n\t\t\t\t\t\t\t\taResults\r\n\t\t\t\t\t\t\t\t\t.filter(function(item) {\r\n\t\t\t\t\t\t\t\t\t\treturn item.Value3 === \"C\"; // only keep items where Value3 is \"C\"\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.forEach(function(item) {\r\n\t\t\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\taResults.forEach(function(item) {\r\n\t\t\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col1 === \"Material\") {\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1 ? item.Value1.replace(/^0+/, \"\") : item.Value1;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\trow.col1 = item.Value1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col2) {\r\n\t\t\t\t\t\t\t\t\t\trow.col2 = item.Value2;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col3) {\r\n\t\t\t\t\t\t\t\t\t\trow.col3 = item.Value3;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oLabels.col4) {\r\n\t\t\t\t\t\t\t\t\t\trow.col4 = item.Value4;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\taFormattedRows.push(row);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\toJsonModel = new sap.ui.model.json.JSONModel({\r\n\t\t\t\t\t\t\t\tlabels: oLabels,\r\n\t\t\t\t\t\t\t\trows: aFormattedRows\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.getView().setModel(oJsonModel, \"JM_F4Model\");\r\n\t\t\t\t\t\t\tthat.getView().getModel(\"JM_F4Model\");\r\n\t\t\t\t\t\t\tvTitle = that.getView().getModel(\"JM_F4Model\").getData().labels.col1 + \" (\" + vLength + \")\";\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t\tthat.fnF4fragopen(oEvent, vTitle).open();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\t// data press from F4 dialog\r\n\t\tfnF4Itempress: function(oEvent) {\r\n\t\t\tvar oItem = oEvent.getSource();\r\n\t\t\tvar oContext = oItem.getBindingContext(\"JM_F4Model\");\r\n\t\t\tif (!oContext) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar item = oContext.getProperty(\"col1\"); // Value (e.g., 'IN')\r\n\t\t\tvar item1 = oContext.getProperty(\"col2\"); // Description (e.g., 'India')\r\n\r\n\t\t\tthis.getView().byId(this.selectedField).setValue(item);\r\n\t\t\tthis.getView().byId(this.selectedField).setValueState(\"None\");\r\n\t\t\tthis.getView().byId(this.selectedField + \"_DES\").setValue(item1);\r\n\t\t\tif (this.selectedField === \"KID_RECI_WERKS\") {\r\n\t\t\t\tthis.fnValidatePlant(this.getView().byId(\"KID_RECI_WERKS\").getValue());\r\n\t\t\t}\r\n\t\t\tthis.fnAfterCloseFragment();\r\n\t\t},\r\n\r\n\t\t// to open the fragment \r\n\t\tfnF4fragopen: function(oEvent, vTitle) {\r\n\t\t\tif (!this.f4HelpFrag) {\r\n\t\t\t\tthis.f4HelpFrag = sap.ui.xmlfragment(this.getView().getId(), \"MANAGED_RECIPE.fragment.F4Help\", this);\r\n\t\t\t\tthis.getView().addDependent(this.f4HelpFrag);\r\n\t\t\t}\r\n\t\t\tthis.f4HelpFrag.setTitle(vTitle);\r\n\t\t\treturn this.f4HelpFrag;\r\n\t\t},\r\n\r\n\t\t// to close the fragment \r\n\t\tfnf4HelpCancel: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\tfnAfterCloseFragment: function(oEvent) {\r\n\t\t\tthis.fnF4fragopen().close();\r\n\t\t\tthis.f4HelpFrag.destroy();\r\n\t\t\tthis.f4HelpFrag = null;\r\n\t\t},\r\n\r\n\t\t// Value hel in the f4 dialog\r\n\t\tfnValueSearch: function(oEvent) {\r\n\t\t\tvar oInput = oEvent.getSource();\r\n\t\t\tvar sValue = oInput.getValue();\r\n\t\t\toInput.setValue(sValue.toUpperCase());\r\n\t\t\tvar sQuery = oEvent.getSource().getValue().toLowerCase();\r\n\t\t\t// Get table and binding\r\n\t\t\tvar oTable = this.byId(\"idMaterialTable\");\r\n\t\t\tvar oBinding = oTable.getBinding(\"items\");\r\n\t\t\tif (!oBinding) return;\r\n\t\t\tvar aFilters = [];\r\n\t\t\t// Filter on all possible columns\r\n\t\t\tif (sQuery) {\r\n\t\t\t\taFilters.push(new sap.ui.model.Filter({\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col1\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col2\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col3\", sap.ui.model.FilterOperator.Contains, sQuery),\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"col4\", sap.ui.model.FilterOperator.Contains, sQuery)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tand: false\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\toBinding.filter(aFilters, \"Application\");\r\n\t\t},\r\n\r\n\t\t// *-----------------------------------------------------------------------\r\n\t\t//\t\t\t\t\tRecipe Duplicate Dialog Open and Close\r\n\t\t// *-----------------------------------------------------------------------\r\n\r\n\t\t// check duplicate recipe in the funtion logic\r\n\t\tfnCheckDuplicate: function() {\r\n\t\t\tvar oKeyDataEntity = this.getOwnerComponent().getModel();\r\n\t\t\tvar KeyDataModel = this.getOwnerComponent().getModel(\"JM_KeyData\").getData();\r\n\r\n\t\t\t// var oGlobalparmData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\tvar cleanedParamData = {};\r\n\t\t\tvar oGlobalparmData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\tObject.keys(oGlobalparmData).forEach(function(key) {\r\n\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\tvar field = this.byId(oGlobalparmData[key]);\r\n\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\r\n\t\t\tvar Parmmodel = cleanedParamData;\r\n\t\t\tParmmodel.AppId = this.Appid;\r\n\t\t\tParmmodel.Matnr = KeyDataModel.Matnr;\r\n\t\t\tParmmodel.Werks = KeyDataModel.Werks;\r\n\t\t\tParmmodel.Ind = \"V\";\r\n\t\t\tParmmodel.Nav_Duplicate = [];\r\n\r\n\t\t\tbusyDialog.open();\r\n\t\t\toKeyDataEntity.create(\"/Recipe_Key_dataSet\", Parmmodel, {\r\n\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\tif (oData.MsgTyp === \"S\") {\r\n\t\t\t\t\t\tvar length = oData.Nav_Duplicate.results.length;\r\n\t\t\t\t\t\tvar aData = {\r\n\t\t\t\t\t\t\tDuplicate: oData.Nav_Duplicate.results,\r\n\t\t\t\t\t\t\tlength: \"(\" + length + \")\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar oModel = new sap.ui.model.json.JSONModel(aData);\r\n\t\t\t\t\t\tthis.getView().setModel(oModel, \"JM_ReciDuplicate\");\r\n\t\t\t\t\t\tif (length === 0) {\r\n\t\t\t\t\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.fnReciDuplicate();\r\n\t\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"Error\");\r\n\t\t\t\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueStateText(oData.MsgLine);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(oData.MsgLine, \"Error\", this);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// to open recipe duplicate fragment\r\n\t\tfnReciDuplicate: function() {\r\n\t\t\tif (!this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog = sap.ui.xmlfragment(this.getView().getId(),\r\n\t\t\t\t\t\"MANAGED_RECIPE.Fragment.reci_duplicate\", // Fragment name\r\n\t\t\t\t\tthis // Pass controller instance\r\n\t\t\t\t);\r\n\t\t\t\tthis.getView().addDependent(this.duplicateDialog);\r\n\t\t\t}\r\n\t\t\tthis.getView().byId(\"id_dupSubmit\").setVisible(true);\r\n\t\t\tthis.duplicateDialog.open();\r\n\t\t},\r\n\r\n\t\t// to close the recipe duplicate fragment\r\n\t\tfncloseDialog: function() {\r\n\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// to clear all the field in the keydata\r\n\t\tfnClearallFields: function() {\r\n\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_MATNR_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_MATNR\").setValueState(\"None\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_WERKS_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_WERKS\").setValueState(\"None\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD_DES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_PROFID_STD\").setValueState(\"None\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValue(\"\");\r\n\t\t\tthis.getView().byId(\"KID_RECI_RECIDES\").setValueState(\"None\");\r\n\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\toWfparm.setData({}); // replaces the data\r\n\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\toWfparm = this.getOwnerComponent().getModel(\"JM_KeyData\");\r\n\t\t\toWfparm.setData({}); // replaces the data\r\n\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t},\r\n\r\n\t\t// after close duplicate fragment navigate to the initiator\r\n\t\tfnNavInitiator: function() {\r\n\t\t\tif (this.duplicateDialog) {\r\n\t\t\t\tthis.duplicateDialog.close();\r\n\t\t\t\tthis.duplicateDialog.destroy();\r\n\t\t\t\tthis.duplicateDialog = null;\r\n\t\t\t}\r\n\r\n\t\t\tvar cleanedParamData = {};\r\n\t\t\tvar oGlobalparmData = this.getOwnerComponent().getModel(\"JM_WfParm\").getData();\r\n\t\t\tObject.keys(oGlobalparmData).forEach(function(key) {\r\n\t\t\t\tif (key.endsWith(\"Id\")) {\r\n\t\t\t\t\tvar newKey = key.slice(0, -2);\r\n\t\t\t\t\tvar field = this.byId(oGlobalparmData[key]);\r\n\t\t\t\t\tvar fieldValue = \"\";\r\n\t\t\t\t\tif (field && field.getValue) {\r\n\t\t\t\t\t\tfieldValue = field.getValue();\r\n\t\t\t\t\t\tcleanedParamData[newKey] = fieldValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\toWfparm.setData(cleanedParamData); // replaces the data\r\n\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_initiator\");\r\n\t\t},\r\n\r\n\t\t// when cancel press function logics\r\n\t\tfnCancel: function() {\r\n\t\t\tthis.fnClearallFields();\r\n\t\t\tsap.ui.core.UIComponent.getRouterFor(this).navTo(\"reci_search\");\r\n\t\t},\r\n\r\n\t\t// to set the parm value in the JM_Wfparm model\r\n\t\tfnSetParmdata: function(appid) {\r\n\t\t\treturn new Promise(function(Resolve, Reject) {\r\n\t\t\t\tvar oWFParmSet = this.getOwnerComponent().getModel(\"JMConfig\");\r\n\t\t\t\tbusyDialog.open();\r\n\t\t\t\toWFParmSet.read(\"/WFParmSet\", {\r\n\t\t\t\t\tfilters: [\r\n\t\t\t\t\t\tnew sap.ui.model.Filter(\"AppId\", sap.ui.model.FilterOperator.EQ, appid)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tsuccess: function(oData) {\r\n\t\t\t\t\t\tvar oEntry = oData.results[0];\r\n\t\t\t\t\t\tvar oMatchedParams = {};\r\n\t\t\t\t\t\tvar aInvalidParams = [];\r\n\t\t\t\t\t\t// Getting the workflow parameter\r\n\t\t\t\t\t\tObject.keys(oEntry).forEach(function(sKey) {\r\n\t\t\t\t\t\t\tif (/^WfParm\\d+Id$/.test(sKey)) {\r\n\t\t\t\t\t\t\t\tvar sVal = oEntry[sKey];\r\n\t\t\t\t\t\t\t\tif (sVal && sVal.trim() !== \"\") {\r\n\t\t\t\t\t\t\t\t\toMatchedParams[sKey] = sVal.trim();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// oMatchedParams.AppId = oEntry.AppId;\r\n\r\n\t\t\t\t\t\t// bind the model for the next view\r\n\t\t\t\t\t\tvar oWfparm = this.getOwnerComponent().getModel(\"JM_WfParm\");\r\n\t\t\t\t\t\toWfparm.setData(oMatchedParams); // replaces the data\r\n\t\t\t\t\t\toWfparm.refresh(true); // updates the bindings\r\n\t\t\t\t\t\tResolve(true);\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\terror: function(oResponse) {\r\n\t\t\t\t\t\tbusyDialog.close();\r\n\t\t\t\t\t\tvar sMessage = ErrorHandler.parseODataError(oResponse);\r\n\t\t\t\t\t\tErrorHandler.showCustomSnackbar(sMessage, \"Error\", this);\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t});\r\n\t\t\t}.bind(this));\r\n\r\n\t\t},\r\n\t\t// fnMobileViewChanges: function() {\r\n\t\t// \tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", false);\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_roadmap\");\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_roadmapSS\");\r\n\t\t// \tthis.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t// \tthis.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t// },\r\n\t\t// fnTabDesktopViewChanges: function() {\r\n\t\t// \tthis.getView().getModel(\"RoadMapUI\").setProperty(\"/labelVisible\", true);\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").removeStyleClass(\"cl_roadmapSS\");\r\n\t\t// \tthis.getView().byId(\"id_roadmap\").addStyleClass(\"cl_roadmap\");\r\n\t\t// \tthis.getView().byId(\"id_roadmapHighlighter\").removeStyleClass(\"cl_Highlightborder_roadMapSS\");\r\n\t\t// \tthis.getView().byId(\"id_roadmapHighlighter\").addStyleClass(\"cl_Highlightborder_roadMap\");\r\n\t\t// },\r\n\t\t// _onResize: function() {\r\n\t\t// \tvar oRange = sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD);\r\n\r\n\t\t// \tif (oRange.name === \"Phone\") {\r\n\t\t// \t\tthis.fnMobileViewChanges();\r\n\t\t// \t} else {\r\n\t\t// \t\tthis.fnTabDesktopViewChanges();\r\n\t\t// \t}\r\n\t\t// }\r\n\t});\r\n});",
		"MANAGED_RECIPE/controller/App.controller.js": "sap.ui.define([\n\t\"sap/ui/core/mvc/Controller\"\n], function(Controller) {\n\t\"use strict\";\n\n\treturn Controller.extend(\"MANAGED_RECIPE.controller.App\", {\n\n\t});\n});",
		"MANAGED_RECIPE/thirdparty/jszip.min.js": "/*!\n\nJSZip v3.10.1 - A JavaScript class for generating and reading zip files\n<http://stuartk.com/jszip>\n\n(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>\nDual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.\n\nJSZip uses the library pako released under the MIT license :\nhttps://github.com/nodeca/pako/blob/main/LICENSE\n*/\n\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{(\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this).JSZip=e()}}(function(){return function s(a,o,h){function u(r,e){if(!o[r]){if(!a[r]){var t=\"function\"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error(\"Cannot find module '\"+r+\"'\");throw n.code=\"MODULE_NOT_FOUND\",n}var i=o[r]={exports:{}};a[r][0].call(i.exports,function(e){var t=a[r][1][e];return u(t||e)},i,i.exports,s,a,o,h)}return o[r].exports}for(var l=\"function\"==typeof require&&require,e=0;e<h.length;e++)u(h[e]);return u}({1:[function(e,t,r){\"use strict\";var d=e(\"./utils\"),c=e(\"./support\"),p=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";r.encode=function(e){for(var t,r,n,i,s,a,o,h=[],u=0,l=e.length,f=l,c=\"string\"!==d.getTypeOf(e);u<e.length;)f=l-u,n=c?(t=e[u++],r=u<l?e[u++]:0,u<l?e[u++]:0):(t=e.charCodeAt(u++),r=u<l?e.charCodeAt(u++):0,u<l?e.charCodeAt(u++):0),i=t>>2,s=(3&t)<<4|r>>4,a=1<f?(15&r)<<2|n>>6:64,o=2<f?63&n:64,h.push(p.charAt(i)+p.charAt(s)+p.charAt(a)+p.charAt(o));return h.join(\"\")},r.decode=function(e){var t,r,n,i,s,a,o=0,h=0,u=\"data:\";if(e.substr(0,u.length)===u)throw new Error(\"Invalid base64 input, it looks like a data url.\");var l,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,\"\")).length/4;if(e.charAt(e.length-1)===p.charAt(64)&&f--,e.charAt(e.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error(\"Invalid base64 input, bad content length.\");for(l=c.uint8array?new Uint8Array(0|f):new Array(0|f);o<e.length;)t=p.indexOf(e.charAt(o++))<<2|(i=p.indexOf(e.charAt(o++)))>>4,r=(15&i)<<4|(s=p.indexOf(e.charAt(o++)))>>2,n=(3&s)<<6|(a=p.indexOf(e.charAt(o++))),l[h++]=t,64!==s&&(l[h++]=r),64!==a&&(l[h++]=n);return l}},{\"./support\":30,\"./utils\":32}],2:[function(e,t,r){\"use strict\";var n=e(\"./external\"),i=e(\"./stream/DataWorker\"),s=e(\"./stream/Crc32Probe\"),a=e(\"./stream/DataLengthProbe\");function o(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}o.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a(\"data_length\")),t=this;return e.on(\"end\",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error(\"Bug : uncompressed data size mismatch\")}),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo(\"compressedSize\",this.compressedSize).withStreamInfo(\"uncompressedSize\",this.uncompressedSize).withStreamInfo(\"crc32\",this.crc32).withStreamInfo(\"compression\",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new a(\"uncompressedSize\")).pipe(t.compressWorker(r)).pipe(new a(\"compressedSize\")).withStreamInfo(\"compression\",t)},t.exports=o},{\"./external\":6,\"./stream/Crc32Probe\":25,\"./stream/DataLengthProbe\":26,\"./stream/DataWorker\":27}],3:[function(e,t,r){\"use strict\";var n=e(\"./stream/GenericWorker\");r.STORE={magic:\"\\0\\0\",compressWorker:function(){return new n(\"STORE compression\")},uncompressWorker:function(){return new n(\"STORE decompression\")}},r.DEFLATE=e(\"./flate\")},{\"./flate\":7,\"./stream/GenericWorker\":28}],4:[function(e,t,r){\"use strict\";var n=e(\"./utils\");var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?\"string\"!==n.getTypeOf(e)?function(e,t,r,n){var i=o,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}(0|t,e,e.length,0):function(e,t,r,n){var i=o,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^i[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length,0):0}},{\"./utils\":32}],5:[function(e,t,r){\"use strict\";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){\"use strict\";var n=null;n=\"undefined\"!=typeof Promise?Promise:e(\"lie\"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){\"use strict\";var n=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Uint32Array,i=e(\"pako\"),s=e(\"./utils\"),a=e(\"./stream/GenericWorker\"),o=n?\"uint8array\":\"array\";function h(e,t){a.call(this,\"FlateWorker/\"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic=\"\\b\\0\",s.inherits(h,a),h.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(e){return new h(\"Deflate\",e)},r.uncompressWorker=function(){return new h(\"Inflate\",{})}},{\"./stream/GenericWorker\":28,\"./utils\":32,pako:38}],8:[function(e,t,r){\"use strict\";function A(e,t){var r,n=\"\";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function n(e,t,r,n,i,s){var a,o,h=e.file,u=e.compression,l=s!==O.utf8encode,f=I.transformTo(\"string\",s(h.name)),c=I.transformTo(\"string\",O.utf8encode(h.name)),d=h.comment,p=I.transformTo(\"string\",s(d)),m=I.transformTo(\"string\",O.utf8encode(d)),_=c.length!==h.name.length,g=m.length!==d.length,b=\"\",v=\"\",y=\"\",w=h.dir,k=h.date,x={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(x.crc32=e.crc32,x.compressedSize=e.compressedSize,x.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),l||!_&&!g||(S|=2048);var z=0,C=0;w&&(z|=16),\"UNIX\"===i?(C=798,z|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(h.unixPermissions,w)):(C=20,z|=function(e){return 63&(e||0)}(h.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),_&&(v=A(1,1)+A(B(f),4)+c,b+=\"up\"+A(v.length,2)+v),g&&(y=A(1,1)+A(B(p),4)+m,b+=\"uc\"+A(y.length,2)+y);var E=\"\";return E+=\"\\n\\0\",E+=A(S,2),E+=u.magic,E+=A(a,2),E+=A(o,2),E+=A(x.crc32,4),E+=A(x.compressedSize,4),E+=A(x.uncompressedSize,4),E+=A(f.length,2),E+=A(b.length,2),{fileRecord:R.LOCAL_FILE_HEADER+E+f+b,dirRecord:R.CENTRAL_FILE_HEADER+A(C,2)+E+A(p.length,2)+\"\\0\\0\\0\\0\"+A(z,4)+A(n,4)+f+b+p}}var I=e(\"../utils\"),i=e(\"../stream/GenericWorker\"),O=e(\"../utf8\"),B=e(\"../crc32\"),R=e(\"../signature\");function s(e,t,r,n){i.call(this,\"ZipFileWorker\"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}I.inherits(s,i),s.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},s.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=n(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return R.DATA_DESCRIPTOR+A(e.crc32,4)+A(e.compressedSize,4)+A(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,i){var s=I.transformTo(\"string\",i(n));return R.CENTRAL_DIRECTORY_END+\"\\0\\0\\0\\0\"+A(e,2)+A(e,2)+A(t,4)+A(r,4)+A(s.length,2)+s}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on(\"data\",function(e){t.processChunk(e)}),e.on(\"end\",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on(\"error\",function(e){t.error(e)}),this},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},s.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=s},{\"../crc32\":4,\"../signature\":23,\"../stream/GenericWorker\":28,\"../utf8\":31,\"../utils\":32}],9:[function(e,t,r){\"use strict\";var u=e(\"../compressions\"),n=e(\"./ZipFileWorker\");r.generateWorker=function(e,a,t){var o=new n(a.streamFiles,t,a.platform,a.encodeFileName),h=0;try{e.forEach(function(e,t){h++;var r=function(e,t){var r=e||t,n=u[r];if(!n)throw new Error(r+\" is not a valid compression method !\");return n}(t.options.compression,a.compression),n=t.options.compressionOptions||a.compressionOptions||{},i=t.dir,s=t.date;t._compressWorker(r,n).withStreamInfo(\"file\",{name:e,dir:i,date:s,comment:t.comment||\"\",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(o)}),o.entriesCount=h}catch(e){o.error(e)}return o}},{\"../compressions\":3,\"./ZipFileWorker\":8}],10:[function(e,t,r){\"use strict\";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error(\"The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.\");this.files=Object.create(null),this.comment=null,this.root=\"\",this.clone=function(){var e=new n;for(var t in this)\"function\"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e(\"./object\")).loadAsync=e(\"./load\"),n.support=e(\"./support\"),n.defaults=e(\"./defaults\"),n.version=\"3.10.1\",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e(\"./external\"),t.exports=n},{\"./defaults\":5,\"./external\":6,\"./load\":11,\"./object\":15,\"./support\":30}],11:[function(e,t,r){\"use strict\";var u=e(\"./utils\"),i=e(\"./external\"),n=e(\"./utf8\"),s=e(\"./zipEntries\"),a=e(\"./stream/Crc32Probe\"),l=e(\"./nodejsUtils\");function f(n){return new i.Promise(function(e,t){var r=n.decompressed.getContentWorker().pipe(new a);r.on(\"error\",function(e){t(e)}).on(\"end\",function(){r.streamInfo.crc32!==n.decompressed.crc32?t(new Error(\"Corrupted zip : CRC32 mismatch\")):e()}).resume()})}t.exports=function(e,o){var h=this;return o=u.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error(\"JSZip can't accept a stream when loading a zip file.\")):u.prepareContent(\"the loaded zip file\",e,!0,o.optimizedBinaryString,o.base64).then(function(e){var t=new s(o);return t.load(e),t}).then(function(e){var t=[i.Promise.resolve(e)],r=e.files;if(o.checkCRC32)for(var n=0;n<r.length;n++)t.push(f(r[n]));return i.Promise.all(t)}).then(function(e){for(var t=e.shift(),r=t.files,n=0;n<r.length;n++){var i=r[n],s=i.fileNameStr,a=u.resolve(i.fileNameStr);h.file(a,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileCommentStr.length?i.fileCommentStr:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:o.createFolders}),i.dir||(h.file(a).unsafeOriginalName=s)}return t.zipComment.length&&(h.comment=t.zipComment),h})}},{\"./external\":6,\"./nodejsUtils\":14,\"./stream/Crc32Probe\":25,\"./utf8\":31,\"./utils\":32,\"./zipEntries\":33}],12:[function(e,t,r){\"use strict\";var n=e(\"../utils\"),i=e(\"../stream/GenericWorker\");function s(e,t){i.call(this,\"Nodejs stream input adapter for \"+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(s,i),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on(\"data\",function(e){t.push({data:e,meta:{percent:0}})}).on(\"error\",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on(\"end\",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{\"../stream/GenericWorker\":28,\"../utils\":32}],13:[function(e,t,r){\"use strict\";var i=e(\"readable-stream\").Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on(\"data\",function(e,t){n.push(e)||n._helper.pause(),r&&r(t)}).on(\"error\",function(e){n.emit(\"error\",e)}).on(\"end\",function(){n.push(null)})}e(\"../utils\").inherits(n,i),n.prototype._read=function(){this._helper.resume()},t.exports=n},{\"../utils\":32,\"readable-stream\":16}],14:[function(e,t,r){\"use strict\";t.exports={isNode:\"undefined\"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if(\"number\"==typeof e)throw new Error('The \"data\" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&\"function\"==typeof e.on&&\"function\"==typeof e.pause&&\"function\"==typeof e.resume}}},{}],15:[function(e,t,r){\"use strict\";function s(e,t,r){var n,i=u.getTypeOf(t),s=u.extend(r||{},f);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),\"string\"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(n=_(e))&&b.call(this,n,!0);var a=\"string\"===i&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!a),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t=\"\",s.compression=\"STORE\",i=\"string\");var o=null;o=t instanceof c||t instanceof l?t:p.isNode&&p.isStream(t)?new m(e,t):u.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var h=new d(e,o,s);this.files[e]=h}var i=e(\"./utf8\"),u=e(\"./utils\"),l=e(\"./stream/GenericWorker\"),a=e(\"./stream/StreamHelper\"),f=e(\"./defaults\"),c=e(\"./compressedObject\"),d=e(\"./zipObject\"),o=e(\"./generate\"),p=e(\"./nodejsUtils\"),m=e(\"./nodejs/NodejsStreamInputAdapter\"),_=function(e){\"/\"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf(\"/\");return 0<t?e.substring(0,t):\"\"},g=function(e){return\"/\"!==e.slice(-1)&&(e+=\"/\"),e},b=function(e,t){return t=void 0!==t?t:f.createFolders,e=g(e),this.files[e]||s.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function h(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)}var n={load:function(){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(r){var n=[];return this.forEach(function(e,t){r(e,t)&&n.push(t)}),n},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,s.call(this,e,t,r),this;if(h(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(r){if(!r)return this;if(h(r))return this.filter(function(e,t){return t.dir&&r.test(e)});var e=this.root+r,t=b.call(this,e),n=this.clone();return n.root=t.name,n},remove:function(r){r=this.root+r;var e=this.files[r];if(e||(\"/\"!==r.slice(-1)&&(r+=\"/\"),e=this.files[r]),e&&!e.dir)delete this.files[r];else for(var t=this.filter(function(e,t){return t.name.slice(0,r.length)===r}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},generateInternalStream:function(e){var t,r={};try{if((r=u.extend(e||{},{streamFiles:!1,compression:\"STORE\",compressionOptions:null,type:\"\",platform:\"DOS\",comment:null,mimeType:\"application/zip\",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),\"binarystring\"===r.type&&(r.type=\"string\"),!r.type)throw new Error(\"No output type specified.\");u.checkSupport(r.type),\"darwin\"!==r.platform&&\"freebsd\"!==r.platform&&\"linux\"!==r.platform&&\"sunos\"!==r.platform||(r.platform=\"UNIX\"),\"win32\"===r.platform&&(r.platform=\"DOS\");var n=r.comment||this.comment||\"\";t=o.generateWorker(this,r,n)}catch(e){(t=new l(\"error\")).error(e)}return new a(t,r.type||\"string\",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type=\"nodebuffer\"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=n},{\"./compressedObject\":2,\"./defaults\":5,\"./generate\":9,\"./nodejs/NodejsStreamInputAdapter\":12,\"./nodejsUtils\":14,\"./stream/GenericWorker\":28,\"./stream/StreamHelper\":29,\"./utf8\":31,\"./utils\":32,\"./zipObject\":35}],16:[function(e,t,r){\"use strict\";t.exports=e(\"stream\")},{stream:void 0}],17:[function(e,t,r){\"use strict\";var n=e(\"./DataReader\");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e(\"../utils\").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&n===s[2]&&i===s[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{\"../utils\":32,\"./DataReader\":18}],18:[function(e,t,r){\"use strict\";var n=e(\"../utils\");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error(\"End of data reached (data length = \"+this.length+\", asked index = \"+e+\"). Corrupted zip ?\")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo(\"string\",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{\"../utils\":32}],19:[function(e,t,r){\"use strict\";var n=e(\"./Uint8ArrayReader\");function i(e){n.call(this,e)}e(\"../utils\").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{\"../utils\":32,\"./Uint8ArrayReader\":21}],20:[function(e,t,r){\"use strict\";var n=e(\"./DataReader\");function i(e){n.call(this,e)}e(\"../utils\").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{\"../utils\":32,\"./DataReader\":18}],21:[function(e,t,r){\"use strict\";var n=e(\"./ArrayReader\");function i(e){n.call(this,e)}e(\"../utils\").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{\"../utils\":32,\"./ArrayReader\":17}],22:[function(e,t,r){\"use strict\";var n=e(\"../utils\"),i=e(\"../support\"),s=e(\"./ArrayReader\"),a=e(\"./StringReader\"),o=e(\"./NodeBufferReader\"),h=e(\"./Uint8ArrayReader\");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),\"string\"!==t||i.uint8array?\"nodebuffer\"===t?new o(e):i.uint8array?new h(n.transformTo(\"uint8array\",e)):new s(n.transformTo(\"array\",e)):new a(e)}},{\"../support\":30,\"../utils\":32,\"./ArrayReader\":17,\"./NodeBufferReader\":19,\"./StringReader\":20,\"./Uint8ArrayReader\":21}],23:[function(e,t,r){\"use strict\";r.LOCAL_FILE_HEADER=\"PK\u0003\u0004\",r.CENTRAL_FILE_HEADER=\"PK\u0001\u0002\",r.CENTRAL_DIRECTORY_END=\"PK\u0005\u0006\",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR=\"PK\u0006\u0007\",r.ZIP64_CENTRAL_DIRECTORY_END=\"PK\u0006\u0006\",r.DATA_DESCRIPTOR=\"PK\u0007\\b\"},{}],24:[function(e,t,r){\"use strict\";var n=e(\"./GenericWorker\"),i=e(\"../utils\");function s(e){n.call(this,\"ConvertWorker to \"+e),this.destType=e}i.inherits(s,n),s.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{\"../utils\":32,\"./GenericWorker\":28}],25:[function(e,t,r){\"use strict\";var n=e(\"./GenericWorker\"),i=e(\"../crc32\");function s(){n.call(this,\"Crc32Probe\"),this.withStreamInfo(\"crc32\",0)}e(\"../utils\").inherits(s,n),s.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{\"../crc32\":4,\"../utils\":32,\"./GenericWorker\":28}],26:[function(e,t,r){\"use strict\";var n=e(\"../utils\"),i=e(\"./GenericWorker\");function s(e){i.call(this,\"DataLengthProbe for \"+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(s,i),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=s},{\"../utils\":32,\"./GenericWorker\":28}],27:[function(e,t,r){\"use strict\";var n=e(\"../utils\"),i=e(\"./GenericWorker\");function s(e){i.call(this,\"DataWorker\");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type=\"\",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}n.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case\"string\":e=this.data.substring(this.index,t);break;case\"uint8array\":e=this.data.subarray(this.index,t);break;case\"array\":case\"nodebuffer\":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{\"../utils\":32,\"./GenericWorker\":28}],28:[function(e,t,r){\"use strict\";function n(e){this.name=e||\"default\",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit(\"data\",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit(\"end\"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit(\"error\",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit(\"error\",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error(\"The stream '\"+this+\"' has already been used.\");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on(\"data\",function(e){t.processChunk(e)}),e.on(\"end\",function(){t.end()}),e.on(\"error\",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error(\"The stream '\"+this+\"' has already been used.\");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e=\"Worker \"+this.name;return this.previous?this.previous+\" -> \"+e:e}},t.exports=n},{}],29:[function(e,t,r){\"use strict\";var h=e(\"../utils\"),i=e(\"./ConvertWorker\"),s=e(\"./GenericWorker\"),u=e(\"../base64\"),n=e(\"../support\"),a=e(\"../external\"),o=null;if(n.nodestream)try{o=e(\"../nodejs/NodejsStreamOutputAdapter\")}catch(e){}function l(e,o){return new a.Promise(function(t,r){var n=[],i=e._internalType,s=e._outputType,a=e._mimeType;e.on(\"data\",function(e,t){n.push(e),o&&o(t)}).on(\"error\",function(e){n=[],r(e)}).on(\"end\",function(){try{var e=function(e,t,r){switch(e){case\"blob\":return h.newBlob(h.transformTo(\"arraybuffer\",t),r);case\"base64\":return u.encode(t);default:return h.transformTo(e,t)}}(s,function(e,t){var r,n=0,i=null,s=0;for(r=0;r<t.length;r++)s+=t[r].length;switch(e){case\"string\":return t.join(\"\");case\"array\":return Array.prototype.concat.apply([],t);case\"uint8array\":for(i=new Uint8Array(s),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case\"nodebuffer\":return Buffer.concat(t);default:throw new Error(\"concat : unsupported type '\"+e+\"'\")}}(i,n),a);t(e)}catch(e){r(e)}n=[]}).resume()})}function f(e,t,r){var n=t;switch(t){case\"blob\":case\"arraybuffer\":n=\"uint8array\";break;case\"base64\":n=\"string\"}try{this._internalType=n,this._outputType=t,this._mimeType=r,h.checkSupport(n),this._worker=e.pipe(new i(n)),e.lock()}catch(e){this._worker=new s(\"error\"),this._worker.error(e)}}f.prototype={accumulate:function(e){return l(this,e)},on:function(e,t){var r=this;return\"data\"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){h.delay(t,arguments,r)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(h.checkSupport(\"nodestream\"),\"nodebuffer\"!==this._outputType)throw new Error(this._outputType+\" is not supported by this method\");return new o(this,{objectMode:\"nodebuffer\"!==this._outputType},e)}},t.exports=f},{\"../base64\":1,\"../external\":6,\"../nodejs/NodejsStreamOutputAdapter\":13,\"../support\":30,\"../utils\":32,\"./ConvertWorker\":24,\"./GenericWorker\":28}],30:[function(e,t,r){\"use strict\";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=\"undefined\"!=typeof ArrayBuffer&&\"undefined\"!=typeof Uint8Array,r.nodebuffer=\"undefined\"!=typeof Buffer,r.uint8array=\"undefined\"!=typeof Uint8Array,\"undefined\"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:\"application/zip\"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob(\"application/zip\").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e(\"readable-stream\").Readable}catch(e){r.nodestream=!1}},{\"readable-stream\":16}],31:[function(e,t,s){\"use strict\";for(var o=e(\"./utils\"),h=e(\"./support\"),r=e(\"./nodejsUtils\"),n=e(\"./stream/GenericWorker\"),u=new Array(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;u[254]=u[254]=1;function a(){n.call(this,\"utf-8 decode\"),this.leftOver=null}function l(){n.call(this,\"utf-8 encode\")}s.utf8encode=function(e){return h.nodebuffer?r.newBufferFrom(e,\"utf-8\"):function(e){var t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=h.uint8array?new Uint8Array(o):new Array(o),i=s=0;s<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t}(e)},s.utf8decode=function(e){return h.nodebuffer?o.transformTo(\"nodebuffer\",e).toString(\"utf-8\"):function(e){var t,r,n,i,s=e.length,a=new Array(2*s);for(t=r=0;t<s;)if((n=e[t++])<128)a[r++]=n;else if(4<(i=u[n]))a[r++]=65533,t+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&t<s;)n=n<<6|63&e[t++],i--;1<i?a[r++]=65533:n<65536?a[r++]=n:(n-=65536,a[r++]=55296|n>>10&1023,a[r++]=56320|1023&n)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),o.applyFromCharCode(a)}(e=o.transformTo(h.uint8array?\"uint8array\":\"array\",e))},o.inherits(a,n),a.prototype.processChunk=function(e){var t=o.transformTo(h.uint8array?\"uint8array\":\"array\",e.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var n=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+u[e[r]]>t?r:t}(t),i=t;n!==t.length&&(h.uint8array?(i=t.subarray(0,n),this.leftOver=t.subarray(n,t.length)):(i=t.slice(0,n),this.leftOver=t.slice(n,t.length))),this.push({data:s.utf8decode(i),meta:e.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=a,o.inherits(l,n),l.prototype.processChunk=function(e){this.push({data:s.utf8encode(e.data),meta:e.meta})},s.Utf8EncodeWorker=l},{\"./nodejsUtils\":14,\"./stream/GenericWorker\":28,\"./support\":30,\"./utils\":32}],32:[function(e,t,a){\"use strict\";var o=e(\"./support\"),h=e(\"./base64\"),r=e(\"./nodejsUtils\"),u=e(\"./external\");function n(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e(\"setimmediate\"),a.newBlob=function(t,r){a.checkSupport(\"blob\");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error(\"Bug : can't construct the Blob.\")}}};var i={stringifyByChunk:function(e,t,r){var n=[],i=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;i<s;)\"array\"===t||\"nodebuffer\"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,s)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,s)))),i+=r;return n.join(\"\")},stringifyByChar:function(e){for(var t=\"\",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function s(e){var t=65536,r=a.getTypeOf(e),n=!0;if(\"uint8array\"===r?n=i.applyCanBeUsed.uint8array:\"nodebuffer\"===r&&(n=i.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return i.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return i.stringifyByChar(e)}function f(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}a.applyFromCharCode=s;var c={};c.string={string:n,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,r.allocBuffer(e.length))}},c.array={string:s,array:n,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},c.arraybuffer={string:function(e){return s(new Uint8Array(e))},array:function(e){return f(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:n,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},c.uint8array={string:s,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:n,nodebuffer:function(e){return r.newBufferFrom(e)}},c.nodebuffer={string:s,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:n},a.transformTo=function(e,t){if(t=t||\"\",!e)return t;a.checkSupport(e);var r=a.getTypeOf(t);return c[r][e](t)},a.resolve=function(e){for(var t=e.split(\"/\"),r=[],n=0;n<t.length;n++){var i=t[n];\".\"===i||\"\"===i&&0!==n&&n!==t.length-1||(\"..\"===i?r.pop():r.push(i))}return r.join(\"/\")},a.getTypeOf=function(e){return\"string\"==typeof e?\"string\":\"[object Array]\"===Object.prototype.toString.call(e)?\"array\":o.nodebuffer&&r.isBuffer(e)?\"nodebuffer\":o.uint8array&&e instanceof Uint8Array?\"uint8array\":o.arraybuffer&&e instanceof ArrayBuffer?\"arraybuffer\":void 0},a.checkSupport=function(e){if(!o[e.toLowerCase()])throw new Error(e+\" is not supported by this platform\")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(e){var t,r,n=\"\";for(r=0;r<(e||\"\").length;r++)n+=\"\\\\x\"+((t=e.charCodeAt(r))<16?\"0\":\"\")+t.toString(16).toUpperCase();return n},a.delay=function(e,t,r){setImmediate(function(){e.apply(r||null,t||[])})},a.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},a.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},a.prepareContent=function(r,e,n,i,s){return u.Promise.resolve(e).then(function(n){return o.blob&&(n instanceof Blob||-1!==[\"[object File]\",\"[object Blob]\"].indexOf(Object.prototype.toString.call(n)))&&\"undefined\"!=typeof FileReader?new u.Promise(function(t,r){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)},e.readAsArrayBuffer(n)}):n}).then(function(e){var t=a.getTypeOf(e);return t?(\"arraybuffer\"===t?e=a.transformTo(\"uint8array\",e):\"string\"===t&&(s?e=h.decode(e):n&&!0!==i&&(e=function(e){return l(e,o.uint8array?new Uint8Array(e.length):new Array(e.length))}(e))),e):u.Promise.reject(new Error(\"Can't read the data of '\"+r+\"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?\"))})}},{\"./base64\":1,\"./external\":6,\"./nodejsUtils\":14,\"./support\":30,setimmediate:54}],33:[function(e,t,r){\"use strict\";var n=e(\"./reader/readerFor\"),i=e(\"./utils\"),s=e(\"./signature\"),a=e(\"./zipEntry\"),o=e(\"./support\");function h(e){this.files=[],this.loadOptions=e}h.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error(\"Corrupted zip or bug: unexpected signature (\"+i.pretty(t)+\", expected \"+i.pretty(e)+\")\")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?\"uint8array\":\"array\",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error(\"Multi-volumes zip are not supported\")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error(\"Corrupted zip or bug: expected \"+this.centralDirRecords+\" records in central dir, got \"+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error(\"Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html\"):new Error(\"Corrupted zip: can't find end of central directory\");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error(\"Corrupted zip: can't find the ZIP64 end of central directory locator\");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error(\"Corrupted zip: can't find the ZIP64 end of central directory\");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error(\"Corrupted zip: missing \"+Math.abs(n)+\" bytes.\")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=h},{\"./reader/readerFor\":22,\"./signature\":23,\"./support\":30,\"./utils\":32,\"./zipEntry\":34}],34:[function(e,t,r){\"use strict\";var n=e(\"./reader/readerFor\"),s=e(\"./utils\"),i=e(\"./compressedObject\"),a=e(\"./crc32\"),o=e(\"./utf8\"),h=e(\"./compressions\"),u=e(\"./support\");function l(e,t){this.options=e,this.loadOptions=t}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error(\"Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)\");if(null===(t=function(e){for(var t in h)if(Object.prototype.hasOwnProperty.call(h,t)&&h[t].magic===e)return h[t];return null}(this.compressionMethod)))throw new Error(\"Corrupted zip : compression \"+s.pretty(this.compressionMethod)+\" unknown (inner file : \"+s.transformTo(\"string\",this.fileName)+\")\");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error(\"Encrypted zip are not supported\");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||\"/\"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?\"uint8array\":\"array\";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)?null:a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)?null:a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=l},{\"./compressedObject\":2,\"./compressions\":3,\"./crc32\":4,\"./reader/readerFor\":22,\"./support\":30,\"./utf8\":31,\"./utils\":32}],35:[function(e,t,r){\"use strict\";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var s=e(\"./stream/StreamHelper\"),i=e(\"./stream/DataWorker\"),a=e(\"./utf8\"),o=e(\"./compressedObject\"),h=e(\"./stream/GenericWorker\");n.prototype={internalStream:function(e){var t=null,r=\"string\";try{if(!e)throw new Error(\"No output type specified.\");var n=\"string\"===(r=e.toLowerCase())||\"text\"===r;\"binarystring\"!==r&&\"text\"!==r||(r=\"string\"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new a.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new h(\"error\")).error(e)}return new s(t,r,\"\")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||\"nodebuffer\").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof h?this._data:new i(this._data)}};for(var u=[\"asText\",\"asBinary\",\"asNodeBuffer\",\"asUint8Array\",\"asArrayBuffer\"],l=function(){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},f=0;f<u.length;f++)n.prototype[u[f]]=l;t.exports=n},{\"./compressedObject\":2,\"./stream/DataWorker\":27,\"./stream/GenericWorker\":28,\"./stream/StreamHelper\":29,\"./utf8\":31}],36:[function(e,l,t){(function(t){\"use strict\";var r,n,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,s=new e(u),a=t.document.createTextNode(\"\");s.observe(a,{characterData:!0}),r=function(){a.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)r=\"document\"in t&&\"onreadystatechange\"in t.document.createElement(\"script\")?function(){var e=t.document.createElement(\"script\");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var o=new t.MessageChannel;o.port1.onmessage=u,r=function(){o.port2.postMessage(0)}}var h=[];function u(){var e,t;n=!0;for(var r=h.length;r;){for(t=h,h=[],e=-1;++e<r;)t[e]();r=h.length}n=!1}l.exports=function(e){1!==h.push(e)||n||r()}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],37:[function(e,t,r){\"use strict\";var i=e(\"immediate\");function u(){}var l={},s=[\"REJECTED\"],a=[\"FULFILLED\"],n=[\"PENDING\"];function o(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function\");this.state=n,this.queue=[],this.outcome=void 0,e!==u&&d(this,e)}function h(e,t,r){this.promise=e,\"function\"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(t,r,n){i(function(){var e;try{e=r(n)}catch(e){return l.reject(t,e)}e===t?l.reject(t,new TypeError(\"Cannot resolve promise with itself\")):l.resolve(t,e)})}function c(e){var t=e&&e.then;if(e&&(\"object\"==typeof e||\"function\"==typeof e)&&\"function\"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,l.reject(t,e))}function i(e){r||(r=!0,l.resolve(t,e))}var s=p(function(){e(i,n)});\"error\"===s.status&&n(s.value)}function p(e,t){var r={};try{r.value=e(t),r.status=\"success\"}catch(e){r.status=\"error\",r.value=e}return r}(t.exports=o).prototype.finally=function(t){if(\"function\"!=typeof t)return this;var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})},o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if(\"function\"!=typeof e&&this.state===a||\"function\"!=typeof t&&this.state===s)return this;var r=new this.constructor(u);this.state!==n?f(r,this.state===a?e:t,this.outcome):this.queue.push(new h(r,e,t));return r},h.prototype.callFulfilled=function(e){l.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){l.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},l.resolve=function(e,t){var r=p(c,t);if(\"error\"===r.status)return l.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},l.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},o.resolve=function(e){if(e instanceof this)return e;return l.resolve(new this(u),e)},o.reject=function(e){var t=new this(u);return l.reject(t,e)},o.all=function(e){var r=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var n=e.length,i=!1;if(!n)return this.resolve([]);var s=new Array(n),a=0,t=-1,o=new this(u);for(;++t<n;)h(e[t],t);return o;function h(e,t){r.resolve(e).then(function(e){s[t]=e,++a!==n||i||(i=!0,l.resolve(o,s))},function(e){i||(i=!0,l.reject(o,e))})}},o.race=function(e){var t=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var r=e.length,n=!1;if(!r)return this.resolve([]);var i=-1,s=new this(u);for(;++i<r;)a=e[i],t.resolve(a).then(function(e){n||(n=!0,l.resolve(s,e))},function(e){n||(n=!0,l.reject(s,e))});var a;return s}},{immediate:36}],38:[function(e,t,r){\"use strict\";var n={};(0,e(\"./lib/utils/common\").assign)(n,e(\"./lib/deflate\"),e(\"./lib/inflate\"),e(\"./lib/zlib/constants\")),t.exports=n},{\"./lib/deflate\":39,\"./lib/inflate\":40,\"./lib/utils/common\":41,\"./lib/zlib/constants\":44}],39:[function(e,t,r){\"use strict\";var a=e(\"./zlib/deflate\"),o=e(\"./utils/common\"),h=e(\"./utils/strings\"),i=e(\"./zlib/messages\"),s=e(\"./zlib/zstream\"),u=Object.prototype.toString,l=0,f=-1,c=0,d=8;function p(e){if(!(this instanceof p))return new p(e);this.options=o.assign({level:f,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:\"\"},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==l)throw new Error(i[r]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n=\"string\"==typeof t.dictionary?h.string2buf(t.dictionary):\"[object ArrayBuffer]\"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=a.deflateSetDictionary(this.strm,n))!==l)throw new Error(i[r]);this._dict_set=!0}}function n(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}p.prototype.push=function(e,t){var r,n,i=this.strm,s=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,\"string\"==typeof e?i.input=h.string2buf(e):\"[object ArrayBuffer]\"===u.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new o.Buf8(s),i.next_out=0,i.avail_out=s),1!==(r=a.deflate(i,n))&&r!==l)return this.onEnd(r),!(this.ended=!0);0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||(\"string\"===this.options.to?this.onData(h.buf2binstring(o.shrinkBuf(i.output,i.next_out))):this.onData(o.shrinkBuf(i.output,i.next_out)))}while((0<i.avail_in||0===i.avail_out)&&1!==r);return 4===n?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==n||(this.onEnd(l),!(i.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===l&&(\"string\"===this.options.to?this.result=this.chunks.join(\"\"):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=p,r.deflate=n,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,n(e,t)}},{\"./utils/common\":41,\"./utils/strings\":42,\"./zlib/deflate\":46,\"./zlib/messages\":51,\"./zlib/zstream\":53}],40:[function(e,t,r){\"use strict\";var c=e(\"./zlib/inflate\"),d=e(\"./utils/common\"),p=e(\"./utils/strings\"),m=e(\"./zlib/constants\"),n=e(\"./zlib/messages\"),i=e(\"./zlib/zstream\"),s=e(\"./zlib/gzheader\"),_=Object.prototype.toString;function a(e){if(!(this instanceof a))return new a(e);this.options=d.assign({chunkSize:16384,windowBits:0,to:\"\"},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var r=c.inflateInit2(this.strm,t.windowBits);if(r!==m.Z_OK)throw new Error(n[r]);this.header=new s,c.inflateGetHeader(this.strm,this.header)}function o(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||n[r.err];return r.result}a.prototype.push=function(e,t){var r,n,i,s,a,o,h=this.strm,u=this.options.chunkSize,l=this.options.dictionary,f=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,\"string\"==typeof e?h.input=p.binstring2buf(e):\"[object ArrayBuffer]\"===_.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new d.Buf8(u),h.next_out=0,h.avail_out=u),(r=c.inflate(h,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&l&&(o=\"string\"==typeof l?p.string2buf(l):\"[object ArrayBuffer]\"===_.call(l)?new Uint8Array(l):l,r=c.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===f&&(r=m.Z_OK,f=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);h.next_out&&(0!==h.avail_out&&r!==m.Z_STREAM_END&&(0!==h.avail_in||n!==m.Z_FINISH&&n!==m.Z_SYNC_FLUSH)||(\"string\"===this.options.to?(i=p.utf8border(h.output,h.next_out),s=h.next_out-i,a=p.buf2string(h.output,i),h.next_out=s,h.avail_out=u-s,s&&d.arraySet(h.output,h.output,i,s,0),this.onData(a)):this.onData(d.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((0<h.avail_in||0===h.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(n=m.Z_FINISH),n===m.Z_FINISH?(r=c.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):n!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(h.avail_out=0))},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===m.Z_OK&&(\"string\"===this.options.to?this.result=this.chunks.join(\"\"):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=a,r.inflate=o,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},r.ungzip=o},{\"./utils/common\":41,\"./utils/strings\":42,\"./zlib/constants\":44,\"./zlib/gzheader\":47,\"./zlib/inflate\":49,\"./zlib/messages\":51,\"./zlib/zstream\":53}],41:[function(e,t,r){\"use strict\";var n=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if(\"object\"!=typeof r)throw new TypeError(r+\"must be non-object\");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,a;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)s=e[t],a.set(s,i),i+=s.length;return a}},s={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],42:[function(e,t,r){\"use strict\";var h=e(\"./common\"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var u=new h.Buf8(256),n=0;n<256;n++)u[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&i))return String.fromCharCode.apply(null,h.shrinkBuf(e,t));for(var r=\"\",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}u[254]=u[254]=1,r.string2buf=function(e){var t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new h.Buf8(o),i=s=0;s<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new h.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,s,a=t||e.length,o=new Array(2*a);for(r=n=0;r<a;)if((i=e[r++])<128)o[n++]=i;else if(4<(s=u[i]))o[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&r<a;)i=i<<6|63&e[r++],s--;1<s?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return l(o,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+u[e[r]]>t?r:t}},{\"./common\":41}],43:[function(e,t,r){\"use strict\";t.exports=function(e,t,r,n){for(var i=65535&e|0,s=e>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(i=i+t[n++]|0)|0,--a;);i%=65521,s%=65521}return i|s<<16|0}},{}],44:[function(e,t,r){\"use strict\";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){\"use strict\";var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var i=o,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,r){\"use strict\";var h,c=e(\"../utils/common\"),u=e(\"./trees\"),d=e(\"./adler32\"),p=e(\"./crc32\"),n=e(\"./messages\"),l=0,f=4,m=0,_=-2,g=-1,b=4,i=2,v=8,y=9,s=286,a=30,o=19,w=2*s+1,k=15,x=3,S=258,z=S+x+1,C=42,E=113,A=1,I=2,O=3,B=4;function R(e,t){return e.msg=n[t],t}function T(e){return(e<<1)-(4<e?9:0)}function D(e){for(var t=e.length;0<=--t;)e[t]=0}function F(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(c.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function N(e,t){u._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)}function U(e,t){e.pending_buf[e.pending++]=t}function P(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function L(e,t){var r,n,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,h=e.strstart>e.w_size-z?e.strstart-(e.w_size-z):0,u=e.window,l=e.w_mask,f=e.prev,c=e.strstart+S,d=u[s+a-1],p=u[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(u[(r=t)+a]===p&&u[r+a-1]===d&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<c);if(n=S-(c-s),s=c-S,a<n){if(e.match_start=t,o<=(a=n))break;d=u[s+a-1],p=u[s+a]}}}while((t=f[t&l])>h&&0!=--i);return a<=e.lookahead?a:e.lookahead}function j(e){var t,r,n,i,s,a,o,h,u,l,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-z)){for(c.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=r=e.hash_size;n=e.head[--t],e.head[t]=f<=n?n-f:0,--r;);for(t=r=f;n=e.prev[--t],e.prev[t]=f<=n?n-f:0,--r;);i+=f}if(0===e.strm.avail_in)break;if(a=e.strm,o=e.window,h=e.strstart+e.lookahead,u=i,l=void 0,l=a.avail_in,u<l&&(l=u),r=0===l?0:(a.avail_in-=l,c.arraySet(o,a.input,a.next_in,l,h),1===a.state.wrap?a.adler=d(a.adler,o,l,h):2===a.state.wrap&&(a.adler=p(a.adler,o,l,h)),a.next_in+=l,a.total_in+=l,l),e.lookahead+=r,e.lookahead+e.insert>=x)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+x-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<x)););}while(e.lookahead<z&&0!==e.strm.avail_in)}function Z(e,t){for(var r,n;;){if(e.lookahead<z){if(j(e),e.lookahead<z&&t===l)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-z&&(e.match_length=L(e,r)),e.match_length>=x)if(n=u._tr_tally(e,e.strstart-e.match_start,e.match_length-x),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=x){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<x-1?e.strstart:x-1,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}function W(e,t){for(var r,n,i;;){if(e.lookahead<z){if(j(e),e.lookahead<z&&t===l)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=x-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-z&&(e.match_length=L(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===x&&4096<e.strstart-e.match_start)&&(e.match_length=x-1)),e.prev_length>=x&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-x,n=u._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-x),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=x-1,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((n=u._tr_tally(e,0,e.window[e.strstart-1]))&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=u._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<x-1?e.strstart:x-1,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}function M(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*w),this.dyn_dtree=new c.Buf16(2*(2*a+1)),this.bl_tree=new c.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(k+1),this.heap=new c.Buf16(2*s+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*s+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=i,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:E,e.adler=2===t.wrap?0:1,t.last_flush=l,u._tr_init(t),m):R(e,_)}function K(e){var t=G(e);return t===m&&function(e){e.window_size=2*e.w_size,D(e.head),e.max_lazy_match=h[e.level].max_lazy,e.good_match=h[e.level].good_length,e.nice_match=h[e.level].nice_length,e.max_chain_length=h[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=x-1,e.match_available=0,e.ins_h=0}(e.state),t}function Y(e,t,r,n,i,s){if(!e)return _;var a=1;if(t===g&&(t=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),i<1||y<i||r!==v||n<8||15<n||t<0||9<t||s<0||b<s)return R(e,_);8===n&&(n=9);var o=new H;return(e.state=o).strm=e,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new c.Buf8(2*o.w_size),o.head=new c.Buf16(o.hash_size),o.prev=new c.Buf16(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new c.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=s,o.method=r,K(e)}h=[new M(0,0,0,0,function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(j(e),0===e.lookahead&&t===l)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,N(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-z&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out),A)}),new M(4,4,8,4,Z),new M(4,5,16,8,Z),new M(4,6,32,32,Z),new M(4,4,16,16,W),new M(8,16,32,32,W),new M(8,16,128,128,W),new M(8,32,128,256,W),new M(32,128,258,1024,W),new M(32,258,258,4096,W)],r.deflateInit=function(e,t){return Y(e,t,v,15,8,0)},r.deflateInit2=Y,r.deflateReset=K,r.deflateResetKeep=G,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,m):_},r.deflate=function(e,t){var r,n,i,s;if(!e||!e.state||5<t||t<0)return e?R(e,_):_;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&t!==f)return R(e,0===e.avail_out?-5:_);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===C)if(2===n.wrap)e.adler=0,U(n,31),U(n,139),U(n,8),n.gzhead?(U(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),U(n,255&n.gzhead.time),U(n,n.gzhead.time>>8&255),U(n,n.gzhead.time>>16&255),U(n,n.gzhead.time>>24&255),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(U(n,255&n.gzhead.extra.length),U(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=p(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(U(n,0),U(n,0),U(n,0),U(n,0),U(n,0),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,3),n.status=E);else{var a=v+(n.w_bits-8<<4)<<8;a|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=E,P(n,a),0!==n.strstart&&(P(n,e.adler>>>16),P(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending!==n.pending_buf_size));)U(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,U(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,U(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&F(e),n.pending+2<=n.pending_buf_size&&(U(n,255&e.adler),U(n,e.adler>>8&255),e.adler=0,n.status=E)):n.status=E),0!==n.pending){if(F(e),0===e.avail_out)return n.last_flush=-1,m}else if(0===e.avail_in&&T(t)<=T(r)&&t!==f)return R(e,-5);if(666===n.status&&0!==e.avail_in)return R(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==l&&666!==n.status){var o=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(t===l)return A;break}if(e.match_length=0,r=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}(n,t):3===n.strategy?function(e,t){for(var r,n,i,s,a=e.window;;){if(e.lookahead<=S){if(j(e),e.lookahead<=S&&t===l)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=x&&0<e.strstart&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){s=e.strstart+S;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<s);e.match_length=S-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=x?(r=u._tr_tally(e,1,e.match_length-x),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}(n,t):h[n.level].func(n,t);if(o!==O&&o!==B||(n.status=666),o===A||o===O)return 0===e.avail_out&&(n.last_flush=-1),m;if(o===I&&(1===t?u._tr_align(n):5!==t&&(u._tr_stored_block(n,0,0,!1),3===t&&(D(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),F(e),0===e.avail_out))return n.last_flush=-1,m}return t!==f?m:n.wrap<=0?1:(2===n.wrap?(U(n,255&e.adler),U(n,e.adler>>8&255),U(n,e.adler>>16&255),U(n,e.adler>>24&255),U(n,255&e.total_in),U(n,e.total_in>>8&255),U(n,e.total_in>>16&255),U(n,e.total_in>>24&255)):(P(n,e.adler>>>16),P(n,65535&e.adler)),F(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?m:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==E&&666!==t?R(e,_):(e.state=null,t===E?R(e,-3):m):_},r.deflateSetDictionary=function(e,t){var r,n,i,s,a,o,h,u,l=t.length;if(!e||!e.state)return _;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==C||r.lookahead)return _;for(1===s&&(e.adler=d(e.adler,t,l,0)),r.wrap=0,l>=r.w_size&&(0===s&&(D(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new c.Buf8(r.w_size),c.arraySet(u,t,l-r.w_size,r.w_size,0),t=u,l=r.w_size),a=e.avail_in,o=e.next_in,h=e.input,e.avail_in=l,e.next_in=0,e.input=t,j(r);r.lookahead>=x;){for(n=r.strstart,i=r.lookahead-(x-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+x-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--i;);r.strstart=n,r.lookahead=x-1,j(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=x-1,r.match_available=0,e.next_in=o,e.input=h,e.avail_in=a,r.wrap=s,m},r.deflateInfo=\"pako deflate (from Nodeca project)\"},{\"../utils/common\":41,\"./adler32\":43,\"./crc32\":45,\"./messages\":51,\"./trees\":52}],47:[function(e,t,r){\"use strict\";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\"\",this.comment=\"\",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){\"use strict\";t.exports=function(e,t){var r,n,i,s,a,o,h,u,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C;r=e.state,n=e.next_in,z=e.input,i=n+(e.avail_in-5),s=e.next_out,C=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),h=r.dmax,u=r.wsize,l=r.whave,f=r.wnext,c=r.window,d=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=m[d&g];t:for(;;){if(d>>>=y=v>>>24,p-=y,0===(y=v>>>16&255))C[s++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(d&(1<<y)-1)];continue t}if(32&y){r.mode=12;break e}e.msg=\"invalid literal/length code\",r.mode=30;break e}w=65535&v,(y&=15)&&(p<y&&(d+=z[n++]<<p,p+=8),w+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=_[d&b];r:for(;;){if(d>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(d&(1<<y)-1)];continue r}e.msg=\"invalid distance code\",r.mode=30;break e}if(k=65535&v,p<(y&=15)&&(d+=z[n++]<<p,(p+=8)<y&&(d+=z[n++]<<p,p+=8)),h<(k+=d&(1<<y)-1)){e.msg=\"invalid distance too far back\",r.mode=30;break e}if(d>>>=y,p-=y,(y=s-a)<k){if(l<(y=k-y)&&r.sane){e.msg=\"invalid distance too far back\",r.mode=30;break e}if(S=c,(x=0)===f){if(x+=u-y,y<w){for(w-=y;C[s++]=c[x++],--y;);x=s-k,S=C}}else if(f<y){if(x+=u+f-y,(y-=f)<w){for(w-=y;C[s++]=c[x++],--y;);if(x=0,f<w){for(w-=y=f;C[s++]=c[x++],--y;);x=s-k,S=C}}}else if(x+=f-y,y<w){for(w-=y;C[s++]=c[x++],--y;);x=s-k,S=C}for(;2<w;)C[s++]=S[x++],C[s++]=S[x++],C[s++]=S[x++],w-=3;w&&(C[s++]=S[x++],1<w&&(C[s++]=S[x++]))}else{for(x=s-k;C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],2<(w-=3););w&&(C[s++]=C[x++],1<w&&(C[s++]=C[x++]))}break}}break}}while(n<i&&s<o);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=d,r.bits=p}},{}],49:[function(e,t,r){\"use strict\";var I=e(\"../utils/common\"),O=e(\"./adler32\"),B=e(\"./crc32\"),R=e(\"./inffast\"),T=e(\"./inftrees\"),D=1,F=2,N=0,U=-2,P=1,n=852,i=592;function L(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\"\",t.wrap&&(e.adler=1&t.wrap),t.mode=P,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new I.Buf32(n),t.distcode=t.distdyn=new I.Buf32(i),t.sane=1,t.back=-1,N):U}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e)):U}function h(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?U:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,o(e))):U}function u(e,t){var r,n;return e?(n=new s,(e.state=n).window=null,(r=h(e,t))!==N&&(e.state=null),r):U}var l,f,c=!0;function j(e){if(c){var t;for(l=new I.Buf32(512),f=new I.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(T(D,e.lens,0,288,l,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;T(F,e.lens,0,32,f,0,e.work,{bits:5}),c=!1}e.lencode=l,e.lenbits=9,e.distcode=f,e.distbits=5}function Z(e,t,r,n){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new I.Buf8(s.wsize)),n>=s.wsize?(I.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n<(i=s.wsize-s.wnext)&&(i=n),I.arraySet(s.window,t,r-n,i,s.wnext),(n-=i)?(I.arraySet(s.window,t,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}r.inflateReset=o,r.inflateReset2=h,r.inflateResetKeep=a,r.inflateInit=function(e){return u(e,15)},r.inflateInit2=u,r.inflate=function(e,t){var r,n,i,s,a,o,h,u,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C=0,E=new I.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return U;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,i=e.output,h=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,l=r.bits,f=o,c=h,x=N;e:for(;;)switch(r.mode){case P:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(2&r.wrap&&35615===u){E[r.check=0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0),l=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg=\"incorrect header check\",r.mode=30;break}if(8!=(15&u)){e.msg=\"unknown compression method\",r.mode=30;break}if(l-=4,k=8+(15&(u>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg=\"invalid window size\",r.mode=30;break}r.dmax=1<<k,e.adler=r.check=1,r.mode=512&u?10:12,l=u=0;break;case 2:for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(r.flags=u,8!=(255&r.flags)){e.msg=\"unknown compression method\",r.mode=30;break}if(57344&r.flags){e.msg=\"unknown header flags set\",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=3;case 3:for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.head&&(r.head.time=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=B(r.check,E,4,0)),l=u=0,r.mode=4;case 4:for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(d=r.length)&&(d=o),d&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),I.arraySet(r.head.extra,n,s,d,k)),512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break e;for(d=0;k=n[s+d++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break e;for(d=0;k=n[s+d++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,k)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u!==(65535&r.check)){e.msg=\"header crc mismatch\",r.mode=30;break}l=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}e.adler=r.check=L(u),l=u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}switch(r.last=1&u,l-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(j(r),r.mode=20,6!==t)break;u>>>=2,l-=2;break e;case 2:r.mode=17;break;case 3:e.msg=\"invalid block type\",r.mode=30}u>>>=2,l-=2;break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg=\"invalid stored block lengths\",r.mode=30;break}if(r.length=65535&u,l=u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(d=r.length){if(o<d&&(d=o),h<d&&(d=h),0===d)break e;I.arraySet(i,n,s,d,a),o-=d,s+=d,h-=d,a+=d,r.length-=d;break}r.mode=12;break;case 17:for(;l<14;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(r.nlen=257+(31&u),u>>>=5,l-=5,r.ndist=1+(31&u),u>>>=5,l-=5,r.ncode=4+(15&u),u>>>=4,l-=4,286<r.nlen||30<r.ndist){e.msg=\"too many length or distance symbols\",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.lens[A[r.have++]]=7&u,u>>>=3,l-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},x=T(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg=\"invalid code lengths set\",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(b<16)u>>>=_,l-=_,r.lens[r.have++]=b;else{if(16===b){for(z=_+2;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u>>>=_,l-=_,0===r.have){e.msg=\"invalid bit length repeat\",r.mode=30;break}k=r.lens[r.have-1],d=3+(3&u),u>>>=2,l-=2}else if(17===b){for(z=_+3;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}l-=_,k=0,d=3+(7&(u>>>=_)),u>>>=3,l-=3}else{for(z=_+7;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}l-=_,k=0,d=11+(127&(u>>>=_)),u>>>=7,l-=7}if(r.have+d>r.nlen+r.ndist){e.msg=\"invalid bit length repeat\",r.mode=30;break}for(;d--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){e.msg=\"invalid code -- missing end-of-block\",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},x=T(D,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg=\"invalid literal/lengths set\",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},x=T(F,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,x){e.msg=\"invalid distances set\",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=o&&258<=h){e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,R(e,c),a=e.next_out,i=e.output,h=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(g&&0==(240&g)){for(v=_,y=g,w=b;g=(C=r.lencode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,r.length=b,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=12;break}if(64&g){e.msg=\"invalid literal/length code\",r.mode=30;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(C=r.distcode[u&(1<<r.distbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(0==(240&g)){for(v=_,y=g,w=b;g=(C=r.distcode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,64&g){e.msg=\"invalid distance code\",r.mode=30;break}r.offset=b,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg=\"invalid distance too far back\",r.mode=30;break}r.mode=25;case 25:if(0===h)break e;if(d=c-h,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg=\"invalid distance too far back\",r.mode=30;break}p=d>r.wnext?(d-=r.wnext,r.wsize-d):r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=i,p=a-r.offset,d=r.length;for(h<d&&(d=h),h-=d,r.length-=d;i[a++]=m[p++],--d;);0===r.length&&(r.mode=21);break;case 26:if(0===h)break e;i[a++]=r.length,h--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===o)break e;o--,u|=n[s++]<<l,l+=8}if(c-=h,e.total_out+=c,r.total+=c,c&&(e.adler=r.check=r.flags?B(r.check,i,c,a-c):O(r.check,i,c,a-c)),c=h,(r.flags?u:L(u))!==r.check){e.msg=\"incorrect data check\",r.mode=30;break}l=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u!==(4294967295&r.total)){e.msg=\"incorrect length check\",r.mode=30;break}l=u=0}r.mode=29;case 29:x=1;break e;case 30:x=-3;break e;case 31:return-4;case 32:default:return U}return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,(r.wsize||c!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&Z(e,e.output,e.next_out,c-e.avail_out)?(r.mode=31,-4):(f-=e.avail_in,c-=e.avail_out,e.total_in+=f,e.total_out+=c,r.total+=c,r.wrap&&c&&(e.adler=r.check=r.flags?B(r.check,i,c,e.next_out-c):O(r.check,i,c,e.next_out-c)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==f&&0===c||4===t)&&x===N&&(x=-5),x)},r.inflateEnd=function(e){if(!e||!e.state)return U;var t=e.state;return t.window&&(t.window=null),e.state=null,N},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?U:((r.head=t).done=!1,N):U},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?U:11===r.mode&&O(1,t,n,0)!==r.check?-3:Z(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,N):U},r.inflateInfo=\"pako inflate (from Nodeca project)\"},{\"../utils/common\":41,\"./adler32\":43,\"./crc32\":45,\"./inffast\":48,\"./inftrees\":50}],50:[function(e,t,r){\"use strict\";var D=e(\"../utils/common\"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,n,i,s,a,o){var h,u,l,f,c,d,p,m,_,g=o.bits,b=0,v=0,y=0,w=0,k=0,x=0,S=0,z=0,C=0,E=0,A=null,I=0,O=new D.Buf16(16),B=new D.Buf16(16),R=null,T=0;for(b=0;b<=15;b++)O[b]=0;for(v=0;v<n;v++)O[t[r+v]]++;for(k=g,w=15;1<=w&&0===O[w];w--);if(w<k&&(k=w),0===w)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(y=1;y<w&&0===O[y];y++);for(k<y&&(k=y),b=z=1;b<=15;b++)if(z<<=1,(z-=O[b])<0)return-1;if(0<z&&(0===e||1!==w))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+O[b];for(v=0;v<n;v++)0!==t[r+v]&&(a[B[t[r+v]]++]=v);if(d=0===e?(A=R=a,19):1===e?(A=F,I-=257,R=N,T-=257,256):(A=U,R=P,-1),b=y,c=s,S=v=E=0,l=-1,f=(C=1<<(x=k))-1,1===e&&852<C||2===e&&592<C)return 1;for(;;){for(p=b-S,_=a[v]<d?(m=0,a[v]):a[v]>d?(m=R[T+a[v]],A[I+a[v]]):(m=96,0),h=1<<b-S,y=u=1<<x;i[c+(E>>S)+(u-=h)]=p<<24|m<<16|_|0,0!==u;);for(h=1<<b-1;E&h;)h>>=1;if(0!==h?(E&=h-1,E+=h):E=0,v++,0==--O[b]){if(b===w)break;b=t[r+a[v]]}if(k<b&&(E&f)!==l){for(0===S&&(S=k),c+=y,z=1<<(x=b-S);x+S<w&&!((z-=O[x+S])<=0);)x++,z<<=1;if(C+=1<<x,1===e&&852<C||2===e&&592<C)return 1;i[l=E&f]=k<<24|x<<16|c-s|0}}return 0!==E&&(i[c+E]=b-S<<24|64<<16|0),o.bits=k,0}},{\"../utils/common\":41}],51:[function(e,t,r){\"use strict\";t.exports={2:\"need dictionary\",1:\"stream end\",0:\"\",\"-1\":\"file error\",\"-2\":\"stream error\",\"-3\":\"data error\",\"-4\":\"insufficient memory\",\"-5\":\"buffer error\",\"-6\":\"incompatible version\"}},{}],52:[function(e,t,r){\"use strict\";var i=e(\"../utils/common\"),o=0,h=1;function n(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,a=29,u=256,l=u+1+a,f=30,c=19,_=2*l+1,g=15,d=16,p=7,m=256,b=16,v=17,y=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(l+2));n(z);var C=new Array(2*f);n(C);var E=new Array(512);n(E);var A=new Array(256);n(A);var I=new Array(a);n(I);var O,B,R,T=new Array(f);function D(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function N(e){return e<256?E[e]:E[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function P(e,t,r){e.bi_valid>d-r?(e.bi_buf|=t<<e.bi_valid&65535,U(e,e.bi_buf),e.bi_buf=t>>d-e.bi_valid,e.bi_valid+=r-d):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function L(e,t,r){P(e,r[2*t],r[2*t+1])}function j(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function Z(e,t,r){var n,i,s=new Array(g+1),a=0;for(n=1;n<=g;n++)s[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=j(s[o]++,o))}}function W(e){var t;for(t=0;t<l;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<c;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*m]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function M(e){8<e.bi_valid?U(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function G(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&H(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!H(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function K(e,t,r){var n,i,s,a,o=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],i=e.pending_buf[e.l_buf+o],o++,0===n?L(e,i,t):(L(e,(s=A[i])+u+1,t),0!==(a=w[s])&&P(e,i-=I[s],a),L(e,s=N(--n),r),0!==(a=k[s])&&P(e,n-=T[s],a)),o<e.last_lit;);L(e,m,t)}function Y(e,t){var r,n,i,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,h=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=_,r=0;r<h;r++)0!==s[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;1<=r;r--)G(e,s,r);for(i=h;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,G(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,a,o,h=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=g;s++)e.bl_count[s]=0;for(h[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<_;r++)p<(s=h[2*h[2*(n=e.heap[r])+1]+1]+1)&&(s=p,m++),h[2*n+1]=s,u<n||(e.bl_count[s]++,a=0,d<=n&&(a=c[n-d]),o=h[2*n],e.opt_len+=o*(s+a),f&&(e.static_len+=o*(l[2*n+1]+a)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(0<m);for(s=p;0!==s;s--)for(n=e.bl_count[s];0!==n;)u<(i=e.heap[--r])||(h[2*i+1]!==s&&(e.opt_len+=(s-h[2*i+1])*h[2*i],h[2*i+1]=s),n--)}}(e,t),Z(s,u,e.bl_count)}function X(e,t,r){var n,i,s=-1,a=t[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++o<h&&i===a||(o<u?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[2*b]++):o<=10?e.bl_tree[2*v]++:e.bl_tree[2*y]++,s=i,u=(o=0)===a?(h=138,3):i===a?(h=6,3):(h=7,4))}function V(e,t,r){var n,i,s=-1,a=t[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++o<h&&i===a)){if(o<u)for(;L(e,i,e.bl_tree),0!=--o;);else 0!==i?(i!==s&&(L(e,i,e.bl_tree),o--),L(e,b,e.bl_tree),P(e,o-3,2)):o<=10?(L(e,v,e.bl_tree),P(e,o-3,3)):(L(e,y,e.bl_tree),P(e,o-11,7));s=i,u=(o=0)===a?(h=138,3):i===a?(h=6,3):(h=7,4)}}n(T);var q=!1;function J(e,t,r,n){P(e,(s<<1)+(n?1:0),3),function(e,t,r,n){M(e),n&&(U(e,r),U(e,~r)),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}r._tr_init=function(e){q||(function(){var e,t,r,n,i,s=new Array(g+1);for(n=r=0;n<a-1;n++)for(I[n]=r,e=0;e<1<<w[n];e++)A[r++]=n;for(A[r-1]=n,n=i=0;n<16;n++)for(T[n]=i,e=0;e<1<<k[n];e++)E[i++]=n;for(i>>=7;n<f;n++)for(T[n]=i<<7,e=0;e<1<<k[n]-7;e++)E[256+i++]=n;for(t=0;t<=g;t++)s[t]=0;for(e=0;e<=143;)z[2*e+1]=8,e++,s[8]++;for(;e<=255;)z[2*e+1]=9,e++,s[9]++;for(;e<=279;)z[2*e+1]=7,e++,s[7]++;for(;e<=287;)z[2*e+1]=8,e++,s[8]++;for(Z(z,l+1,s),e=0;e<f;e++)C[2*e+1]=5,C[2*e]=j(e,5);O=new D(z,w,u+1,l,g),B=new D(C,k,0,f,g),R=new D(new Array(0),x,0,c,p)}(),q=!0),e.l_desc=new F(e.dyn_ltree,O),e.d_desc=new F(e.dyn_dtree,B),e.bl_desc=new F(e.bl_tree,R),e.bi_buf=0,e.bi_valid=0,W(e)},r._tr_stored_block=J,r._tr_flush_block=function(e,t,r,n){var i,s,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return h;for(t=32;t<u;t++)if(0!==e.dyn_ltree[2*t])return h;return o}(e)),Y(e,e.l_desc),Y(e,e.d_desc),a=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=c-1;3<=t&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==t?J(e,t,r,n):4===e.strategy||s===i?(P(e,2+(n?1:0),3),K(e,z,C)):(P(e,4+(n?1:0),3),function(e,t,r,n){var i;for(P(e,t-257,5),P(e,r-1,5),P(e,n-4,4),i=0;i<n;i++)P(e,e.bl_tree[2*S[i]+1],3);V(e,e.dyn_ltree,t-1),V(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),K(e,e.dyn_ltree,e.dyn_dtree)),W(e),n&&M(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(A[r]+u+1)]++,e.dyn_dtree[2*N(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){P(e,2,3),L(e,m,z),function(e){16===e.bi_valid?(U(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{\"../utils/common\":41}],53:[function(e,t,r){\"use strict\";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\"\",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(r,n){\"use strict\";if(!r.setImmediate){var i,s,t,a,o=1,h={},u=!1,l=r.document,e=Object.getPrototypeOf&&Object.getPrototypeOf(r);e=e&&e.setTimeout?e:r,i=\"[object process]\"==={}.toString.call(r.process)?function(e){process.nextTick(function(){c(e)})}:function(){if(r.postMessage&&!r.importScripts){var e=!0,t=r.onmessage;return r.onmessage=function(){e=!1},r.postMessage(\"\",\"*\"),r.onmessage=t,e}}()?(a=\"setImmediate$\"+Math.random()+\"$\",r.addEventListener?r.addEventListener(\"message\",d,!1):r.attachEvent(\"onmessage\",d),function(e){r.postMessage(a+e,\"*\")}):r.MessageChannel?((t=new MessageChannel).port1.onmessage=function(e){c(e.data)},function(e){t.port2.postMessage(e)}):l&&\"onreadystatechange\"in l.createElement(\"script\")?(s=l.documentElement,function(e){var t=l.createElement(\"script\");t.onreadystatechange=function(){c(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):function(e){setTimeout(c,0,e)},e.setImmediate=function(e){\"function\"!=typeof e&&(e=new Function(\"\"+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return h[o]=n,i(o),o++},e.clearImmediate=f}function f(e){delete h[e]}function c(e){if(u)setTimeout(c,0,e);else{var t=h[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{f(e),u=!1}}}}function d(e){e.source===r&&\"string\"==typeof e.data&&0===e.data.indexOf(a)&&c(+e.data.slice(a.length))}}(\"undefined\"==typeof self?void 0===e?this:e:self)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}]},{},[10])(10)});",
		"MANAGED_RECIPE/thirdparty/xlsx.full.min.js": "/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\nvar DO_NOT_EXPORT_CODEPAGE=true;var cptable={version:\"1.15.0\"};cptable[437]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[620]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[737]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[850]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[852]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[857]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[861]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[865]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[866]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[874]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[895]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[932]=function(){var e=[],r={},t=[],a;t[0]=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");for(a=0;a!=t[0].length;++a)if(t[0][a].charCodeAt(0)!==65533){r[t[0][a]]=0+a;e[0+a]=t[0][a]}t[129]=\"\".split(\"\");for(a=0;a!=t[129].length;++a)if(t[129][a].charCodeAt(0)!==65533){r[t[129][a]]=33024+a;e[33024+a]=t[129][a]}t[130]=\"\".split(\"\");for(a=0;a!=t[130].length;++a)if(t[130][a].charCodeAt(0)!==65533){r[t[130][a]]=33280+a;e[33280+a]=t[130][a]}t[131]=\"\".split(\"\");for(a=0;a!=t[131].length;++a)if(t[131][a].charCodeAt(0)!==65533){r[t[131][a]]=33536+a;e[33536+a]=t[131][a]}t[132]=\"\".split(\"\");for(a=0;a!=t[132].length;++a)if(t[132][a].charCodeAt(0)!==65533){r[t[132][a]]=33792+a;e[33792+a]=t[132][a]}t[135]=\"\".split(\"\");for(a=0;a!=t[135].length;++a)if(t[135][a].charCodeAt(0)!==65533){r[t[135][a]]=34560+a;e[34560+a]=t[135][a]}t[136]=\"\".split(\"\");for(a=0;a!=t[136].length;++a)if(t[136][a].charCodeAt(0)!==65533){r[t[136][a]]=34816+a;e[34816+a]=t[136][a]}t[137]=\"\".split(\"\");for(a=0;a!=t[137].length;++a)if(t[137][a].charCodeAt(0)!==65533){r[t[137][a]]=35072+a;e[35072+a]=t[137][a]}t[138]=\"\".split(\"\");for(a=0;a!=t[138].length;++a)if(t[138][a].charCodeAt(0)!==65533){r[t[138][a]]=35328+a;e[35328+a]=t[138][a]}t[139]=\"\".split(\"\");for(a=0;a!=t[139].length;++a)if(t[139][a].charCodeAt(0)!==65533){r[t[139][a]]=35584+a;e[35584+a]=t[139][a]}t[140]=\"\".split(\"\");for(a=0;a!=t[140].length;++a)if(t[140][a].charCodeAt(0)!==65533){r[t[140][a]]=35840+a;e[35840+a]=t[140][a]}t[141]=\"\".split(\"\");for(a=0;a!=t[141].length;++a)if(t[141][a].charCodeAt(0)!==65533){r[t[141][a]]=36096+a;e[36096+a]=t[141][a]}t[142]=\"\".split(\"\");for(a=0;a!=t[142].length;++a)if(t[142][a].charCodeAt(0)!==65533){r[t[142][a]]=36352+a;e[36352+a]=t[142][a]}t[143]=\"\".split(\"\");for(a=0;a!=t[143].length;++a)if(t[143][a].charCodeAt(0)!==65533){r[t[143][a]]=36608+a;e[36608+a]=t[143][a]}t[144]=\"\".split(\"\");for(a=0;a!=t[144].length;++a)if(t[144][a].charCodeAt(0)!==65533){r[t[144][a]]=36864+a;e[36864+a]=t[144][a]}t[145]=\"\".split(\"\");for(a=0;a!=t[145].length;++a)if(t[145][a].charCodeAt(0)!==65533){r[t[145][a]]=37120+a;e[37120+a]=t[145][a]}t[146]=\"\".split(\"\");for(a=0;a!=t[146].length;++a)if(t[146][a].charCodeAt(0)!==65533){r[t[146][a]]=37376+a;e[37376+a]=t[146][a]}t[147]=\"\".split(\"\");for(a=0;a!=t[147].length;++a)if(t[147][a].charCodeAt(0)!==65533){r[t[147][a]]=37632+a;e[37632+a]=t[147][a]}t[148]=\"\".split(\"\");for(a=0;a!=t[148].length;++a)if(t[148][a].charCodeAt(0)!==65533){r[t[148][a]]=37888+a;e[37888+a]=t[148][a]}t[149]=\"\".split(\"\");for(a=0;a!=t[149].length;++a)if(t[149][a].charCodeAt(0)!==65533){r[t[149][a]]=38144+a;e[38144+a]=t[149][a]}t[150]=\"\".split(\"\");for(a=0;a!=t[150].length;++a)if(t[150][a].charCodeAt(0)!==65533){r[t[150][a]]=38400+a;e[38400+a]=t[150][a]}t[151]=\"\".split(\"\");for(a=0;a!=t[151].length;++a)if(t[151][a].charCodeAt(0)!==65533){r[t[151][a]]=38656+a;e[38656+a]=t[151][a]}t[152]=\"\".split(\"\");for(a=0;a!=t[152].length;++a)if(t[152][a].charCodeAt(0)!==65533){r[t[152][a]]=38912+a;e[38912+a]=t[152][a]}t[153]=\"\".split(\"\");for(a=0;a!=t[153].length;++a)if(t[153][a].charCodeAt(0)!==65533){r[t[153][a]]=39168+a;e[39168+a]=t[153][a]}t[154]=\"\".split(\"\");for(a=0;a!=t[154].length;++a)if(t[154][a].charCodeAt(0)!==65533){r[t[154][a]]=39424+a;e[39424+a]=t[154][a]}t[155]=\"\".split(\"\");for(a=0;a!=t[155].length;++a)if(t[155][a].charCodeAt(0)!==65533){r[t[155][a]]=39680+a;e[39680+a]=t[155][a]}t[156]=\"\".split(\"\");for(a=0;a!=t[156].length;++a)if(t[156][a].charCodeAt(0)!==65533){r[t[156][a]]=39936+a;e[39936+a]=t[156][a]}t[157]=\"\".split(\"\");for(a=0;a!=t[157].length;++a)if(t[157][a].charCodeAt(0)!==65533){r[t[157][a]]=40192+a;e[40192+a]=t[157][a]}t[158]=\"\".split(\"\");for(a=0;a!=t[158].length;++a)if(t[158][a].charCodeAt(0)!==65533){r[t[158][a]]=40448+a;e[40448+a]=t[158][a]}t[159]=\"\".split(\"\");for(a=0;a!=t[159].length;++a)if(t[159][a].charCodeAt(0)!==65533){r[t[159][a]]=40704+a;e[40704+a]=t[159][a]}t[224]=\"\".split(\"\");for(a=0;a!=t[224].length;++a)if(t[224][a].charCodeAt(0)!==65533){r[t[224][a]]=57344+a;e[57344+a]=t[224][a]}t[225]=\"\".split(\"\");for(a=0;a!=t[225].length;++a)if(t[225][a].charCodeAt(0)!==65533){r[t[225][a]]=57600+a;e[57600+a]=t[225][a]}t[226]=\"\".split(\"\");for(a=0;a!=t[226].length;++a)if(t[226][a].charCodeAt(0)!==65533){r[t[226][a]]=57856+a;e[57856+a]=t[226][a]}t[227]=\"\".split(\"\");for(a=0;a!=t[227].length;++a)if(t[227][a].charCodeAt(0)!==65533){r[t[227][a]]=58112+a;e[58112+a]=t[227][a]}t[228]=\"\".split(\"\");for(a=0;a!=t[228].length;++a)if(t[228][a].charCodeAt(0)!==65533){r[t[228][a]]=58368+a;e[58368+a]=t[228][a]}t[229]=\"\".split(\"\");for(a=0;a!=t[229].length;++a)if(t[229][a].charCodeAt(0)!==65533){r[t[229][a]]=58624+a;e[58624+a]=t[229][a]}t[230]=\"\".split(\"\");for(a=0;a!=t[230].length;++a)if(t[230][a].charCodeAt(0)!==65533){r[t[230][a]]=58880+a;e[58880+a]=t[230][a]}t[231]=\"\".split(\"\");for(a=0;a!=t[231].length;++a)if(t[231][a].charCodeAt(0)!==65533){r[t[231][a]]=59136+a;e[59136+a]=t[231][a]}t[232]=\"\".split(\"\");for(a=0;a!=t[232].length;++a)if(t[232][a].charCodeAt(0)!==65533){r[t[232][a]]=59392+a;e[59392+a]=t[232][a]}t[233]=\"\".split(\"\");for(a=0;a!=t[233].length;++a)if(t[233][a].charCodeAt(0)!==65533){r[t[233][a]]=59648+a;e[59648+a]=t[233][a]}t[234]=\"\".split(\"\");for(a=0;a!=t[234].length;++a)if(t[234][a].charCodeAt(0)!==65533){r[t[234][a]]=59904+a;e[59904+a]=t[234][a]}t[237]=\"\".split(\"\");for(a=0;a!=t[237].length;++a)if(t[237][a].charCodeAt(0)!==65533){r[t[237][a]]=60672+a;e[60672+a]=t[237][a]}t[238]=\"\".split(\"\");for(a=0;a!=t[238].length;++a)if(t[238][a].charCodeAt(0)!==65533){r[t[238][a]]=60928+a;e[60928+a]=t[238][a]}t[250]=\"\".split(\"\");for(a=0;a!=t[250].length;++a)if(t[250][a].charCodeAt(0)!==65533){r[t[250][a]]=64e3+a;e[64e3+a]=t[250][a]}t[251]=\"\".split(\"\");for(a=0;a!=t[251].length;++a)if(t[251][a].charCodeAt(0)!==65533){r[t[251][a]]=64256+a;e[64256+a]=t[251][a]}t[252]=\"\".split(\"\");for(a=0;a!=t[252].length;++a)if(t[252][a].charCodeAt(0)!==65533){r[t[252][a]]=64512+a;e[64512+a]=t[252][a]}return{enc:r,dec:e}}();cptable[936]=function(){var e=[],r={},t=[],a;t[0]=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");for(a=0;a!=t[0].length;++a)if(t[0][a].charCodeAt(0)!==65533){r[t[0][a]]=0+a;e[0+a]=t[0][a]}t[129]=\"\".split(\"\");for(a=0;a!=t[129].length;++a)if(t[129][a].charCodeAt(0)!==65533){r[t[129][a]]=33024+a;e[33024+a]=t[129][a]}t[130]=\"\".split(\"\");for(a=0;a!=t[130].length;++a)if(t[130][a].charCodeAt(0)!==65533){r[t[130][a]]=33280+a;e[33280+a]=t[130][a]}t[131]=\"\".split(\"\");for(a=0;a!=t[131].length;++a)if(t[131][a].charCodeAt(0)!==65533){r[t[131][a]]=33536+a;e[33536+a]=t[131][a]}t[132]=\"\".split(\"\");for(a=0;a!=t[132].length;++a)if(t[132][a].charCodeAt(0)!==65533){r[t[132][a]]=33792+a;e[33792+a]=t[132][a]}t[133]=\"\".split(\"\");for(a=0;a!=t[133].length;++a)if(t[133][a].charCodeAt(0)!==65533){r[t[133][a]]=34048+a;e[34048+a]=t[133][a]}t[134]=\"\".split(\"\");for(a=0;a!=t[134].length;++a)if(t[134][a].charCodeAt(0)!==65533){r[t[134][a]]=34304+a;e[34304+a]=t[134][a]}t[135]=\"\".split(\"\");for(a=0;a!=t[135].length;++a)if(t[135][a].charCodeAt(0)!==65533){r[t[135][a]]=34560+a;e[34560+a]=t[135][a]}t[136]=\"\".split(\"\");for(a=0;a!=t[136].length;++a)if(t[136][a].charCodeAt(0)!==65533){r[t[136][a]]=34816+a;e[34816+a]=t[136][a]}t[137]=\"\".split(\"\");for(a=0;a!=t[137].length;++a)if(t[137][a].charCodeAt(0)!==65533){r[t[137][a]]=35072+a;e[35072+a]=t[137][a]}t[138]=\"\".split(\"\");for(a=0;a!=t[138].length;++a)if(t[138][a].charCodeAt(0)!==65533){r[t[138][a]]=35328+a;e[35328+a]=t[138][a]}t[139]=\"\".split(\"\");for(a=0;a!=t[139].length;++a)if(t[139][a].charCodeAt(0)!==65533){r[t[139][a]]=35584+a;e[35584+a]=t[139][a]}t[140]=\"\".split(\"\");for(a=0;a!=t[140].length;++a)if(t[140][a].charCodeAt(0)!==65533){r[t[140][a]]=35840+a;e[35840+a]=t[140][a]}t[141]=\"\".split(\"\");for(a=0;a!=t[141].length;++a)if(t[141][a].charCodeAt(0)!==65533){r[t[141][a]]=36096+a;e[36096+a]=t[141][a]}t[142]=\"\".split(\"\");for(a=0;a!=t[142].length;++a)if(t[142][a].charCodeAt(0)!==65533){r[t[142][a]]=36352+a;e[36352+a]=t[142][a]}t[143]=\"\".split(\"\");for(a=0;a!=t[143].length;++a)if(t[143][a].charCodeAt(0)!==65533){r[t[143][a]]=36608+a;e[36608+a]=t[143][a]}t[144]=\"\".split(\"\");for(a=0;a!=t[144].length;++a)if(t[144][a].charCodeAt(0)!==65533){r[t[144][a]]=36864+a;e[36864+a]=t[144][a]}t[145]=\"\".split(\"\");for(a=0;a!=t[145].length;++a)if(t[145][a].charCodeAt(0)!==65533){r[t[145][a]]=37120+a;e[37120+a]=t[145][a]}t[146]=\"\".split(\"\");for(a=0;a!=t[146].length;++a)if(t[146][a].charCodeAt(0)!==65533){r[t[146][a]]=37376+a;e[37376+a]=t[146][a]}t[147]=\"\".split(\"\");for(a=0;a!=t[147].length;++a)if(t[147][a].charCodeAt(0)!==65533){r[t[147][a]]=37632+a;e[37632+a]=t[147][a]}t[148]=\"\".split(\"\");for(a=0;a!=t[148].length;++a)if(t[148][a].charCodeAt(0)!==65533){r[t[148][a]]=37888+a;e[37888+a]=t[148][a]}t[149]=\"\".split(\"\");for(a=0;a!=t[149].length;++a)if(t[149][a].charCodeAt(0)!==65533){r[t[149][a]]=38144+a;e[38144+a]=t[149][a]}t[150]=\"\".split(\"\");for(a=0;a!=t[150].length;++a)if(t[150][a].charCodeAt(0)!==65533){r[t[150][a]]=38400+a;e[38400+a]=t[150][a]}t[151]=\"\".split(\"\");for(a=0;a!=t[151].length;++a)if(t[151][a].charCodeAt(0)!==65533){r[t[151][a]]=38656+a;e[38656+a]=t[151][a]}t[152]=\"\".split(\"\");for(a=0;a!=t[152].length;++a)if(t[152][a].charCodeAt(0)!==65533){r[t[152][a]]=38912+a;e[38912+a]=t[152][a];\n}t[153]=\"\".split(\"\");for(a=0;a!=t[153].length;++a)if(t[153][a].charCodeAt(0)!==65533){r[t[153][a]]=39168+a;e[39168+a]=t[153][a]}t[154]=\"\".split(\"\");for(a=0;a!=t[154].length;++a)if(t[154][a].charCodeAt(0)!==65533){r[t[154][a]]=39424+a;e[39424+a]=t[154][a]}t[155]=\"\".split(\"\");for(a=0;a!=t[155].length;++a)if(t[155][a].charCodeAt(0)!==65533){r[t[155][a]]=39680+a;e[39680+a]=t[155][a]}t[156]=\"\".split(\"\");for(a=0;a!=t[156].length;++a)if(t[156][a].charCodeAt(0)!==65533){r[t[156][a]]=39936+a;e[39936+a]=t[156][a]}t[157]=\"\".split(\"\");for(a=0;a!=t[157].length;++a)if(t[157][a].charCodeAt(0)!==65533){r[t[157][a]]=40192+a;e[40192+a]=t[157][a]}t[158]=\"\".split(\"\");for(a=0;a!=t[158].length;++a)if(t[158][a].charCodeAt(0)!==65533){r[t[158][a]]=40448+a;e[40448+a]=t[158][a]}t[159]=\"\".split(\"\");for(a=0;a!=t[159].length;++a)if(t[159][a].charCodeAt(0)!==65533){r[t[159][a]]=40704+a;e[40704+a]=t[159][a]}t[160]=\"\".split(\"\");for(a=0;a!=t[160].length;++a)if(t[160][a].charCodeAt(0)!==65533){r[t[160][a]]=40960+a;e[40960+a]=t[160][a]}t[161]=\"\".split(\"\");for(a=0;a!=t[161].length;++a)if(t[161][a].charCodeAt(0)!==65533){r[t[161][a]]=41216+a;e[41216+a]=t[161][a]}t[162]=\"\".split(\"\");for(a=0;a!=t[162].length;++a)if(t[162][a].charCodeAt(0)!==65533){r[t[162][a]]=41472+a;e[41472+a]=t[162][a]}t[163]=\"\".split(\"\");for(a=0;a!=t[163].length;++a)if(t[163][a].charCodeAt(0)!==65533){r[t[163][a]]=41728+a;e[41728+a]=t[163][a]}t[164]=\"\".split(\"\");for(a=0;a!=t[164].length;++a)if(t[164][a].charCodeAt(0)!==65533){r[t[164][a]]=41984+a;e[41984+a]=t[164][a]}t[165]=\"\".split(\"\");for(a=0;a!=t[165].length;++a)if(t[165][a].charCodeAt(0)!==65533){r[t[165][a]]=42240+a;e[42240+a]=t[165][a]}t[166]=\"\".split(\"\");for(a=0;a!=t[166].length;++a)if(t[166][a].charCodeAt(0)!==65533){r[t[166][a]]=42496+a;e[42496+a]=t[166][a]}t[167]=\"\".split(\"\");for(a=0;a!=t[167].length;++a)if(t[167][a].charCodeAt(0)!==65533){r[t[167][a]]=42752+a;e[42752+a]=t[167][a]}t[168]=\"\".split(\"\");for(a=0;a!=t[168].length;++a)if(t[168][a].charCodeAt(0)!==65533){r[t[168][a]]=43008+a;e[43008+a]=t[168][a]}t[169]=\"\".split(\"\");for(a=0;a!=t[169].length;++a)if(t[169][a].charCodeAt(0)!==65533){r[t[169][a]]=43264+a;e[43264+a]=t[169][a]}t[170]=\"\".split(\"\");for(a=0;a!=t[170].length;++a)if(t[170][a].charCodeAt(0)!==65533){r[t[170][a]]=43520+a;e[43520+a]=t[170][a]}t[171]=\"\".split(\"\");for(a=0;a!=t[171].length;++a)if(t[171][a].charCodeAt(0)!==65533){r[t[171][a]]=43776+a;e[43776+a]=t[171][a]}t[172]=\"\".split(\"\");for(a=0;a!=t[172].length;++a)if(t[172][a].charCodeAt(0)!==65533){r[t[172][a]]=44032+a;e[44032+a]=t[172][a]}t[173]=\"\".split(\"\");for(a=0;a!=t[173].length;++a)if(t[173][a].charCodeAt(0)!==65533){r[t[173][a]]=44288+a;e[44288+a]=t[173][a]}t[174]=\"\".split(\"\");for(a=0;a!=t[174].length;++a)if(t[174][a].charCodeAt(0)!==65533){r[t[174][a]]=44544+a;e[44544+a]=t[174][a]}t[175]=\"\".split(\"\");for(a=0;a!=t[175].length;++a)if(t[175][a].charCodeAt(0)!==65533){r[t[175][a]]=44800+a;e[44800+a]=t[175][a]}t[176]=\"\".split(\"\");for(a=0;a!=t[176].length;++a)if(t[176][a].charCodeAt(0)!==65533){r[t[176][a]]=45056+a;e[45056+a]=t[176][a]}t[177]=\"\".split(\"\");for(a=0;a!=t[177].length;++a)if(t[177][a].charCodeAt(0)!==65533){r[t[177][a]]=45312+a;e[45312+a]=t[177][a]}t[178]=\"\".split(\"\");for(a=0;a!=t[178].length;++a)if(t[178][a].charCodeAt(0)!==65533){r[t[178][a]]=45568+a;e[45568+a]=t[178][a]}t[179]=\"\".split(\"\");for(a=0;a!=t[179].length;++a)if(t[179][a].charCodeAt(0)!==65533){r[t[179][a]]=45824+a;e[45824+a]=t[179][a]}t[180]=\"\".split(\"\");for(a=0;a!=t[180].length;++a)if(t[180][a].charCodeAt(0)!==65533){r[t[180][a]]=46080+a;e[46080+a]=t[180][a]}t[181]=\"\".split(\"\");for(a=0;a!=t[181].length;++a)if(t[181][a].charCodeAt(0)!==65533){r[t[181][a]]=46336+a;e[46336+a]=t[181][a]}t[182]=\"\".split(\"\");for(a=0;a!=t[182].length;++a)if(t[182][a].charCodeAt(0)!==65533){r[t[182][a]]=46592+a;e[46592+a]=t[182][a]}t[183]=\"\".split(\"\");for(a=0;a!=t[183].length;++a)if(t[183][a].charCodeAt(0)!==65533){r[t[183][a]]=46848+a;e[46848+a]=t[183][a]}t[184]=\"\".split(\"\");for(a=0;a!=t[184].length;++a)if(t[184][a].charCodeAt(0)!==65533){r[t[184][a]]=47104+a;e[47104+a]=t[184][a]}t[185]=\"\".split(\"\");for(a=0;a!=t[185].length;++a)if(t[185][a].charCodeAt(0)!==65533){r[t[185][a]]=47360+a;e[47360+a]=t[185][a]}t[186]=\"\".split(\"\");for(a=0;a!=t[186].length;++a)if(t[186][a].charCodeAt(0)!==65533){r[t[186][a]]=47616+a;e[47616+a]=t[186][a]}t[187]=\"\".split(\"\");for(a=0;a!=t[187].length;++a)if(t[187][a].charCodeAt(0)!==65533){r[t[187][a]]=47872+a;e[47872+a]=t[187][a]}t[188]=\"\".split(\"\");for(a=0;a!=t[188].length;++a)if(t[188][a].charCodeAt(0)!==65533){r[t[188][a]]=48128+a;e[48128+a]=t[188][a]}t[189]=\"\".split(\"\");for(a=0;a!=t[189].length;++a)if(t[189][a].charCodeAt(0)!==65533){r[t[189][a]]=48384+a;e[48384+a]=t[189][a]}t[190]=\"\".split(\"\");for(a=0;a!=t[190].length;++a)if(t[190][a].charCodeAt(0)!==65533){r[t[190][a]]=48640+a;e[48640+a]=t[190][a]}t[191]=\"\".split(\"\");for(a=0;a!=t[191].length;++a)if(t[191][a].charCodeAt(0)!==65533){r[t[191][a]]=48896+a;e[48896+a]=t[191][a]}t[192]=\"\".split(\"\");for(a=0;a!=t[192].length;++a)if(t[192][a].charCodeAt(0)!==65533){r[t[192][a]]=49152+a;e[49152+a]=t[192][a]}t[193]=\"\".split(\"\");for(a=0;a!=t[193].length;++a)if(t[193][a].charCodeAt(0)!==65533){r[t[193][a]]=49408+a;e[49408+a]=t[193][a]}t[194]=\"\".split(\"\");for(a=0;a!=t[194].length;++a)if(t[194][a].charCodeAt(0)!==65533){r[t[194][a]]=49664+a;e[49664+a]=t[194][a]}t[195]=\"\".split(\"\");for(a=0;a!=t[195].length;++a)if(t[195][a].charCodeAt(0)!==65533){r[t[195][a]]=49920+a;e[49920+a]=t[195][a]}t[196]=\"\".split(\"\");for(a=0;a!=t[196].length;++a)if(t[196][a].charCodeAt(0)!==65533){r[t[196][a]]=50176+a;e[50176+a]=t[196][a]}t[197]=\"\".split(\"\");for(a=0;a!=t[197].length;++a)if(t[197][a].charCodeAt(0)!==65533){r[t[197][a]]=50432+a;e[50432+a]=t[197][a]}t[198]=\"\".split(\"\");for(a=0;a!=t[198].length;++a)if(t[198][a].charCodeAt(0)!==65533){r[t[198][a]]=50688+a;e[50688+a]=t[198][a]}t[199]=\"\".split(\"\");for(a=0;a!=t[199].length;++a)if(t[199][a].charCodeAt(0)!==65533){r[t[199][a]]=50944+a;e[50944+a]=t[199][a]}t[200]=\"\".split(\"\");for(a=0;a!=t[200].length;++a)if(t[200][a].charCodeAt(0)!==65533){r[t[200][a]]=51200+a;e[51200+a]=t[200][a]}t[201]=\"\".split(\"\");for(a=0;a!=t[201].length;++a)if(t[201][a].charCodeAt(0)!==65533){r[t[201][a]]=51456+a;e[51456+a]=t[201][a]}t[202]=\"\".split(\"\");for(a=0;a!=t[202].length;++a)if(t[202][a].charCodeAt(0)!==65533){r[t[202][a]]=51712+a;e[51712+a]=t[202][a]}t[203]=\"\".split(\"\");for(a=0;a!=t[203].length;++a)if(t[203][a].charCodeAt(0)!==65533){r[t[203][a]]=51968+a;e[51968+a]=t[203][a]}t[204]=\"\".split(\"\");for(a=0;a!=t[204].length;++a)if(t[204][a].charCodeAt(0)!==65533){r[t[204][a]]=52224+a;e[52224+a]=t[204][a]}t[205]=\"\".split(\"\");for(a=0;a!=t[205].length;++a)if(t[205][a].charCodeAt(0)!==65533){r[t[205][a]]=52480+a;e[52480+a]=t[205][a]}t[206]=\"\".split(\"\");for(a=0;a!=t[206].length;++a)if(t[206][a].charCodeAt(0)!==65533){r[t[206][a]]=52736+a;e[52736+a]=t[206][a]}t[207]=\"\".split(\"\");for(a=0;a!=t[207].length;++a)if(t[207][a].charCodeAt(0)!==65533){r[t[207][a]]=52992+a;e[52992+a]=t[207][a]}t[208]=\"\".split(\"\");for(a=0;a!=t[208].length;++a)if(t[208][a].charCodeAt(0)!==65533){r[t[208][a]]=53248+a;e[53248+a]=t[208][a]}t[209]=\"\".split(\"\");for(a=0;a!=t[209].length;++a)if(t[209][a].charCodeAt(0)!==65533){r[t[209][a]]=53504+a;e[53504+a]=t[209][a]}t[210]=\"\".split(\"\");for(a=0;a!=t[210].length;++a)if(t[210][a].charCodeAt(0)!==65533){r[t[210][a]]=53760+a;e[53760+a]=t[210][a]}t[211]=\"\".split(\"\");for(a=0;a!=t[211].length;++a)if(t[211][a].charCodeAt(0)!==65533){r[t[211][a]]=54016+a;e[54016+a]=t[211][a]}t[212]=\"\".split(\"\");for(a=0;a!=t[212].length;++a)if(t[212][a].charCodeAt(0)!==65533){r[t[212][a]]=54272+a;e[54272+a]=t[212][a]}t[213]=\"\".split(\"\");for(a=0;a!=t[213].length;++a)if(t[213][a].charCodeAt(0)!==65533){r[t[213][a]]=54528+a;e[54528+a]=t[213][a]}t[214]=\"\".split(\"\");for(a=0;a!=t[214].length;++a)if(t[214][a].charCodeAt(0)!==65533){r[t[214][a]]=54784+a;e[54784+a]=t[214][a]}t[215]=\"\".split(\"\");for(a=0;a!=t[215].length;++a)if(t[215][a].charCodeAt(0)!==65533){r[t[215][a]]=55040+a;e[55040+a]=t[215][a]}t[216]=\"\".split(\"\");for(a=0;a!=t[216].length;++a)if(t[216][a].charCodeAt(0)!==65533){r[t[216][a]]=55296+a;e[55296+a]=t[216][a]}t[217]=\"\".split(\"\");for(a=0;a!=t[217].length;++a)if(t[217][a].charCodeAt(0)!==65533){r[t[217][a]]=55552+a;e[55552+a]=t[217][a]}t[218]=\"\".split(\"\");for(a=0;a!=t[218].length;++a)if(t[218][a].charCodeAt(0)!==65533){r[t[218][a]]=55808+a;e[55808+a]=t[218][a]}t[219]=\"\".split(\"\");for(a=0;a!=t[219].length;++a)if(t[219][a].charCodeAt(0)!==65533){r[t[219][a]]=56064+a;e[56064+a]=t[219][a]}t[220]=\"\".split(\"\");for(a=0;a!=t[220].length;++a)if(t[220][a].charCodeAt(0)!==65533){r[t[220][a]]=56320+a;e[56320+a]=t[220][a]}t[221]=\"\".split(\"\");for(a=0;a!=t[221].length;++a)if(t[221][a].charCodeAt(0)!==65533){r[t[221][a]]=56576+a;e[56576+a]=t[221][a]}t[222]=\"\".split(\"\");for(a=0;a!=t[222].length;++a)if(t[222][a].charCodeAt(0)!==65533){r[t[222][a]]=56832+a;e[56832+a]=t[222][a]}t[223]=\"\".split(\"\");for(a=0;a!=t[223].length;++a)if(t[223][a].charCodeAt(0)!==65533){r[t[223][a]]=57088+a;e[57088+a]=t[223][a]}t[224]=\"\".split(\"\");for(a=0;a!=t[224].length;++a)if(t[224][a].charCodeAt(0)!==65533){r[t[224][a]]=57344+a;e[57344+a]=t[224][a]}t[225]=\"\".split(\"\");for(a=0;a!=t[225].length;++a)if(t[225][a].charCodeAt(0)!==65533){r[t[225][a]]=57600+a;e[57600+a]=t[225][a]}t[226]=\"\".split(\"\");for(a=0;a!=t[226].length;++a)if(t[226][a].charCodeAt(0)!==65533){r[t[226][a]]=57856+a;e[57856+a]=t[226][a]}t[227]=\"\".split(\"\");for(a=0;a!=t[227].length;++a)if(t[227][a].charCodeAt(0)!==65533){r[t[227][a]]=58112+a;e[58112+a]=t[227][a]}t[228]=\"\".split(\"\");for(a=0;a!=t[228].length;++a)if(t[228][a].charCodeAt(0)!==65533){r[t[228][a]]=58368+a;e[58368+a]=t[228][a]}t[229]=\"\".split(\"\");for(a=0;a!=t[229].length;++a)if(t[229][a].charCodeAt(0)!==65533){r[t[229][a]]=58624+a;e[58624+a]=t[229][a]}t[230]=\"\".split(\"\");for(a=0;a!=t[230].length;++a)if(t[230][a].charCodeAt(0)!==65533){r[t[230][a]]=58880+a;e[58880+a]=t[230][a]}t[231]=\"\".split(\"\");for(a=0;a!=t[231].length;++a)if(t[231][a].charCodeAt(0)!==65533){r[t[231][a]]=59136+a;e[59136+a]=t[231][a]}t[232]=\"\".split(\"\");for(a=0;a!=t[232].length;++a)if(t[232][a].charCodeAt(0)!==65533){r[t[232][a]]=59392+a;e[59392+a]=t[232][a]}t[233]=\"\".split(\"\");for(a=0;a!=t[233].length;++a)if(t[233][a].charCodeAt(0)!==65533){r[t[233][a]]=59648+a;e[59648+a]=t[233][a]}t[234]=\"\".split(\"\");for(a=0;a!=t[234].length;++a)if(t[234][a].charCodeAt(0)!==65533){r[t[234][a]]=59904+a;e[59904+a]=t[234][a]}t[235]=\"\".split(\"\");for(a=0;a!=t[235].length;++a)if(t[235][a].charCodeAt(0)!==65533){r[t[235][a]]=60160+a;e[60160+a]=t[235][a]}t[236]=\"\".split(\"\");\nfor(a=0;a!=t[236].length;++a)if(t[236][a].charCodeAt(0)!==65533){r[t[236][a]]=60416+a;e[60416+a]=t[236][a]}t[237]=\"\".split(\"\");for(a=0;a!=t[237].length;++a)if(t[237][a].charCodeAt(0)!==65533){r[t[237][a]]=60672+a;e[60672+a]=t[237][a]}t[238]=\"\".split(\"\");for(a=0;a!=t[238].length;++a)if(t[238][a].charCodeAt(0)!==65533){r[t[238][a]]=60928+a;e[60928+a]=t[238][a]}t[239]=\"\".split(\"\");for(a=0;a!=t[239].length;++a)if(t[239][a].charCodeAt(0)!==65533){r[t[239][a]]=61184+a;e[61184+a]=t[239][a]}t[240]=\"\".split(\"\");for(a=0;a!=t[240].length;++a)if(t[240][a].charCodeAt(0)!==65533){r[t[240][a]]=61440+a;e[61440+a]=t[240][a]}t[241]=\"\".split(\"\");for(a=0;a!=t[241].length;++a)if(t[241][a].charCodeAt(0)!==65533){r[t[241][a]]=61696+a;e[61696+a]=t[241][a]}t[242]=\"\".split(\"\");for(a=0;a!=t[242].length;++a)if(t[242][a].charCodeAt(0)!==65533){r[t[242][a]]=61952+a;e[61952+a]=t[242][a]}t[243]=\"\".split(\"\");for(a=0;a!=t[243].length;++a)if(t[243][a].charCodeAt(0)!==65533){r[t[243][a]]=62208+a;e[62208+a]=t[243][a]}t[244]=\"\".split(\"\");for(a=0;a!=t[244].length;++a)if(t[244][a].charCodeAt(0)!==65533){r[t[244][a]]=62464+a;e[62464+a]=t[244][a]}t[245]=\"\".split(\"\");for(a=0;a!=t[245].length;++a)if(t[245][a].charCodeAt(0)!==65533){r[t[245][a]]=62720+a;e[62720+a]=t[245][a]}t[246]=\"\".split(\"\");for(a=0;a!=t[246].length;++a)if(t[246][a].charCodeAt(0)!==65533){r[t[246][a]]=62976+a;e[62976+a]=t[246][a]}t[247]=\"\".split(\"\");for(a=0;a!=t[247].length;++a)if(t[247][a].charCodeAt(0)!==65533){r[t[247][a]]=63232+a;e[63232+a]=t[247][a]}t[248]=\"\".split(\"\");for(a=0;a!=t[248].length;++a)if(t[248][a].charCodeAt(0)!==65533){r[t[248][a]]=63488+a;e[63488+a]=t[248][a]}t[249]=\"\".split(\"\");for(a=0;a!=t[249].length;++a)if(t[249][a].charCodeAt(0)!==65533){r[t[249][a]]=63744+a;e[63744+a]=t[249][a]}t[250]=\"\".split(\"\");for(a=0;a!=t[250].length;++a)if(t[250][a].charCodeAt(0)!==65533){r[t[250][a]]=64e3+a;e[64e3+a]=t[250][a]}t[251]=\"\".split(\"\");for(a=0;a!=t[251].length;++a)if(t[251][a].charCodeAt(0)!==65533){r[t[251][a]]=64256+a;e[64256+a]=t[251][a]}t[252]=\"\".split(\"\");for(a=0;a!=t[252].length;++a)if(t[252][a].charCodeAt(0)!==65533){r[t[252][a]]=64512+a;e[64512+a]=t[252][a]}t[253]=\"\".split(\"\");for(a=0;a!=t[253].length;++a)if(t[253][a].charCodeAt(0)!==65533){r[t[253][a]]=64768+a;e[64768+a]=t[253][a]}t[254]=\"\".split(\"\");for(a=0;a!=t[254].length;++a)if(t[254][a].charCodeAt(0)!==65533){r[t[254][a]]=65024+a;e[65024+a]=t[254][a]}return{enc:r,dec:e}}();cptable[949]=function(){var e=[],r={},t=[],a;t[0]=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");for(a=0;a!=t[0].length;++a)if(t[0][a].charCodeAt(0)!==65533){r[t[0][a]]=0+a;e[0+a]=t[0][a]}t[129]=\"\".split(\"\");for(a=0;a!=t[129].length;++a)if(t[129][a].charCodeAt(0)!==65533){r[t[129][a]]=33024+a;e[33024+a]=t[129][a]}t[130]=\"\".split(\"\");for(a=0;a!=t[130].length;++a)if(t[130][a].charCodeAt(0)!==65533){r[t[130][a]]=33280+a;e[33280+a]=t[130][a]}t[131]=\"\".split(\"\");for(a=0;a!=t[131].length;++a)if(t[131][a].charCodeAt(0)!==65533){r[t[131][a]]=33536+a;e[33536+a]=t[131][a]}t[132]=\"\".split(\"\");for(a=0;a!=t[132].length;++a)if(t[132][a].charCodeAt(0)!==65533){r[t[132][a]]=33792+a;e[33792+a]=t[132][a]}t[133]=\"\".split(\"\");for(a=0;a!=t[133].length;++a)if(t[133][a].charCodeAt(0)!==65533){r[t[133][a]]=34048+a;e[34048+a]=t[133][a]}t[134]=\"\".split(\"\");for(a=0;a!=t[134].length;++a)if(t[134][a].charCodeAt(0)!==65533){r[t[134][a]]=34304+a;e[34304+a]=t[134][a]}t[135]=\"\".split(\"\");for(a=0;a!=t[135].length;++a)if(t[135][a].charCodeAt(0)!==65533){r[t[135][a]]=34560+a;e[34560+a]=t[135][a]}t[136]=\"\".split(\"\");for(a=0;a!=t[136].length;++a)if(t[136][a].charCodeAt(0)!==65533){r[t[136][a]]=34816+a;e[34816+a]=t[136][a]}t[137]=\"\".split(\"\");for(a=0;a!=t[137].length;++a)if(t[137][a].charCodeAt(0)!==65533){r[t[137][a]]=35072+a;e[35072+a]=t[137][a]}t[138]=\"\".split(\"\");for(a=0;a!=t[138].length;++a)if(t[138][a].charCodeAt(0)!==65533){r[t[138][a]]=35328+a;e[35328+a]=t[138][a]}t[139]=\"\".split(\"\");for(a=0;a!=t[139].length;++a)if(t[139][a].charCodeAt(0)!==65533){r[t[139][a]]=35584+a;e[35584+a]=t[139][a]}t[140]=\"\".split(\"\");for(a=0;a!=t[140].length;++a)if(t[140][a].charCodeAt(0)!==65533){r[t[140][a]]=35840+a;e[35840+a]=t[140][a]}t[141]=\"\".split(\"\");for(a=0;a!=t[141].length;++a)if(t[141][a].charCodeAt(0)!==65533){r[t[141][a]]=36096+a;e[36096+a]=t[141][a]}t[142]=\"\".split(\"\");for(a=0;a!=t[142].length;++a)if(t[142][a].charCodeAt(0)!==65533){r[t[142][a]]=36352+a;e[36352+a]=t[142][a]}t[143]=\"\".split(\"\");for(a=0;a!=t[143].length;++a)if(t[143][a].charCodeAt(0)!==65533){r[t[143][a]]=36608+a;e[36608+a]=t[143][a]}t[144]=\"\".split(\"\");for(a=0;a!=t[144].length;++a)if(t[144][a].charCodeAt(0)!==65533){r[t[144][a]]=36864+a;e[36864+a]=t[144][a]}t[145]=\"\".split(\"\");for(a=0;a!=t[145].length;++a)if(t[145][a].charCodeAt(0)!==65533){r[t[145][a]]=37120+a;e[37120+a]=t[145][a]}t[146]=\"\".split(\"\");for(a=0;a!=t[146].length;++a)if(t[146][a].charCodeAt(0)!==65533){r[t[146][a]]=37376+a;e[37376+a]=t[146][a]}t[147]=\"\".split(\"\");for(a=0;a!=t[147].length;++a)if(t[147][a].charCodeAt(0)!==65533){r[t[147][a]]=37632+a;e[37632+a]=t[147][a]}t[148]=\"\".split(\"\");for(a=0;a!=t[148].length;++a)if(t[148][a].charCodeAt(0)!==65533){r[t[148][a]]=37888+a;e[37888+a]=t[148][a]}t[149]=\"\".split(\"\");for(a=0;a!=t[149].length;++a)if(t[149][a].charCodeAt(0)!==65533){r[t[149][a]]=38144+a;e[38144+a]=t[149][a]}t[150]=\"\".split(\"\");for(a=0;a!=t[150].length;++a)if(t[150][a].charCodeAt(0)!==65533){r[t[150][a]]=38400+a;e[38400+a]=t[150][a]}t[151]=\"\".split(\"\");for(a=0;a!=t[151].length;++a)if(t[151][a].charCodeAt(0)!==65533){r[t[151][a]]=38656+a;e[38656+a]=t[151][a]}t[152]=\"\".split(\"\");for(a=0;a!=t[152].length;++a)if(t[152][a].charCodeAt(0)!==65533){r[t[152][a]]=38912+a;e[38912+a]=t[152][a]}t[153]=\"\".split(\"\");for(a=0;a!=t[153].length;++a)if(t[153][a].charCodeAt(0)!==65533){r[t[153][a]]=39168+a;e[39168+a]=t[153][a]}t[154]=\"\".split(\"\");for(a=0;a!=t[154].length;++a)if(t[154][a].charCodeAt(0)!==65533){r[t[154][a]]=39424+a;e[39424+a]=t[154][a]}t[155]=\"\".split(\"\");for(a=0;a!=t[155].length;++a)if(t[155][a].charCodeAt(0)!==65533){r[t[155][a]]=39680+a;e[39680+a]=t[155][a]}t[156]=\"\".split(\"\");for(a=0;a!=t[156].length;++a)if(t[156][a].charCodeAt(0)!==65533){r[t[156][a]]=39936+a;e[39936+a]=t[156][a]}t[157]=\"\".split(\"\");for(a=0;a!=t[157].length;++a)if(t[157][a].charCodeAt(0)!==65533){r[t[157][a]]=40192+a;e[40192+a]=t[157][a]}t[158]=\"\".split(\"\");for(a=0;a!=t[158].length;++a)if(t[158][a].charCodeAt(0)!==65533){r[t[158][a]]=40448+a;e[40448+a]=t[158][a]}t[159]=\"\".split(\"\");for(a=0;a!=t[159].length;++a)if(t[159][a].charCodeAt(0)!==65533){r[t[159][a]]=40704+a;e[40704+a]=t[159][a]}t[160]=\"\".split(\"\");for(a=0;a!=t[160].length;++a)if(t[160][a].charCodeAt(0)!==65533){r[t[160][a]]=40960+a;e[40960+a]=t[160][a]}t[161]=\"\".split(\"\");for(a=0;a!=t[161].length;++a)if(t[161][a].charCodeAt(0)!==65533){r[t[161][a]]=41216+a;e[41216+a]=t[161][a]}t[162]=\"\".split(\"\");for(a=0;a!=t[162].length;++a)if(t[162][a].charCodeAt(0)!==65533){r[t[162][a]]=41472+a;e[41472+a]=t[162][a]}t[163]=\"\".split(\"\");for(a=0;a!=t[163].length;++a)if(t[163][a].charCodeAt(0)!==65533){r[t[163][a]]=41728+a;e[41728+a]=t[163][a]}t[164]=\"\".split(\"\");for(a=0;a!=t[164].length;++a)if(t[164][a].charCodeAt(0)!==65533){r[t[164][a]]=41984+a;e[41984+a]=t[164][a]}t[165]=\"\".split(\"\");for(a=0;a!=t[165].length;++a)if(t[165][a].charCodeAt(0)!==65533){r[t[165][a]]=42240+a;e[42240+a]=t[165][a]}t[166]=\"\".split(\"\");for(a=0;a!=t[166].length;++a)if(t[166][a].charCodeAt(0)!==65533){r[t[166][a]]=42496+a;e[42496+a]=t[166][a]}t[167]=\"\".split(\"\");for(a=0;a!=t[167].length;++a)if(t[167][a].charCodeAt(0)!==65533){r[t[167][a]]=42752+a;e[42752+a]=t[167][a]}t[168]=\"\".split(\"\");for(a=0;a!=t[168].length;++a)if(t[168][a].charCodeAt(0)!==65533){r[t[168][a]]=43008+a;e[43008+a]=t[168][a]}t[169]=\"\".split(\"\");for(a=0;a!=t[169].length;++a)if(t[169][a].charCodeAt(0)!==65533){r[t[169][a]]=43264+a;e[43264+a]=t[169][a]}t[170]=\"\".split(\"\");for(a=0;a!=t[170].length;++a)if(t[170][a].charCodeAt(0)!==65533){r[t[170][a]]=43520+a;e[43520+a]=t[170][a]}t[171]=\"\".split(\"\");for(a=0;a!=t[171].length;++a)if(t[171][a].charCodeAt(0)!==65533){r[t[171][a]]=43776+a;e[43776+a]=t[171][a]}t[172]=\"\".split(\"\");for(a=0;a!=t[172].length;++a)if(t[172][a].charCodeAt(0)!==65533){r[t[172][a]]=44032+a;e[44032+a]=t[172][a]}t[173]=\"\".split(\"\");for(a=0;a!=t[173].length;++a)if(t[173][a].charCodeAt(0)!==65533){r[t[173][a]]=44288+a;e[44288+a]=t[173][a]}t[174]=\"\".split(\"\");for(a=0;a!=t[174].length;++a)if(t[174][a].charCodeAt(0)!==65533){r[t[174][a]]=44544+a;e[44544+a]=t[174][a]}t[175]=\"\".split(\"\");for(a=0;a!=t[175].length;++a)if(t[175][a].charCodeAt(0)!==65533){r[t[175][a]]=44800+a;e[44800+a]=t[175][a]}t[176]=\"\".split(\"\");for(a=0;a!=t[176].length;++a)if(t[176][a].charCodeAt(0)!==65533){r[t[176][a]]=45056+a;e[45056+a]=t[176][a]}t[177]=\"\".split(\"\");for(a=0;a!=t[177].length;++a)if(t[177][a].charCodeAt(0)!==65533){r[t[177][a]]=45312+a;e[45312+a]=t[177][a]}t[178]=\"\".split(\"\");for(a=0;a!=t[178].length;++a)if(t[178][a].charCodeAt(0)!==65533){r[t[178][a]]=45568+a;e[45568+a]=t[178][a]}t[179]=\"\".split(\"\");for(a=0;a!=t[179].length;++a)if(t[179][a].charCodeAt(0)!==65533){r[t[179][a]]=45824+a;e[45824+a]=t[179][a]}t[180]=\"\".split(\"\");for(a=0;a!=t[180].length;++a)if(t[180][a].charCodeAt(0)!==65533){r[t[180][a]]=46080+a;e[46080+a]=t[180][a]}t[181]=\"\".split(\"\");for(a=0;a!=t[181].length;++a)if(t[181][a].charCodeAt(0)!==65533){r[t[181][a]]=46336+a;e[46336+a]=t[181][a]}t[182]=\"\".split(\"\");for(a=0;a!=t[182].length;++a)if(t[182][a].charCodeAt(0)!==65533){r[t[182][a]]=46592+a;e[46592+a]=t[182][a]}t[183]=\"\".split(\"\");for(a=0;a!=t[183].length;++a)if(t[183][a].charCodeAt(0)!==65533){r[t[183][a]]=46848+a;e[46848+a]=t[183][a]}t[184]=\"\".split(\"\");for(a=0;a!=t[184].length;++a)if(t[184][a].charCodeAt(0)!==65533){r[t[184][a]]=47104+a;e[47104+a]=t[184][a]}t[185]=\"\".split(\"\");for(a=0;a!=t[185].length;++a)if(t[185][a].charCodeAt(0)!==65533){r[t[185][a]]=47360+a;e[47360+a]=t[185][a]}t[186]=\"\".split(\"\");for(a=0;a!=t[186].length;++a)if(t[186][a].charCodeAt(0)!==65533){r[t[186][a]]=47616+a;e[47616+a]=t[186][a]}t[187]=\"\".split(\"\");for(a=0;a!=t[187].length;++a)if(t[187][a].charCodeAt(0)!==65533){r[t[187][a]]=47872+a;e[47872+a]=t[187][a]}t[188]=\"\".split(\"\");for(a=0;a!=t[188].length;++a)if(t[188][a].charCodeAt(0)!==65533){r[t[188][a]]=48128+a;e[48128+a]=t[188][a]}t[189]=\"\".split(\"\");for(a=0;a!=t[189].length;++a)if(t[189][a].charCodeAt(0)!==65533){r[t[189][a]]=48384+a;e[48384+a]=t[189][a]}t[190]=\"\".split(\"\");for(a=0;a!=t[190].length;++a)if(t[190][a].charCodeAt(0)!==65533){r[t[190][a]]=48640+a;e[48640+a]=t[190][a]}t[191]=\"\".split(\"\");for(a=0;a!=t[191].length;++a)if(t[191][a].charCodeAt(0)!==65533){r[t[191][a]]=48896+a;e[48896+a]=t[191][a]}t[192]=\"\".split(\"\");for(a=0;a!=t[192].length;++a)if(t[192][a].charCodeAt(0)!==65533){r[t[192][a]]=49152+a;e[49152+a]=t[192][a]}t[193]=\"\".split(\"\");\nfor(a=0;a!=t[193].length;++a)if(t[193][a].charCodeAt(0)!==65533){r[t[193][a]]=49408+a;e[49408+a]=t[193][a]}t[194]=\"\".split(\"\");for(a=0;a!=t[194].length;++a)if(t[194][a].charCodeAt(0)!==65533){r[t[194][a]]=49664+a;e[49664+a]=t[194][a]}t[195]=\"\".split(\"\");for(a=0;a!=t[195].length;++a)if(t[195][a].charCodeAt(0)!==65533){r[t[195][a]]=49920+a;e[49920+a]=t[195][a]}t[196]=\"\".split(\"\");for(a=0;a!=t[196].length;++a)if(t[196][a].charCodeAt(0)!==65533){r[t[196][a]]=50176+a;e[50176+a]=t[196][a]}t[197]=\"\".split(\"\");for(a=0;a!=t[197].length;++a)if(t[197][a].charCodeAt(0)!==65533){r[t[197][a]]=50432+a;e[50432+a]=t[197][a]}t[198]=\"\".split(\"\");for(a=0;a!=t[198].length;++a)if(t[198][a].charCodeAt(0)!==65533){r[t[198][a]]=50688+a;e[50688+a]=t[198][a]}t[199]=\"\".split(\"\");for(a=0;a!=t[199].length;++a)if(t[199][a].charCodeAt(0)!==65533){r[t[199][a]]=50944+a;e[50944+a]=t[199][a]}t[200]=\"\".split(\"\");for(a=0;a!=t[200].length;++a)if(t[200][a].charCodeAt(0)!==65533){r[t[200][a]]=51200+a;e[51200+a]=t[200][a]}t[202]=\"\".split(\"\");for(a=0;a!=t[202].length;++a)if(t[202][a].charCodeAt(0)!==65533){r[t[202][a]]=51712+a;e[51712+a]=t[202][a]}t[203]=\"\".split(\"\");for(a=0;a!=t[203].length;++a)if(t[203][a].charCodeAt(0)!==65533){r[t[203][a]]=51968+a;e[51968+a]=t[203][a]}t[204]=\"\".split(\"\");for(a=0;a!=t[204].length;++a)if(t[204][a].charCodeAt(0)!==65533){r[t[204][a]]=52224+a;e[52224+a]=t[204][a]}t[205]=\"\".split(\"\");for(a=0;a!=t[205].length;++a)if(t[205][a].charCodeAt(0)!==65533){r[t[205][a]]=52480+a;e[52480+a]=t[205][a]}t[206]=\"\".split(\"\");for(a=0;a!=t[206].length;++a)if(t[206][a].charCodeAt(0)!==65533){r[t[206][a]]=52736+a;e[52736+a]=t[206][a]}t[207]=\"\".split(\"\");for(a=0;a!=t[207].length;++a)if(t[207][a].charCodeAt(0)!==65533){r[t[207][a]]=52992+a;e[52992+a]=t[207][a]}t[208]=\"\".split(\"\");for(a=0;a!=t[208].length;++a)if(t[208][a].charCodeAt(0)!==65533){r[t[208][a]]=53248+a;e[53248+a]=t[208][a]}t[209]=\"\".split(\"\");for(a=0;a!=t[209].length;++a)if(t[209][a].charCodeAt(0)!==65533){r[t[209][a]]=53504+a;e[53504+a]=t[209][a]}t[210]=\"\".split(\"\");for(a=0;a!=t[210].length;++a)if(t[210][a].charCodeAt(0)!==65533){r[t[210][a]]=53760+a;e[53760+a]=t[210][a]}t[211]=\"\".split(\"\");for(a=0;a!=t[211].length;++a)if(t[211][a].charCodeAt(0)!==65533){r[t[211][a]]=54016+a;e[54016+a]=t[211][a]}t[212]=\"\".split(\"\");for(a=0;a!=t[212].length;++a)if(t[212][a].charCodeAt(0)!==65533){r[t[212][a]]=54272+a;e[54272+a]=t[212][a]}t[213]=\"\".split(\"\");for(a=0;a!=t[213].length;++a)if(t[213][a].charCodeAt(0)!==65533){r[t[213][a]]=54528+a;e[54528+a]=t[213][a]}t[214]=\"\".split(\"\");for(a=0;a!=t[214].length;++a)if(t[214][a].charCodeAt(0)!==65533){r[t[214][a]]=54784+a;e[54784+a]=t[214][a]}t[215]=\"\".split(\"\");for(a=0;a!=t[215].length;++a)if(t[215][a].charCodeAt(0)!==65533){r[t[215][a]]=55040+a;e[55040+a]=t[215][a]}t[216]=\"\".split(\"\");for(a=0;a!=t[216].length;++a)if(t[216][a].charCodeAt(0)!==65533){r[t[216][a]]=55296+a;e[55296+a]=t[216][a]}t[217]=\"\".split(\"\");for(a=0;a!=t[217].length;++a)if(t[217][a].charCodeAt(0)!==65533){r[t[217][a]]=55552+a;e[55552+a]=t[217][a]}t[218]=\"\".split(\"\");for(a=0;a!=t[218].length;++a)if(t[218][a].charCodeAt(0)!==65533){r[t[218][a]]=55808+a;e[55808+a]=t[218][a]}t[219]=\"\".split(\"\");for(a=0;a!=t[219].length;++a)if(t[219][a].charCodeAt(0)!==65533){r[t[219][a]]=56064+a;e[56064+a]=t[219][a]}t[220]=\"\".split(\"\");for(a=0;a!=t[220].length;++a)if(t[220][a].charCodeAt(0)!==65533){r[t[220][a]]=56320+a;e[56320+a]=t[220][a]}t[221]=\"\".split(\"\");for(a=0;a!=t[221].length;++a)if(t[221][a].charCodeAt(0)!==65533){r[t[221][a]]=56576+a;e[56576+a]=t[221][a]}t[222]=\"\".split(\"\");for(a=0;a!=t[222].length;++a)if(t[222][a].charCodeAt(0)!==65533){r[t[222][a]]=56832+a;e[56832+a]=t[222][a]}t[223]=\"\".split(\"\");for(a=0;a!=t[223].length;++a)if(t[223][a].charCodeAt(0)!==65533){r[t[223][a]]=57088+a;e[57088+a]=t[223][a]}t[224]=\"\".split(\"\");for(a=0;a!=t[224].length;++a)if(t[224][a].charCodeAt(0)!==65533){r[t[224][a]]=57344+a;e[57344+a]=t[224][a]}t[225]=\"\".split(\"\");for(a=0;a!=t[225].length;++a)if(t[225][a].charCodeAt(0)!==65533){r[t[225][a]]=57600+a;e[57600+a]=t[225][a]}t[226]=\"\".split(\"\");for(a=0;a!=t[226].length;++a)if(t[226][a].charCodeAt(0)!==65533){r[t[226][a]]=57856+a;e[57856+a]=t[226][a]}t[227]=\"\".split(\"\");for(a=0;a!=t[227].length;++a)if(t[227][a].charCodeAt(0)!==65533){r[t[227][a]]=58112+a;e[58112+a]=t[227][a]}t[228]=\"\".split(\"\");for(a=0;a!=t[228].length;++a)if(t[228][a].charCodeAt(0)!==65533){r[t[228][a]]=58368+a;e[58368+a]=t[228][a]}t[229]=\"\".split(\"\");for(a=0;a!=t[229].length;++a)if(t[229][a].charCodeAt(0)!==65533){r[t[229][a]]=58624+a;e[58624+a]=t[229][a]}t[230]=\"\".split(\"\");for(a=0;a!=t[230].length;++a)if(t[230][a].charCodeAt(0)!==65533){r[t[230][a]]=58880+a;e[58880+a]=t[230][a]}t[231]=\"\".split(\"\");for(a=0;a!=t[231].length;++a)if(t[231][a].charCodeAt(0)!==65533){r[t[231][a]]=59136+a;e[59136+a]=t[231][a]}t[232]=\"\".split(\"\");for(a=0;a!=t[232].length;++a)if(t[232][a].charCodeAt(0)!==65533){r[t[232][a]]=59392+a;e[59392+a]=t[232][a]}t[233]=\"\".split(\"\");for(a=0;a!=t[233].length;++a)if(t[233][a].charCodeAt(0)!==65533){r[t[233][a]]=59648+a;e[59648+a]=t[233][a]}t[234]=\"\".split(\"\");for(a=0;a!=t[234].length;++a)if(t[234][a].charCodeAt(0)!==65533){r[t[234][a]]=59904+a;e[59904+a]=t[234][a]}t[235]=\"\".split(\"\");for(a=0;a!=t[235].length;++a)if(t[235][a].charCodeAt(0)!==65533){r[t[235][a]]=60160+a;e[60160+a]=t[235][a]}t[236]=\"\".split(\"\");for(a=0;a!=t[236].length;++a)if(t[236][a].charCodeAt(0)!==65533){r[t[236][a]]=60416+a;e[60416+a]=t[236][a]}t[237]=\"\".split(\"\");for(a=0;a!=t[237].length;++a)if(t[237][a].charCodeAt(0)!==65533){r[t[237][a]]=60672+a;e[60672+a]=t[237][a]}t[238]=\"\".split(\"\");for(a=0;a!=t[238].length;++a)if(t[238][a].charCodeAt(0)!==65533){r[t[238][a]]=60928+a;e[60928+a]=t[238][a]}t[239]=\"\".split(\"\");for(a=0;a!=t[239].length;++a)if(t[239][a].charCodeAt(0)!==65533){r[t[239][a]]=61184+a;e[61184+a]=t[239][a]}t[240]=\"\".split(\"\");for(a=0;a!=t[240].length;++a)if(t[240][a].charCodeAt(0)!==65533){r[t[240][a]]=61440+a;e[61440+a]=t[240][a]}t[241]=\"\".split(\"\");for(a=0;a!=t[241].length;++a)if(t[241][a].charCodeAt(0)!==65533){r[t[241][a]]=61696+a;e[61696+a]=t[241][a]}t[242]=\"\".split(\"\");for(a=0;a!=t[242].length;++a)if(t[242][a].charCodeAt(0)!==65533){r[t[242][a]]=61952+a;e[61952+a]=t[242][a]}t[243]=\"\".split(\"\");for(a=0;a!=t[243].length;++a)if(t[243][a].charCodeAt(0)!==65533){r[t[243][a]]=62208+a;e[62208+a]=t[243][a]}t[244]=\"\".split(\"\");for(a=0;a!=t[244].length;++a)if(t[244][a].charCodeAt(0)!==65533){r[t[244][a]]=62464+a;e[62464+a]=t[244][a]}t[245]=\"\".split(\"\");for(a=0;a!=t[245].length;++a)if(t[245][a].charCodeAt(0)!==65533){r[t[245][a]]=62720+a;e[62720+a]=t[245][a]}t[246]=\"\".split(\"\");for(a=0;a!=t[246].length;++a)if(t[246][a].charCodeAt(0)!==65533){r[t[246][a]]=62976+a;e[62976+a]=t[246][a]}t[247]=\"\".split(\"\");for(a=0;a!=t[247].length;++a)if(t[247][a].charCodeAt(0)!==65533){r[t[247][a]]=63232+a;e[63232+a]=t[247][a]}t[248]=\"\".split(\"\");for(a=0;a!=t[248].length;++a)if(t[248][a].charCodeAt(0)!==65533){r[t[248][a]]=63488+a;e[63488+a]=t[248][a]}t[249]=\"\".split(\"\");for(a=0;a!=t[249].length;++a)if(t[249][a].charCodeAt(0)!==65533){r[t[249][a]]=63744+a;e[63744+a]=t[249][a]}t[250]=\"\".split(\"\");for(a=0;a!=t[250].length;++a)if(t[250][a].charCodeAt(0)!==65533){r[t[250][a]]=64e3+a;e[64e3+a]=t[250][a]}t[251]=\"\".split(\"\");for(a=0;a!=t[251].length;++a)if(t[251][a].charCodeAt(0)!==65533){r[t[251][a]]=64256+a;e[64256+a]=t[251][a]}t[252]=\"\".split(\"\");for(a=0;a!=t[252].length;++a)if(t[252][a].charCodeAt(0)!==65533){r[t[252][a]]=64512+a;e[64512+a]=t[252][a]}t[253]=\"\".split(\"\");for(a=0;a!=t[253].length;++a)if(t[253][a].charCodeAt(0)!==65533){r[t[253][a]]=64768+a;e[64768+a]=t[253][a]}return{enc:r,dec:e}}();cptable[950]=function(){var e=[],r={},t=[],a;t[0]=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");for(a=0;a!=t[0].length;++a)if(t[0][a].charCodeAt(0)!==65533){r[t[0][a]]=0+a;e[0+a]=t[0][a]}t[161]=\"\".split(\"\");for(a=0;a!=t[161].length;++a)if(t[161][a].charCodeAt(0)!==65533){r[t[161][a]]=41216+a;e[41216+a]=t[161][a]}t[162]=\"\".split(\"\");for(a=0;a!=t[162].length;++a)if(t[162][a].charCodeAt(0)!==65533){r[t[162][a]]=41472+a;e[41472+a]=t[162][a]}t[163]=\"\".split(\"\");for(a=0;a!=t[163].length;++a)if(t[163][a].charCodeAt(0)!==65533){r[t[163][a]]=41728+a;e[41728+a]=t[163][a]}t[164]=\"\".split(\"\");for(a=0;a!=t[164].length;++a)if(t[164][a].charCodeAt(0)!==65533){r[t[164][a]]=41984+a;e[41984+a]=t[164][a]}t[165]=\"\".split(\"\");for(a=0;a!=t[165].length;++a)if(t[165][a].charCodeAt(0)!==65533){r[t[165][a]]=42240+a;e[42240+a]=t[165][a]}t[166]=\"\".split(\"\");for(a=0;a!=t[166].length;++a)if(t[166][a].charCodeAt(0)!==65533){r[t[166][a]]=42496+a;e[42496+a]=t[166][a]}t[167]=\"\".split(\"\");for(a=0;a!=t[167].length;++a)if(t[167][a].charCodeAt(0)!==65533){r[t[167][a]]=42752+a;e[42752+a]=t[167][a]}t[168]=\"\".split(\"\");for(a=0;a!=t[168].length;++a)if(t[168][a].charCodeAt(0)!==65533){r[t[168][a]]=43008+a;e[43008+a]=t[168][a]}t[169]=\"\".split(\"\");for(a=0;a!=t[169].length;++a)if(t[169][a].charCodeAt(0)!==65533){r[t[169][a]]=43264+a;e[43264+a]=t[169][a]}t[170]=\"\".split(\"\");for(a=0;a!=t[170].length;++a)if(t[170][a].charCodeAt(0)!==65533){r[t[170][a]]=43520+a;e[43520+a]=t[170][a]}t[171]=\"\".split(\"\");for(a=0;a!=t[171].length;++a)if(t[171][a].charCodeAt(0)!==65533){r[t[171][a]]=43776+a;e[43776+a]=t[171][a]}t[172]=\"\".split(\"\");for(a=0;a!=t[172].length;++a)if(t[172][a].charCodeAt(0)!==65533){r[t[172][a]]=44032+a;e[44032+a]=t[172][a]}t[173]=\"\".split(\"\");for(a=0;a!=t[173].length;++a)if(t[173][a].charCodeAt(0)!==65533){r[t[173][a]]=44288+a;e[44288+a]=t[173][a]}t[174]=\"\".split(\"\");for(a=0;a!=t[174].length;++a)if(t[174][a].charCodeAt(0)!==65533){r[t[174][a]]=44544+a;e[44544+a]=t[174][a]}t[175]=\"\".split(\"\");for(a=0;a!=t[175].length;++a)if(t[175][a].charCodeAt(0)!==65533){r[t[175][a]]=44800+a;e[44800+a]=t[175][a]}t[176]=\"\".split(\"\");for(a=0;a!=t[176].length;++a)if(t[176][a].charCodeAt(0)!==65533){r[t[176][a]]=45056+a;e[45056+a]=t[176][a]}t[177]=\"\".split(\"\");for(a=0;a!=t[177].length;++a)if(t[177][a].charCodeAt(0)!==65533){r[t[177][a]]=45312+a;e[45312+a]=t[177][a]}t[178]=\"\".split(\"\");for(a=0;a!=t[178].length;++a)if(t[178][a].charCodeAt(0)!==65533){r[t[178][a]]=45568+a;e[45568+a]=t[178][a]}t[179]=\"\".split(\"\");for(a=0;a!=t[179].length;++a)if(t[179][a].charCodeAt(0)!==65533){r[t[179][a]]=45824+a;e[45824+a]=t[179][a]}t[180]=\"\".split(\"\");for(a=0;a!=t[180].length;++a)if(t[180][a].charCodeAt(0)!==65533){r[t[180][a]]=46080+a;e[46080+a]=t[180][a]}t[181]=\"\".split(\"\");for(a=0;a!=t[181].length;++a)if(t[181][a].charCodeAt(0)!==65533){r[t[181][a]]=46336+a;e[46336+a]=t[181][a]}t[182]=\"\".split(\"\");for(a=0;a!=t[182].length;++a)if(t[182][a].charCodeAt(0)!==65533){r[t[182][a]]=46592+a;e[46592+a]=t[182][a]}t[183]=\"\".split(\"\");for(a=0;a!=t[183].length;++a)if(t[183][a].charCodeAt(0)!==65533){r[t[183][a]]=46848+a;e[46848+a]=t[183][a]}t[184]=\"\".split(\"\");\nfor(a=0;a!=t[184].length;++a)if(t[184][a].charCodeAt(0)!==65533){r[t[184][a]]=47104+a;e[47104+a]=t[184][a]}t[185]=\"\".split(\"\");for(a=0;a!=t[185].length;++a)if(t[185][a].charCodeAt(0)!==65533){r[t[185][a]]=47360+a;e[47360+a]=t[185][a]}t[186]=\"\".split(\"\");for(a=0;a!=t[186].length;++a)if(t[186][a].charCodeAt(0)!==65533){r[t[186][a]]=47616+a;e[47616+a]=t[186][a]}t[187]=\"\".split(\"\");for(a=0;a!=t[187].length;++a)if(t[187][a].charCodeAt(0)!==65533){r[t[187][a]]=47872+a;e[47872+a]=t[187][a]}t[188]=\"\".split(\"\");for(a=0;a!=t[188].length;++a)if(t[188][a].charCodeAt(0)!==65533){r[t[188][a]]=48128+a;e[48128+a]=t[188][a]}t[189]=\"\".split(\"\");for(a=0;a!=t[189].length;++a)if(t[189][a].charCodeAt(0)!==65533){r[t[189][a]]=48384+a;e[48384+a]=t[189][a]}t[190]=\"\".split(\"\");for(a=0;a!=t[190].length;++a)if(t[190][a].charCodeAt(0)!==65533){r[t[190][a]]=48640+a;e[48640+a]=t[190][a]}t[191]=\"\".split(\"\");for(a=0;a!=t[191].length;++a)if(t[191][a].charCodeAt(0)!==65533){r[t[191][a]]=48896+a;e[48896+a]=t[191][a]}t[192]=\"\".split(\"\");for(a=0;a!=t[192].length;++a)if(t[192][a].charCodeAt(0)!==65533){r[t[192][a]]=49152+a;e[49152+a]=t[192][a]}t[193]=\"\".split(\"\");for(a=0;a!=t[193].length;++a)if(t[193][a].charCodeAt(0)!==65533){r[t[193][a]]=49408+a;e[49408+a]=t[193][a]}t[194]=\"\".split(\"\");for(a=0;a!=t[194].length;++a)if(t[194][a].charCodeAt(0)!==65533){r[t[194][a]]=49664+a;e[49664+a]=t[194][a]}t[195]=\"\".split(\"\");for(a=0;a!=t[195].length;++a)if(t[195][a].charCodeAt(0)!==65533){r[t[195][a]]=49920+a;e[49920+a]=t[195][a]}t[196]=\"\".split(\"\");for(a=0;a!=t[196].length;++a)if(t[196][a].charCodeAt(0)!==65533){r[t[196][a]]=50176+a;e[50176+a]=t[196][a]}t[197]=\"\".split(\"\");for(a=0;a!=t[197].length;++a)if(t[197][a].charCodeAt(0)!==65533){r[t[197][a]]=50432+a;e[50432+a]=t[197][a]}t[198]=\"\".split(\"\");for(a=0;a!=t[198].length;++a)if(t[198][a].charCodeAt(0)!==65533){r[t[198][a]]=50688+a;e[50688+a]=t[198][a]}t[201]=\"\".split(\"\");for(a=0;a!=t[201].length;++a)if(t[201][a].charCodeAt(0)!==65533){r[t[201][a]]=51456+a;e[51456+a]=t[201][a]}t[202]=\"\".split(\"\");for(a=0;a!=t[202].length;++a)if(t[202][a].charCodeAt(0)!==65533){r[t[202][a]]=51712+a;e[51712+a]=t[202][a]}t[203]=\"\".split(\"\");for(a=0;a!=t[203].length;++a)if(t[203][a].charCodeAt(0)!==65533){r[t[203][a]]=51968+a;e[51968+a]=t[203][a]}t[204]=\"\".split(\"\");for(a=0;a!=t[204].length;++a)if(t[204][a].charCodeAt(0)!==65533){r[t[204][a]]=52224+a;e[52224+a]=t[204][a]}t[205]=\"\".split(\"\");for(a=0;a!=t[205].length;++a)if(t[205][a].charCodeAt(0)!==65533){r[t[205][a]]=52480+a;e[52480+a]=t[205][a]}t[206]=\"\".split(\"\");for(a=0;a!=t[206].length;++a)if(t[206][a].charCodeAt(0)!==65533){r[t[206][a]]=52736+a;e[52736+a]=t[206][a]}t[207]=\"\".split(\"\");for(a=0;a!=t[207].length;++a)if(t[207][a].charCodeAt(0)!==65533){r[t[207][a]]=52992+a;e[52992+a]=t[207][a]}t[208]=\"\".split(\"\");for(a=0;a!=t[208].length;++a)if(t[208][a].charCodeAt(0)!==65533){r[t[208][a]]=53248+a;e[53248+a]=t[208][a]}t[209]=\"\".split(\"\");for(a=0;a!=t[209].length;++a)if(t[209][a].charCodeAt(0)!==65533){r[t[209][a]]=53504+a;e[53504+a]=t[209][a]}t[210]=\"\".split(\"\");for(a=0;a!=t[210].length;++a)if(t[210][a].charCodeAt(0)!==65533){r[t[210][a]]=53760+a;e[53760+a]=t[210][a]}t[211]=\"\".split(\"\");for(a=0;a!=t[211].length;++a)if(t[211][a].charCodeAt(0)!==65533){r[t[211][a]]=54016+a;e[54016+a]=t[211][a]}t[212]=\"\".split(\"\");for(a=0;a!=t[212].length;++a)if(t[212][a].charCodeAt(0)!==65533){r[t[212][a]]=54272+a;e[54272+a]=t[212][a]}t[213]=\"\".split(\"\");for(a=0;a!=t[213].length;++a)if(t[213][a].charCodeAt(0)!==65533){r[t[213][a]]=54528+a;e[54528+a]=t[213][a]}t[214]=\"\".split(\"\");for(a=0;a!=t[214].length;++a)if(t[214][a].charCodeAt(0)!==65533){r[t[214][a]]=54784+a;e[54784+a]=t[214][a]}t[215]=\"\".split(\"\");for(a=0;a!=t[215].length;++a)if(t[215][a].charCodeAt(0)!==65533){r[t[215][a]]=55040+a;e[55040+a]=t[215][a]}t[216]=\"\".split(\"\");for(a=0;a!=t[216].length;++a)if(t[216][a].charCodeAt(0)!==65533){r[t[216][a]]=55296+a;e[55296+a]=t[216][a]}t[217]=\"\".split(\"\");for(a=0;a!=t[217].length;++a)if(t[217][a].charCodeAt(0)!==65533){r[t[217][a]]=55552+a;e[55552+a]=t[217][a]}t[218]=\"\".split(\"\");for(a=0;a!=t[218].length;++a)if(t[218][a].charCodeAt(0)!==65533){r[t[218][a]]=55808+a;e[55808+a]=t[218][a]}t[219]=\"\".split(\"\");for(a=0;a!=t[219].length;++a)if(t[219][a].charCodeAt(0)!==65533){r[t[219][a]]=56064+a;e[56064+a]=t[219][a]}t[220]=\"\".split(\"\");for(a=0;a!=t[220].length;++a)if(t[220][a].charCodeAt(0)!==65533){r[t[220][a]]=56320+a;e[56320+a]=t[220][a]}t[221]=\"\".split(\"\");for(a=0;a!=t[221].length;++a)if(t[221][a].charCodeAt(0)!==65533){r[t[221][a]]=56576+a;e[56576+a]=t[221][a]}t[222]=\"\".split(\"\");for(a=0;a!=t[222].length;++a)if(t[222][a].charCodeAt(0)!==65533){r[t[222][a]]=56832+a;e[56832+a]=t[222][a]}t[223]=\"\".split(\"\");for(a=0;a!=t[223].length;++a)if(t[223][a].charCodeAt(0)!==65533){r[t[223][a]]=57088+a;e[57088+a]=t[223][a]}t[224]=\"\".split(\"\");for(a=0;a!=t[224].length;++a)if(t[224][a].charCodeAt(0)!==65533){r[t[224][a]]=57344+a;e[57344+a]=t[224][a]}t[225]=\"\".split(\"\");for(a=0;a!=t[225].length;++a)if(t[225][a].charCodeAt(0)!==65533){r[t[225][a]]=57600+a;e[57600+a]=t[225][a]}t[226]=\"\".split(\"\");for(a=0;a!=t[226].length;++a)if(t[226][a].charCodeAt(0)!==65533){r[t[226][a]]=57856+a;e[57856+a]=t[226][a]}t[227]=\"\".split(\"\");for(a=0;a!=t[227].length;++a)if(t[227][a].charCodeAt(0)!==65533){r[t[227][a]]=58112+a;e[58112+a]=t[227][a]}t[228]=\"\".split(\"\");for(a=0;a!=t[228].length;++a)if(t[228][a].charCodeAt(0)!==65533){r[t[228][a]]=58368+a;e[58368+a]=t[228][a]}t[229]=\"\".split(\"\");for(a=0;a!=t[229].length;++a)if(t[229][a].charCodeAt(0)!==65533){r[t[229][a]]=58624+a;e[58624+a]=t[229][a]}t[230]=\"\".split(\"\");for(a=0;a!=t[230].length;++a)if(t[230][a].charCodeAt(0)!==65533){r[t[230][a]]=58880+a;e[58880+a]=t[230][a]}t[231]=\"\".split(\"\");for(a=0;a!=t[231].length;++a)if(t[231][a].charCodeAt(0)!==65533){r[t[231][a]]=59136+a;e[59136+a]=t[231][a]}t[232]=\"\".split(\"\");for(a=0;a!=t[232].length;++a)if(t[232][a].charCodeAt(0)!==65533){r[t[232][a]]=59392+a;e[59392+a]=t[232][a]}t[233]=\"\".split(\"\");for(a=0;a!=t[233].length;++a)if(t[233][a].charCodeAt(0)!==65533){r[t[233][a]]=59648+a;e[59648+a]=t[233][a]}t[234]=\"\".split(\"\");for(a=0;a!=t[234].length;++a)if(t[234][a].charCodeAt(0)!==65533){r[t[234][a]]=59904+a;e[59904+a]=t[234][a]}t[235]=\"\".split(\"\");for(a=0;a!=t[235].length;++a)if(t[235][a].charCodeAt(0)!==65533){r[t[235][a]]=60160+a;e[60160+a]=t[235][a]}t[236]=\"\".split(\"\");for(a=0;a!=t[236].length;++a)if(t[236][a].charCodeAt(0)!==65533){r[t[236][a]]=60416+a;e[60416+a]=t[236][a]}t[237]=\"\".split(\"\");for(a=0;a!=t[237].length;++a)if(t[237][a].charCodeAt(0)!==65533){r[t[237][a]]=60672+a;e[60672+a]=t[237][a]}t[238]=\"\".split(\"\");for(a=0;a!=t[238].length;++a)if(t[238][a].charCodeAt(0)!==65533){r[t[238][a]]=60928+a;e[60928+a]=t[238][a]}t[239]=\"\".split(\"\");for(a=0;a!=t[239].length;++a)if(t[239][a].charCodeAt(0)!==65533){r[t[239][a]]=61184+a;e[61184+a]=t[239][a]}t[240]=\"\".split(\"\");for(a=0;a!=t[240].length;++a)if(t[240][a].charCodeAt(0)!==65533){r[t[240][a]]=61440+a;e[61440+a]=t[240][a]}t[241]=\"\".split(\"\");for(a=0;a!=t[241].length;++a)if(t[241][a].charCodeAt(0)!==65533){r[t[241][a]]=61696+a;e[61696+a]=t[241][a]}t[242]=\"\".split(\"\");for(a=0;a!=t[242].length;++a)if(t[242][a].charCodeAt(0)!==65533){r[t[242][a]]=61952+a;e[61952+a]=t[242][a]}t[243]=\"\".split(\"\");for(a=0;a!=t[243].length;++a)if(t[243][a].charCodeAt(0)!==65533){r[t[243][a]]=62208+a;e[62208+a]=t[243][a]}t[244]=\"\".split(\"\");for(a=0;a!=t[244].length;++a)if(t[244][a].charCodeAt(0)!==65533){r[t[244][a]]=62464+a;e[62464+a]=t[244][a]}t[245]=\"\".split(\"\");for(a=0;a!=t[245].length;++a)if(t[245][a].charCodeAt(0)!==65533){r[t[245][a]]=62720+a;e[62720+a]=t[245][a]}t[246]=\"\".split(\"\");for(a=0;a!=t[246].length;++a)if(t[246][a].charCodeAt(0)!==65533){r[t[246][a]]=62976+a;e[62976+a]=t[246][a]}t[247]=\"\".split(\"\");for(a=0;a!=t[247].length;++a)if(t[247][a].charCodeAt(0)!==65533){r[t[247][a]]=63232+a;e[63232+a]=t[247][a]}t[248]=\"\".split(\"\");for(a=0;a!=t[248].length;++a)if(t[248][a].charCodeAt(0)!==65533){r[t[248][a]]=63488+a;e[63488+a]=t[248][a]}t[249]=\"\".split(\"\");for(a=0;a!=t[249].length;++a)if(t[249][a].charCodeAt(0)!==65533){r[t[249][a]]=63744+a;e[63744+a]=t[249][a]}return{enc:r,dec:e}}();cptable[1250]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1251]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1252]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1253]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1254]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1255]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1256]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1257]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1258]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[1e4]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[10006]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[10007]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[10008]=function(){var e=[],r={},t=[],a;t[0]=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");for(a=0;a!=t[0].length;++a)if(t[0][a].charCodeAt(0)!==65533){r[t[0][a]]=0+a;e[0+a]=t[0][a]}t[161]=\"\".split(\"\");for(a=0;a!=t[161].length;++a)if(t[161][a].charCodeAt(0)!==65533){r[t[161][a]]=41216+a;e[41216+a]=t[161][a]}t[162]=\"\".split(\"\");for(a=0;a!=t[162].length;++a)if(t[162][a].charCodeAt(0)!==65533){r[t[162][a]]=41472+a;e[41472+a]=t[162][a]}t[163]=\"\".split(\"\");for(a=0;a!=t[163].length;++a)if(t[163][a].charCodeAt(0)!==65533){r[t[163][a]]=41728+a;e[41728+a]=t[163][a]}t[164]=\"\".split(\"\");for(a=0;a!=t[164].length;++a)if(t[164][a].charCodeAt(0)!==65533){r[t[164][a]]=41984+a;e[41984+a]=t[164][a]}t[165]=\"\".split(\"\");for(a=0;a!=t[165].length;++a)if(t[165][a].charCodeAt(0)!==65533){r[t[165][a]]=42240+a;e[42240+a]=t[165][a]}t[166]=\"\".split(\"\");for(a=0;a!=t[166].length;++a)if(t[166][a].charCodeAt(0)!==65533){\nr[t[166][a]]=42496+a;e[42496+a]=t[166][a]}t[167]=\"\".split(\"\");for(a=0;a!=t[167].length;++a)if(t[167][a].charCodeAt(0)!==65533){r[t[167][a]]=42752+a;e[42752+a]=t[167][a]}t[168]=\"\".split(\"\");for(a=0;a!=t[168].length;++a)if(t[168][a].charCodeAt(0)!==65533){r[t[168][a]]=43008+a;e[43008+a]=t[168][a]}t[169]=\"\".split(\"\");for(a=0;a!=t[169].length;++a)if(t[169][a].charCodeAt(0)!==65533){r[t[169][a]]=43264+a;e[43264+a]=t[169][a]}t[176]=\"\".split(\"\");for(a=0;a!=t[176].length;++a)if(t[176][a].charCodeAt(0)!==65533){r[t[176][a]]=45056+a;e[45056+a]=t[176][a]}t[177]=\"\".split(\"\");for(a=0;a!=t[177].length;++a)if(t[177][a].charCodeAt(0)!==65533){r[t[177][a]]=45312+a;e[45312+a]=t[177][a]}t[178]=\"\".split(\"\");for(a=0;a!=t[178].length;++a)if(t[178][a].charCodeAt(0)!==65533){r[t[178][a]]=45568+a;e[45568+a]=t[178][a]}t[179]=\"\".split(\"\");for(a=0;a!=t[179].length;++a)if(t[179][a].charCodeAt(0)!==65533){r[t[179][a]]=45824+a;e[45824+a]=t[179][a]}t[180]=\"\".split(\"\");for(a=0;a!=t[180].length;++a)if(t[180][a].charCodeAt(0)!==65533){r[t[180][a]]=46080+a;e[46080+a]=t[180][a]}t[181]=\"\".split(\"\");for(a=0;a!=t[181].length;++a)if(t[181][a].charCodeAt(0)!==65533){r[t[181][a]]=46336+a;e[46336+a]=t[181][a]}t[182]=\"\".split(\"\");for(a=0;a!=t[182].length;++a)if(t[182][a].charCodeAt(0)!==65533){r[t[182][a]]=46592+a;e[46592+a]=t[182][a]}t[183]=\"\".split(\"\");for(a=0;a!=t[183].length;++a)if(t[183][a].charCodeAt(0)!==65533){r[t[183][a]]=46848+a;e[46848+a]=t[183][a]}t[184]=\"\".split(\"\");for(a=0;a!=t[184].length;++a)if(t[184][a].charCodeAt(0)!==65533){r[t[184][a]]=47104+a;e[47104+a]=t[184][a]}t[185]=\"\".split(\"\");for(a=0;a!=t[185].length;++a)if(t[185][a].charCodeAt(0)!==65533){r[t[185][a]]=47360+a;e[47360+a]=t[185][a]}t[186]=\"\".split(\"\");for(a=0;a!=t[186].length;++a)if(t[186][a].charCodeAt(0)!==65533){r[t[186][a]]=47616+a;e[47616+a]=t[186][a]}t[187]=\"\".split(\"\");for(a=0;a!=t[187].length;++a)if(t[187][a].charCodeAt(0)!==65533){r[t[187][a]]=47872+a;e[47872+a]=t[187][a]}t[188]=\"\".split(\"\");for(a=0;a!=t[188].length;++a)if(t[188][a].charCodeAt(0)!==65533){r[t[188][a]]=48128+a;e[48128+a]=t[188][a]}t[189]=\"\".split(\"\");for(a=0;a!=t[189].length;++a)if(t[189][a].charCodeAt(0)!==65533){r[t[189][a]]=48384+a;e[48384+a]=t[189][a]}t[190]=\"\".split(\"\");for(a=0;a!=t[190].length;++a)if(t[190][a].charCodeAt(0)!==65533){r[t[190][a]]=48640+a;e[48640+a]=t[190][a]}t[191]=\"\".split(\"\");for(a=0;a!=t[191].length;++a)if(t[191][a].charCodeAt(0)!==65533){r[t[191][a]]=48896+a;e[48896+a]=t[191][a]}t[192]=\"\".split(\"\");for(a=0;a!=t[192].length;++a)if(t[192][a].charCodeAt(0)!==65533){r[t[192][a]]=49152+a;e[49152+a]=t[192][a]}t[193]=\"\".split(\"\");for(a=0;a!=t[193].length;++a)if(t[193][a].charCodeAt(0)!==65533){r[t[193][a]]=49408+a;e[49408+a]=t[193][a]}t[194]=\"\".split(\"\");for(a=0;a!=t[194].length;++a)if(t[194][a].charCodeAt(0)!==65533){r[t[194][a]]=49664+a;e[49664+a]=t[194][a]}t[195]=\"\".split(\"\");for(a=0;a!=t[195].length;++a)if(t[195][a].charCodeAt(0)!==65533){r[t[195][a]]=49920+a;e[49920+a]=t[195][a]}t[196]=\"\".split(\"\");for(a=0;a!=t[196].length;++a)if(t[196][a].charCodeAt(0)!==65533){r[t[196][a]]=50176+a;e[50176+a]=t[196][a]}t[197]=\"\".split(\"\");for(a=0;a!=t[197].length;++a)if(t[197][a].charCodeAt(0)!==65533){r[t[197][a]]=50432+a;e[50432+a]=t[197][a]}t[198]=\"\".split(\"\");for(a=0;a!=t[198].length;++a)if(t[198][a].charCodeAt(0)!==65533){r[t[198][a]]=50688+a;e[50688+a]=t[198][a]}t[199]=\"\".split(\"\");for(a=0;a!=t[199].length;++a)if(t[199][a].charCodeAt(0)!==65533){r[t[199][a]]=50944+a;e[50944+a]=t[199][a]}t[200]=\"\".split(\"\");for(a=0;a!=t[200].length;++a)if(t[200][a].charCodeAt(0)!==65533){r[t[200][a]]=51200+a;e[51200+a]=t[200][a]}t[201]=\"\".split(\"\");for(a=0;a!=t[201].length;++a)if(t[201][a].charCodeAt(0)!==65533){r[t[201][a]]=51456+a;e[51456+a]=t[201][a]}t[202]=\"\".split(\"\");for(a=0;a!=t[202].length;++a)if(t[202][a].charCodeAt(0)!==65533){r[t[202][a]]=51712+a;e[51712+a]=t[202][a]}t[203]=\"\".split(\"\");for(a=0;a!=t[203].length;++a)if(t[203][a].charCodeAt(0)!==65533){r[t[203][a]]=51968+a;e[51968+a]=t[203][a]}t[204]=\"\".split(\"\");for(a=0;a!=t[204].length;++a)if(t[204][a].charCodeAt(0)!==65533){r[t[204][a]]=52224+a;e[52224+a]=t[204][a]}t[205]=\"\".split(\"\");for(a=0;a!=t[205].length;++a)if(t[205][a].charCodeAt(0)!==65533){r[t[205][a]]=52480+a;e[52480+a]=t[205][a]}t[206]=\"\".split(\"\");for(a=0;a!=t[206].length;++a)if(t[206][a].charCodeAt(0)!==65533){r[t[206][a]]=52736+a;e[52736+a]=t[206][a]}t[207]=\"\".split(\"\");for(a=0;a!=t[207].length;++a)if(t[207][a].charCodeAt(0)!==65533){r[t[207][a]]=52992+a;e[52992+a]=t[207][a]}t[208]=\"\".split(\"\");for(a=0;a!=t[208].length;++a)if(t[208][a].charCodeAt(0)!==65533){r[t[208][a]]=53248+a;e[53248+a]=t[208][a]}t[209]=\"\".split(\"\");for(a=0;a!=t[209].length;++a)if(t[209][a].charCodeAt(0)!==65533){r[t[209][a]]=53504+a;e[53504+a]=t[209][a]}t[210]=\"\".split(\"\");for(a=0;a!=t[210].length;++a)if(t[210][a].charCodeAt(0)!==65533){r[t[210][a]]=53760+a;e[53760+a]=t[210][a]}t[211]=\"\".split(\"\");for(a=0;a!=t[211].length;++a)if(t[211][a].charCodeAt(0)!==65533){r[t[211][a]]=54016+a;e[54016+a]=t[211][a]}t[212]=\"\".split(\"\");for(a=0;a!=t[212].length;++a)if(t[212][a].charCodeAt(0)!==65533){r[t[212][a]]=54272+a;e[54272+a]=t[212][a]}t[213]=\"\".split(\"\");for(a=0;a!=t[213].length;++a)if(t[213][a].charCodeAt(0)!==65533){r[t[213][a]]=54528+a;e[54528+a]=t[213][a]}t[214]=\"\".split(\"\");for(a=0;a!=t[214].length;++a)if(t[214][a].charCodeAt(0)!==65533){r[t[214][a]]=54784+a;e[54784+a]=t[214][a]}t[215]=\"\".split(\"\");for(a=0;a!=t[215].length;++a)if(t[215][a].charCodeAt(0)!==65533){r[t[215][a]]=55040+a;e[55040+a]=t[215][a]}t[216]=\"\".split(\"\");for(a=0;a!=t[216].length;++a)if(t[216][a].charCodeAt(0)!==65533){r[t[216][a]]=55296+a;e[55296+a]=t[216][a]}t[217]=\"\".split(\"\");for(a=0;a!=t[217].length;++a)if(t[217][a].charCodeAt(0)!==65533){r[t[217][a]]=55552+a;e[55552+a]=t[217][a]}t[218]=\"\".split(\"\");for(a=0;a!=t[218].length;++a)if(t[218][a].charCodeAt(0)!==65533){r[t[218][a]]=55808+a;e[55808+a]=t[218][a]}t[219]=\"\".split(\"\");for(a=0;a!=t[219].length;++a)if(t[219][a].charCodeAt(0)!==65533){r[t[219][a]]=56064+a;e[56064+a]=t[219][a]}t[220]=\"\".split(\"\");for(a=0;a!=t[220].length;++a)if(t[220][a].charCodeAt(0)!==65533){r[t[220][a]]=56320+a;e[56320+a]=t[220][a]}t[221]=\"\".split(\"\");for(a=0;a!=t[221].length;++a)if(t[221][a].charCodeAt(0)!==65533){r[t[221][a]]=56576+a;e[56576+a]=t[221][a]}t[222]=\"\".split(\"\");for(a=0;a!=t[222].length;++a)if(t[222][a].charCodeAt(0)!==65533){r[t[222][a]]=56832+a;e[56832+a]=t[222][a]}t[223]=\"\".split(\"\");for(a=0;a!=t[223].length;++a)if(t[223][a].charCodeAt(0)!==65533){r[t[223][a]]=57088+a;e[57088+a]=t[223][a]}t[224]=\"\".split(\"\");for(a=0;a!=t[224].length;++a)if(t[224][a].charCodeAt(0)!==65533){r[t[224][a]]=57344+a;e[57344+a]=t[224][a]}t[225]=\"\".split(\"\");for(a=0;a!=t[225].length;++a)if(t[225][a].charCodeAt(0)!==65533){r[t[225][a]]=57600+a;e[57600+a]=t[225][a]}t[226]=\"\".split(\"\");for(a=0;a!=t[226].length;++a)if(t[226][a].charCodeAt(0)!==65533){r[t[226][a]]=57856+a;e[57856+a]=t[226][a]}t[227]=\"\".split(\"\");for(a=0;a!=t[227].length;++a)if(t[227][a].charCodeAt(0)!==65533){r[t[227][a]]=58112+a;e[58112+a]=t[227][a]}t[228]=\"\".split(\"\");for(a=0;a!=t[228].length;++a)if(t[228][a].charCodeAt(0)!==65533){r[t[228][a]]=58368+a;e[58368+a]=t[228][a]}t[229]=\"\".split(\"\");for(a=0;a!=t[229].length;++a)if(t[229][a].charCodeAt(0)!==65533){r[t[229][a]]=58624+a;e[58624+a]=t[229][a]}t[230]=\"\".split(\"\");for(a=0;a!=t[230].length;++a)if(t[230][a].charCodeAt(0)!==65533){r[t[230][a]]=58880+a;e[58880+a]=t[230][a]}t[231]=\"\".split(\"\");for(a=0;a!=t[231].length;++a)if(t[231][a].charCodeAt(0)!==65533){r[t[231][a]]=59136+a;e[59136+a]=t[231][a]}t[232]=\"\".split(\"\");for(a=0;a!=t[232].length;++a)if(t[232][a].charCodeAt(0)!==65533){r[t[232][a]]=59392+a;e[59392+a]=t[232][a]}t[233]=\"\".split(\"\");for(a=0;a!=t[233].length;++a)if(t[233][a].charCodeAt(0)!==65533){r[t[233][a]]=59648+a;e[59648+a]=t[233][a]}t[234]=\"\".split(\"\");for(a=0;a!=t[234].length;++a)if(t[234][a].charCodeAt(0)!==65533){r[t[234][a]]=59904+a;e[59904+a]=t[234][a]}t[235]=\"\".split(\"\");for(a=0;a!=t[235].length;++a)if(t[235][a].charCodeAt(0)!==65533){r[t[235][a]]=60160+a;e[60160+a]=t[235][a]}t[236]=\"\".split(\"\");for(a=0;a!=t[236].length;++a)if(t[236][a].charCodeAt(0)!==65533){r[t[236][a]]=60416+a;e[60416+a]=t[236][a]}t[237]=\"\".split(\"\");for(a=0;a!=t[237].length;++a)if(t[237][a].charCodeAt(0)!==65533){r[t[237][a]]=60672+a;e[60672+a]=t[237][a]}t[238]=\"\".split(\"\");for(a=0;a!=t[238].length;++a)if(t[238][a].charCodeAt(0)!==65533){r[t[238][a]]=60928+a;e[60928+a]=t[238][a]}t[239]=\"\".split(\"\");for(a=0;a!=t[239].length;++a)if(t[239][a].charCodeAt(0)!==65533){r[t[239][a]]=61184+a;e[61184+a]=t[239][a]}t[240]=\"\".split(\"\");for(a=0;a!=t[240].length;++a)if(t[240][a].charCodeAt(0)!==65533){r[t[240][a]]=61440+a;e[61440+a]=t[240][a]}t[241]=\"\".split(\"\");for(a=0;a!=t[241].length;++a)if(t[241][a].charCodeAt(0)!==65533){r[t[241][a]]=61696+a;e[61696+a]=t[241][a]}t[242]=\"\".split(\"\");for(a=0;a!=t[242].length;++a)if(t[242][a].charCodeAt(0)!==65533){r[t[242][a]]=61952+a;e[61952+a]=t[242][a]}t[243]=\"\".split(\"\");for(a=0;a!=t[243].length;++a)if(t[243][a].charCodeAt(0)!==65533){r[t[243][a]]=62208+a;e[62208+a]=t[243][a]}t[244]=\"\".split(\"\");for(a=0;a!=t[244].length;++a)if(t[244][a].charCodeAt(0)!==65533){r[t[244][a]]=62464+a;e[62464+a]=t[244][a]}t[245]=\"\".split(\"\");for(a=0;a!=t[245].length;++a)if(t[245][a].charCodeAt(0)!==65533){r[t[245][a]]=62720+a;e[62720+a]=t[245][a]}t[246]=\"\".split(\"\");for(a=0;a!=t[246].length;++a)if(t[246][a].charCodeAt(0)!==65533){r[t[246][a]]=62976+a;e[62976+a]=t[246][a]}t[247]=\"\".split(\"\");for(a=0;a!=t[247].length;++a)if(t[247][a].charCodeAt(0)!==65533){r[t[247][a]]=63232+a;e[63232+a]=t[247][a]}return{enc:r,dec:e}}();cptable[10029]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[10079]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[10081]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();cptable[28591]=function(){var e=\"\\0\u0001\u0002\u0003\u0004\u0005\u0006\u0007\\b\\t\\n\\x0B\\f\\r\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001a\u001b\u001c\u001d\u001e\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",r=[],t={};for(var a=0;a!=e.length;++a){if(e.charCodeAt(a)!==65533)t[e.charAt(a)]=a;r[a]=e.charAt(a)}return{enc:t,dec:r}}();if(typeof module!==\"undefined\"&&module.exports&&typeof DO_NOT_EXPORT_CODEPAGE===\"undefined\")module.exports=cptable;(function(e,r){\"use strict\";if(typeof cptable===\"undefined\"){if(typeof require!==\"undefined\"){var t=cptable;if(typeof module!==\"undefined\"&&module.exports&&typeof DO_NOT_EXPORT_CODEPAGE===\"undefined\")module.exports=r(t);else e.cptable=r(t)}else throw new Error(\"cptable not found\")}else cptable=r(cptable)})(this,function(e){\"use strict\";var r={1200:\"utf16le\",1201:\"utf16be\",12000:\"utf32le\",12001:\"utf32be\",16969:\"utf64le\",20127:\"ascii\",65000:\"utf7\",65001:\"utf8\"};var t=[874,1250,1251,1252,1253,1254,1255,1256,1e4];var a=[932,936,949,950];var n=[65001];var i={};var s={};var f={};var o={};var l=function F(e){return String.fromCharCode(e)};var c=function P(e){return e.charCodeAt(0)};var h=typeof Buffer!==\"undefined\";var u=function(){};if(h){var d=!Buffer.from;if(!d)try{Buffer.from(\"foo\",\"utf8\")}catch(v){d=true}u=d?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer);if(!Buffer.allocUnsafe)Buffer.allocUnsafe=function(e){return new Buffer(e)};var p=1024,g=Buffer.allocUnsafe(p);var m=function L(e){var r=Buffer.allocUnsafe(65536);for(var t=0;t<65536;++t)r[t]=0;var a=Object.keys(e),n=a.length;for(var i=0,s=a[i];i<n;++i){if(!(s=a[i]))continue;r[s.charCodeAt(0)]=e[s]}return r};var b=function M(r){var t=m(e[r].enc);return function a(e,r){var a=e.length;var n,i=0,s=0,f=0,o=0;if(typeof e===\"string\"){n=Buffer.allocUnsafe(a);for(i=0;i<a;++i)n[i]=t[e.charCodeAt(i)]}else if(Buffer.isBuffer(e)){\nn=Buffer.allocUnsafe(2*a);s=0;for(i=0;i<a;++i){f=e[i];if(f<128)n[s++]=t[f];else if(f<224){n[s++]=t[((f&31)<<6)+(e[i+1]&63)];++i}else if(f<240){n[s++]=t[((f&15)<<12)+((e[i+1]&63)<<6)+(e[i+2]&63)];i+=2}else{o=((f&7)<<18)+((e[i+1]&63)<<12)+((e[i+2]&63)<<6)+(e[i+3]&63);i+=3;if(o<65536)n[s++]=t[o];else{o-=65536;n[s++]=t[55296+(o>>10&1023)];n[s++]=t[56320+(o&1023)]}}}n=n.slice(0,s)}else{n=Buffer.allocUnsafe(a);for(i=0;i<a;++i)n[i]=t[e[i].charCodeAt(0)]}if(!r||r===\"buf\")return n;if(r!==\"arr\")return n.toString(\"binary\");return[].slice.call(n)}};var w=function U(r){var t=e[r].dec;var a=Buffer.allocUnsafe(131072),n=0,i=\"\";for(n=0;n<t.length;++n){if(!(i=t[n]))continue;var s=i.charCodeAt(0);a[2*n]=s&255;a[2*n+1]=s>>8}return function f(e){var r=e.length,t=0,n=0;if(2*r>p){p=2*r;g=Buffer.allocUnsafe(p)}if(Buffer.isBuffer(e)){for(t=0;t<r;t++){n=2*e[t];g[2*t]=a[n];g[2*t+1]=a[n+1]}}else if(typeof e===\"string\"){for(t=0;t<r;t++){n=2*e.charCodeAt(t);g[2*t]=a[n];g[2*t+1]=a[n+1]}}else{for(t=0;t<r;t++){n=2*e[t];g[2*t]=a[n];g[2*t+1]=a[n+1]}}return g.slice(0,2*r).toString(\"ucs2\")}};var k=function B(r){var t=e[r].enc;var a=Buffer.allocUnsafe(131072);for(var n=0;n<131072;++n)a[n]=0;var i=Object.keys(t);for(var s=0,f=i[s];s<i.length;++s){if(!(f=i[s]))continue;var o=f.charCodeAt(0);a[2*o]=t[f]&255;a[2*o+1]=t[f]>>8}return function l(e,r){var t=e.length,n=Buffer.allocUnsafe(2*t),i=0,s=0,f=0,o=0,l=0;if(typeof e===\"string\"){for(i=o=0;i<t;++i){s=e.charCodeAt(i)*2;n[o++]=a[s+1]||a[s];if(a[s+1]>0)n[o++]=a[s]}n=n.slice(0,o)}else if(Buffer.isBuffer(e)){for(i=o=0;i<t;++i){l=e[i];if(l<128)s=l;else if(l<224){s=((l&31)<<6)+(e[i+1]&63);++i}else if(l<240){s=((l&15)<<12)+((e[i+1]&63)<<6)+(e[i+2]&63);i+=2}else{s=((l&7)<<18)+((e[i+1]&63)<<12)+((e[i+2]&63)<<6)+(e[i+3]&63);i+=3}if(s<65536){s*=2;n[o++]=a[s+1]||a[s];if(a[s+1]>0)n[o++]=a[s]}else{f=s-65536;s=2*(55296+(f>>10&1023));n[o++]=a[s+1]||a[s];if(a[s+1]>0)n[o++]=a[s];s=2*(56320+(f&1023));n[o++]=a[s+1]||a[s];if(a[s+1]>0)n[o++]=a[s]}}n=n.slice(0,o)}else{for(i=o=0;i<t;i++){s=e[i].charCodeAt(0)*2;n[o++]=a[s+1]||a[s];if(a[s+1]>0)n[o++]=a[s]}}if(!r||r===\"buf\")return n;if(r!==\"arr\")return n.toString(\"binary\");return[].slice.call(n)}};var T=function W(r){var t=e[r].dec;var a=Buffer.allocUnsafe(131072),n=0,i,s=0,f=0,o=0;for(o=0;o<65536;++o){a[2*o]=255;a[2*o+1]=253}for(n=0;n<t.length;++n){if(!(i=t[n]))continue;s=i.charCodeAt(0);f=2*n;a[f]=s&255;a[f+1]=s>>8}return function l(e){var r=e.length,t=Buffer.allocUnsafe(2*r),n=0,i=0,s=0;if(Buffer.isBuffer(e)){for(n=0;n<r;n++){i=2*e[n];if(a[i]===255&&a[i+1]===253){i=2*((e[n]<<8)+e[n+1]);++n}t[s++]=a[i];t[s++]=a[i+1]}}else if(typeof e===\"string\"){for(n=0;n<r;n++){i=2*e.charCodeAt(n);if(a[i]===255&&a[i+1]===253){i=2*((e.charCodeAt(n)<<8)+e.charCodeAt(n+1));++n}t[s++]=a[i];t[s++]=a[i+1]}}else{for(n=0;n<r;n++){i=2*e[n];if(a[i]===255&&a[i+1]===253){i=2*((e[n]<<8)+e[n+1]);++n}t[s++]=a[i];t[s++]=a[i+1]}}return t.slice(0,s).toString(\"ucs2\")}};i[65001]=function H(e){if(typeof e===\"string\")return H(e.split(\"\").map(c));var r=e.length,t=0,a=0;if(4*r>p){p=4*r;g=Buffer.allocUnsafe(p)}var n=0;if(r>=3&&e[0]==239)if(e[1]==187&&e[2]==191)n=3;for(var i=1,s=0,f=0;n<r;n+=i){i=1;f=e[n];if(f<128)t=f;else if(f<224){t=(f&31)*64+(e[n+1]&63);i=2}else if(f<240){t=((f&15)<<12)+(e[n+1]&63)*64+(e[n+2]&63);i=3}else{t=(f&7)*262144+((e[n+1]&63)<<12)+(e[n+2]&63)*64+(e[n+3]&63);i=4}if(t<65536){g[s++]=t&255;g[s++]=t>>8}else{t-=65536;a=55296+(t>>10&1023);t=56320+(t&1023);g[s++]=a&255;g[s++]=a>>>8;g[s++]=t&255;g[s++]=t>>>8&255}}return g.slice(0,s).toString(\"ucs2\")};s[65001]=function z(e,r){if(h&&Buffer.isBuffer(e)){if(!r||r===\"buf\")return e;if(r!==\"arr\")return e.toString(\"binary\");return[].slice.call(e)}var t=e.length,a=0,n=0,i=0;var s=typeof e===\"string\";if(4*t>p){p=4*t;g=Buffer.allocUnsafe(p)}for(var f=0;f<t;++f){a=s?e.charCodeAt(f):e[f].charCodeAt(0);if(a<=127)g[i++]=a;else if(a<=2047){g[i++]=192+(a>>6);g[i++]=128+(a&63)}else if(a>=55296&&a<=57343){a-=55296;++f;n=(s?e.charCodeAt(f):e[f].charCodeAt(0))-56320+(a<<10);g[i++]=240+(n>>>18&7);g[i++]=144+(n>>>12&63);g[i++]=128+(n>>>6&63);g[i++]=128+(n&63)}else{g[i++]=224+(a>>12);g[i++]=128+(a>>6&63);g[i++]=128+(a&63)}}if(!r||r===\"buf\")return g.slice(0,i);if(r!==\"arr\")return g.slice(0,i).toString(\"binary\");return[].slice.call(g,0,i)}}var A=function V(){if(h){if(f[t[0]])return;var r=0,l=0;for(r=0;r<t.length;++r){l=t[r];if(e[l]){f[l]=w(l);o[l]=b(l)}}for(r=0;r<a.length;++r){l=a[r];if(e[l]){f[l]=T(l);o[l]=k(l)}}for(r=0;r<n.length;++r){l=n[r];if(i[l])f[l]=i[l];if(s[l])o[l]=s[l]}}};var E=function(e,r){void r;return\"\"};var C=function G(e){delete f[e];delete o[e]};var y=function j(){if(h){if(!f[t[0]])return;t.forEach(C);a.forEach(C);n.forEach(C)}O=E;R=0};var S={encache:A,decache:y,sbcs:t,dbcs:a};A();var _=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";var x=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?\";var O=E,R=0;var I=function X(t,a,n){if(t===R&&O){return O(a,n)}if(o[t]){O=o[R=t];return O(a,n)}if(h&&Buffer.isBuffer(a))a=a.toString(\"utf8\");var i=a.length;var s=h?Buffer.allocUnsafe(4*i):[],f=0,c=0,d=0,v=0;var p=e[t],g,m=\"\";var b=typeof a===\"string\";if(p&&(g=p.enc))for(c=0;c<i;++c,++d){f=g[b?a.charAt(c):a[c]];if(f>255){s[d]=f>>8;s[++d]=f&255}else s[d]=f&255}else if(m=r[t])switch(m){case\"utf8\":if(h&&b){s=u(a,m);d=s.length;break}for(c=0;c<i;++c,++d){f=b?a.charCodeAt(c):a[c].charCodeAt(0);if(f<=127)s[d]=f;else if(f<=2047){s[d]=192+(f>>6);s[++d]=128+(f&63)}else if(f>=55296&&f<=57343){f-=55296;v=(b?a.charCodeAt(++c):a[++c].charCodeAt(0))-56320+(f<<10);s[d]=240+(v>>>18&7);s[++d]=144+(v>>>12&63);s[++d]=128+(v>>>6&63);s[++d]=128+(v&63)}else{s[d]=224+(f>>12);s[++d]=128+(f>>6&63);s[++d]=128+(f&63)}}break;case\"ascii\":if(h&&typeof a===\"string\"){s=u(a,m);d=s.length;break}for(c=0;c<i;++c,++d){f=b?a.charCodeAt(c):a[c].charCodeAt(0);if(f<=127)s[d]=f;else throw new Error(\"bad ascii \"+f)}break;case\"utf16le\":if(h&&typeof a===\"string\"){s=u(a,m);d=s.length;break}for(c=0;c<i;++c){f=b?a.charCodeAt(c):a[c].charCodeAt(0);s[d++]=f&255;s[d++]=f>>8}break;case\"utf16be\":for(c=0;c<i;++c){f=b?a.charCodeAt(c):a[c].charCodeAt(0);s[d++]=f>>8;s[d++]=f&255}break;case\"utf32le\":for(c=0;c<i;++c){f=b?a.charCodeAt(c):a[c].charCodeAt(0);if(f>=55296&&f<=57343)f=65536+(f-55296<<10)+(a[++c].charCodeAt(0)-56320);s[d++]=f&255;f>>=8;s[d++]=f&255;f>>=8;s[d++]=f&255;f>>=8;s[d++]=f&255}break;case\"utf32be\":for(c=0;c<i;++c){f=b?a.charCodeAt(c):a[c].charCodeAt(0);if(f>=55296&&f<=57343)f=65536+(f-55296<<10)+(a[++c].charCodeAt(0)-56320);s[d+3]=f&255;f>>=8;s[d+2]=f&255;f>>=8;s[d+1]=f&255;f>>=8;s[d]=f&255;d+=4}break;case\"utf7\":for(c=0;c<i;c++){var w=b?a.charAt(c):a[c].charAt(0);if(w===\"+\"){s[d++]=43;s[d++]=45;continue}if(x.indexOf(w)>-1){s[d++]=w.charCodeAt(0);continue}var k=X(1201,w);s[d++]=43;s[d++]=_.charCodeAt(k[0]>>2);s[d++]=_.charCodeAt(((k[0]&3)<<4)+((k[1]||0)>>4));s[d++]=_.charCodeAt(((k[1]&15)<<2)+((k[2]||0)>>6));s[d++]=45}break;default:throw new Error(\"Unsupported magic: \"+t+\" \"+r[t]);}else throw new Error(\"Unrecognized CP: \"+t);s=s.slice(0,d);if(!h)return n==\"str\"?s.map(l).join(\"\"):s;if(!n||n===\"buf\")return s;if(n!==\"arr\")return s.toString(\"binary\");return[].slice.call(s)};var N=function $(t,a){var n;if(n=f[t])return n(a);if(typeof a===\"string\")return $(t,a.split(\"\").map(c));var i=a.length,s=new Array(i),o=\"\",l=0,u=0,d=1,v=0,p=0;var g=e[t],m,b=\"\";if(g&&(m=g.dec)){for(u=0;u<i;u+=d){d=2;o=m[(a[u]<<8)+a[u+1]];if(!o){d=1;o=m[a[u]]}if(!o)throw new Error(\"Unrecognized code: \"+a[u]+\" \"+a[u+d-1]+\" \"+u+\" \"+d+\" \"+m[a[u]]);s[v++]=o}}else if(b=r[t])switch(b){case\"utf8\":if(i>=3&&a[0]==239)if(a[1]==187&&a[2]==191)u=3;for(;u<i;u+=d){d=1;if(a[u]<128)l=a[u];else if(a[u]<224){l=(a[u]&31)*64+(a[u+1]&63);d=2}else if(a[u]<240){l=((a[u]&15)<<12)+(a[u+1]&63)*64+(a[u+2]&63);d=3}else{l=(a[u]&7)*262144+((a[u+1]&63)<<12)+(a[u+2]&63)*64+(a[u+3]&63);d=4}if(l<65536){s[v++]=String.fromCharCode(l)}else{l-=65536;p=55296+(l>>10&1023);l=56320+(l&1023);s[v++]=String.fromCharCode(p);s[v++]=String.fromCharCode(l)}}break;case\"ascii\":if(h&&Buffer.isBuffer(a))return a.toString(b);for(u=0;u<i;u++)s[u]=String.fromCharCode(a[u]);v=i;break;case\"utf16le\":if(i>=2&&a[0]==255)if(a[1]==254)u=2;if(h&&Buffer.isBuffer(a))return a.toString(b);d=2;for(;u+1<i;u+=d){s[v++]=String.fromCharCode((a[u+1]<<8)+a[u])}break;case\"utf16be\":if(i>=2&&a[0]==254)if(a[1]==255)u=2;d=2;for(;u+1<i;u+=d){s[v++]=String.fromCharCode((a[u]<<8)+a[u+1])}break;case\"utf32le\":if(i>=4&&a[0]==255)if(a[1]==254&&a[2]===0&&a[3]===0)u=4;d=4;for(;u<i;u+=d){l=(a[u+3]<<24)+(a[u+2]<<16)+(a[u+1]<<8)+a[u];if(l>65535){l-=65536;s[v++]=String.fromCharCode(55296+(l>>10&1023));s[v++]=String.fromCharCode(56320+(l&1023))}else s[v++]=String.fromCharCode(l)}break;case\"utf32be\":if(i>=4&&a[3]==255)if(a[2]==254&&a[1]===0&&a[0]===0)u=4;d=4;for(;u<i;u+=d){l=(a[u]<<24)+(a[u+1]<<16)+(a[u+2]<<8)+a[u+3];if(l>65535){l-=65536;s[v++]=String.fromCharCode(55296+(l>>10&1023));s[v++]=String.fromCharCode(56320+(l&1023))}else s[v++]=String.fromCharCode(l)}break;case\"utf7\":if(i>=4&&a[0]==43&&a[1]==47&&a[2]==118){if(i>=5&&a[3]==56&&a[4]==45)u=5;else if(a[3]==56||a[3]==57||a[3]==43||a[3]==47)u=4}for(;u<i;u+=d){if(a[u]!==43){d=1;s[v++]=String.fromCharCode(a[u]);continue}d=1;if(a[u+1]===45){d=2;s[v++]=\"+\";continue}while(String.fromCharCode(a[u+d]).match(/[A-Za-z0-9+\\/]/))d++;var w=0;if(a[u+d]===45){++d;w=1}var k=[];var T=\"\";var A=0,E=0,C=0;var y=0,S=0,x=0,O=0;for(var R=1;R<d-w;){y=_.indexOf(String.fromCharCode(a[u+R++]));S=_.indexOf(String.fromCharCode(a[u+R++]));A=y<<2|S>>4;k.push(A);x=_.indexOf(String.fromCharCode(a[u+R++]));if(x===-1)break;E=(S&15)<<4|x>>2;k.push(E);O=_.indexOf(String.fromCharCode(a[u+R++]));if(O===-1)break;C=(x&3)<<6|O;if(O<64)k.push(C)}T=$(1201,k);for(R=0;R<T.length;++R)s[v++]=T.charAt(R)}break;default:throw new Error(\"Unsupported magic: \"+t+\" \"+r[t]);}else throw new Error(\"Unrecognized CP: \"+t);return s.slice(0,v).join(\"\")};var D=function Y(t){return!!(e[t]||r[t])};e.utils={decode:N,encode:I,hascp:D,magic:r,cache:S};return e});var XLSX={};function make_xlsx_lib(e){e.version=\"0.18.5\";var r=1200,t=1252;var a;if(typeof cptable!==\"undefined\")a=cptable;else if(typeof module!==\"undefined\"&&typeof require!==\"undefined\"){a=undefined}var n=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4];var i={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var s=function(e){if(n.indexOf(e)==-1)return;t=i[0]=e};function f(){s(1252)}var o=function(e){r=e;s(e)};function l(){o(1200);f()}function c(e){var r=[];for(var t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function h(e){var r=[];for(var t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join(\"\")}function u(e){var r=[];for(var t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join(\"\")}var d=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);if(r==255&&t==254)return h(e.slice(2));if(r==254&&t==255)return u(e.slice(2));if(r==65279)return e.slice(1);return e};var v=function Yw(e){return String.fromCharCode(e)};var p=function Kw(e){return String.fromCharCode(e)};if(typeof a!==\"undefined\"){o=function(e){r=e;s(e)};d=function(e){if(e.charCodeAt(0)===255&&e.charCodeAt(1)===254){return a.utils.decode(1200,c(e.slice(2)))}return e};v=function Jw(e){if(r===1200)return String.fromCharCode(e);return a.utils.decode(r,[e&255,e>>8])[0]};p=function qw(e){return a.utils.decode(t,[e])[0]}}var g=null;var m=true;var b=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";function w(e){var r=\"\";var t=0,a=0,n=0,i=0,s=0,f=0,o=0;for(var l=0;l<e.length;){t=e.charCodeAt(l++);i=t>>2;a=e.charCodeAt(l++);s=(t&3)<<4|a>>4;n=e.charCodeAt(l++);f=(a&15)<<2|n>>6;o=n&63;if(isNaN(a)){f=o=64}else if(isNaN(n)){o=64}r+=b.charAt(i)+b.charAt(s)+b.charAt(f)+b.charAt(o)}return r}function k(e){var r=\"\";var t=0,a=0,n=0,i=0,s=0,f=0,o=0;e=e.replace(/[^\\w\\+\\/\\=]/g,\"\");for(var l=0;l<e.length;){i=b.indexOf(e.charAt(l++));s=b.indexOf(e.charAt(l++));t=i<<2|s>>4;r+=String.fromCharCode(t);f=b.indexOf(e.charAt(l++));a=(s&15)<<4|f>>2;if(f!==64){r+=String.fromCharCode(a)}o=b.indexOf(e.charAt(l++));n=(f&3)<<6|o;if(o!==64){r+=String.fromCharCode(n)}}return r}var T=function(){return typeof Buffer!==\"undefined\"&&typeof undefined!==\"undefined\"&&typeof{}!==\"undefined\"&&!!{}.node}();var A=function(){if(typeof Buffer!==\"undefined\"){var e=!Buffer.from;if(!e)try{Buffer.from(\"foo\",\"utf8\")}catch(r){e=true}return e?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function E(e){if(T)return Buffer.alloc?Buffer.alloc(e):new Buffer(e);return typeof Uint8Array!=\"undefined\"?new Uint8Array(e):new Array(e)}function C(e){if(T)return Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e);return typeof Uint8Array!=\"undefined\"?new Uint8Array(e):new Array(e)}var y=function Zw(e){if(T)return A(e,\"binary\");return e.split(\"\").map(function(e){return e.charCodeAt(0)&255})};function S(e){if(typeof ArrayBuffer===\"undefined\")return y(e);var r=new ArrayBuffer(e.length),t=new Uint8Array(r);for(var a=0;a!=e.length;++a)t[a]=e.charCodeAt(a)&255;return r}function _(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join(\"\");var r=[];for(var t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join(\"\")}function x(e){if(typeof Uint8Array===\"undefined\")throw new Error(\"Unsupported\");return new Uint8Array(e)}function O(e){if(typeof ArrayBuffer==\"undefined\")throw new Error(\"Unsupported\");if(e instanceof ArrayBuffer)return O(new Uint8Array(e));var r=new Array(e.length);for(var t=0;t<e.length;++t)r[t]=e[t];return r}var R=T?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:A(e)}))}:function(e){if(typeof Uint8Array!==\"undefined\"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t);var n=0;for(r=0,t=0;r<e.length;t+=n,++r){n=e[r].length;if(e[r]instanceof Uint8Array)a.set(e[r],t);else if(typeof e[r]==\"string\"){throw\"wtf\"}else a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};function I(e){var r=[],t=0,a=e.length+250;var n=E(e.length+255);for(var i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[t++]=s;else if(s<2048){n[t++]=192|s>>6&31;n[t++]=128|s&63}else if(s>=55296&&s<57344){s=(s&1023)+64;var f=e.charCodeAt(++i)&1023;n[t++]=240|s>>8&7;n[t++]=128|s>>2&63;n[t++]=128|f>>6&15|(s&3)<<4;n[t++]=128|f&63}else{n[t++]=224|s>>12&15;n[t++]=128|s>>6&63;n[t++]=128|s&63}if(t>a){r.push(n.slice(0,t));t=0;n=E(65535);a=65530}}r.push(n.slice(0,t));return R(r)}var N=/\\u0000/g,D=/[\\u0001-\\u0006]/g;function F(e){var r=\"\",t=e.length-1;while(t>=0)r+=e.charAt(t--);return r}function P(e,r){var t=\"\"+e;return t.length>=r?t:wr(\"0\",r-t.length)+t}function L(e,r){var t=\"\"+e;return t.length>=r?t:wr(\" \",r-t.length)+t}function M(e,r){var t=\"\"+e;return t.length>=r?t:t+wr(\" \",r-t.length)}function U(e,r){var t=\"\"+Math.round(e);return t.length>=r?t:wr(\"0\",r-t.length)+t}function B(e,r){var t=\"\"+e;return t.length>=r?t:wr(\"0\",r-t.length)+t}var W=Math.pow(2,32);function H(e,r){if(e>W||e<-W)return U(e,r);var t=Math.round(e);return B(t,r)}function z(e,r){r=r||0;return e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var V=[[\"Sun\",\"Sunday\"],[\"Mon\",\"Monday\"],[\"Tue\",\"Tuesday\"],[\"Wed\",\"Wednesday\"],[\"Thu\",\"Thursday\"],[\"Fri\",\"Friday\"],[\"Sat\",\"Saturday\"]];var G=[[\"J\",\"Jan\",\"January\"],[\"F\",\"Feb\",\"February\"],[\"M\",\"Mar\",\"March\"],[\"A\",\"Apr\",\"April\"],[\"M\",\"May\",\"May\"],[\"J\",\"Jun\",\"June\"],[\"J\",\"Jul\",\"July\"],[\"A\",\"Aug\",\"August\"],[\"S\",\"Sep\",\"September\"],[\"O\",\"Oct\",\"October\"],[\"N\",\"Nov\",\"November\"],[\"D\",\"Dec\",\"December\"]];function j(e){if(!e)e={};e[0]=\"General\";e[1]=\"0\";e[2]=\"0.00\";e[3]=\"#,##0\";e[4]=\"#,##0.00\";e[9]=\"0%\";e[10]=\"0.00%\";e[11]=\"0.00E+00\";e[12]=\"# ?/?\";e[13]=\"# ??/??\";e[14]=\"m/d/yy\";e[15]=\"d-mmm-yy\";e[16]=\"d-mmm\";e[17]=\"mmm-yy\";e[18]=\"h:mm AM/PM\";e[19]=\"h:mm:ss AM/PM\";e[20]=\"h:mm\";e[21]=\"h:mm:ss\";e[22]=\"m/d/yy h:mm\";e[37]=\"#,##0 ;(#,##0)\";e[38]=\"#,##0 ;[Red](#,##0)\";e[39]=\"#,##0.00;(#,##0.00)\";e[40]=\"#,##0.00;[Red](#,##0.00)\";e[45]=\"mm:ss\";e[46]=\"[h]:mm:ss\";e[47]=\"mmss.0\";e[48]=\"##0.0E+0\";e[49]=\"@\";e[56]='\"/ \"hh\"\"mm\"\"ss\" \"';return e}var X={0:\"General\",1:\"0\",2:\"0.00\",3:\"#,##0\",4:\"#,##0.00\",9:\"0%\",10:\"0.00%\",11:\"0.00E+00\",12:\"# ?/?\",13:\"# ??/??\",14:\"m/d/yy\",15:\"d-mmm-yy\",16:\"d-mmm\",17:\"mmm-yy\",18:\"h:mm AM/PM\",19:\"h:mm:ss AM/PM\",20:\"h:mm\",21:\"h:mm:ss\",22:\"m/d/yy h:mm\",37:\"#,##0 ;(#,##0)\",38:\"#,##0 ;[Red](#,##0)\",39:\"#,##0.00;(#,##0.00)\",40:\"#,##0.00;[Red](#,##0.00)\",45:\"mm:ss\",46:\"[h]:mm:ss\",47:\"mmss.0\",48:\"##0.0E+0\",49:\"@\",56:'\"/ \"hh\"\"mm\"\"ss\" \"'};var Y={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0};var K={5:'\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',63:'\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',6:'\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',64:'\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',7:'\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',65:'\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',8:'\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',66:'\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',41:'_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',42:'_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',43:'_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',44:'_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'};function J(e,r,t){var a=e<0?-1:1;var n=e*a;var i=0,s=1,f=0;var o=1,l=0,c=0;var h=Math.floor(n);while(l<r){h=Math.floor(n);f=h*s+i;c=h*l+o;if(n-h<5e-8)break;n=1/(n-h);i=s;s=f;o=l;l=c}if(c>r){if(l>r){c=o;f=i}else{c=l;f=s}}if(!t)return[0,a*f,c];var u=Math.floor(a*f/c);return[u,a*f-u*c,c]}function q(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0;var s=[];var f={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6)f.u=0;if(r&&r.date1904)a+=1462;if(f.u>.9999){f.u=0;if(++n==86400){f.T=n=0;++a;++f.D}}if(a===60){s=t?[1317,10,29]:[1900,2,29];i=3}else if(a===0){s=t?[1317,8,29]:[1900,1,0];i=6}else{if(a>60)--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1);s=[o.getFullYear(),o.getMonth()+1,o.getDate()];i=o.getDay();if(a<60)i=(i+6)%7;if(t)i=oe(o,s)}f.y=s[0];f.m=s[1];f.d=s[2];f.S=n%60;n=Math.floor(n/60);f.M=n%60;n=Math.floor(n/60);f.H=n;f.q=i;return f}var Z=new Date(1899,11,31,0,0,0);var Q=Z.getTime();var ee=new Date(1900,2,1,0,0,0);function re(e,r){var t=e.getTime();if(r)t-=1461*24*60*60*1e3;else if(e>=ee)t+=24*60*60*1e3;return(t-(Q+(e.getTimezoneOffset()-Z.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function te(e){return e.indexOf(\".\")==-1?e:e.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/,\"$1\")}function ae(e){if(e.indexOf(\"E\")==-1)return e;return e.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/,\"$1E\").replace(/(E[+-])(\\d)$/,\"$10$2\")}function ne(e){var r=e<0?12:11;var t=te(e.toFixed(12));if(t.length<=r)return t;t=e.toPrecision(10);if(t.length<=r)return t;return e.toExponential(5)}function ie(e){var r=te(e.toFixed(11));return r.length>(e<0?12:11)||r===\"0\"||r===\"-0\"?e.toPrecision(6):r}function se(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;if(r>=-4&&r<=-1)t=e.toPrecision(10+r);else if(Math.abs(r)<=9)t=ne(e);else if(r===10)t=e.toFixed(10).substr(0,12);else t=ie(e);return te(ae(t.toUpperCase()))}function fe(e,r){switch(typeof e){case\"string\":return e;case\"boolean\":return e?\"TRUE\":\"FALSE\";case\"number\":return(e|0)===e?e.toString(10):se(e);case\"undefined\":return\"\";case\"object\":if(e==null)return\"\";if(e instanceof Date)return Be(14,re(e,r&&r.date1904),r);}throw new Error(\"unsupported value in General format: \"+e)}function oe(e,r){r[0]-=581;var t=e.getDay();if(e<60)t=(t+6)%7;return t}function le(e,r,t,a){var n=\"\",i=0,s=0,f=t.y,o,l=0;switch(e){case 98:f=t.y+543;case 121:switch(r.length){case 1:;case 2:o=f%100;l=2;break;default:o=f%1e4;l=4;break;}break;case 109:switch(r.length){case 1:;case 2:o=t.m;l=r.length;break;case 3:return G[t.m-1][1];case 5:return G[t.m-1][0];default:return G[t.m-1][2];}break;case 100:switch(r.length){case 1:;case 2:o=t.d;l=r.length;break;case 3:return V[t.q][0];default:return V[t.q][1];}break;case 104:switch(r.length){case 1:;case 2:o=1+(t.H+11)%12;l=r.length;break;default:throw\"bad hour format: \"+r;}break;case 72:switch(r.length){case 1:;case 2:o=t.H;l=r.length;break;default:throw\"bad hour format: \"+r;}break;case 77:switch(r.length){case 1:;case 2:o=t.M;l=r.length;break;default:throw\"bad minute format: \"+r;}break;case 115:if(r!=\"s\"&&r!=\"ss\"&&r!=\".0\"&&r!=\".00\"&&r!=\".000\")throw\"bad second format: \"+r;if(t.u===0&&(r==\"s\"||r==\"ss\"))return P(t.S,r.length);if(a>=2)s=a===3?1e3:100;else s=a===1?10:1;i=Math.round(s*(t.S+t.u));if(i>=60*s)i=0;if(r===\"s\")return i===0?\"0\":\"\"+i/s;n=P(i,2+a);if(r===\"ss\")return n.substr(0,2);return\".\"+n.substr(2,r.length-1);case 90:switch(r){case\"[h]\":;case\"[hh]\":o=t.D*24+t.H;break;case\"[m]\":;case\"[mm]\":o=(t.D*24+t.H)*60+t.M;break;case\"[s]\":;case\"[ss]\":o=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw\"bad abstime format: \"+r;}l=r.length===3?1:2;break;case 101:o=f;l=1;break;}var c=l>0?P(o,l):\"\";return c}function ce(e){var r=3;if(e.length<=r)return e;var t=e.length%r,a=e.substr(0,t);for(;t!=e.length;t+=r)a+=(a.length>0?\",\":\"\")+e.substr(t,r);return a}var he=/%/g;function ue(e,r,t){var a=r.replace(he,\"\"),n=r.length-a.length;return Ie(e,a,t*Math.pow(10,2*n))+wr(\"%\",n)}function de(e,r,t){var a=r.length-1;while(r.charCodeAt(a-1)===44)--a;return Ie(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function ve(e,r){var t;var a=e.indexOf(\"E\")-e.indexOf(\".\")-1;if(e.match(/^#+0.0E\\+0$/)){if(r==0)return\"0.0E+0\";else if(r<0)return\"-\"+ve(e,-r);var n=e.indexOf(\".\");if(n===-1)n=e.indexOf(\"E\");var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0)i+=n;t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n);if(t.indexOf(\"e\")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);if(t.indexOf(\".\")===-1)t=t.charAt(0)+\".\"+t.substr(1)+\"E+\"+(s-t.length+i);else t+=\"E+\"+(s-i);while(t.substr(0,2)===\"0.\"){t=t.charAt(0)+t.substr(2,n)+\".\"+t.substr(2+n);t=t.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\")}t=t.replace(/\\+-/,\"-\")}t=t.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+\".\"+a.substr(i)+\"E\"})}else t=r.toExponential(a);if(e.match(/E\\+00$/)&&t.match(/e[+-]\\d$/))t=t.substr(0,t.length-1)+\"0\"+t.charAt(t.length-1);if(e.match(/E\\-/)&&t.match(/e\\+/))t=t.replace(/e\\+/,\"e\");return t.replace(\"e\",\"E\")}var pe=/# (\\?+)( ?)\\/( ?)(\\d+)/;function ge(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),i=Math.floor(n/a);var s=n-i*a,f=a;return t+(i===0?\"\":\"\"+i)+\" \"+(s===0?wr(\" \",e[1].length+1+e[4].length):L(s,e[1].length)+e[2]+\"/\"+e[3]+P(f,e[4].length))}function me(e,r,t){return t+(r===0?\"\":\"\"+r)+wr(\" \",e[1].length+2+e[4].length)}var be=/^#*0*\\.([0#]+)/;var we=/\\).*[0#]/;var ke=/\\(###\\) ###\\\\?-####/;function Te(e){var r=\"\",t;for(var a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=\" \";break;case 48:r+=\"0\";break;default:r+=String.fromCharCode(t);}return r}function Ae(e,r){var t=Math.pow(10,r);return\"\"+Math.round(e*t)/t}function Ee(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);if(r<(\"\"+Math.round(t*a)).length)return 0;return Math.round(t*a)}function Ce(e,r){if(r<(\"\"+Math.round((e-Math.floor(e))*Math.pow(10,r))).length){return 1}return 0}function ye(e){if(e<2147483647&&e>-2147483648)return\"\"+(e>=0?e|0:e-1|0);return\"\"+Math.floor(e)}function Se(e,r,t){if(e.charCodeAt(0)===40&&!r.match(we)){var a=r.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");if(t>=0)return Se(\"n\",a,t);return\"(\"+Se(\"n\",a,-t)+\")\"}if(r.charCodeAt(r.length-1)===44)return de(e,r,t);if(r.indexOf(\"%\")!==-1)return ue(e,r,t);if(r.indexOf(\"E\")!==-1)return ve(r,t);if(r.charCodeAt(0)===36)return\"$\"+Se(e,r.substr(r.charAt(1)==\" \"?2:1),t);var n;var i,s,f,o=Math.abs(t),l=t<0?\"-\":\"\";if(r.match(/^00+$/))return l+H(o,r.length);if(r.match(/^[#?]+$/)){n=H(t,0);if(n===\"0\")n=\"\";return n.length>r.length?n:Te(r.substr(0,r.length-n.length))+n}if(i=r.match(pe))return ge(i,o,l);if(r.match(/^#+0+$/))return l+H(o,r.length-r.indexOf(\"0\"));if(i=r.match(be)){n=Ae(t,i[1].length).replace(/^([^\\.]+)$/,\"$1.\"+Te(i[1])).replace(/\\.$/,\".\"+Te(i[1])).replace(/\\.(\\d*)$/,function(e,r){return\".\"+r+wr(\"0\",Te(i[1]).length-r.length)});return r.indexOf(\"0.\")!==-1?n:n.replace(/^0\\./,\".\")}r=r.replace(/^#+([0.])/,\"$1\");if(i=r.match(/^(0*)\\.(#*)$/)){return l+Ae(o,i[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,i[1].length?\"0.\":\".\")}if(i=r.match(/^#{1,3},##0(\\.?)$/))return l+ce(H(o,0));if(i=r.match(/^#,##0\\.([#0]*0)$/)){return t<0?\"-\"+Se(e,r,-t):ce(\"\"+(Math.floor(t)+Ce(t,i[1].length)))+\".\"+P(Ee(t,i[1].length),i[1].length)}if(i=r.match(/^#,#*,#0/))return Se(e,r.replace(/^#,#*,/,\"\"),t);if(i=r.match(/^([0#]+)(\\\\?-([0#]+))+$/)){n=F(Se(e,r.replace(/[\\\\-]/g,\"\"),t));s=0;return F(F(r.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(e){return s<n.length?n.charAt(s++):e===\"0\"?\"0\":\"\"}))}if(r.match(ke)){n=Se(e,\"##########\",t);return\"(\"+n.substr(0,3)+\") \"+n.substr(3,3)+\"-\"+n.substr(6)}var c=\"\";if(i=r.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)){s=Math.min(i[4].length,7);f=J(o,Math.pow(10,s)-1,false);n=\"\"+l;c=Ie(\"n\",i[1],f[1]);if(c.charAt(c.length-1)==\" \")c=c.substr(0,c.length-1)+\"0\";n+=c+i[2]+\"/\"+i[3];c=M(f[2],s);if(c.length<i[4].length)c=Te(i[4].substr(i[4].length-c.length))+c;n+=c;return n}if(i=r.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)){s=Math.min(Math.max(i[1].length,i[4].length),7);f=J(o,Math.pow(10,s)-1,true);return l+(f[0]||(f[1]?\"\":\"0\"))+\" \"+(f[1]?L(f[1],s)+i[2]+\"/\"+i[3]+M(f[2],s):wr(\" \",2*s+1+i[2].length+i[3].length))}if(i=r.match(/^[#0?]+$/)){n=H(t,0);if(r.length<=n.length)return n;return Te(r.substr(0,r.length-n.length))+n}if(i=r.match(/^([#0?]+)\\.([#0]+)$/)){n=\"\"+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,\"$1\");s=n.indexOf(\".\");var h=r.indexOf(\".\")-s,u=r.length-n.length-h;return Te(r.substr(0,h)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\\.([#0]*0)$/)){s=Ee(t,i[1].length);return t<0?\"-\"+Se(e,r,-t):ce(ye(t)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function(e){return\"00,\"+(e.length<3?P(0,3-e.length):\"\")+e})+\".\"+P(s,i[1].length)}switch(r){case\"###,##0.00\":return Se(e,\"#,##0.00\",t);case\"###,###\":;case\"##,###\":;case\"#,###\":var d=ce(H(o,0));return d!==\"0\"?l+d:\"\";case\"###,###.00\":return Se(e,\"###,##0.00\",t).replace(/^0\\./,\".\");case\"#,###.00\":return Se(e,\"#,##0.00\",t).replace(/^0\\./,\".\");default:;}throw new Error(\"unsupported format |\"+r+\"|\")}function _e(e,r,t){var a=r.length-1;while(r.charCodeAt(a-1)===44)--a;return Ie(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function xe(e,r,t){var a=r.replace(he,\"\"),n=r.length-a.length;return Ie(e,a,t*Math.pow(10,2*n))+wr(\"%\",n)}function Oe(e,r){var t;var a=e.indexOf(\"E\")-e.indexOf(\".\")-1;if(e.match(/^#+0.0E\\+0$/)){if(r==0)return\"0.0E+0\";else if(r<0)return\"-\"+Oe(e,-r);var n=e.indexOf(\".\");if(n===-1)n=e.indexOf(\"E\");var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0)i+=n;t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n);if(!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);if(t.indexOf(\".\")===-1)t=t.charAt(0)+\".\"+t.substr(1)+\"E+\"+(s-t.length+i);else t+=\"E+\"+(s-i);t=t.replace(/\\+-/,\"-\")}t=t.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+\".\"+a.substr(i)+\"E\"})}else t=r.toExponential(a);if(e.match(/E\\+00$/)&&t.match(/e[+-]\\d$/))t=t.substr(0,t.length-1)+\"0\"+t.charAt(t.length-1);if(e.match(/E\\-/)&&t.match(/e\\+/))t=t.replace(/e\\+/,\"e\");return t.replace(\"e\",\"E\")}function Re(e,r,t){if(e.charCodeAt(0)===40&&!r.match(we)){var a=r.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");if(t>=0)return Re(\"n\",a,t);return\"(\"+Re(\"n\",a,-t)+\")\"}if(r.charCodeAt(r.length-1)===44)return _e(e,r,t);if(r.indexOf(\"%\")!==-1)return xe(e,r,t);if(r.indexOf(\"E\")!==-1)return Oe(r,t);if(r.charCodeAt(0)===36)return\"$\"+Re(e,r.substr(r.charAt(1)==\" \"?2:1),t);var n;var i,s,f,o=Math.abs(t),l=t<0?\"-\":\"\";if(r.match(/^00+$/))return l+P(o,r.length);if(r.match(/^[#?]+$/)){n=\"\"+t;if(t===0)n=\"\";return n.length>r.length?n:Te(r.substr(0,r.length-n.length))+n}if(i=r.match(pe))return me(i,o,l);if(r.match(/^#+0+$/))return l+P(o,r.length-r.indexOf(\"0\"));if(i=r.match(be)){n=(\"\"+t).replace(/^([^\\.]+)$/,\"$1.\"+Te(i[1])).replace(/\\.$/,\".\"+Te(i[1]));n=n.replace(/\\.(\\d*)$/,function(e,r){return\".\"+r+wr(\"0\",Te(i[1]).length-r.length)});return r.indexOf(\"0.\")!==-1?n:n.replace(/^0\\./,\".\")}r=r.replace(/^#+([0.])/,\"$1\");if(i=r.match(/^(0*)\\.(#*)$/)){return l+(\"\"+o).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,i[1].length?\"0.\":\".\")}if(i=r.match(/^#{1,3},##0(\\.?)$/))return l+ce(\"\"+o);if(i=r.match(/^#,##0\\.([#0]*0)$/)){return t<0?\"-\"+Re(e,r,-t):ce(\"\"+t)+\".\"+wr(\"0\",i[1].length)}if(i=r.match(/^#,#*,#0/))return Re(e,r.replace(/^#,#*,/,\"\"),t);if(i=r.match(/^([0#]+)(\\\\?-([0#]+))+$/)){n=F(Re(e,r.replace(/[\\\\-]/g,\"\"),t));s=0;return F(F(r.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(e){return s<n.length?n.charAt(s++):e===\"0\"?\"0\":\"\"}))}if(r.match(ke)){n=Re(e,\"##########\",t);return\"(\"+n.substr(0,3)+\") \"+n.substr(3,3)+\"-\"+n.substr(6)}var c=\"\";if(i=r.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)){s=Math.min(i[4].length,7);f=J(o,Math.pow(10,s)-1,false);n=\"\"+l;c=Ie(\"n\",i[1],f[1]);if(c.charAt(c.length-1)==\" \")c=c.substr(0,c.length-1)+\"0\";n+=c+i[2]+\"/\"+i[3];c=M(f[2],s);if(c.length<i[4].length)c=Te(i[4].substr(i[4].length-c.length))+c;n+=c;return n}if(i=r.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)){s=Math.min(Math.max(i[1].length,i[4].length),7);f=J(o,Math.pow(10,s)-1,true);return l+(f[0]||(f[1]?\"\":\"0\"))+\" \"+(f[1]?L(f[1],s)+i[2]+\"/\"+i[3]+M(f[2],s):wr(\" \",2*s+1+i[2].length+i[3].length))}if(i=r.match(/^[#0?]+$/)){n=\"\"+t;if(r.length<=n.length)return n;return Te(r.substr(0,r.length-n.length))+n}if(i=r.match(/^([#0]+)\\.([#0]+)$/)){n=\"\"+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,\"$1\");s=n.indexOf(\".\");var h=r.indexOf(\".\")-s,u=r.length-n.length-h;return Te(r.substr(0,h)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\\.([#0]*0)$/)){return t<0?\"-\"+Re(e,r,-t):ce(\"\"+t).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function(e){return\"00,\"+(e.length<3?P(0,3-e.length):\"\")+e})+\".\"+P(0,i[1].length)}switch(r){case\"###,###\":;case\"##,###\":;case\"#,###\":var d=ce(\"\"+o);return d!==\"0\"?l+d:\"\";default:if(r.match(/\\.[0#?]*$/))return Re(e,r.slice(0,r.lastIndexOf(\".\")),t)+Te(r.slice(r.lastIndexOf(\".\")));}throw new Error(\"unsupported format |\"+r+\"|\")}function Ie(e,r,t){return(t|0)===t?Re(e,r,t):Se(e,r,t)}function Ne(e){var r=[];var t=false;for(var a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:;case 42:;case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n);n=a+1;}r[r.length]=e.substr(n);if(t===true)throw new Error(\"Format |\"+e+\"| unterminated string \");return r}var De=/\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;function Fe(e){var r=0,t=\"\",a=\"\";while(r<e.length){switch(t=e.charAt(r)){case\"G\":if(z(e,r))r+=6;r++;break;case'\"':for(;e.charCodeAt(++r)!==34&&r<e.length;){}++r;break;case\"\\\\\":r+=2;break;case\"_\":r+=2;break;case\"@\":++r;break;case\"B\":;case\"b\":if(e.charAt(r+1)===\"1\"||e.charAt(r+1)===\"2\")return true;case\"M\":;case\"D\":;case\"Y\":;case\"H\":;case\"S\":;case\"E\":;case\"m\":;case\"d\":;case\"y\":;case\"h\":;case\"s\":;case\"e\":;case\"g\":return true;case\"A\":;case\"a\":;case\"\":if(e.substr(r,3).toUpperCase()===\"A/P\")return true;if(e.substr(r,5).toUpperCase()===\"AM/PM\")return true;if(e.substr(r,5).toUpperCase()===\"/\")return true;++r;break;case\"[\":a=t;while(e.charAt(r++)!==\"]\"&&r<e.length)a+=e.charAt(r);if(a.match(De))return true;break;case\".\":;case\"0\":;case\"#\":while(r<e.length&&(\"0#?.,E+-%\".indexOf(t=e.charAt(++r))>-1||t==\"\\\\\"&&e.charAt(r+1)==\"-\"&&\"0#\".indexOf(e.charAt(r+2))>-1)){}break;case\"?\":while(e.charAt(++r)===t){}break;case\"*\":++r;if(e.charAt(r)==\" \"||e.charAt(r)==\"*\")++r;break;case\"(\":;case\")\":++r;break;case\"1\":;case\"2\":;case\"3\":;case\"4\":;case\"5\":;case\"6\":;case\"7\":;case\"8\":;case\"9\":while(r<e.length&&\"0123456789\".indexOf(e.charAt(++r))>-1){}break;case\" \":++r;break;default:++r;break;}}return false}function Pe(e,r,t,a){\nvar n=[],i=\"\",s=0,f=\"\",o=\"t\",l,c,h;var u=\"H\";while(s<e.length){switch(f=e.charAt(s)){case\"G\":if(!z(e,s))throw new Error(\"unrecognized character \"+f+\" in \"+e);n[n.length]={t:\"G\",v:\"General\"};s+=7;break;case'\"':for(i=\"\";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);n[n.length]={t:\"t\",v:i};++s;break;case\"\\\\\":var d=e.charAt(++s),v=d===\"(\"||d===\")\"?d:\"t\";n[n.length]={t:v,v:d};++s;break;case\"_\":n[n.length]={t:\"t\",v:\" \"};s+=2;break;case\"@\":n[n.length]={t:\"T\",v:r};++s;break;case\"B\":;case\"b\":if(e.charAt(s+1)===\"1\"||e.charAt(s+1)===\"2\"){if(l==null){l=q(r,t,e.charAt(s+1)===\"2\");if(l==null)return\"\"}n[n.length]={t:\"X\",v:e.substr(s,2)};o=f;s+=2;break};case\"M\":;case\"D\":;case\"Y\":;case\"H\":;case\"S\":;case\"E\":f=f.toLowerCase();case\"m\":;case\"d\":;case\"y\":;case\"h\":;case\"s\":;case\"e\":;case\"g\":if(r<0)return\"\";if(l==null){l=q(r,t);if(l==null)return\"\"}i=f;while(++s<e.length&&e.charAt(s).toLowerCase()===f)i+=f;if(f===\"m\"&&o.toLowerCase()===\"h\")f=\"M\";if(f===\"h\")f=u;n[n.length]={t:f,v:i};o=f;break;case\"A\":;case\"a\":;case\"\":var p={t:f,v:f};if(l==null)l=q(r,t);if(e.substr(s,3).toUpperCase()===\"A/P\"){if(l!=null)p.v=l.H>=12?\"P\":\"A\";p.t=\"T\";u=\"h\";s+=3}else if(e.substr(s,5).toUpperCase()===\"AM/PM\"){if(l!=null)p.v=l.H>=12?\"PM\":\"AM\";p.t=\"T\";s+=5;u=\"h\"}else if(e.substr(s,5).toUpperCase()===\"/\"){if(l!=null)p.v=l.H>=12?\"\":\"\";p.t=\"T\";s+=5;u=\"h\"}else{p.t=\"t\";++s}if(l==null&&p.t===\"T\")return\"\";n[n.length]=p;o=f;break;case\"[\":i=f;while(e.charAt(s++)!==\"]\"&&s<e.length)i+=e.charAt(s);if(i.slice(-1)!==\"]\")throw'unterminated \"[\" block: |'+i+\"|\";if(i.match(De)){if(l==null){l=q(r,t);if(l==null)return\"\"}n[n.length]={t:\"Z\",v:i.toLowerCase()};o=i.charAt(1)}else if(i.indexOf(\"$\")>-1){i=(i.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";if(!Fe(e))n[n.length]={t:\"t\",v:i}}break;case\".\":if(l!=null){i=f;while(++s<e.length&&(f=e.charAt(s))===\"0\")i+=f;n[n.length]={t:\"s\",v:i};break};case\"0\":;case\"#\":i=f;while(++s<e.length&&\"0#?.,E+-%\".indexOf(f=e.charAt(s))>-1)i+=f;n[n.length]={t:\"n\",v:i};break;case\"?\":i=f;while(e.charAt(++s)===f)i+=f;n[n.length]={t:f,v:i};o=f;break;case\"*\":++s;if(e.charAt(s)==\" \"||e.charAt(s)==\"*\")++s;break;case\"(\":;case\")\":n[n.length]={t:a===1?\"t\":f,v:f};++s;break;case\"1\":;case\"2\":;case\"3\":;case\"4\":;case\"5\":;case\"6\":;case\"7\":;case\"8\":;case\"9\":i=f;while(s<e.length&&\"0123456789\".indexOf(e.charAt(++s))>-1)i+=e.charAt(s);n[n.length]={t:\"D\",v:i};break;case\" \":n[n.length]={t:f,v:f};++s;break;case\"$\":n[n.length]={t:\"t\",v:\"$\"};++s;break;default:if(\",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP\".indexOf(f)===-1)throw new Error(\"unrecognized character \"+f+\" in \"+e);n[n.length]={t:\"t\",v:f};++s;break;}}var g=0,m=0,b;for(s=n.length-1,o=\"t\";s>=0;--s){switch(n[s].t){case\"h\":;case\"H\":n[s].t=u;o=\"h\";if(g<1)g=1;break;case\"s\":if(b=n[s].v.match(/\\.0+$/))m=Math.max(m,b[0].length-1);if(g<3)g=3;case\"d\":;case\"y\":;case\"M\":;case\"e\":o=n[s].t;break;case\"m\":if(o===\"s\"){n[s].t=\"M\";if(g<2)g=2}break;case\"X\":break;case\"Z\":if(g<1&&n[s].v.match(/[Hh]/))g=1;if(g<2&&n[s].v.match(/[Mm]/))g=2;if(g<3&&n[s].v.match(/[Ss]/))g=3;}}switch(g){case 0:break;case 1:if(l.u>=.5){l.u=0;++l.S}if(l.S>=60){l.S=0;++l.M}if(l.M>=60){l.M=0;++l.H}break;case 2:if(l.u>=.5){l.u=0;++l.S}if(l.S>=60){l.S=0;++l.M}break;}var w=\"\",k;for(s=0;s<n.length;++s){switch(n[s].t){case\"t\":;case\"T\":;case\" \":;case\"D\":break;case\"X\":n[s].v=\"\";n[s].t=\";\";break;case\"d\":;case\"m\":;case\"y\":;case\"h\":;case\"H\":;case\"M\":;case\"s\":;case\"e\":;case\"b\":;case\"Z\":n[s].v=le(n[s].t.charCodeAt(0),n[s].v,l,m);n[s].t=\"t\";break;case\"n\":;case\"?\":k=s+1;while(n[k]!=null&&((f=n[k].t)===\"?\"||f===\"D\"||(f===\" \"||f===\"t\")&&n[k+1]!=null&&(n[k+1].t===\"?\"||n[k+1].t===\"t\"&&n[k+1].v===\"/\")||n[s].t===\"(\"&&(f===\" \"||f===\"n\"||f===\")\")||f===\"t\"&&(n[k].v===\"/\"||n[k].v===\" \"&&n[k+1]!=null&&n[k+1].t==\"?\"))){n[s].v+=n[k].v;n[k]={v:\"\",t:\";\"};++k}w+=n[s].v;s=k-1;break;case\"G\":n[s].t=\"t\";n[s].v=fe(r,t);break;}}var T=\"\",A,E;if(w.length>0){if(w.charCodeAt(0)==40){A=r<0&&w.charCodeAt(0)===45?-r:r;E=Ie(\"n\",w,A)}else{A=r<0&&a>1?-r:r;E=Ie(\"n\",w,A);if(A<0&&n[0]&&n[0].t==\"t\"){E=E.substr(1);n[0].v=\"-\"+n[0].v}}k=E.length-1;var C=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!=\"t\"&&n[s].v.indexOf(\".\")>-1){C=s;break}var y=n.length;if(C===n.length&&E.indexOf(\"E\")===-1){for(s=n.length-1;s>=0;--s){if(n[s]==null||\"n?\".indexOf(n[s].t)===-1)continue;if(k>=n[s].v.length-1){k-=n[s].v.length;n[s].v=E.substr(k+1,n[s].v.length)}else if(k<0)n[s].v=\"\";else{n[s].v=E.substr(0,k+1);k=-1}n[s].t=\"t\";y=s}if(k>=0&&y<n.length)n[y].v=E.substr(0,k+1)+n[y].v}else if(C!==n.length&&E.indexOf(\"E\")===-1){k=E.indexOf(\".\")-1;for(s=C;s>=0;--s){if(n[s]==null||\"n?\".indexOf(n[s].t)===-1)continue;c=n[s].v.indexOf(\".\")>-1&&s===C?n[s].v.indexOf(\".\")-1:n[s].v.length-1;T=n[s].v.substr(c+1);for(;c>=0;--c){if(k>=0&&(n[s].v.charAt(c)===\"0\"||n[s].v.charAt(c)===\"#\"))T=E.charAt(k--)+T}n[s].v=T;n[s].t=\"t\";y=s}if(k>=0&&y<n.length)n[y].v=E.substr(0,k+1)+n[y].v;k=E.indexOf(\".\")+1;for(s=C;s<n.length;++s){if(n[s]==null||\"n?(\".indexOf(n[s].t)===-1&&s!==C)continue;c=n[s].v.indexOf(\".\")>-1&&s===C?n[s].v.indexOf(\".\")+1:0;T=n[s].v.substr(0,c);for(;c<n[s].v.length;++c){if(k<E.length)T+=E.charAt(k++)}n[s].v=T;n[s].t=\"t\";y=s}}}for(s=0;s<n.length;++s)if(n[s]!=null&&\"n?\".indexOf(n[s].t)>-1){A=a>1&&r<0&&s>0&&n[s-1].v===\"-\"?-r:r;n[s].v=Ie(n[s].t,n[s].v,A);n[s].t=\"t\"}var S=\"\";for(s=0;s!==n.length;++s)if(n[s]!=null)S+=n[s].v;return S}var Le=/\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;function Me(e,r){if(r==null)return false;var t=parseFloat(r[2]);switch(r[1]){case\"=\":if(e==t)return true;break;case\">\":if(e>t)return true;break;case\"<\":if(e<t)return true;break;case\"<>\":if(e!=t)return true;break;case\">=\":if(e>=t)return true;break;case\"<=\":if(e<=t)return true;break;}return false}function Ue(e,r){var t=Ne(e);var a=t.length,n=t[a-1].indexOf(\"@\");if(a<4&&n>-1)--a;if(t.length>4)throw new Error(\"cannot find right format for |\"+t.join(\"|\")+\"|\");if(typeof r!==\"number\")return[4,t.length===4||n>-1?t[t.length-1]:\"@\"];switch(t.length){case 1:t=n>-1?[\"General\",\"General\",\"General\",t[0]]:[t[0],t[0],t[0],\"@\"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],\"@\"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],\"@\"];break;case 4:break;}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf(\"[\")===-1&&t[1].indexOf(\"[\")===-1)return[a,i];if(t[0].match(/\\[[=<>]/)!=null||t[1].match(/\\[[=<>]/)!=null){var s=t[0].match(Le);var f=t[1].match(Le);return Me(r,s)?[a,t[0]]:Me(r,f)?[a,t[1]]:[a,t[s!=null&&f!=null?2:1]]}return[a,i]}function Be(e,r,t){if(t==null)t={};var a=\"\";switch(typeof e){case\"string\":if(e==\"m/d/yy\"&&t.dateNF)a=t.dateNF;else a=e;break;case\"number\":if(e==14&&t.dateNF)a=t.dateNF;else a=(t.table!=null?t.table:X)[e];if(a==null)a=t.table&&t.table[Y[e]]||X[Y[e]];if(a==null)a=K[e]||\"General\";break;}if(z(a,0))return fe(r,t);if(r instanceof Date)r=re(r,t.date1904);var n=Ue(a,r);if(z(n[1]))return fe(r,t);if(r===true)r=\"TRUE\";else if(r===false)r=\"FALSE\";else if(r===\"\"||r==null)return\"\";return Pe(n[1],r,t,n[0])}function We(e,r){if(typeof r!=\"number\"){r=+r||-1;for(var t=0;t<392;++t){if(X[t]==undefined){if(r<0)r=t;continue}if(X[t]==e){r=t;break}}if(r<0)r=391}X[r]=e;return r}function He(e){for(var r=0;r!=392;++r)if(e[r]!==undefined)We(e[r],r)}function ze(){X=j()}var Ve={format:Be,load:We,_table:X,load_table:He,parse_date_code:q,is_date:Fe,get_table:function Qw(){return Ve._table=X}};var Ge={5:'\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',6:'\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',7:'\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',8:'\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',23:\"General\",24:\"General\",25:\"General\",26:\"General\",27:\"m/d/yy\",28:\"m/d/yy\",29:\"m/d/yy\",30:\"m/d/yy\",31:\"m/d/yy\",32:\"h:mm:ss\",33:\"h:mm:ss\",34:\"h:mm:ss\",35:\"h:mm:ss\",36:\"m/d/yy\",41:'_(* #,##0_);_(* (#,##0);_(* \"-\"_);_(@_)',42:'_(\"$\"* #,##0_);_(\"$\"* (#,##0);_(\"$\"* \"-\"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* \"-\"??_);_(@_)',44:'_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',50:\"m/d/yy\",51:\"m/d/yy\",52:\"m/d/yy\",53:\"m/d/yy\",54:\"m/d/yy\",55:\"m/d/yy\",56:\"m/d/yy\",57:\"m/d/yy\",58:\"m/d/yy\",59:\"0\",60:\"0.00\",61:\"#,##0\",62:\"#,##0.00\",63:'\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',64:'\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',65:'\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',66:'\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',67:\"0%\",68:\"0.00%\",69:\"# ?/?\",70:\"# ??/??\",71:\"m/d/yy\",72:\"m/d/yy\",73:\"d-mmm-yy\",74:\"d-mmm\",75:\"mmm-yy\",76:\"h:mm\",77:\"h:mm:ss\",78:\"m/d/yy h:mm\",79:\"mm:ss\",80:\"[h]:mm:ss\",81:\"mmss.0\"};var je=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Xe(e){var r=typeof e==\"number\"?X[e]:e;r=r.replace(je,\"(\\\\d+)\");return new RegExp(\"^\"+r+\"$\")}function $e(e,r,t){var a=-1,n=-1,i=-1,s=-1,f=-1,o=-1;(r.match(je)||[]).forEach(function(e,r){var l=parseInt(t[r+1],10);switch(e.toLowerCase().charAt(0)){case\"y\":a=l;break;case\"d\":i=l;break;case\"h\":s=l;break;case\"s\":o=l;break;case\"m\":if(s>=0)f=l;else n=l;break;}});if(o>=0&&f==-1&&n>=0){f=n;n=-1}var l=(\"\"+(a>=0?a:(new Date).getFullYear())).slice(-4)+\"-\"+(\"00\"+(n>=1?n:1)).slice(-2)+\"-\"+(\"00\"+(i>=1?i:1)).slice(-2);if(l.length==7)l=\"0\"+l;if(l.length==8)l=\"20\"+l;var c=(\"00\"+(s>=0?s:0)).slice(-2)+\":\"+(\"00\"+(f>=0?f:0)).slice(-2)+\":\"+(\"00\"+(o>=0?o:0)).slice(-2);if(s==-1&&f==-1&&o==-1)return l;if(a==-1&&n==-1&&i==-1)return c;return l+\"T\"+c}var Ye=function(){var e={};e.version=\"1.2.0\";function r(){var e=0,r=new Array(256);for(var t=0;t!=256;++t){e=t;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;e=e&1?-306674912^e>>>1:e>>>1;r[t]=e}return typeof Int32Array!==\"undefined\"?new Int32Array(r):r}var t=r();function a(e){var r=0,t=0,a=0,n=typeof Int32Array!==\"undefined\"?new Int32Array(4096):new Array(4096);for(a=0;a!=256;++a)n[a]=e[a];for(a=0;a!=256;++a){t=e[a];for(r=256+a;r<4096;r+=256)t=n[r]=t>>>8^e[t&255]}var i=[];for(a=1;a!=16;++a)i[a-1]=typeof Int32Array!==\"undefined\"?n.subarray(a*256,a*256+256):n.slice(a*256,a*256+256);return i}var n=a(t);var i=n[0],s=n[1],f=n[2],o=n[3],l=n[4];var c=n[5],h=n[6],u=n[7],d=n[8],v=n[9];var p=n[10],g=n[11],m=n[12],b=n[13],w=n[14];function k(e,r){var a=r^-1;for(var n=0,i=e.length;n<i;)a=a>>>8^t[(a^e.charCodeAt(n++))&255];return~a}function T(e,r){var a=r^-1,n=e.length-15,k=0;for(;k<n;)a=w[e[k++]^a&255]^b[e[k++]^a>>8&255]^m[e[k++]^a>>16&255]^g[e[k++]^a>>>24]^p[e[k++]]^v[e[k++]]^d[e[k++]]^u[e[k++]]^h[e[k++]]^c[e[k++]]^l[e[k++]]^o[e[k++]]^f[e[k++]]^s[e[k++]]^i[e[k++]]^t[e[k++]];n+=15;while(k<n)a=a>>>8^t[(a^e[k++])&255];return~a}function A(e,r){var a=r^-1;for(var n=0,i=e.length,s=0,f=0;n<i;){s=e.charCodeAt(n++);if(s<128){a=a>>>8^t[(a^s)&255]}else if(s<2048){a=a>>>8^t[(a^(192|s>>6&31))&255];a=a>>>8^t[(a^(128|s&63))&255]}else if(s>=55296&&s<57344){s=(s&1023)+64;f=e.charCodeAt(n++)&1023;a=a>>>8^t[(a^(240|s>>8&7))&255];a=a>>>8^t[(a^(128|s>>2&63))&255];a=a>>>8^t[(a^(128|f>>6&15|(s&3)<<4))&255];a=a>>>8^t[(a^(128|f&63))&255]}else{a=a>>>8^t[(a^(224|s>>12&15))&255];a=a>>>8^t[(a^(128|s>>6&63))&255];a=a>>>8^t[(a^(128|s&63))&255]}}return~a}e.table=t;e.bstr=k;e.buf=T;e.str=A;return e}();var Ke=function ek(){var e={};e.version=\"1.2.1\";function r(e,r){var t=e.split(\"/\"),a=r.split(\"/\");for(var n=0,i=0,s=Math.min(t.length,a.length);n<s;++n){if(i=t[n].length-a[n].length)return i;if(t[n]!=a[n])return t[n]<a[n]?-1:1}return t.length-a.length}function t(e){if(e.charAt(e.length-1)==\"/\")return e.slice(0,-1).indexOf(\"/\")===-1?e:t(e.slice(0,-1));var r=e.lastIndexOf(\"/\");return r===-1?e:e.slice(0,r+1)}function a(e){if(e.charAt(e.length-1)==\"/\")return a(e.slice(0,-1));var r=e.lastIndexOf(\"/\");return r===-1?e:e.slice(r+1)}function n(e,r){if(typeof r===\"string\")r=new Date(r);var t=r.getHours();t=t<<6|r.getMinutes();t=t<<5|r.getSeconds()>>>1;e._W(2,t);var a=r.getFullYear()-1980;a=a<<4|r.getMonth()+1;a=a<<5|r.getDate();e._W(2,a)}function i(e){var r=e._R(2)&65535;var t=e._R(2)&65535;var a=new Date;var n=t&31;t>>>=5;var i=t&15;t>>>=4;a.setMilliseconds(0);a.setFullYear(t+1980);a.setMonth(i-1);a.setDate(n);var s=r&31;r>>>=5;var f=r&63;r>>>=6;a.setHours(r);a.setMinutes(f);a.setSeconds(s<<1);return a}function s(e){ca(e,0);var r={};var t=0;while(e.l<=e.length-4){var a=e._R(2);var n=e._R(2),i=e.l+n;var s={};switch(a){case 21589:{t=e._R(1);if(t&1)s.mtime=e._R(4);if(n>5){if(t&2)s.atime=e._R(4);if(t&4)s.ctime=e._R(4)}if(s.mtime)s.mt=new Date(s.mtime*1e3)}break;}e.l=i;r[a]=s}return r}var f;function o(){return f||(f=undefined)}function l(e,r){if(e[0]==80&&e[1]==75)return Ie(e,r);if((e[0]|32)==109&&(e[1]|32)==105)return We(e,r);if(e.length<512)throw new Error(\"CFB file size \"+e.length+\" < 512\");var t=3;var a=512;var n=0;var i=0;var s=0;var f=0;var o=0;var l=[];var v=e.slice(0,512);ca(v,0);var g=c(v);t=g[0];switch(t){case 3:a=512;break;case 4:a=4096;break;case 0:if(g[1]==0)return Ie(e,r);default:throw new Error(\"Major Version: Expected 3 or 4 saw \"+t);}if(a!==512){v=e.slice(0,a);ca(v,28)}var w=e.slice(0,a);h(v,t);var k=v._R(4,\"i\");if(t===3&&k!==0)throw new Error(\"# Directory Sectors: Expected 0 saw \"+k);v.l+=4;s=v._R(4,\"i\");v.l+=4;v.chk(\"00100000\",\"Mini Stream Cutoff Size: \");f=v._R(4,\"i\");n=v._R(4,\"i\");o=v._R(4,\"i\");i=v._R(4,\"i\");for(var T=-1,A=0;A<109;++A){T=v._R(4,\"i\");if(T<0)break;l[A]=T}var E=u(e,a);p(o,i,E,a,l);var C=m(E,s,l,a);C[s].name=\"!Directory\";if(n>0&&f!==U)C[f].name=\"!MiniFAT\";C[l[0]].name=\"!FAT\";C.fat_addrs=l;C.ssz=a;var y={},S=[],_=[],x=[];b(s,C,E,S,n,y,_,f);d(_,x,S);S.shift();var O={FileIndex:_,FullPaths:x};if(r&&r.raw)O.raw={header:w,sectors:E};return O}function c(e){if(e[e.l]==80&&e[e.l+1]==75)return[0,0];e.chk(B,\"Header Signature: \");e.l+=16;var r=e._R(2,\"u\");return[e._R(2,\"u\"),r]}function h(e,r){var t=9;e.l+=2;switch(t=e._R(2)){case 9:if(r!=3)throw new Error(\"Sector Shift: Expected 9 saw \"+t);break;case 12:if(r!=4)throw new Error(\"Sector Shift: Expected 12 saw \"+t);break;default:throw new Error(\"Sector Shift: Expected 9 or 12 saw \"+t);}e.chk(\"0600\",\"Mini Sector Shift: \");e.chk(\"000000000000\",\"Reserved: \")}function u(e,r){var t=Math.ceil(e.length/r)-1;var a=[];for(var n=1;n<t;++n)a[n-1]=e.slice(n*r,(n+1)*r);a[t-1]=e.slice(t*r);return a}function d(e,r,t){var a=0,n=0,i=0,s=0,f=0,o=t.length;var l=[],c=[];for(;a<o;++a){l[a]=c[a]=a;r[a]=t[a]}for(;f<c.length;++f){a=c[f];n=e[a].L;i=e[a].R;s=e[a].C;if(l[a]===a){if(n!==-1&&l[n]!==n)l[a]=l[n];if(i!==-1&&l[i]!==i)l[a]=l[i]}if(s!==-1)l[s]=a;if(n!==-1&&a!=l[a]){l[n]=l[a];if(c.lastIndexOf(n)<f)c.push(n)}if(i!==-1&&a!=l[a]){l[i]=l[a];if(c.lastIndexOf(i)<f)c.push(i)}}for(a=1;a<o;++a)if(l[a]===a){if(i!==-1&&l[i]!==i)l[a]=l[i];else if(n!==-1&&l[n]!==n)l[a]=l[n]}for(a=1;a<o;++a){if(e[a].type===0)continue;f=a;if(f!=l[f])do{f=l[f];r[a]=r[f]+\"/\"+r[a]}while(f!==0&&-1!==l[f]&&f!=l[f]);l[a]=-1}r[0]+=\"/\";for(a=1;a<o;++a){if(e[a].type!==2)r[a]+=\"/\"}}function v(e,r,t){var a=e.start,n=e.size;var i=[];var s=a;while(t&&n>0&&s>=0){i.push(r.slice(s*M,s*M+M));n-=M;s=ta(t,s*4)}if(i.length===0)return ua(0);return R(i).slice(0,e.size)}function p(e,r,t,a,n){var i=U;if(e===U){if(r!==0)throw new Error(\"DIFAT chain shorter than expected\")}else if(e!==-1){var s=t[e],f=(a>>>2)-1;if(!s)return;for(var o=0;o<f;++o){if((i=ta(s,o*4))===U)break;n.push(i)}p(ta(s,a-4),r-1,t,a,n)}}function g(e,r,t,a,n){var i=[],s=[];if(!n)n=[];var f=a-1,o=0,l=0;for(o=r;o>=0;){n[o]=true;i[i.length]=o;s.push(e[o]);var c=t[Math.floor(o*4/a)];l=o*4&f;if(a<4+l)throw new Error(\"FAT boundary crossed: \"+o+\" 4 \"+a);if(!e[c])break;o=ta(e[c],l)}return{nodes:i,data:It([s])}}function m(e,r,t,a){var n=e.length,i=[];var s=[],f=[],o=[];var l=a-1,c=0,h=0,u=0,d=0;for(c=0;c<n;++c){f=[];u=c+r;if(u>=n)u-=n;if(s[u])continue;o=[];var v=[];for(h=u;h>=0;){v[h]=true;s[h]=true;f[f.length]=h;o.push(e[h]);var p=t[Math.floor(h*4/a)];d=h*4&l;if(a<4+d)throw new Error(\"FAT boundary crossed: \"+h+\" 4 \"+a);if(!e[p])break;h=ta(e[p],d);if(v[h])break}i[u]={nodes:f,data:It([o])}}return i}function b(e,r,t,a,n,i,s,f){var o=0,l=a.length?2:0;var c=r[e].data;var h=0,u=0,d;for(;h<c.length;h+=128){var p=c.slice(h,h+128);ca(p,64);u=p._R(2);d=Dt(p,0,u-l);a.push(d);var m={name:d,type:p._R(1),color:p._R(1),L:p._R(4,\"i\"),R:p._R(4,\"i\"),C:p._R(4,\"i\"),clsid:p._R(16),state:p._R(4,\"i\"),start:0,size:0};var b=p._R(2)+p._R(2)+p._R(2)+p._R(2);if(b!==0)m.ct=S(p,p.l-8);var w=p._R(2)+p._R(2)+p._R(2)+p._R(2);if(w!==0)m.mt=S(p,p.l-8);m.start=p._R(4,\"i\");m.size=p._R(4,\"i\");if(m.size<0&&m.start<0){m.size=m.type=0;m.start=U;m.name=\"\"}if(m.type===5){o=m.start;if(n>0&&o!==U)r[o].name=\"!StreamData\"}else if(m.size>=4096){m.storage=\"fat\";if(r[m.start]===undefined)r[m.start]=g(t,m.start,r.fat_addrs,r.ssz);r[m.start].name=m.name;m.content=r[m.start].data.slice(0,m.size)}else{m.storage=\"minifat\";if(m.size<0)m.size=0;else if(o!==U&&m.start!==U&&r[o]){m.content=v(m,r[o].data,(r[f]||{}).data)}}if(m.content)ca(m.content,0);i[d]=m;s.push(m)}}function S(e,r){return new Date((ra(e,r+4)/1e7*Math.pow(2,32)+ra(e,r)/1e7-11644473600)*1e3)}function _(e,r){o();return l(f.readFileSync(e),r)}function x(e,r){var t=r&&r.type;if(!t){if(T&&Buffer.isBuffer(e))t=\"buffer\"}switch(t||\"base64\"){case\"file\":return _(e,r);case\"base64\":return l(y(k(e)),r);case\"binary\":return l(y(e),r);}return l(e,r)}function O(e,r){var t=r||{},a=t.root||\"Root Entry\";if(!e.FullPaths)e.FullPaths=[];if(!e.FileIndex)e.FileIndex=[];if(e.FullPaths.length!==e.FileIndex.length)throw new Error(\"inconsistent CFB structure\");if(e.FullPaths.length===0){e.FullPaths[0]=a+\"/\";e.FileIndex[0]={name:a,type:5}}if(t.CLSID)e.FileIndex[0].clsid=t.CLSID;I(e)}function I(e){var r=\"\u0001Sh33tJ5\";if(Ke.find(e,\"/\"+r))return;var t=ua(4);t[0]=55;t[1]=t[3]=50;t[2]=54;e.FileIndex.push({name:r,type:2,content:t,size:4,L:69,R:69,C:69});e.FullPaths.push(e.FullPaths[0]+r);F(e)}function F(e,n){O(e);var i=false,s=false;for(var f=e.FullPaths.length-1;f>=0;--f){var o=e.FileIndex[f];switch(o.type){case 0:if(s)i=true;else{e.FileIndex.pop();e.FullPaths.pop()}break;case 1:;case 2:;case 5:s=true;if(isNaN(o.R*o.L*o.C))i=true;if(o.R>-1&&o.L>-1&&o.R==o.L)i=true;break;default:i=true;break;}}if(!i&&!n)return;var l=new Date(1987,1,19),c=0;var h=Object.create?Object.create(null):{};var u=[];for(f=0;f<e.FullPaths.length;++f){h[e.FullPaths[f]]=true;if(e.FileIndex[f].type===0)continue;u.push([e.FullPaths[f],e.FileIndex[f]])}for(f=0;f<u.length;++f){var d=t(u[f][0]);s=h[d];if(!s){u.push([d,{name:a(d).replace(\"/\",\"\"),type:1,clsid:H,ct:l,mt:l,content:null}]);h[d]=true}}u.sort(function(e,t){return r(e[0],t[0])});e.FullPaths=[];e.FileIndex=[];for(f=0;f<u.length;++f){e.FullPaths[f]=u[f][0];e.FileIndex[f]=u[f][1]}for(f=0;f<u.length;++f){var v=e.FileIndex[f];var p=e.FullPaths[f];v.name=a(p).replace(\"/\",\"\");v.L=v.R=v.C=-(v.color=1);v.size=v.content?v.content.length:0;v.start=0;v.clsid=v.clsid||H;if(f===0){v.C=u.length>1?1:-1;v.size=0;v.type=5}else if(p.slice(-1)==\"/\"){for(c=f+1;c<u.length;++c)if(t(e.FullPaths[c])==p)break;v.C=c>=u.length?-1:c;for(c=f+1;c<u.length;++c)if(t(e.FullPaths[c])==t(p))break;v.R=c>=u.length?-1:c;v.type=1}else{if(t(e.FullPaths[f+1]||\"\")==t(p))v.R=f+1;v.type=2}}}function P(e,r){var t=r||{};if(t.fileType==\"mad\")return He(e,t);F(e);switch(t.fileType){case\"zip\":return De(e,t);}var a=function(e){var r=0,t=0;for(var a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];if(!n.content)continue;var i=n.content.length;if(i>0){if(i<4096)r+=i+63>>6;else t+=i+511>>9}}var s=e.FullPaths.length+3>>2;var f=r+7>>3;var o=r+127>>7;var l=f+t+s+o;var c=l+127>>7;var h=c<=109?0:Math.ceil((c-109)/127);while(l+c+h+127>>7>c)h=++c<=109?0:Math.ceil((c-109)/127);var u=[1,h,c,o,s,t,r,0];e.FileIndex[0].size=r<<6;u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3);return u}(e);var n=ua(a[7]<<9);var i=0,s=0;{for(i=0;i<8;++i)n._W(1,W[i]);for(i=0;i<8;++i)n._W(2,0);n._W(2,62);n._W(2,3);n._W(2,65534);n._W(2,9);n._W(2,6);for(i=0;i<3;++i)n._W(2,0);n._W(4,0);n._W(4,a[2]);n._W(4,a[0]+a[1]+a[2]+a[3]-1);n._W(4,0);n._W(4,1<<12);n._W(4,a[3]?a[0]+a[1]+a[2]-1:U);n._W(4,a[3]);n._W(-4,a[1]?a[0]-1:U);n._W(4,a[1]);for(i=0;i<109;++i)n._W(-4,i<a[2]?a[1]+i:-1)}if(a[1]){for(s=0;s<a[1];++s){for(;i<236+s*127;++i)n._W(-4,i<a[2]?a[1]+i:-1);n._W(-4,s===a[1]-1?U:s+1)}}var f=function(e){for(s+=e;i<s-1;++i)n._W(-4,i+1);if(e){++i;n._W(-4,U)}};s=i=0;for(s+=a[1];i<s;++i)n._W(-4,z.DIFSECT);for(s+=a[2];i<s;++i)n._W(-4,z.FATSECT);f(a[3]);f(a[4]);var o=0,l=0;var c=e.FileIndex[0];for(;o<e.FileIndex.length;++o){c=e.FileIndex[o];if(!c.content)continue;l=c.content.length;if(l<4096)continue;c.start=s;f(l+511>>9)}f(a[6]+7>>3);while(n.l&511)n._W(-4,z.ENDOFCHAIN);s=i=0;for(o=0;o<e.FileIndex.length;++o){c=e.FileIndex[o];if(!c.content)continue;l=c.content.length;if(!l||l>=4096)continue;c.start=s;f(l+63>>6)}while(n.l&511)n._W(-4,z.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var h=e.FullPaths[i];if(!h||h.length===0){for(o=0;o<17;++o)n._W(4,0);for(o=0;o<3;++o)n._W(4,-1);for(o=0;o<12;++o)n._W(4,0);continue}c=e.FileIndex[i];if(i===0)c.start=c.size?c.start-1:U;var u=i===0&&t.root||c.name;l=2*(u.length+1);n._W(64,u,\"utf16le\");n._W(2,l);n._W(1,c.type);n._W(1,c.color);n._W(-4,c.L);n._W(-4,c.R);n._W(-4,c.C);if(!c.clsid)for(o=0;o<4;++o)n._W(4,0);else n._W(16,c.clsid,\"hex\");n._W(4,c.state||0);n._W(4,0);n._W(4,0);n._W(4,0);n._W(4,0);n._W(4,c.start);n._W(4,c.size);n._W(4,0)}for(i=1;i<e.FileIndex.length;++i){c=e.FileIndex[i];if(c.size>=4096){n.l=c.start+1<<9;if(T&&Buffer.isBuffer(c.content)){c.content.copy(n,n.l,0,c.size);n.l+=c.size+511&-512}else{for(o=0;o<c.size;++o)n._W(1,c.content[o]);for(;o&511;++o)n._W(1,0)}}}for(i=1;i<e.FileIndex.length;++i){c=e.FileIndex[i];if(c.size>0&&c.size<4096){if(T&&Buffer.isBuffer(c.content)){c.content.copy(n,n.l,0,c.size);n.l+=c.size+63&-64}else{for(o=0;o<c.size;++o)n._W(1,c.content[o]);for(;o&63;++o)n._W(1,0)}}}if(T){n.l=n.length}else{while(n.l<n.length)n._W(1,0)}return n}function L(e,r){var t=e.FullPaths.map(function(e){return e.toUpperCase()});var a=t.map(function(e){var r=e.split(\"/\");return r[r.length-(e.slice(-1)==\"/\"?2:1)]});var n=false;if(r.charCodeAt(0)===47){n=true;r=t[0].slice(0,-1)+r}else n=r.indexOf(\"/\")!==-1;var i=r.toUpperCase();var s=n===true?t.indexOf(i):a.indexOf(i);if(s!==-1)return e.FileIndex[s];var f=!i.match(D);i=i.replace(N,\"\");if(f)i=i.replace(D,\"!\");for(s=0;s<t.length;++s){if((f?t[s].replace(D,\"!\"):t[s]).replace(N,\"\")==i)return e.FileIndex[s];if((f?a[s].replace(D,\"!\"):a[s]).replace(N,\"\")==i)return e.FileIndex[s]}return null}var M=64;var U=-2;var B=\"d0cf11e0a1b11ae1\";var W=[208,207,17,224,161,177,26,225];var H=\"00000000000000000000000000000000\";var z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:\"3e00\",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:[\"unknown\",\"storage\",\"stream\",\"lockbytes\",\"property\",\"root\"]};function V(e,r,t){o();var a=P(e,t);f.writeFileSync(r,a)}function G(e){var r=new Array(e.length);for(var t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join(\"\")}function j(e,r){var t=P(e,r);switch(r&&r.type||\"buffer\"){case\"file\":o();f.writeFileSync(r.filename,t);return t;case\"binary\":return typeof t==\"string\"?t:G(t);case\"base64\":return w(typeof t==\"string\"?t:G(t));case\"buffer\":if(T)return Buffer.isBuffer(t)?t:A(t);case\"array\":return typeof t==\"string\"?y(t):t;}return t}var X;function $(e){try{var r=e.InflateRaw;var t=new r;t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag);if(t.bytesRead)X=e;else throw new Error(\"zlib does not expose bytesRead\")}catch(a){console.error(\"cannot use native zlib: \"+(a.message||a))}}function Y(e,r){if(!X)return Oe(e,r);var t=X.InflateRaw;var a=new t;var n=a._processChunk(e.slice(e.l),a._finishFlushFlag);e.l+=a.bytesRead;return n}function K(e){return X?X.deflateRawSync(e):Te(e)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];var Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(e){var r=(e<<1|e<<11)&139536|(e<<5|e<<15)&558144;return(r>>16|r>>8|r)&255}var ee=typeof Uint8Array!==\"undefined\";var re=ee?new Uint8Array(1<<8):[];for(var te=0;te<1<<8;++te)re[te]=Q(te);function ae(e,r){var t=re[e&255];if(r<=8)return t>>>8-r;t=t<<8|re[e>>8&255];if(r<=16)return t>>>16-r;t=t<<8|re[e>>16&255];return t>>>24-r}function ne(e,r){var t=r&7,a=r>>>3;return(e[a]|(t<=6?0:e[a+1]<<8))>>>t&3}function ie(e,r){var t=r&7,a=r>>>3;return(e[a]|(t<=5?0:e[a+1]<<8))>>>t&7}function se(e,r){var t=r&7,a=r>>>3;return(e[a]|(t<=4?0:e[a+1]<<8))>>>t&15}function fe(e,r){var t=r&7,a=r>>>3;return(e[a]|(t<=3?0:e[a+1]<<8))>>>t&31}function oe(e,r){var t=r&7,a=r>>>3;return(e[a]|(t<=1?0:e[a+1]<<8))>>>t&127}function le(e,r,t){var a=r&7,n=r>>>3,i=(1<<t)-1;var s=e[n]>>>a;if(t<8-a)return s&i;s|=e[n+1]<<8-a;if(t<16-a)return s&i;s|=e[n+2]<<16-a;if(t<24-a)return s&i;s|=e[n+3]<<24-a;return s&i}function ce(e,r,t){var a=r&7,n=r>>>3;if(a<=5)e[n]|=(t&7)<<a;else{e[n]|=t<<a&255;e[n+1]=(t&7)>>8-a}return r+3}function he(e,r,t){var a=r&7,n=r>>>3;t=(t&1)<<a;e[n]|=t;return r+1}function ue(e,r,t){var a=r&7,n=r>>>3;t<<=a;e[n]|=t&255;t>>>=8;e[n+1]=t;return r+8}function de(e,r,t){var a=r&7,n=r>>>3;t<<=a;e[n]|=t&255;t>>>=8;e[n+1]=t&255;e[n+2]=t>>>8;return r+16}function ve(e,r){var t=e.length,a=2*t>r?2*t:r+5,n=0;if(t>=r)return e;if(T){var i=C(a);if(e.copy)e.copy(i);else for(;n<e.length;++n)i[n]=e[n];return i}else if(ee){var s=new Uint8Array(a);if(s.set)s.set(e);else for(;n<t;++n)s[n]=e[n];return s}e.length=a;return e}function pe(e){var r=new Array(e);for(var t=0;t<e;++t)r[t]=0;return r}function ge(e,r,t){var a=1,n=0,i=0,s=0,f=0,o=e.length;var l=ee?new Uint16Array(32):pe(32);for(i=0;i<32;++i)l[i]=0;for(i=o;i<t;++i)e[i]=0;o=e.length;var c=ee?new Uint16Array(o):pe(o);for(i=0;i<o;++i){l[n=e[i]]++;if(a<n)a=n;c[i]=0}l[0]=0;for(i=1;i<=a;++i)l[i+16]=f=f+l[i-1]<<1;for(i=0;i<o;++i){f=e[i];if(f!=0)c[i]=l[f+16]++}var h=0;for(i=0;i<o;++i){h=e[i];if(h!=0){f=ae(c[i],a)>>a-h;for(s=(1<<a+4-h)-1;s>=0;--s)r[f|s<<h]=h&15|i<<4}}return a}var me=ee?new Uint16Array(512):pe(512);var be=ee?new Uint16Array(32):pe(32);if(!ee){for(var we=0;we<512;++we)me[we]=0;for(we=0;we<32;++we)be[we]=0}(function(){var e=[];var r=0;for(;r<32;r++)e.push(5);ge(e,be,32);var t=[];r=0;for(;r<=143;r++)t.push(8);for(;r<=255;r++)t.push(9);for(;r<=279;r++)t.push(7);for(;r<=287;r++)t.push(8);ge(t,me,288)})();var ke=function $e(){var e=ee?new Uint8Array(32768):[];var r=0,t=0;for(;r<Z.length-1;++r){for(;t<Z[r+1];++t)e[t]=r}for(;t<32768;++t)e[t]=29;var a=ee?new Uint8Array(259):[];for(r=0,t=0;r<q.length-1;++r){for(;t<q[r+1];++t)a[t]=r}function n(e,r){var t=0;while(t<e.length){var a=Math.min(65535,e.length-t);var n=t+a==e.length;r._W(1,+n);r._W(2,a);r._W(2,~a&65535);while(a-- >0)r[r.l++]=e[t++]}return r.l}function i(r,t){var n=0;var i=0;var s=ee?new Uint16Array(32768):[];while(i<r.length){var f=Math.min(65535,r.length-i);if(f<10){n=ce(t,n,+!!(i+f==r.length));if(n&7)n+=8-(n&7);t.l=n/8|0;t._W(2,f);t._W(2,~f&65535);while(f-- >0)t[t.l++]=r[i++];n=t.l*8;continue}n=ce(t,n,+!!(i+f==r.length)+2);var o=0;while(f-- >0){var l=r[i];o=(o<<5^l)&32767;var c=-1,h=0;if(c=s[o]){c|=i&~32767;if(c>i)c-=32768;if(c<i)while(r[c+h]==r[i+h]&&h<250)++h}if(h>2){l=a[h];if(l<=22)n=ue(t,n,re[l+1]>>1)-1;else{ue(t,n,3);n+=5;ue(t,n,re[l-23]>>5);n+=3}var u=l<8?0:l-4>>2;if(u>0){de(t,n,h-q[l]);n+=u}l=e[i-c];n=ue(t,n,re[l]>>3);n-=3;var d=l<4?0:l-2>>1;if(d>0){de(t,n,i-c-Z[l]);n+=d}for(var v=0;v<h;++v){s[o]=i&32767;o=(o<<5^r[i])&32767;++i}f-=h-1}else{if(l<=143)l=l+48;else n=he(t,n,1);n=ue(t,n,re[l]);s[o]=i&32767;++i}}n=ue(t,n,0)-1}t.l=(n+7)/8|0;return t.l}return function s(e,r){if(e.length<8)return n(e,r);return i(e,r)}}();function Te(e){var r=ua(50+Math.floor(e.length*1.1));var t=ke(e,r);return r.slice(0,t)}var Ae=ee?new Uint16Array(32768):pe(32768);var Ee=ee?new Uint16Array(32768):pe(32768);var Ce=ee?new Uint16Array(128):pe(128);var ye=1,Se=1;function _e(e,r){var t=fe(e,r)+257;r+=5;var a=fe(e,r)+1;r+=5;var n=se(e,r)+4;r+=4;var i=0;var s=ee?new Uint8Array(19):pe(19);var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var o=1;var l=ee?new Uint8Array(8):pe(8);var c=ee?new Uint8Array(8):pe(8);var h=s.length;for(var u=0;u<n;++u){s[J[u]]=i=ie(e,r);if(o<i)o=i;l[i]++;r+=3}var d=0;l[0]=0;for(u=1;u<=o;++u)c[u]=d=d+l[u-1]<<1;for(u=0;u<h;++u)if((d=s[u])!=0)f[u]=c[d]++;var v=0;for(u=0;u<h;++u){v=s[u];if(v!=0){d=re[f[u]]>>8-v;for(var p=(1<<7-v)-1;p>=0;--p)Ce[d|p<<v]=v&7|u<<3}}var g=[];o=1;for(;g.length<t+a;){d=Ce[oe(e,r)];r+=d&7;switch(d>>>=3){case 16:i=3+ne(e,r);r+=2;d=g[g.length-1];while(i-- >0)g.push(d);break;case 17:i=3+ie(e,r);r+=3;while(i-- >0)g.push(0);break;case 18:i=11+oe(e,r);r+=7;while(i-- >0)g.push(0);break;default:g.push(d);if(o<d)o=d;break;}}var m=g.slice(0,t),b=g.slice(t);for(u=t;u<286;++u)m[u]=0;for(u=a;u<30;++u)b[u]=0;ye=ge(m,Ae,286);Se=ge(b,Ee,30);return r}function xe(e,r){if(e[0]==3&&!(e[1]&3)){return[E(r),2]}var t=0;var a=0;var n=C(r?r:1<<18);var i=0;var s=n.length>>>0;var f=0,o=0;while((a&1)==0){a=ie(e,t);t+=3;if(a>>>1==0){if(t&7)t+=8-(t&7);var l=e[t>>>3]|e[(t>>>3)+1]<<8;t+=32;if(l>0){if(!r&&s<i+l){n=ve(n,i+l);s=n.length}while(l-- >0){n[i++]=e[t>>>3];t+=8}}continue}else if(a>>1==1){f=9;o=5}else{t=_e(e,t);f=ye;o=Se}for(;;){if(!r&&s<i+32767){n=ve(n,i+32767);s=n.length}var c=le(e,t,f);var h=a>>>1==1?me[c]:Ae[c];t+=h&15;h>>>=4;if((h>>>8&255)===0)n[i++]=h;else if(h==256)break;else{h-=257;var u=h<8?0:h-4>>2;if(u>5)u=0;var d=i+q[h];if(u>0){d+=le(e,t,u);t+=u}c=le(e,t,o);h=a>>>1==1?be[c]:Ee[c];t+=h&15;h>>>=4;var v=h<4?0:h-2>>1;var p=Z[h];if(v>0){p+=le(e,t,v);t+=v}if(!r&&s<d){n=ve(n,d+100);s=n.length}while(i<d){n[i]=n[i-p];++i}}}}if(r)return[n,t+7>>>3];return[n.slice(0,i),t+7>>>3]}function Oe(e,r){var t=e.slice(e.l||0);var a=xe(t,r);e.l+=a[1];return a[0]}function Re(e,r){if(e){if(typeof console!==\"undefined\")console.error(r)}else throw new Error(r)}function Ie(e,r){var t=e;ca(t,0);var a=[],n=[];var i={FileIndex:a,FullPaths:n};O(i,{root:r.root});var f=t.length-4;while((t[f]!=80||t[f+1]!=75||t[f+2]!=5||t[f+3]!=6)&&f>=0)--f;t.l=f+4;t.l+=4;var o=t._R(2);t.l+=6;var l=t._R(4);t.l=l;for(f=0;f<o;++f){t.l+=20;var c=t._R(4);var h=t._R(4);var u=t._R(2);var d=t._R(2);var v=t._R(2);t.l+=8;var p=t._R(4);var g=s(t.slice(t.l+u,t.l+u+d));t.l+=u+d+v;var m=t.l;t.l=p+4;Ne(t,c,h,i,g);t.l=m}return i}function Ne(e,r,t,a,n){e.l+=2;var f=e._R(2);var o=e._R(2);var l=i(e);if(f&8257)throw new Error(\"Unsupported ZIP encryption\");var c=e._R(4);var h=e._R(4);var u=e._R(4);var d=e._R(2);var v=e._R(2);var p=\"\";for(var g=0;g<d;++g)p+=String.fromCharCode(e[e.l++]);if(v){var m=s(e.slice(e.l,e.l+v));if((m[21589]||{}).mt)l=m[21589].mt;if(((n||{})[21589]||{}).mt)l=n[21589].mt}e.l+=v;var b=e.slice(e.l,e.l+h);switch(o){case 8:b=Y(e,u);break;case 0:break;default:throw new Error(\"Unsupported ZIP Compression method \"+o);}var w=false;if(f&8){c=e._R(4);if(c==134695760){c=e._R(4);w=true}h=e._R(4);u=e._R(4)}if(h!=r)Re(w,\"Bad compressed size: \"+r+\" != \"+h);if(u!=t)Re(w,\"Bad uncompressed size: \"+t+\" != \"+u);Ve(a,p,b,{unsafe:true,mt:l})}function De(e,r){var t=r||{};var a=[],i=[];var s=ua(1);var f=t.compression?8:0,o=0;var l=false;if(l)o|=8;var c=0,h=0;var u=0,d=0;var v=e.FullPaths[0],p=v,g=e.FileIndex[0];var m=[];var b=0;for(c=1;c<e.FullPaths.length;++c){p=e.FullPaths[c].slice(v.length);g=e.FileIndex[c];if(!g.size||!g.content||p==\"\u0001Sh33tJ5\")continue;var w=u;var k=ua(p.length);for(h=0;h<p.length;++h)k._W(1,p.charCodeAt(h)&127);k=k.slice(0,k.l);m[d]=Ye.buf(g.content,0);var T=g.content;if(f==8)T=K(T);\ns=ua(30);s._W(4,67324752);s._W(2,20);s._W(2,o);s._W(2,f);if(g.mt)n(s,g.mt);else s._W(4,0);s._W(-4,o&8?0:m[d]);s._W(4,o&8?0:T.length);s._W(4,o&8?0:g.content.length);s._W(2,k.length);s._W(2,0);u+=s.length;a.push(s);u+=k.length;a.push(k);u+=T.length;a.push(T);if(o&8){s=ua(12);s._W(-4,m[d]);s._W(4,T.length);s._W(4,g.content.length);u+=s.l;a.push(s)}s=ua(46);s._W(4,33639248);s._W(2,0);s._W(2,20);s._W(2,o);s._W(2,f);s._W(4,0);s._W(-4,m[d]);s._W(4,T.length);s._W(4,g.content.length);s._W(2,k.length);s._W(2,0);s._W(2,0);s._W(2,0);s._W(2,0);s._W(4,0);s._W(4,w);b+=s.l;i.push(s);b+=k.length;i.push(k);++d}s=ua(22);s._W(4,101010256);s._W(2,0);s._W(2,0);s._W(2,d);s._W(2,d);s._W(4,b);s._W(4,u);s._W(2,0);return R([R(a),R(i),s])}var Fe={htm:\"text/html\",xml:\"text/xml\",gif:\"image/gif\",jpg:\"image/jpeg\",png:\"image/png\",mso:\"application/x-mso\",thmx:\"application/vnd.ms-officetheme\",sh33tj5:\"application/octet-stream\"};function Pe(e,r){if(e.ctype)return e.ctype;var t=e.name||\"\",a=t.match(/\\.([^\\.]+)$/);if(a&&Fe[a[1]])return Fe[a[1]];if(r){a=(t=r).match(/[\\.\\\\]([^\\.\\\\])+$/);if(a&&Fe[a[1]])return Fe[a[1]]}return\"application/octet-stream\"}function Le(e){var r=w(e);var t=[];for(var a=0;a<r.length;a+=76)t.push(r.slice(a,a+76));return t.join(\"\\r\\n\")+\"\\r\\n\"}function Me(e){var r=e.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g,function(e){var r=e.charCodeAt(0).toString(16).toUpperCase();return\"=\"+(r.length==1?\"0\"+r:r)});r=r.replace(/ $/gm,\"=20\").replace(/\\t$/gm,\"=09\");if(r.charAt(0)==\"\\n\")r=\"=0D\"+r.slice(1);r=r.replace(/\\r(?!\\n)/gm,\"=0D\").replace(/\\n\\n/gm,\"\\n=0A\").replace(/([^\\r\\n])\\n/gm,\"$1=0A\");var t=[],a=r.split(\"\\r\\n\");for(var n=0;n<a.length;++n){var i=a[n];if(i.length==0){t.push(\"\");continue}for(var s=0;s<i.length;){var f=76;var o=i.slice(s,s+f);if(o.charAt(f-1)==\"=\")f--;else if(o.charAt(f-2)==\"=\")f-=2;else if(o.charAt(f-3)==\"=\")f-=3;o=i.slice(s,s+f);s+=f;if(s<i.length)o+=\"=\";t.push(o)}}return t.join(\"\\r\\n\")}function Ue(e){var r=[];for(var t=0;t<e.length;++t){var a=e[t];while(t<=e.length&&a.charAt(a.length-1)==\"=\")a=a.slice(0,a.length-1)+e[++t];r.push(a)}for(var n=0;n<r.length;++n)r[n]=r[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return y(r.join(\"\\r\\n\"))}function Be(e,r,t){var a=\"\",n=\"\",i=\"\",s;var f=0;for(;f<10;++f){var o=r[f];if(!o||o.match(/^\\s*$/))break;var l=o.match(/^(.*?):\\s*([^\\s].*)$/);if(l)switch(l[1].toLowerCase()){case\"content-location\":a=l[2].trim();break;case\"content-type\":i=l[2].trim();break;case\"content-transfer-encoding\":n=l[2].trim();break;}}++f;switch(n.toLowerCase()){case\"base64\":s=y(k(r.slice(f).join(\"\")));break;case\"quoted-printable\":s=Ue(r.slice(f));break;default:throw new Error(\"Unsupported Content-Transfer-Encoding \"+n);}var c=Ve(e,a.slice(t.length),s,{unsafe:true});if(i)c.ctype=i}function We(e,r){if(G(e.slice(0,13)).toLowerCase()!=\"mime-version:\")throw new Error(\"Unsupported MAD header\");var t=r&&r.root||\"\";var a=(T&&Buffer.isBuffer(e)?e.toString(\"binary\"):G(e)).split(\"\\r\\n\");var n=0,i=\"\";for(n=0;n<a.length;++n){i=a[n];if(!/^Content-Location:/i.test(i))continue;i=i.slice(i.indexOf(\"file\"));if(!t)t=i.slice(0,i.lastIndexOf(\"/\")+1);if(i.slice(0,t.length)==t)continue;while(t.length>0){t=t.slice(0,t.length-1);t=t.slice(0,t.lastIndexOf(\"/\")+1);if(i.slice(0,t.length)==t)break}}var s=(a[1]||\"\").match(/boundary=\"(.*?)\"/);if(!s)throw new Error(\"MAD cannot find boundary\");var f=\"--\"+(s[1]||\"\");var o=[],l=[];var c={FileIndex:o,FullPaths:l};O(c);var h,u=0;for(n=0;n<a.length;++n){var d=a[n];if(d!==f&&d!==f+\"--\")continue;if(u++)Be(c,a.slice(h,n),t);h=n}return c}function He(e,r){var t=r||{};var a=t.boundary||\"SheetJS\";a=\"------=\"+a;var n=[\"MIME-Version: 1.0\",'Content-Type: multipart/related; boundary=\"'+a.slice(2)+'\"',\"\",\"\",\"\"];var i=e.FullPaths[0],s=i,f=e.FileIndex[0];for(var o=1;o<e.FullPaths.length;++o){s=e.FullPaths[o].slice(i.length);f=e.FileIndex[o];if(!f.size||!f.content||s==\"\u0001Sh33tJ5\")continue;s=s.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g,function(e){return\"_x\"+e.charCodeAt(0).toString(16)+\"_\"}).replace(/[\\u0080-\\uFFFF]/g,function(e){return\"_u\"+e.charCodeAt(0).toString(16)+\"_\"});var l=f.content;var c=T&&Buffer.isBuffer(l)?l.toString(\"binary\"):G(l);var h=0,u=Math.min(1024,c.length),d=0;for(var v=0;v<=u;++v)if((d=c.charCodeAt(v))>=32&&d<128)++h;var p=h>=u*4/5;n.push(a);n.push(\"Content-Location: \"+(t.root||\"file:///C:/SheetJS/\")+s);n.push(\"Content-Transfer-Encoding: \"+(p?\"quoted-printable\":\"base64\"));n.push(\"Content-Type: \"+Pe(f,s));n.push(\"\");n.push(p?Me(c):Le(c))}n.push(a+\"--\\r\\n\");return n.join(\"\\r\\n\")}function ze(e){var r={};O(r,e);return r}function Ve(e,r,t,n){var i=n&&n.unsafe;if(!i)O(e);var s=!i&&Ke.find(e,r);if(!s){var f=e.FullPaths[0];if(r.slice(0,f.length)==f)f=r;else{if(f.slice(-1)!=\"/\")f+=\"/\";f=(f+r).replace(\"//\",\"/\")}s={name:a(r),type:2};e.FileIndex.push(s);e.FullPaths.push(f);if(!i)Ke.utils.cfb_gc(e)}s.content=t;s.size=t?t.length:0;if(n){if(n.CLSID)s.clsid=n.CLSID;if(n.mt)s.mt=n.mt;if(n.ct)s.ct=n.ct}return s}function Ge(e,r){O(e);var t=Ke.find(e,r);if(t)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==t){e.FileIndex.splice(a,1);e.FullPaths.splice(a,1);return true}return false}function je(e,r,t){O(e);var n=Ke.find(e,r);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n){e.FileIndex[i].name=a(t);e.FullPaths[i]=t;return true}return false}function Xe(e){F(e,true)}e.find=L;e.read=x;e.parse=l;e.write=j;e.writeFile=V;e.utils={cfb_new:ze,cfb_add:Ve,cfb_del:Ge,cfb_mov:je,cfb_gc:Xe,ReadShift:na,CheckField:la,prep_blob:ca,bconcat:R,use_zlib:$,_deflateRaw:Te,_inflateRaw:Oe,consts:z};return e}();var Je;if(typeof require!==\"undefined\")try{Je=undefined}catch(qe){}function Ze(e){if(typeof e===\"string\")return S(e);if(Array.isArray(e))return x(e);return e}function Qe(e,r,t){if(typeof Je!==\"undefined\"&&Je.writeFileSync)return t?Je.writeFileSync(e,r,t):Je.writeFileSync(e,r);if(typeof Deno!==\"undefined\"){if(t&&typeof r==\"string\")switch(t){case\"utf8\":r=new TextEncoder(t).encode(r);break;case\"binary\":r=S(r);break;default:throw new Error(\"Unsupported encoding \"+t);}return Deno.writeFileSync(e,r)}var a=t==\"utf8\"?ct(r):r;if(typeof IE_SaveFile!==\"undefined\")return IE_SaveFile(a,e);if(typeof Blob!==\"undefined\"){var n=new Blob([Ze(a)],{type:\"application/octet-stream\"});if(typeof navigator!==\"undefined\"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!==\"undefined\")return saveAs(n,e);if(typeof URL!==\"undefined\"&&typeof document!==\"undefined\"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome===\"object\"&&typeof(chrome.downloads||{}).download==\"function\"){if(URL.revokeObjectURL&&typeof setTimeout!==\"undefined\")setTimeout(function(){URL.revokeObjectURL(i)},6e4);return chrome.downloads.download({url:i,filename:e,saveAs:true})}var s=document.createElement(\"a\");if(s.download!=null){s.download=e;s.href=i;document.body.appendChild(s);s.click();document.body.removeChild(s);if(URL.revokeObjectURL&&typeof setTimeout!==\"undefined\")setTimeout(function(){URL.revokeObjectURL(i)},6e4);return i}}}if(typeof $!==\"undefined\"&&typeof File!==\"undefined\"&&typeof Folder!==\"undefined\")try{var f=File(e);f.open(\"w\");f.encoding=\"binary\";if(Array.isArray(r))r=_(r);f.write(r);f.close();return r}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error(\"cannot save file \"+e)}function er(e){if(typeof Je!==\"undefined\")return Je.readFileSync(e);if(typeof Deno!==\"undefined\")return Deno.readFileSync(e);if(typeof $!==\"undefined\"&&typeof File!==\"undefined\"&&typeof Folder!==\"undefined\")try{var r=File(e);r.open(\"r\");r.encoding=\"binary\";var t=r.read();r.close();return t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error(\"Cannot access file \"+e)}function rr(e){var r=Object.keys(e),t=[];for(var a=0;a<r.length;++a)if(Object.prototype.hasOwnProperty.call(e,r[a]))t.push(r[a]);return t}function tr(e,r){var t=[],a=rr(e);for(var n=0;n!==a.length;++n)if(t[e[a[n]][r]]==null)t[e[a[n]][r]]=a[n];return t}function ar(e){var r=[],t=rr(e);for(var a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function nr(e){var r=[],t=rr(e);for(var a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function ir(e){var r=[],t=rr(e);for(var a=0;a!==t.length;++a){if(r[e[t[a]]]==null)r[e[t[a]]]=[];r[e[t[a]]].push(t[a])}return r}var sr=new Date(1899,11,30,0,0,0);function fr(e,r){var t=e.getTime();if(r)t-=1462*24*60*60*1e3;var a=sr.getTime()+(e.getTimezoneOffset()-sr.getTimezoneOffset())*6e4;return(t-a)/(24*60*60*1e3)}var or=new Date;var lr=sr.getTime()+(or.getTimezoneOffset()-sr.getTimezoneOffset())*6e4;var cr=or.getTimezoneOffset();function hr(e){var r=new Date;r.setTime(e*24*60*60*1e3+lr);if(r.getTimezoneOffset()!==cr){r.setTime(r.getTime()+(r.getTimezoneOffset()-cr)*6e4)}return r}function ur(e){var r=0,t=0,a=false;var n=e.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);if(!n)throw new Error(\"|\"+e+\"| is not an ISO8601 Duration\");for(var i=1;i!=n.length;++i){if(!n[i])continue;t=1;if(i>3)a=true;switch(n[i].slice(n[i].length-1)){case\"Y\":throw new Error(\"Unsupported ISO Duration Field: \"+n[i].slice(n[i].length-1));case\"D\":t*=24;case\"H\":t*=60;case\"M\":if(!a)throw new Error(\"Unsupported ISO Duration Field: M\");else t*=60;case\"S\":break;}r+=t*parseInt(n[i],10)}return r}var dr=new Date(\"2017-02-19T19:06:09.000Z\");var vr=isNaN(dr.getFullYear())?new Date(\"2/19/17\"):dr;var pr=vr.getFullYear()==2017;function gr(e,r){var t=new Date(e);if(pr){if(r>0)t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3);else if(r<0)t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3);return t}if(e instanceof Date)return e;if(vr.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();if(e.indexOf(\"\"+a)>-1)return t;t.setFullYear(t.getFullYear()+100);return t}var n=e.match(/\\d+/g)||[\"2017\",\"2\",\"19\",\"0\",\"0\",\"0\"];var i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);if(e.indexOf(\"Z\")>-1)i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3);return i}function mr(e,r){if(T&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ct(e.slice(2).toString(\"utf16le\"));if(e[1]==254&&e[2]==255)return ct(u(e.slice(2).toString(\"binary\")))}return e.toString(\"binary\")}if(typeof TextDecoder!==\"undefined\")try{if(r){if(e[0]==255&&e[1]==254)return ct(new TextDecoder(\"utf-16le\").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ct(new TextDecoder(\"utf-16be\").decode(e.slice(2)))}var t={\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\"};if(Array.isArray(e))e=new Uint8Array(e);return new TextDecoder(\"latin1\").decode(e).replace(/[]/g,function(e){return t[e]||e})}catch(a){}var n=[];for(var i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join(\"\")}function br(e){if(typeof JSON!=\"undefined\"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!=\"object\"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))r[t]=br(e[t]);return r}function wr(e,r){var t=\"\";while(t.length<r)t+=e;return t}function kr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\\d/.test(e))return r;var t=1;var a=e.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g,function(){t*=100;return\"\"});if(!isNaN(r=Number(a)))return r/t;a=a.replace(/[(](.*)[)]/,function(e,r){t=-t;return r});if(!isNaN(r=Number(a)))return r/t;return r}var Tr=[\"january\",\"february\",\"march\",\"april\",\"may\",\"june\",\"july\",\"august\",\"september\",\"october\",\"november\",\"december\"];function Ar(e){var r=new Date(e),t=new Date(NaN);var a=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){s=s.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");if(s.length>3&&Tr.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;if(a<0||a>8099)return t;if((n>0||i>1)&&a!=101)return r;if(e.match(/[^-0-9:,\\/\\\\]/))return t;return r}var Er=function(){var e=\"abacaba\".split(/(:?b)/i).length==5;return function r(t,a,n){if(e||typeof a==\"string\")return t.split(a);var i=t.split(a),s=[i[0]];for(var f=1;f<i.length;++f){s.push(n);s.push(i[f])}return s}}();function Cr(e){if(!e)return null;if(e.content&&e.type)return mr(e.content,true);if(e.data)return d(e.data);if(e.asNodeBuffer&&T)return d(e.asNodeBuffer().toString(\"binary\"));if(e.asBinary)return d(e.asBinary());if(e._data&&e._data.getContent)return d(mr(Array.prototype.slice.call(e._data.getContent(),0)));return null}function yr(e){if(!e)return null;if(e.data)return c(e.data);if(e.asNodeBuffer&&T)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();if(typeof r==\"string\")return c(r);return Array.prototype.slice.call(r)}if(e.content&&e.type)return e.content;return null}function Sr(e){return e&&e.name.slice(-4)===\".bin\"?yr(e):Cr(e)}function _r(e,r){var t=e.FullPaths||rr(e.files);var a=r.toLowerCase().replace(/[\\/]/g,\"\\\\\"),n=a.replace(/\\\\/g,\"/\");for(var i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\\/]/,\"\").toLowerCase();if(a==s||n==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function xr(e,r){var t=_r(e,r);if(t==null)throw new Error(\"Cannot find file \"+r+\" in zip\");return t}function Or(e,r,t){if(!t)return Sr(xr(e,r));if(!r)return null;try{return Or(e,r)}catch(a){return null}}function Rr(e,r,t){if(!t)return Cr(xr(e,r));if(!r)return null;try{return Rr(e,r)}catch(a){return null}}function Ir(e,r,t){if(!t)return yr(xr(e,r));if(!r)return null;try{return Ir(e,r)}catch(a){return null}}function Nr(e){var r=e.FullPaths||rr(e.files),t=[];for(var a=0;a<r.length;++a)if(r[a].slice(-1)!=\"/\")t.push(r[a].replace(/^Root Entry[\\/]/,\"\"));return t.sort()}function Dr(e,r,t){if(e.FullPaths){if(typeof t==\"string\"){var a;if(T)a=A(t);else a=I(t);return Ke.utils.cfb_add(e,r,a)}Ke.utils.cfb_add(e,r,t)}else e.file(r,t)}function Fr(){return Ke.utils.cfb_new()}function Pr(e,r){switch(r.type){case\"base64\":return Ke.read(e,{type:\"base64\"});case\"binary\":return Ke.read(e,{type:\"binary\"});case\"buffer\":;case\"array\":return Ke.read(e,{type:\"buffer\"});}throw new Error(\"Unrecognized type \"+r.type)}function Lr(e,r){if(e.charAt(0)==\"/\")return e.slice(1);var t=r.split(\"/\");if(r.slice(-1)!=\"/\")t.pop();var a=e.split(\"/\");while(a.length!==0){var n=a.shift();if(n===\"..\")t.pop();else if(n!==\".\")t.push(n)}return t.join(\"/\")}var Mr='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';var Ur=/([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;var Br=/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/gm,Wr=/<[^>]*>/g;var Hr=Mr.match(Br)?Br:Wr;var zr=/<\\w*:/,Vr=/<(\\/?)\\w+:/;function Gr(e,r,t){var a={};var n=0,i=0;for(;n!==e.length;++n)if((i=e.charCodeAt(n))===32||i===10||i===13)break;if(!r)a[0]=e.slice(0,n);if(n===e.length)return a;var s=e.match(Ur),f=0,o=\"\",l=0,c=\"\",h=\"\",u=1;if(s)for(l=0;l!=s.length;++l){h=s[l];for(i=0;i!=h.length;++i)if(h.charCodeAt(i)===61)break;c=h.slice(0,i).trim();while(h.charCodeAt(i+1)==32)++i;u=(n=h.charCodeAt(i+1))==34||n==39?1:0;o=h.slice(i+1+u,h.length-u);for(f=0;f!=c.length;++f)if(c.charCodeAt(f)===58)break;if(f===c.length){if(c.indexOf(\"_\")>0)c=c.slice(0,c.indexOf(\"_\"));a[c]=o;if(!t)a[c.toLowerCase()]=o}else{var d=(f===5&&c.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+c.slice(f+1);if(a[d]&&c.slice(f-3,f)==\"ext\")continue;a[d]=o;if(!t)a[d.toLowerCase()]=o}}return a}function jr(e){return e.replace(Vr,\"<$1\")}var Xr={\"&quot;\":'\"',\"&apos;\":\"'\",\"&gt;\":\">\",\"&lt;\":\"<\",\"&amp;\":\"&\"};var $r=ar(Xr);var Yr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/gi,r=/_x([\\da-fA-F]{4})_/gi;return function t(a){var n=a+\"\",i=n.indexOf(\"<![CDATA[\");if(i==-1)return n.replace(e,function(e,r){return Xr[e]||String.fromCharCode(parseInt(r,e.indexOf(\"x\")>-1?16:10))||e}).replace(r,function(e,r){return String.fromCharCode(parseInt(r,16))});var s=n.indexOf(\"]]>\");return t(n.slice(0,i))+n.slice(i+9,s)+t(n.slice(s+3))}}();var Kr=/[&<>'\"]/g,Jr=/[\\u0000-\\u0008\\u000b-\\u001f]/g;function qr(e){var r=e+\"\";return r.replace(Kr,function(e){return $r[e]}).replace(Jr,function(e){return\"_x\"+(\"000\"+e.charCodeAt(0).toString(16)).slice(-4)+\"_\"})}function Zr(e){return qr(e).replace(/ /g,\"_x0020_\")}var Qr=/[\\u0000-\\u001f]/g;function et(e){var r=e+\"\";return r.replace(Kr,function(e){return $r[e]}).replace(/\\n/g,\"<br/>\").replace(Qr,function(e){return\"&#x\"+(\"000\"+e.charCodeAt(0).toString(16)).slice(-4)+\";\"})}function rt(e){var r=e+\"\";return r.replace(Kr,function(e){return $r[e]}).replace(Qr,function(e){return\"&#x\"+e.charCodeAt(0).toString(16).toUpperCase()+\";\"})}var tt=function(){var e=/&#(\\d+);/g;function r(e,r){return String.fromCharCode(parseInt(r,10))}return function t(a){return a.replace(e,r)}}();function at(e){return e.replace(/(\\r\\n|[\\r\\n])/g,\"&#10;\")}function nt(e){switch(e){case 1:;case true:;case\"1\":;case\"true\":;case\"TRUE\":return true;default:return false;}}function it(e){var r=\"\",t=0,a=0,n=0,i=0,s=0,f=0;while(t<e.length){a=e.charCodeAt(t++);if(a<128){r+=String.fromCharCode(a);continue}n=e.charCodeAt(t++);if(a>191&&a<224){s=(a&31)<<6;s|=n&63;r+=String.fromCharCode(s);continue}i=e.charCodeAt(t++);if(a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(t++);f=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536;r+=String.fromCharCode(55296+(f>>>10&1023));r+=String.fromCharCode(56320+(f&1023))}return r}function st(e){var r=E(2*e.length),t,a,n=1,i=0,s=0,f;for(a=0;a<e.length;a+=n){n=1;if((f=e.charCodeAt(a))<128)t=f;else if(f<224){t=(f&31)*64+(e.charCodeAt(a+1)&63);n=2}else if(f<240){t=(f&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63);n=3}else{n=4;t=(f&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63);t-=65536;s=55296+(t>>>10&1023);t=56320+(t&1023)}if(s!==0){r[i++]=s&255;r[i++]=s>>>8;s=0}r[i++]=t%256;r[i++]=t>>>8}return r.slice(0,i).toString(\"ucs2\")}function ft(e){return A(e,\"binary\").toString(\"utf8\")}var ot=\"foo bar baz\";var lt=T&&(ft(ot)==it(ot)&&ft||st(ot)==it(ot)&&st)||it;var ct=T?function(e){return A(e,\"utf8\").toString(\"binary\")}:function(e){var r=[],t=0,a=0,n=0;while(t<e.length){a=e.charCodeAt(t++);switch(true){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6)));r.push(String.fromCharCode(128+(a&63)));break;case a>=55296&&a<57344:a-=55296;n=e.charCodeAt(t++)-56320+(a<<10);r.push(String.fromCharCode(240+(n>>18&7)));r.push(String.fromCharCode(144+(n>>12&63)));r.push(String.fromCharCode(128+(n>>6&63)));r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12)));r.push(String.fromCharCode(128+(a>>6&63)));r.push(String.fromCharCode(128+(a&63)));}}return r.join(\"\")};var ht=function(){var e={};return function r(t,a){var n=t+\"|\"+(a||\"\");if(e[n])return e[n];return e[n]=new RegExp(\"<(?:\\\\w+:)?\"+t+'(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?'+t+\">\",a||\"\")}}();var ut=function(){var e=[[\"nbsp\",\" \"],[\"middot\",\"\"],[\"quot\",'\"'],[\"apos\",\"'\"],[\"gt\",\">\"],[\"lt\",\"<\"],[\"amp\",\"&\"]].map(function(e){return[new RegExp(\"&\"+e[0]+\";\",\"ig\"),e[1]]});return function r(t){var a=t.replace(/^[\\t\\n\\r ]+/,\"\").replace(/[\\t\\n\\r ]+$/,\"\").replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\").replace(/[\\t\\n\\r ]+/g,\" \").replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\").replace(/<[^>]*>/g,\"\");for(var n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}();var dt=function(){var e={};return function r(t){if(e[t]!==undefined)return e[t];return e[t]=new RegExp(\"<(?:vt:)?\"+t+\">([\\\\s\\\\S]*?)</(?:vt:)?\"+t+\">\",\"g\")}}();var vt=/<\\/?(?:vt:)?variant>/g,pt=/<(?:vt:)([^>]*)>([\\s\\S]*)</;function gt(e,r){var t=Gr(e);var a=e.match(dt(t.baseType))||[];var n=[];if(a.length!=t.size){if(r.WTF)throw new Error(\"unexpected vector length \"+a.length+\" != \"+t.size);return n}a.forEach(function(e){var r=e.replace(vt,\"\").match(pt);if(r)n.push({v:lt(r[2]),t:r[1]})});return n}var mt=/(^\\s|\\s$|\\n)/;function bt(e,r){return\"<\"+e+(r.match(mt)?' xml:space=\"preserve\"':\"\")+\">\"+r+\"</\"+e+\">\"}function wt(e){return rr(e).map(function(r){return\" \"+r+'=\"'+e[r]+'\"'}).join(\"\")}function kt(e,r,t){return\"<\"+e+(t!=null?wt(t):\"\")+(r!=null?(r.match(mt)?' xml:space=\"preserve\"':\"\")+\">\"+r+\"</\"+e:\"/\")+\">\"}function Tt(e,r){try{return e.toISOString().replace(/\\.\\d*/,\"\")}catch(t){if(r)throw t}return\"\"}function At(e,r){switch(typeof e){case\"string\":var t=kt(\"vt:lpwstr\",qr(e));if(r)t=t.replace(/&quot;/g,\"_x0022_\");return t;case\"number\":return kt((e|0)==e?\"vt:i4\":\"vt:r8\",qr(String(e)));case\"boolean\":return kt(\"vt:bool\",e?\"true\":\"false\");}if(e instanceof Date)return kt(\"vt:filetime\",Tt(e));throw new Error(\"Unable to serialize \"+e)}function Et(e){if(T&&Buffer.isBuffer(e))return e.toString(\"utf8\");if(typeof e===\"string\")return e;if(typeof Uint8Array!==\"undefined\"&&e instanceof Uint8Array)return lt(_(O(e)));throw new Error(\"Bad input format: expected Buffer or string\")}var Ct=/<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/gm;var yt={CORE_PROPS:\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\",CUST_PROPS:\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",EXT_PROPS:\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",CT:\"http://schemas.openxmlformats.org/package/2006/content-types\",RELS:\"http://schemas.openxmlformats.org/package/2006/relationships\",TCMNT:\"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments\",dc:\"http://purl.org/dc/elements/1.1/\",dcterms:\"http://purl.org/dc/terms/\",dcmitype:\"http://purl.org/dc/dcmitype/\",mx:\"http://schemas.microsoft.com/office/mac/excel/2008/main\",r:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\",sjs:\"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties\",vt:\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\",xsi:\"http://www.w3.org/2001/XMLSchema-instance\",xsd:\"http://www.w3.org/2001/XMLSchema\"};var St=[\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\",\"http://purl.oclc.org/ooxml/spreadsheetml/main\",\"http://schemas.microsoft.com/office/excel/2006/main\",\"http://schemas.microsoft.com/office/excel/2006/2\"];var _t={o:\"urn:schemas-microsoft-com:office:office\",x:\"urn:schemas-microsoft-com:office:excel\",ss:\"urn:schemas-microsoft-com:office:spreadsheet\",dt:\"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882\",mv:\"http://macVmlSchemaUri\",v:\"urn:schemas-microsoft-com:vml\",html:\"http://www.w3.org/TR/REC-html40\"};function xt(e,r){var t=1-2*(e[r+7]>>>7);var a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15);var n=e[r+6]&15;for(var i=5;i>=0;--i)n=n*256+e[r+i];if(a==2047)return n==0?t*Infinity:NaN;if(a==0)a=-1022;else{a-=1023;n+=Math.pow(2,52)}return t*Math.pow(2,a-52)*n}function Ot(e,r,t){var a=(r<0||1/r==-Infinity?1:0)<<7,n=0,i=0;var s=a?-r:r;if(!isFinite(s)){n=2047;i=isNaN(r)?26985:0}else if(s==0)n=i=0;else{n=Math.floor(Math.log(s)/Math.LN2);i=s*Math.pow(2,52-n);if(n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))){n=-1022}else{i-=Math.pow(2,52);n+=1023}}for(var f=0;f<=5;++f,i/=256)e[t+f]=i&255;e[t+6]=(n&15)<<4|i&15;e[t+7]=n>>4|a}var Rt=function(e){var r=[],t=10240;for(var a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r};var It=T?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:A(e)})):Rt(e)}:Rt;var Nt=function(e,r,t){var a=[];for(var n=r;n<t;n+=2)a.push(String.fromCharCode(Qt(e,n)));return a.join(\"\").replace(N,\"\")};var Dt=T?function(e,r,t){if(!Buffer.isBuffer(e))return Nt(e,r,t);return e.toString(\"utf16le\",r,t).replace(N,\"\")}:Nt;var Ft=function(e,r,t){var a=[];for(var n=r;n<r+t;++n)a.push((\"0\"+e[n].toString(16)).slice(-2));return a.join(\"\")};var Pt=T?function(e,r,t){return Buffer.isBuffer(e)?e.toString(\"hex\",r,r+t):Ft(e,r,t)}:Ft;var Lt=function(e,r,t){var a=[];for(var n=r;n<t;n++)a.push(String.fromCharCode(Zt(e,n)));return a.join(\"\")};var Mt=T?function rk(e,r,t){return Buffer.isBuffer(e)?e.toString(\"utf8\",r,t):Lt(e,r,t)}:Lt;var Ut=function(e,r){var t=ra(e,r);return t>0?Mt(e,r+4,r+4+t-1):\"\"};var Bt=Ut;var Wt=function(e,r){var t=ra(e,r);return t>0?Mt(e,r+4,r+4+t-1):\"\"};var Ht=Wt;var zt=function(e,r){var t=2*ra(e,r);return t>0?Mt(e,r+4,r+4+t-1):\"\"};var Vt=zt;var Gt=function tk(e,r){var t=ra(e,r);return t>0?Dt(e,r+4,r+4+t):\"\"};var jt=Gt;var Xt=function(e,r){var t=ra(e,r);return t>0?Mt(e,r+4,r+4+t):\"\"};var $t=Xt;var Yt=function(e,r){return xt(e,r)};var Kt=Yt;var Jt=function ak(e){return Array.isArray(e)||typeof Uint8Array!==\"undefined\"&&e instanceof Uint8Array};if(T){Bt=function nk(e,r){if(!Buffer.isBuffer(e))return Ut(e,r);var t=e.readUInt32LE(r);return t>0?e.toString(\"utf8\",r+4,r+4+t-1):\"\"};Ht=function ik(e,r){if(!Buffer.isBuffer(e))return Wt(e,r);var t=e.readUInt32LE(r);return t>0?e.toString(\"utf8\",r+4,r+4+t-1):\"\"};Vt=function sk(e,r){if(!Buffer.isBuffer(e))return zt(e,r);var t=2*e.readUInt32LE(r);return e.toString(\"utf16le\",r+4,r+4+t-1)};jt=function fk(e,r){if(!Buffer.isBuffer(e))return Gt(e,r);var t=e.readUInt32LE(r);return e.toString(\"utf16le\",r+4,r+4+t)};$t=function ok(e,r){if(!Buffer.isBuffer(e))return Xt(e,r);var t=e.readUInt32LE(r);return e.toString(\"utf8\",r+4,r+4+t)};Kt=function lk(e,r){if(Buffer.isBuffer(e))return e.readDoubleLE(r);return Yt(e,r)};Jt=function ck(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array!==\"undefined\"&&e instanceof Uint8Array}}function qt(){Dt=function(e,r,t){return a.utils.decode(1200,e.slice(r,t)).replace(N,\"\")};Mt=function(e,r,t){return a.utils.decode(65001,e.slice(r,t))};Bt=function(e,r){var n=ra(e,r);return n>0?a.utils.decode(t,e.slice(r+4,r+4+n-1)):\"\"};Ht=function(e,t){var n=ra(e,t);return n>0?a.utils.decode(r,e.slice(t+4,t+4+n-1)):\"\"};Vt=function(e,r){var t=2*ra(e,r);return t>0?a.utils.decode(1200,e.slice(r+4,r+4+t-1)):\"\"};jt=function(e,r){var t=ra(e,r);return t>0?a.utils.decode(1200,e.slice(r+4,r+4+t)):\"\"};$t=function(e,r){var t=ra(e,r);return t>0?a.utils.decode(65001,e.slice(r+4,r+4+t)):\"\"}}if(typeof a!==\"undefined\")qt();var Zt=function(e,r){return e[r]};var Qt=function(e,r){return e[r+1]*(1<<8)+e[r]};var ea=function(e,r){var t=e[r+1]*(1<<8)+e[r];return t<32768?t:(65535-t+1)*-1};var ra=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]};var ta=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]};var aa=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function na(e,t){var n=\"\",i,s,f=[],o,l,c,h;switch(t){case\"dbcs\":h=this.l;if(T&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString(\"utf16le\");else for(c=0;c<e;++c){n+=String.fromCharCode(Qt(this,h));h+=2}e*=2;break;case\"utf8\":n=Mt(this,this.l,this.l+e);break;case\"utf16le\":e*=2;n=Dt(this,this.l,this.l+e);break;case\"wstr\":if(typeof a!==\"undefined\")n=a.utils.decode(r,this.slice(this.l,this.l+2*e));else return na.call(this,e,\"dbcs\");e=2*e;break;case\"lpstr-ansi\":n=Bt(this,this.l);e=4+ra(this,this.l);break;case\"lpstr-cp\":n=Ht(this,this.l);e=4+ra(this,this.l);break;case\"lpwstr\":n=Vt(this,this.l);e=4+2*ra(this,this.l);break;case\"lpp4\":e=4+ra(this,this.l);n=jt(this,this.l);if(e&2)e+=2;break;case\"8lpp4\":e=4+ra(this,this.l);n=$t(this,this.l);if(e&3)e+=4-(e&3);break;case\"cstr\":e=0;n=\"\";while((o=Zt(this,this.l+e++))!==0)f.push(v(o));n=f.join(\"\");break;case\"_wstr\":e=0;n=\"\";while((o=Qt(this,this.l+e))!==0){f.push(v(o));e+=2}e+=2;n=f.join(\"\");break;case\"dbcs-cont\":n=\"\";h=this.l;for(c=0;c<e;++c){if(this.lens&&this.lens.indexOf(h)!==-1){o=Zt(this,h);this.l=h+1;l=na.call(this,e-c,o?\"dbcs-cont\":\"sbcs-cont\");return f.join(\"\")+l}f.push(v(Qt(this,h)));h+=2}n=f.join(\"\");e*=2;break;case\"cpstr\":if(typeof a!==\"undefined\"){n=a.utils.decode(r,this.slice(this.l,this.l+e));break};case\"sbcs-cont\":n=\"\";h=this.l;for(c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(h)!==-1){o=Zt(this,h);this.l=h+1;l=na.call(this,e-c,o?\"dbcs-cont\":\"sbcs-cont\");return f.join(\"\")+l}f.push(v(Zt(this,h)));h+=1}n=f.join(\"\");break;default:switch(e){case 1:i=Zt(this,this.l);this.l++;return i;case 2:i=(t===\"i\"?ea:Qt)(this,this.l);this.l+=2;return i;case 4:;case-4:if(t===\"i\"||(this[this.l+3]&128)===0){i=(e>0?ta:aa)(this,this.l);this.l+=4;return i}else{s=ra(this,this.l);this.l+=4}return s;case 8:;case-8:if(t===\"f\"){if(e==8)s=Kt(this,this.l);else s=Kt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0);this.l+=8;return s}else e=8;case 16:n=Pt(this,this.l,e);break;};}this.l+=e;return n}var ia=function(e,r,t){e[t]=r&255;e[t+1]=r>>>8&255;e[t+2]=r>>>16&255;e[t+3]=r>>>24&255};var sa=function(e,r,t){e[t]=r&255;e[t+1]=r>>8&255;e[t+2]=r>>16&255;e[t+3]=r>>24&255};var fa=function(e,r,t){e[t]=r&255;e[t+1]=r>>>8&255};function oa(e,r,n){var i=0,s=0;if(n===\"dbcs\"){for(s=0;s!=r.length;++s)fa(this,r.charCodeAt(s),this.l+2*s);i=2*r.length}else if(n===\"sbcs\"){if(typeof a!==\"undefined\"&&t==874){for(s=0;s!=r.length;++s){var f=a.utils.encode(t,r.charAt(s));this[this.l+s]=f[0]}}else{r=r.replace(/[^\\x00-\\x7F]/g,\"_\");for(s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255}i=r.length}else if(n===\"hex\"){for(;s<e;++s){this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0}return this}else if(n===\"utf16le\"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var l=r.charCodeAt(s);this[this.l++]=l&255;this[this.l++]=l>>8}while(this.l<o)this[this.l++]=0;return this}else switch(e){case 1:i=1;this[this.l]=r&255;break;case 2:i=2;this[this.l]=r&255;r>>>=8;this[this.l+1]=r&255;break;case 3:i=3;this[this.l]=r&255;r>>>=8;this[this.l+1]=r&255;r>>>=8;this[this.l+2]=r&255;break;case 4:i=4;ia(this,r,this.l);break;case 8:i=8;if(n===\"f\"){Ot(this,r,this.l);break};case 16:break;case-4:i=4;sa(this,r,this.l);break;}this.l+=i;return this}function la(e,r){var t=Pt(this,this.l,e.length>>1);if(t!==e)throw new Error(r+\"Expected \"+e+\" saw \"+t);this.l+=e.length>>1}function ca(e,r){e.l=r;e._R=na;e.chk=la;e._W=oa}function ha(e,r){e.l+=r}function ua(e){var r=E(e);ca(r,0);return r}function da(e,r,t){if(!e)return;var a,n,i;ca(e,e.l||0);var s=e.length,f=0,o=0;while(e.l<s){f=e._R(1);if(f&128)f=(f&127)+((e._R(1)&127)<<7);var l=gm[f]||gm[65535];a=e._R(1);i=a&127;for(n=1;n<4&&a&128;++n)i+=((a=e._R(1))&127)<<7*n;o=e.l+i;var c=l.f&&l.f(e,i,t);e.l=o;if(r(c,l,f))return}}function va(){var e=[],r=T?256:2048;var t=function o(e){var r=ua(e);ca(r,0);return r};var a=t(r);var n=function l(){if(!a)return;if(a.length>a.l){a=a.slice(0,a.l);a.l=a.length}if(a.length>0)e.push(a);a=null};var i=function c(e){if(a&&e<a.length-a.l)return a;n();return a=t(Math.max(e+1,r))};var s=function h(){n();return R(e)};var f=function u(e){n();a=e;if(a.l==null)a.l=a.length;i(r)};return{next:i,push:f,end:s,_bufs:e}}function pa(e,r,t,a){var n=+r,i;if(isNaN(n))return;if(!a)a=gm[n].p||(t||[]).length||0;i=1+(n>=128?1:0)+1;if(a>=128)++i;if(a>=16384)++i;if(a>=2097152)++i;var s=e.next(i);if(n<=127)s._W(1,n);else{s._W(1,(n&127)+128);s._W(1,n>>7)}for(var f=0;f!=4;++f){if(a>=128){s._W(1,(a&127)+128);a>>=7}else{s._W(1,a);break}}if(a>0&&Jt(t))e.push(t)}function ga(e,r,t){var a=br(e);if(r.s){if(a.cRel)a.c+=r.s.c;if(a.rRel)a.r+=r.s.r}else{if(a.cRel)a.c+=r.c;if(a.rRel)a.r+=r.r}if(!t||t.biff<12){while(a.c>=256)a.c-=256;while(a.r>=65536)a.r-=65536}return a}function ma(e,r,t){var a=br(e);a.s=ga(a.s,r.s,t);a.e=ga(a.e,r.s,t);return a}function ba(e,r){if(e.cRel&&e.c<0){e=br(e);while(e.c<0)e.c+=r>8?16384:256}if(e.rRel&&e.r<0){e=br(e);while(e.r<0)e.r+=r>8?1048576:r>5?65536:16384}var t=Ra(e);if(!e.cRel&&e.cRel!=null)t=Sa(t);if(!e.rRel&&e.rRel!=null)t=Aa(t);return t}function wa(e,r){if(e.s.r==0&&!e.s.rRel){if(e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel){return(e.s.cRel?\"\":\"$\")+ya(e.s.c)+\":\"+(e.e.cRel?\"\":\"$\")+ya(e.e.c);\n}}if(e.s.c==0&&!e.s.cRel){if(e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel){return(e.s.rRel?\"\":\"$\")+Ta(e.s.r)+\":\"+(e.e.rRel?\"\":\"$\")+Ta(e.e.r)}}return ba(e.s,r.biff)+\":\"+ba(e.e,r.biff)}function ka(e){return parseInt(Ea(e),10)-1}function Ta(e){return\"\"+(e+1)}function Aa(e){return e.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\")}function Ea(e){return e.replace(/\\$(\\d+)$/,\"$1\")}function Ca(e){var r=_a(e),t=0,a=0;for(;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function ya(e){if(e<0)throw new Error(\"invalid column \"+e);var r=\"\";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Sa(e){return e.replace(/^([A-Z])/,\"$$$1\")}function _a(e){return e.replace(/^\\$([A-Z])/,\"$1\")}function xa(e){return e.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\")}function Oa(e){var r=0,t=0;for(var a=0;a<e.length;++a){var n=e.charCodeAt(a);if(n>=48&&n<=57)r=10*r+(n-48);else if(n>=65&&n<=90)t=26*t+(n-64)}return{c:t-1,r:r-1}}function Ra(e){var r=e.c+1;var t=\"\";for(;r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ia(e){var r=e.indexOf(\":\");if(r==-1)return{s:Oa(e),e:Oa(e)};return{s:Oa(e.slice(0,r)),e:Oa(e.slice(r+1))}}function Na(e,r){if(typeof r===\"undefined\"||typeof r===\"number\"){return Na(e.s,e.e)}if(typeof e!==\"string\")e=Ra(e);if(typeof r!==\"string\")r=Ra(r);return e==r?e:e+\":\"+r}function Da(e){var r={s:{c:0,r:0},e:{c:0,r:0}};var t=0,a=0,n=0;var i=e.length;for(t=0;a<i;++a){if((n=e.charCodeAt(a)-64)<1||n>26)break;t=26*t+n}r.s.c=--t;for(t=0;a<i;++a){if((n=e.charCodeAt(a)-48)<0||n>9)break;t=10*t+n}r.s.r=--t;if(a===i||n!=10){r.e.c=r.s.c;r.e.r=r.s.r;return r}++a;for(t=0;a!=i;++a){if((n=e.charCodeAt(a)-64)<1||n>26)break;t=26*t+n}r.e.c=--t;for(t=0;a!=i;++a){if((n=e.charCodeAt(a)-48)<0||n>9)break;t=10*t+n}r.e.r=--t;return r}function Fa(e,r){var t=e.t==\"d\"&&r instanceof Date;if(e.z!=null)try{return e.w=Be(e.z,t?fr(r):r)}catch(a){}try{return e.w=Be((e.XF||{}).numFmtId||(t?14:0),t?fr(r):r)}catch(a){return\"\"+r}}function Pa(e,r,t){if(e==null||e.t==null||e.t==\"z\")return\"\";if(e.w!==undefined)return e.w;if(e.t==\"d\"&&!e.z&&t&&t.dateNF)e.z=t.dateNF;if(e.t==\"e\")return Gn[e.v]||e.v;if(r==undefined)return Fa(e,e.v);return Fa(e,r)}function La(e,r){var t=r&&r.sheet?r.sheet:\"Sheet1\";var a={};a[t]=e;return{SheetNames:[t],Sheets:a}}function Ma(e,r,t){var a=t||{};var n=e?Array.isArray(e):a.dense;if(g!=null&&n==null)n=g;var i=e||(n?[]:{});var s=0,f=0;if(i&&a.origin!=null){if(typeof a.origin==\"number\")s=a.origin;else{var o=typeof a.origin==\"string\"?Oa(a.origin):a.origin;s=o.r;f=o.c}if(!i[\"!ref\"])i[\"!ref\"]=\"A1:A1\"}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i[\"!ref\"]){var c=Da(i[\"!ref\"]);l.s.c=c.s.c;l.s.r=c.s.r;l.e.c=Math.max(l.e.c,c.e.c);l.e.r=Math.max(l.e.r,c.e.r);if(s==-1)l.e.r=s=c.e.r+1}for(var h=0;h!=r.length;++h){if(!r[h])continue;if(!Array.isArray(r[h]))throw new Error(\"aoa_to_sheet expects an array of arrays\");for(var u=0;u!=r[h].length;++u){if(typeof r[h][u]===\"undefined\")continue;var d={v:r[h][u]};var v=s+h,p=f+u;if(l.s.r>v)l.s.r=v;if(l.s.c>p)l.s.c=p;if(l.e.r<v)l.e.r=v;if(l.e.c<p)l.e.c=p;if(r[h][u]&&typeof r[h][u]===\"object\"&&!Array.isArray(r[h][u])&&!(r[h][u]instanceof Date))d=r[h][u];else{if(Array.isArray(d.v)){d.f=r[h][u][1];d.v=d.v[0]}if(d.v===null){if(d.f)d.t=\"n\";else if(a.nullError){d.t=\"e\";d.v=0}else if(!a.sheetStubs)continue;else d.t=\"z\"}else if(typeof d.v===\"number\")d.t=\"n\";else if(typeof d.v===\"boolean\")d.t=\"b\";else if(d.v instanceof Date){d.z=a.dateNF||X[14];if(a.cellDates){d.t=\"d\";d.w=Be(d.z,fr(d.v))}else{d.t=\"n\";d.v=fr(d.v);d.w=Be(d.z,d.v)}}else d.t=\"s\"}if(n){if(!i[v])i[v]=[];if(i[v][p]&&i[v][p].z)d.z=i[v][p].z;i[v][p]=d}else{var m=Ra({c:p,r:v});if(i[m]&&i[m].z)d.z=i[m].z;i[m]=d}}}if(l.s.c<1e7)i[\"!ref\"]=Na(l);return i}function Ua(e,r){return Ma(null,e,r)}function Ba(e){return e._R(4,\"i\")}function Wa(e,r){if(!r)r=ua(4);r._W(4,e);return r}function Ha(e){var r=e._R(4);return r===0?\"\":e._R(r,\"dbcs\")}function za(e,r){var t=false;if(r==null){t=true;r=ua(4+2*e.length)}r._W(4,e.length);if(e.length>0)r._W(0,e,\"dbcs\");return t?r.slice(0,r.l):r}function Va(e){return{ich:e._R(2),ifnt:e._R(2)}}function Ga(e,r){if(!r)r=ua(4);r._W(2,e.ich||0);r._W(2,e.ifnt||0);return r}function ja(e,r){var t=e.l;var a=e._R(1);var n=Ha(e);var i=[];var s={t:n,h:n};if((a&1)!==0){var f=e._R(4);for(var o=0;o!=f;++o)i.push(Va(e));s.r=i}else s.r=[{ich:0,ifnt:0}];e.l=t+r;return s}function Xa(e,r){var t=false;if(r==null){t=true;r=ua(15+4*e.t.length)}r._W(1,0);za(e.t,r);return t?r.slice(0,r.l):r}var $a=ja;function Ya(e,r){var t=false;if(r==null){t=true;r=ua(23+4*e.t.length)}r._W(1,1);za(e.t,r);r._W(4,1);Ga({ich:0,ifnt:0},r);return t?r.slice(0,r.l):r}function Ka(e){var r=e._R(4);var t=e._R(2);t+=e._R(1)<<16;e.l++;return{c:r,iStyleRef:t}}function Ja(e,r){if(r==null)r=ua(8);r._W(-4,e.c);r._W(3,e.iStyleRef||e.s);r._W(1,0);return r}function qa(e){var r=e._R(2);r+=e._R(1)<<16;e.l++;return{c:-1,iStyleRef:r}}function Za(e,r){if(r==null)r=ua(4);r._W(3,e.iStyleRef||e.s);r._W(1,0);return r}var Qa=Ha;var en=za;function rn(e){var r=e._R(4);return r===0||r===4294967295?\"\":e._R(r,\"dbcs\")}function tn(e,r){var t=false;if(r==null){t=true;r=ua(127)}r._W(4,e.length>0?e.length:4294967295);if(e.length>0)r._W(0,e,\"dbcs\");return t?r.slice(0,r.l):r}var an=Ha;var nn=rn;var sn=tn;function fn(e){var r=e.slice(e.l,e.l+4);var t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Kt([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ta(r,0)>>2;return t?n/100:n}function on(e,r){if(r==null)r=ua(4);var t=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29){a=1}else if(n==(n|0)&&n>=-(1<<29)&&n<1<<29){a=1;t=1}if(a)r._W(-4,((t?n:e)<<2)+(t+2));else throw new Error(\"unsupported RkNumber \"+e)}function ln(e){var r={s:{},e:{}};r.s.r=e._R(4);r.e.r=e._R(4);r.s.c=e._R(4);r.e.c=e._R(4);return r}function cn(e,r){if(!r)r=ua(16);r._W(4,e.s.r);r._W(4,e.e.r);r._W(4,e.s.c);r._W(4,e.e.c);return r}var hn=ln;var un=cn;function dn(e){if(e.length-e.l<8)throw\"XLS Xnum Buffer underflow\";return e._R(8,\"f\")}function vn(e,r){return(r||ua(8))._W(8,e,\"f\")}function pn(e){var r={};var t=e._R(1);var a=t>>>1;var n=e._R(1);var i=e._R(2,\"i\");var s=e._R(1);var f=e._R(1);var o=e._R(1);e.l++;switch(a){case 0:r.auto=1;break;case 1:r.index=n;var l=Vn[n];if(l)r.rgb=bl(l);break;case 2:r.rgb=bl([s,f,o]);break;case 3:r.theme=n;break;}if(i!=0)r.tint=i>0?i/32767:i/32768;return r}function gn(e,r){if(!r)r=ua(8);if(!e||e.auto){r._W(4,0);r._W(4,0);return r}if(e.index!=null){r._W(1,2);r._W(1,e.index)}else if(e.theme!=null){r._W(1,6);r._W(1,e.theme)}else{r._W(1,5);r._W(1,0)}var t=e.tint||0;if(t>0)t*=32767;else if(t<0)t*=32768;r._W(2,t);if(!e.rgb||e.theme!=null){r._W(2,0);r._W(1,0);r._W(1,0)}else{var a=e.rgb||\"FFFFFF\";if(typeof a==\"number\")a=(\"000000\"+a.toString(16)).slice(-6);r._W(1,parseInt(a.slice(0,2),16));r._W(1,parseInt(a.slice(2,4),16));r._W(1,parseInt(a.slice(4,6),16));r._W(1,255)}return r}function mn(e){var r=e._R(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function bn(e,r){if(!r)r=ua(2);var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);r._W(1,t);r._W(1,0);return r}function wn(e,r){var t={2:\"BITMAP\",3:\"METAFILEPICT\",8:\"DIB\",14:\"ENHMETAFILE\"};var a=e._R(4);switch(a){case 0:return\"\";case 4294967295:;case 4294967294:return t[e._R(4)]||\"\";}if(a>400)throw new Error(\"Unsupported Clipboard: \"+a.toString(16));e.l-=4;return e._R(0,r==1?\"lpstr\":\"lpwstr\")}function kn(e){return wn(e,1)}function Tn(e){return wn(e,2)}var An=2;var En=3;var Cn=11;var yn=12;var Sn=19;var _n=30;var xn=64;var On=65;var Rn=71;var In=4096;var Nn=4108;var Dn=4126;var Fn=80;var Pn=81;var Ln=[Fn,Pn];var Mn={1:{n:\"CodePage\",t:An},2:{n:\"Category\",t:Fn},3:{n:\"PresentationFormat\",t:Fn},4:{n:\"ByteCount\",t:En},5:{n:\"LineCount\",t:En},6:{n:\"ParagraphCount\",t:En},7:{n:\"SlideCount\",t:En},8:{n:\"NoteCount\",t:En},9:{n:\"HiddenCount\",t:En},10:{n:\"MultimediaClipCount\",t:En},11:{n:\"ScaleCrop\",t:Cn},12:{n:\"HeadingPairs\",t:Nn},13:{n:\"TitlesOfParts\",t:Dn},14:{n:\"Manager\",t:Fn},15:{n:\"Company\",t:Fn},16:{n:\"LinksUpToDate\",t:Cn},17:{n:\"CharacterCount\",t:En},19:{n:\"SharedDoc\",t:Cn},22:{n:\"HyperlinksChanged\",t:Cn},23:{n:\"AppVersion\",t:En,p:\"version\"},24:{n:\"DigSig\",t:On},26:{n:\"ContentType\",t:Fn},27:{n:\"ContentStatus\",t:Fn},28:{n:\"Language\",t:Fn},29:{n:\"Version\",t:Fn},255:{},2147483648:{n:\"Locale\",t:Sn},2147483651:{n:\"Behavior\",t:Sn},1919054434:{}};var Un={1:{n:\"CodePage\",t:An},2:{n:\"Title\",t:Fn},3:{n:\"Subject\",t:Fn},4:{n:\"Author\",t:Fn},5:{n:\"Keywords\",t:Fn},6:{n:\"Comments\",t:Fn},7:{n:\"Template\",t:Fn},8:{n:\"LastAuthor\",t:Fn},9:{n:\"RevNumber\",t:Fn},10:{n:\"EditTime\",t:xn},11:{n:\"LastPrinted\",t:xn},12:{n:\"CreatedDate\",t:xn},13:{n:\"ModifiedDate\",t:xn},14:{n:\"PageCount\",t:En},15:{n:\"WordCount\",t:En},16:{n:\"CharCount\",t:En},17:{n:\"Thumbnail\",t:Rn},18:{n:\"Application\",t:Fn},19:{n:\"DocSecurity\",t:En},255:{},2147483648:{n:\"Locale\",t:Sn},2147483651:{n:\"Behavior\",t:Sn},1919054434:{}};var Bn={1:\"US\",2:\"CA\",3:\"\",7:\"RU\",20:\"EG\",30:\"GR\",31:\"NL\",32:\"BE\",33:\"FR\",34:\"ES\",36:\"HU\",39:\"IT\",41:\"CH\",43:\"AT\",44:\"GB\",45:\"DK\",46:\"SE\",47:\"NO\",48:\"PL\",49:\"DE\",52:\"MX\",55:\"BR\",61:\"AU\",64:\"NZ\",66:\"TH\",81:\"JP\",82:\"KR\",84:\"VN\",86:\"CN\",90:\"TR\",105:\"JS\",213:\"DZ\",216:\"MA\",218:\"LY\",351:\"PT\",354:\"IS\",358:\"FI\",420:\"CZ\",886:\"TW\",961:\"LB\",962:\"JO\",963:\"SY\",964:\"IQ\",965:\"KW\",966:\"SA\",971:\"AE\",972:\"IL\",974:\"QA\",981:\"IR\",65535:\"US\"};var Wn=[null,\"solid\",\"mediumGray\",\"darkGray\",\"lightGray\",\"darkHorizontal\",\"darkVertical\",\"darkDown\",\"darkUp\",\"darkGrid\",\"darkTrellis\",\"lightHorizontal\",\"lightVertical\",\"lightDown\",\"lightUp\",\"lightGrid\",\"lightTrellis\",\"gray125\",\"gray0625\"];function Hn(e){return e.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var zn=Hn([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var Vn=br(zn);var Gn={0:\"#NULL!\",7:\"#DIV/0!\",15:\"#VALUE!\",23:\"#REF!\",29:\"#NAME?\",36:\"#NUM!\",42:\"#N/A\",43:\"#GETTING_DATA\",255:\"#WTF?\"};var jn={\"#NULL!\":0,\"#DIV/0!\":7,\"#VALUE!\":15,\"#REF!\":23,\"#NAME?\":29,\"#NUM!\":36,\"#N/A\":42,\"#GETTING_DATA\":43,\"#WTF?\":255};var Xn={\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\":\"workbooks\",\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\":\"workbooks\",\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\":\"workbooks\",\"application/vnd.ms-excel.addin.macroEnabled.main+xml\":\"workbooks\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\":\"workbooks\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\":\"sheets\",\"application/vnd.ms-excel.worksheet\":\"sheets\",\"application/vnd.ms-excel.binIndexWs\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\":\"charts\",\"application/vnd.ms-excel.chartsheet\":\"charts\",\"application/vnd.ms-excel.macrosheet+xml\":\"macros\",\"application/vnd.ms-excel.macrosheet\":\"macros\",\"application/vnd.ms-excel.intlmacrosheet\":\"TODO\",\"application/vnd.ms-excel.binIndexMs\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\":\"dialogs\",\"application/vnd.ms-excel.dialogsheet\":\"dialogs\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\":\"strs\",\"application/vnd.ms-excel.sharedStrings\":\"strs\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\":\"styles\",\"application/vnd.ms-excel.styles\":\"styles\",\"application/vnd.openxmlformats-package.core-properties+xml\":\"coreprops\",\"application/vnd.openxmlformats-officedocument.custom-properties+xml\":\"custprops\",\"application/vnd.openxmlformats-officedocument.extended-properties+xml\":\"extprops\",\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\":\"comments\",\"application/vnd.ms-excel.comments\":\"comments\",\"application/vnd.ms-excel.threadedcomments+xml\":\"threadedcomments\",\"application/vnd.ms-excel.person+xml\":\"people\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\":\"metadata\",\"application/vnd.ms-excel.sheetMetadata\":\"metadata\",\"application/vnd.ms-excel.pivotTable\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\":\"TODO\",\"application/vnd.ms-office.chartcolorstyle+xml\":\"TODO\",\"application/vnd.ms-office.chartstyle+xml\":\"TODO\",\"application/vnd.ms-office.chartex+xml\":\"TODO\",\"application/vnd.ms-excel.calcChain\":\"calcchains\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\":\"calcchains\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\":\"TODO\",\"application/vnd.ms-office.activeX\":\"TODO\",\"application/vnd.ms-office.activeX+xml\":\"TODO\",\"application/vnd.ms-excel.attachedToolbars\":\"TODO\",\"application/vnd.ms-excel.connections\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\":\"TODO\",\"application/vnd.ms-excel.externalLink\":\"links\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\":\"links\",\"application/vnd.ms-excel.pivotCacheDefinition\":\"TODO\",\"application/vnd.ms-excel.pivotCacheRecords\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\":\"TODO\",\"application/vnd.ms-excel.queryTable\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\":\"TODO\",\"application/vnd.ms-excel.userNames\":\"TODO\",\"application/vnd.ms-excel.revisionHeaders\":\"TODO\",\"application/vnd.ms-excel.revisionLog\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\":\"TODO\",\"application/vnd.ms-excel.tableSingleCells\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\":\"TODO\",\"application/vnd.ms-excel.slicer\":\"TODO\",\"application/vnd.ms-excel.slicerCache\":\"TODO\",\"application/vnd.ms-excel.slicer+xml\":\"TODO\",\"application/vnd.ms-excel.slicerCache+xml\":\"TODO\",\"application/vnd.ms-excel.wsSortMap\":\"TODO\",\"application/vnd.ms-excel.table\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.theme+xml\":\"themes\",\"application/vnd.openxmlformats-officedocument.themeOverride+xml\":\"TODO\",\"application/vnd.ms-excel.Timeline+xml\":\"TODO\",\"application/vnd.ms-excel.TimelineCache+xml\":\"TODO\",\"application/vnd.ms-office.vbaProject\":\"vba\",\"application/vnd.ms-office.vbaProjectSignature\":\"TODO\",\"application/vnd.ms-office.volatileDependencies\":\"TODO\",\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\":\"TODO\",\"application/vnd.ms-excel.controlproperties+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.model+data\":\"TODO\",\"application/vnd.ms-excel.Survey+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawing+xml\":\"drawings\",\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\":\"TODO\",\"application/vnd.openxmlformats-officedocument.vmlDrawing\":\"TODO\",\"application/vnd.openxmlformats-package.relationships+xml\":\"rels\",\"application/vnd.openxmlformats-officedocument.oleObject\":\"TODO\",\"image/png\":\"TODO\",sheet:\"js\"};var $n={workbooks:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",xlsm:\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",xlsb:\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",xlam:\"application/vnd.ms-excel.addin.macroEnabled.main+xml\",xltx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"},strs:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",xlsb:\"application/vnd.ms-excel.sharedStrings\"},comments:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",xlsb:\"application/vnd.ms-excel.comments\"},sheets:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",xlsb:\"application/vnd.ms-excel.worksheet\"},charts:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",xlsb:\"application/vnd.ms-excel.chartsheet\"},dialogs:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",xlsb:\"application/vnd.ms-excel.dialogsheet\"},macros:{xlsx:\"application/vnd.ms-excel.macrosheet+xml\",xlsb:\"application/vnd.ms-excel.macrosheet\"},metadata:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",xlsb:\"application/vnd.ms-excel.sheetMetadata\"},styles:{xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",xlsb:\"application/vnd.ms-excel.styles\"}};function Yn(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:\"\"}}function Kn(e){var r=Yn();if(!e||!e.match)return r;var t={};(e.match(Hr)||[]).forEach(function(e){var a=Gr(e);switch(a[0].replace(zr,\"<\")){case\"<?xml\":break;case\"<Types\":r.xmlns=a[\"xmlns\"+(a[0].match(/<(\\w+):/)||[\"\",\"\"])[1]];break;case\"<Default\":t[a.Extension]=a.ContentType;break;case\"<Override\":if(r[Xn[a.ContentType]]!==undefined)r[Xn[a.ContentType]].push(a.PartName);break;}});if(r.xmlns!==yt.CT)throw new Error(\"Unknown Namespace: \"+r.xmlns);r.calcchain=r.calcchains.length>0?r.calcchains[0]:\"\";r.sst=r.strs.length>0?r.strs[0]:\"\";r.style=r.styles.length>0?r.styles[0]:\"\";r.defaults=t;delete r.calcchains;return r}function Jn(e,r){var t=ir(Xn);var a=[],n;a[a.length]=Mr;a[a.length]=kt(\"Types\",null,{xmlns:yt.CT,\"xmlns:xsd\":yt.xsd,\"xmlns:xsi\":yt.xsi});a=a.concat([[\"xml\",\"application/xml\"],[\"bin\",\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\"],[\"vml\",\"application/vnd.openxmlformats-officedocument.vmlDrawing\"],[\"data\",\"application/vnd.openxmlformats-officedocument.model+data\"],[\"bmp\",\"image/bmp\"],[\"png\",\"image/png\"],[\"gif\",\"image/gif\"],[\"emf\",\"image/x-emf\"],[\"wmf\",\"image/x-wmf\"],[\"jpg\",\"image/jpeg\"],[\"jpeg\",\"image/jpeg\"],[\"tif\",\"image/tiff\"],[\"tiff\",\"image/tiff\"],[\"pdf\",\"application/pdf\"],[\"rels\",\"application/vnd.openxmlformats-package.relationships+xml\"]].map(function(e){return kt(\"Default\",null,{Extension:e[0],ContentType:e[1]})}));var i=function(t){if(e[t]&&e[t].length>0){n=e[t][0];a[a.length]=kt(\"Override\",null,{PartName:(n[0]==\"/\"?\"\":\"/\")+n,ContentType:$n[t][r.bookType]||$n[t][\"xlsx\"]})}};var s=function(t){(e[t]||[]).forEach(function(e){a[a.length]=kt(\"Override\",null,{PartName:(e[0]==\"/\"?\"\":\"/\")+e,ContentType:$n[t][r.bookType]||$n[t][\"xlsx\"]})})};var f=function(r){(e[r]||[]).forEach(function(e){a[a.length]=kt(\"Override\",null,{PartName:(e[0]==\"/\"?\"\":\"/\")+e,ContentType:t[r][0]})})};i(\"workbooks\");s(\"sheets\");s(\"charts\");f(\"themes\");[\"strs\",\"styles\"].forEach(i);[\"coreprops\",\"extprops\",\"custprops\"].forEach(f);f(\"vba\");f(\"comments\");f(\"threadedcomments\");f(\"drawings\");s(\"metadata\");f(\"people\");if(a.length>2){a[a.length]=\"</Types>\";a[1]=a[1].replace(\"/>\",\">\")}return a.join(\"\")}var qn={WB:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",SHEET:\"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",HLINK:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",VML:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",XPATH:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",XMISS:\"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",XLINK:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",CXML:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",CXMLP:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",CMNT:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",CORE_PROPS:\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",EXT_PROPS:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\",CUST_PROPS:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties\",SST:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",STY:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",THEME:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",CHART:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",CHARTEX:\"http://schemas.microsoft.com/office/2014/relationships/chartEx\",CS:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",WS:[\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"],DS:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",MS:\"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",IMG:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",DRAW:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",XLMETA:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",TCMNT:\"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",PEOPLE:\"http://schemas.microsoft.com/office/2017/10/relationships/person\",VBA:\"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"};function Zn(e){var r=e.lastIndexOf(\"/\");return e.slice(0,r+1)+\"_rels/\"+e.slice(r+1)+\".rels\"}function Qn(e,r){var t={\"!id\":{}};if(!e)return t;if(r.charAt(0)!==\"/\"){r=\"/\"+r}var a={};(e.match(Hr)||[]).forEach(function(e){var n=Gr(e);if(n[0]===\"<Relationship\"){var i={};i.Type=n.Type;i.Target=n.Target;i.Id=n.Id;if(n.TargetMode)i.TargetMode=n.TargetMode;var s=n.TargetMode===\"External\"?n.Target:Lr(n.Target,r);t[s]=i;a[n.Id]=i}});t[\"!id\"]=a;return t}function ei(e){var r=[Mr,kt(\"Relationships\",null,{xmlns:yt.RELS})];rr(e[\"!id\"]).forEach(function(t){r[r.length]=kt(\"Relationship\",null,e[\"!id\"][t])});if(r.length>2){r[r.length]=\"</Relationships>\";r[1]=r[1].replace(\"/>\",\">\")}return r.join(\"\")}function ri(e,r,t,a,n,i){if(!n)n={};if(!e[\"!id\"])e[\"!id\"]={};if(!e[\"!idx\"])e[\"!idx\"]=1;if(r<0)for(r=e[\"!idx\"];e[\"!id\"][\"rId\"+r];++r){}e[\"!idx\"]=r+1;n.Id=\"rId\"+r;n.Type=a;n.Target=t;if(i)n.TargetMode=i;else if([qn.HLINK,qn.XPATH,qn.XMISS].indexOf(n.Type)>-1)n.TargetMode=\"External\";if(e[\"!id\"][n.Id])throw new Error(\"Cannot rewrite rId \"+r);e[\"!id\"][n.Id]=n;e[(\"/\"+n.Target).replace(\"//\",\"/\")]=n;return r}var ti=\"application/vnd.oasis.opendocument.spreadsheet\";function ai(e,r){var t=Et(e);var a;var n;while(a=Ct.exec(t))switch(a[3]){case\"manifest\":break;case\"file-entry\":n=Gr(a[0],false);if(n.path==\"/\"&&n.type!==ti)throw new Error(\"This OpenDocument is not a spreadsheet\");break;case\"encryption-data\":;case\"algorithm\":;case\"start-key-generation\":;case\"key-derivation\":throw new Error(\"Unsupported ODS Encryption\");default:if(r&&r.WTF)throw a;}}function ni(e){var r=[Mr];r.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');r.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path=\"'+e[t][0]+'\" manifest:media-type=\"'+e[t][1]+'\"/>\\n');r.push(\"</manifest:manifest>\");return r.join(\"\")}function ii(e,r,t){return['  <rdf:Description rdf:about=\"'+e+'\">\\n','    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||\"odf\")+\"#\"+r+'\"/>\\n',\"  </rdf:Description>\\n\"].join(\"\")}function si(e,r){return['  <rdf:Description rdf:about=\"'+e+'\">\\n','    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"'+r+'\"/>\\n',\"  </rdf:Description>\\n\"].join(\"\")}function fi(e){var r=[Mr];r.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');for(var t=0;t!=e.length;++t){r.push(ii(e[t][0],e[t][1]));r.push(si(\"\",e[t][0]))}r.push(ii(\"\",\"Document\",\"pkg\"));r.push(\"</rdf:RDF>\");return r.join(\"\")}function oi(){return'<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet'+\"JS \"+e.version+\"</meta:generator></office:meta></office:document-meta>\"}var li=[[\"cp:category\",\"Category\"],[\"cp:contentStatus\",\"ContentStatus\"],[\"cp:keywords\",\"Keywords\"],[\"cp:lastModifiedBy\",\"LastAuthor\"],[\"cp:lastPrinted\",\"LastPrinted\"],[\"cp:revision\",\"RevNumber\"],[\"cp:version\",\"Version\"],[\"dc:creator\",\"Author\"],[\"dc:description\",\"Comments\"],[\"dc:identifier\",\"Identifier\"],[\"dc:language\",\"Language\"],[\"dc:subject\",\"Subject\"],[\"dc:title\",\"Title\"],[\"dcterms:created\",\"CreatedDate\",\"date\"],[\"dcterms:modified\",\"ModifiedDate\",\"date\"]];var ci=function(){var e=new Array(li.length);for(var r=0;r<li.length;++r){var t=li[r];var a=\"(?:\"+t[0].slice(0,t[0].indexOf(\":\"))+\":)\"+t[0].slice(t[0].indexOf(\":\")+1);e[r]=new RegExp(\"<\"+a+\"[^>]*>([\\\\s\\\\S]*?)</\"+a+\">\")}return e}();function hi(e){var r={};e=lt(e);for(var t=0;t<li.length;++t){var a=li[t],n=e.match(ci[t]);if(n!=null&&n.length>0)r[a[1]]=Yr(n[1]);if(a[2]===\"date\"&&r[a[1]])r[a[1]]=gr(r[a[1]])}return r}function ui(e,r,t,a,n){if(n[e]!=null||r==null||r===\"\")return;n[e]=r;r=qr(r);a[a.length]=t?kt(e,r,t):bt(e,r)}function di(e,r){var t=r||{};var a=[Mr,kt(\"cp:coreProperties\",null,{\"xmlns:cp\":yt.CORE_PROPS,\"xmlns:dc\":yt.dc,\"xmlns:dcterms\":yt.dcterms,\"xmlns:dcmitype\":yt.dcmitype,\"xmlns:xsi\":yt.xsi})],n={};if(!e&&!t.Props)return a.join(\"\");if(e){if(e.CreatedDate!=null)ui(\"dcterms:created\",typeof e.CreatedDate===\"string\"?e.CreatedDate:Tt(e.CreatedDate,t.WTF),{\"xsi:type\":\"dcterms:W3CDTF\"},a,n);if(e.ModifiedDate!=null)ui(\"dcterms:modified\",typeof e.ModifiedDate===\"string\"?e.ModifiedDate:Tt(e.ModifiedDate,t.WTF),{\"xsi:type\":\"dcterms:W3CDTF\"},a,n)}for(var i=0;i!=li.length;++i){var s=li[i];var f=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e?e[s[1]]:null;if(f===true)f=\"1\";else if(f===false)f=\"0\";else if(typeof f==\"number\")f=String(f);if(f!=null)ui(s[0],f,null,a,n)}if(a.length>2){a[a.length]=\"</cp:coreProperties>\";a[1]=a[1].replace(\"/>\",\">\")}return a.join(\"\")}var vi=[[\"Application\",\"Application\",\"string\"],[\"AppVersion\",\"AppVersion\",\"string\"],[\"Company\",\"Company\",\"string\"],[\"DocSecurity\",\"DocSecurity\",\"string\"],[\"Manager\",\"Manager\",\"string\"],[\"HyperlinksChanged\",\"HyperlinksChanged\",\"bool\"],[\"SharedDoc\",\"SharedDoc\",\"bool\"],[\"LinksUpToDate\",\"LinksUpToDate\",\"bool\"],[\"ScaleCrop\",\"ScaleCrop\",\"bool\"],[\"HeadingPairs\",\"HeadingPairs\",\"raw\"],[\"TitlesOfParts\",\"TitlesOfParts\",\"raw\"]];var pi=[\"Worksheets\",\"SheetNames\",\"NamedRanges\",\"DefinedNames\",\"Chartsheets\",\"ChartNames\"];function gi(e,r,t,a){var n=[];if(typeof e==\"string\")n=gt(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(e){return{v:e}}));var s=typeof r==\"string\"?gt(r,a).map(function(e){return e.v}):r;var f=0,o=0;if(s.length>0)for(var l=0;l!==n.length;l+=2){o=+n[l+1].v;switch(n[l].v){case\"Worksheets\":;case\"\":;case\"\":;case\" \":;case\"\":;case\" \":;case\"Arbeitsbltter\":;case\"alma Sayfalar\":;case\"Feuilles de calcul\":;case\"Fogli di lavoro\":;case\"Folhas de clculo\":;case\"Planilhas\":;case\"Regneark\":;case\"Hojas de clculo\":;case\"Werkbladen\":t.Worksheets=o;t.SheetNames=s.slice(f,f+o);break;case\"Named Ranges\":;case\"Rangos con nombre\":;case\"\":;case\"Benannte Bereiche\":;case\"Navngivne omrder\":t.NamedRanges=o;t.DefinedNames=s.slice(f,f+o);break;case\"Charts\":;case\"Diagramme\":t.Chartsheets=o;t.ChartNames=s.slice(f,f+o);break;}f+=o}}function mi(e,r,t){var a={};if(!r)r={};e=lt(e);vi.forEach(function(t){var n=(e.match(ht(t[0]))||[])[1];switch(t[2]){case\"string\":if(n)r[t[1]]=Yr(n);break;case\"bool\":r[t[1]]=n===\"true\";break;case\"raw\":var i=e.match(new RegExp(\"<\"+t[0]+\"[^>]*>([\\\\s\\\\S]*?)</\"+t[0]+\">\"));if(i&&i.length>0)a[t[1]]=i[1];break;}});if(a.HeadingPairs&&a.TitlesOfParts)gi(a.HeadingPairs,a.TitlesOfParts,r,t);return r}function bi(e){var r=[],t=kt;if(!e)e={};e.Application=\"SheetJS\";r[r.length]=Mr;r[r.length]=kt(\"Properties\",null,{xmlns:yt.EXT_PROPS,\"xmlns:vt\":yt.vt});vi.forEach(function(a){if(e[a[1]]===undefined)return;var n;switch(a[2]){case\"string\":n=qr(String(e[a[1]]));break;case\"bool\":n=e[a[1]]?\"true\":\"false\";break;}if(n!==undefined)r[r.length]=t(a[0],n)});r[r.length]=t(\"HeadingPairs\",t(\"vt:vector\",t(\"vt:variant\",\"<vt:lpstr>Worksheets</vt:lpstr>\")+t(\"vt:variant\",t(\"vt:i4\",String(e.Worksheets))),{size:2,baseType:\"variant\"}));r[r.length]=t(\"TitlesOfParts\",t(\"vt:vector\",e.SheetNames.map(function(e){return\"<vt:lpstr>\"+qr(e)+\"</vt:lpstr>\"}).join(\"\"),{size:e.Worksheets,baseType:\"lpstr\"}));if(r.length>2){r[r.length]=\"</Properties>\";r[1]=r[1].replace(\"/>\",\">\")}return r.join(\"\")}var wi=/<[^>]+>[^<]*/g;function ki(e,r){var t={},a=\"\";var n=e.match(wi);if(n)for(var i=0;i!=n.length;++i){var s=n[i],f=Gr(s);switch(f[0]){case\"<?xml\":break;case\"<Properties\":break;case\"<property\":a=Yr(f.name);break;case\"</property>\":a=null;break;default:if(s.indexOf(\"<vt:\")===0){var o=s.split(\">\");var l=o[0].slice(4),c=o[1];switch(l){case\"lpstr\":;case\"bstr\":;case\"lpwstr\":t[a]=Yr(c);break;case\"bool\":t[a]=nt(c);break;case\"i1\":;case\"i2\":;case\"i4\":;case\"i8\":;case\"int\":;case\"uint\":t[a]=parseInt(c,10);break;case\"r4\":;case\"r8\":;case\"decimal\":t[a]=parseFloat(c);break;case\"filetime\":;case\"date\":t[a]=gr(c);break;case\"cy\":;case\"error\":t[a]=Yr(c);break;default:if(l.slice(-1)==\"/\")break;if(r.WTF&&typeof console!==\"undefined\")console.warn(\"Unexpected\",s,l,o);}}else if(s.slice(0,2)===\"</\"){}else if(r.WTF)throw new Error(s);}}return t}function Ti(e){var r=[Mr,kt(\"Properties\",null,{xmlns:yt.CUST_PROPS,\"xmlns:vt\":yt.vt})];if(!e)return r.join(\"\");var t=1;rr(e).forEach(function a(n){++t;r[r.length]=kt(\"property\",At(e[n],true),{fmtid:\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\",pid:t,name:qr(n)})});if(r.length>2){r[r.length]=\"</Properties>\";r[1]=r[1].replace(\"/>\",\">\")}return r.join(\"\")}var Ai={Title:\"Title\",Subject:\"Subject\",Author:\"Author\",Keywords:\"Keywords\",Comments:\"Description\",LastAuthor:\"LastAuthor\",RevNumber:\"Revision\",Application:\"AppName\",LastPrinted:\"LastPrinted\",CreatedDate:\"Created\",ModifiedDate:\"LastSaved\",Category:\"Category\",Manager:\"Manager\",Company:\"Company\",AppVersion:\"Version\",ContentStatus:\"ContentStatus\",Identifier:\"Identifier\",\nLanguage:\"Language\"};var Ei;function Ci(e,r,t){if(!Ei)Ei=ar(Ai);r=Ei[r]||r;e[r]=t}function yi(e,r){var t=[];rr(Ai).map(function(e){for(var r=0;r<li.length;++r)if(li[r][1]==e)return li[r];for(r=0;r<vi.length;++r)if(vi[r][1]==e)return vi[r];throw e}).forEach(function(a){if(e[a[1]]==null)return;var n=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case\"date\":n=new Date(n).toISOString().replace(/\\.\\d*Z/,\"Z\");break;}if(typeof n==\"number\")n=String(n);else if(n===true||n===false){n=n?\"1\":\"0\"}else if(n instanceof Date)n=new Date(n).toISOString().replace(/\\.\\d*Z/,\"\");t.push(bt(Ai[a[1]]||a[1],n))});return kt(\"DocumentProperties\",t.join(\"\"),{xmlns:_t.o})}function Si(e,r){var t=[\"Worksheets\",\"SheetNames\"];var a=\"CustomDocumentProperties\";var n=[];if(e)rr(e).forEach(function(r){if(!Object.prototype.hasOwnProperty.call(e,r))return;for(var a=0;a<li.length;++a)if(r==li[a][1])return;for(a=0;a<vi.length;++a)if(r==vi[a][1])return;for(a=0;a<t.length;++a)if(r==t[a])return;var i=e[r];var s=\"string\";if(typeof i==\"number\"){s=\"float\";i=String(i)}else if(i===true||i===false){s=\"boolean\";i=i?\"1\":\"0\"}else i=String(i);n.push(kt(Zr(r),i,{\"dt:dt\":s}))});if(r)rr(r).forEach(function(t){if(!Object.prototype.hasOwnProperty.call(r,t))return;if(e&&Object.prototype.hasOwnProperty.call(e,t))return;var a=r[t];var i=\"string\";if(typeof a==\"number\"){i=\"float\";a=String(a)}else if(a===true||a===false){i=\"boolean\";a=a?\"1\":\"0\"}else if(a instanceof Date){i=\"dateTime.tz\";a=a.toISOString()}else a=String(a);n.push(kt(Zr(t),a,{\"dt:dt\":i}))});return\"<\"+a+' xmlns=\"'+_t.o+'\">'+n.join(\"\")+\"</\"+a+\">\"}function _i(e){var r=e._R(4),t=e._R(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\\.000/,\"\")}function xi(e){var r=typeof e==\"string\"?new Date(Date.parse(e)):e;var t=r.getTime()/1e3+11644473600;var a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);a*=1e7;n*=1e7;var i=a/Math.pow(2,32)|0;if(i>0){a=a%Math.pow(2,32);n+=i}var s=ua(8);s._W(4,a);s._W(4,n);return s}function Oi(e,r,t){var a=e.l;var n=e._R(0,\"lpstr-cp\");if(t)while(e.l-a&3)++e.l;return n}function Ri(e,r,t){var a=e._R(0,\"lpwstr\");if(t)e.l+=4-(a.length+1&3)&3;return a}function Ii(e,r,t){if(r===31)return Ri(e);return Oi(e,r,t)}function Ni(e,r,t){return Ii(e,r,t===false?0:4)}function Di(e,r){if(!r)throw new Error(\"VtUnalignedString must have positive length\");return Ii(e,r,0)}function Fi(e){var r=e._R(4);var t=[];for(var a=0;a!=r;++a){var n=e.l;t[a]=e._R(0,\"lpwstr\").replace(N,\"\");if(e.l-n&2)e.l+=2}return t}function Pi(e){var r=e._R(4);var t=[];for(var a=0;a!=r;++a)t[a]=e._R(0,\"lpstr-cp\").replace(N,\"\");return t}function Li(e){var r=e.l;var t=Hi(e,Pn);if(e[e.l]==0&&e[e.l+1]==0&&e.l-r&2)e.l+=2;var a=Hi(e,En);return[t,a]}function Mi(e){var r=e._R(4);var t=[];for(var a=0;a<r/2;++a)t.push(Li(e));return t}function Ui(e,r){var t=e._R(4);var a={};for(var n=0;n!=t;++n){var i=e._R(4);var s=e._R(4);a[i]=e._R(s,r===1200?\"utf16le\":\"utf8\").replace(N,\"\").replace(D,\"!\");if(r===1200&&s%2)e.l+=2}if(e.l&3)e.l=e.l>>2+1<<2;return a}function Bi(e){var r=e._R(4);var t=e.slice(e.l,e.l+r);e.l+=r;if((r&3)>0)e.l+=4-(r&3)&3;return t}function Wi(e){var r={};r.Size=e._R(4);e.l+=r.Size+3-(r.Size-1)%4;return r}function Hi(e,r,t){var a=e._R(2),n,i=t||{};e.l+=2;if(r!==yn)if(a!==r&&Ln.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error(\"Expected type \"+r+\" saw \"+a);switch(r===yn?a:r){case 2:n=e._R(2,\"i\");if(!i.raw)e.l+=2;return n;case 3:n=e._R(4,\"i\");return n;case 11:return e._R(4)!==0;case 19:n=e._R(4);return n;case 30:return Oi(e,a,4).replace(N,\"\");case 31:return Ri(e);case 64:return _i(e);case 65:return Bi(e);case 71:return Wi(e);case 80:return Ni(e,a,!i.raw).replace(N,\"\");case 81:return Di(e,a).replace(N,\"\");case 4108:return Mi(e);case 4126:;case 4127:return a==4127?Fi(e):Pi(e);default:throw new Error(\"TypedPropertyValue unrecognized type \"+r+\" \"+a);}}function zi(e,r){var t=ua(4),a=ua(4);t._W(4,e==80?31:e);switch(e){case 3:a._W(-4,r);break;case 5:a=ua(8);a._W(8,r,\"f\");break;case 11:a._W(4,r?1:0);break;case 64:a=xi(r);break;case 31:;case 80:a=ua(4+2*(r.length+1)+(r.length%2?0:2));a._W(4,r.length+1);a._W(0,r,\"dbcs\");while(a.l!=a.length)a._W(1,0);break;default:throw new Error(\"TypedPropertyValue unrecognized type \"+e+\" \"+r);}return R([t,a])}function Vi(e,r){var t=e.l;var a=e._R(4);var n=e._R(4);var i=[],s=0;var f=0;var l=-1,c={};for(s=0;s!=n;++s){var h=e._R(4);var u=e._R(4);i[s]=[h,u+t]}i.sort(function(e,r){return e[1]-r[1]});var d={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var v=true;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:if(e.l+2===i[s][1]){e.l+=2;v=false}break;case 80:if(e.l<=i[s][1]){e.l=i[s][1];v=false}break;case 4108:if(e.l<=i[s][1]){e.l=i[s][1];v=false}break;}if((!r||s==0)&&e.l<=i[s][1]){v=false;e.l=i[s][1]}if(v)throw new Error(\"Read Error: Expected address \"+i[s][1]+\" at \"+e.l+\" :\"+s)}if(r){var p=r[i[s][0]];d[p.n]=Hi(e,p.t,{raw:true});if(p.p===\"version\")d[p.n]=String(d[p.n]>>16)+\".\"+(\"0000\"+String(d[p.n]&65535)).slice(-4);if(p.n==\"CodePage\")switch(d[p.n]){case 0:d[p.n]=1252;case 874:;case 932:;case 936:;case 949:;case 950:;case 1250:;case 1251:;case 1253:;case 1254:;case 1255:;case 1256:;case 1257:;case 1258:;case 1e4:;case 1200:;case 1201:;case 1252:;case 65e3:;case-536:;case 65001:;case-535:o(f=d[p.n]>>>0&65535);break;default:throw new Error(\"Unsupported CodePage: \"+d[p.n]);}}else{if(i[s][0]===1){f=d.CodePage=Hi(e,An);o(f);if(l!==-1){var g=e.l;e.l=i[l][1];c=Ui(e,f);e.l=g}}else if(i[s][0]===0){if(f===0){l=s;e.l=i[s+1][1];continue}c=Ui(e,f)}else{var m=c[i[s][0]];var b;switch(e[e.l]){case 65:e.l+=4;b=Bi(e);break;case 30:e.l+=4;b=Ni(e,e[e.l-4]).replace(/\\u0000+$/,\"\");break;case 31:e.l+=4;b=Ni(e,e[e.l-4]).replace(/\\u0000+$/,\"\");break;case 3:e.l+=4;b=e._R(4,\"i\");break;case 19:e.l+=4;b=e._R(4);break;case 5:e.l+=4;b=e._R(8,\"f\");break;case 11:e.l+=4;b=Zi(e,4);break;case 64:e.l+=4;b=gr(_i(e));break;default:throw new Error(\"unparsed value: \"+e[e.l]);}d[m]=b}}}e.l=t+a;return d}var Gi=[\"CodePage\",\"Thumbnail\",\"_PID_LINKBASE\",\"_PID_HLINKS\",\"SystemIdentifier\",\"FMTID\"];function ji(e){switch(typeof e){case\"boolean\":return 11;case\"number\":return(e|0)==e?3:5;case\"string\":return 31;case\"object\":if(e instanceof Date)return 64;break;}return-1}function Xi(e,r,t){var a=ua(8),n=[],i=[];var s=8,f=0;var o=ua(8),l=ua(8);o._W(4,2);o._W(4,1200);l._W(4,1);i.push(o);n.push(l);s+=8+o.length;if(!r){l=ua(8);l._W(4,0);n.unshift(l);var c=[ua(4)];c[0]._W(4,e.length);for(f=0;f<e.length;++f){var h=e[f][0];o=ua(4+4+2*(h.length+1)+(h.length%2?0:2));o._W(4,f+2);o._W(4,h.length+1);o._W(0,h,\"dbcs\");while(o.l!=o.length)o._W(1,0);c.push(o)}o=R(c);i.unshift(o);s+=8+o.length}for(f=0;f<e.length;++f){if(r&&!r[e[f][0]])continue;if(Gi.indexOf(e[f][0])>-1||pi.indexOf(e[f][0])>-1)continue;if(e[f][1]==null)continue;var u=e[f][1],d=0;if(r){d=+r[e[f][0]];var v=t[d];if(v.p==\"version\"&&typeof u==\"string\"){var p=u.split(\".\");u=(+p[0]<<16)+(+p[1]||0)}o=zi(v.t,u)}else{var g=ji(u);if(g==-1){g=31;u=String(u)}o=zi(g,u)}i.push(o);l=ua(8);l._W(4,!r?2+f:d);n.push(l);s+=8+o.length}var m=8*(i.length+1);for(f=0;f<i.length;++f){n[f]._W(4,m);m+=i[f].length}a._W(4,s);a._W(4,i.length);return R([a].concat(n).concat(i))}function $i(e,r,t){var a=e.content;if(!a)return{};ca(a,0);var n,i,s,f,o=0;a.chk(\"feff\",\"Byte Order: \");a._R(2);var l=a._R(4);var c=a._R(16);if(c!==Ke.utils.consts.HEADER_CLSID&&c!==t)throw new Error(\"Bad PropertySet CLSID \"+c);n=a._R(4);if(n!==1&&n!==2)throw new Error(\"Unrecognized #Sets: \"+n);i=a._R(16);f=a._R(4);if(n===1&&f!==a.l)throw new Error(\"Length mismatch: \"+f+\" !== \"+a.l);else if(n===2){s=a._R(16);o=a._R(4)}var h=Vi(a,r);var u={SystemIdentifier:l};for(var d in h)u[d]=h[d];u.FMTID=i;if(n===1)return u;if(o-a.l==2)a.l+=2;if(a.l!==o)throw new Error(\"Length mismatch 2: \"+a.l+\" !== \"+o);var v;try{v=Vi(a,null)}catch(p){}for(d in v)u[d]=v[d];u.FMTID=[i,s];return u}function Yi(e,r,t,a,n,i){var s=ua(n?68:48);var f=[s];s._W(2,65534);s._W(2,0);s._W(4,842412599);s._W(16,Ke.utils.consts.HEADER_CLSID,\"hex\");s._W(4,n?2:1);s._W(16,r,\"hex\");s._W(4,n?68:48);var o=Xi(e,t,a);f.push(o);if(n){var l=Xi(n,null,null);s._W(16,i,\"hex\");s._W(4,68+o.length);f.push(l)}return R(f)}function Ki(e,r){e._R(r);return null}function Ji(e,r){if(!r)r=ua(e);for(var t=0;t<e;++t)r._W(1,0);return r}function qi(e,r,t){var a=[],n=e.l+r;while(e.l<n)a.push(t(e,n-e.l));if(n!==e.l)throw new Error(\"Slurp error\");return a}function Zi(e,r){return e._R(r)===1}function Qi(e,r){if(!r)r=ua(2);r._W(2,+!!e);return r}function es(e){return e._R(2,\"u\")}function rs(e,r){if(!r)r=ua(2);r._W(2,e);return r}function ts(e,r){return qi(e,r,es)}function as(e){var r=e._R(1),t=e._R(1);return t===1?r:r===1}function ns(e,r,t){if(!t)t=ua(2);t._W(1,r==\"e\"?+e:+!!e);t._W(1,r==\"e\"?1:0);return t}function is(e,t,a){var n=e._R(a&&a.biff>=12?2:1);var i=\"sbcs-cont\";var s=r;if(a&&a.biff>=8)r=1200;if(!a||a.biff==8){var f=e._R(1);if(f){i=\"dbcs-cont\"}}else if(a.biff==12){i=\"wstr\"}if(a.biff>=2&&a.biff<=5)i=\"cpstr\";var o=n?e._R(n,i):\"\";r=s;return o}function ss(e){var t=r;r=1200;var a=e._R(2),n=e._R(1);var i=n&4,s=n&8;var f=1+(n&1);var o=0,l;var c={};if(s)o=e._R(2);if(i)l=e._R(4);var h=f==2?\"dbcs-cont\":\"sbcs-cont\";var u=a===0?\"\":e._R(a,h);if(s)e.l+=4*o;if(i)e.l+=l;c.t=u;if(!s){c.raw=\"<t>\"+c.t+\"</t>\";c.r=c.t}r=t;return c}function fs(e){var r=e.t||\"\",t=1;var a=ua(3+(t>1?2:0));a._W(2,r.length);a._W(1,(t>1?8:0)|1);if(t>1)a._W(2,t);var n=ua(2*r.length);n._W(2*r.length,r,\"utf16le\");var i=[a,n];return R(i)}function os(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e._R(r,\"cpstr\");if(t.biff>=12)return e._R(r,\"dbcs-cont\")}var n=e._R(1);if(n===0){a=e._R(r,\"sbcs-cont\")}else{a=e._R(r,\"dbcs-cont\")}return a}function ls(e,r,t){var a=e._R(t&&t.biff==2?1:2);if(a===0){e.l++;return\"\"}return os(e,a,t)}function cs(e,r,t){if(t.biff>5)return ls(e,r,t);var a=e._R(1);if(a===0){e.l++;return\"\"}return e._R(a,t.biff<=4||!e.lens?\"cpstr\":\"sbcs-cont\")}function hs(e,r,t){if(!t)t=ua(3+2*e.length);t._W(2,e.length);t._W(1,1);t._W(31,e,\"utf16le\");return t}function us(e){var r=e._R(1);e.l++;var t=e._R(2);e.l+=2;return[r,t]}function ds(e){var r=e._R(4),t=e.l;var a=false;if(r>24){e.l+=r-24;if(e._R(16)===\"795881f43b1d7f48af2c825dc4852763\")a=true;e.l=t}var n=e._R((a?r-24:r)>>1,\"utf16le\").replace(N,\"\");if(a)e.l+=24;return n}function vs(e){var r=e._R(2);var t=\"\";while(r-- >0)t+=\"../\";var a=e._R(0,\"lpstr-ansi\");e.l+=2;if(e._R(2)!=57005)throw new Error(\"Bad FileMoniker\");var n=e._R(4);if(n===0)return t+a.replace(/\\\\/g,\"/\");var i=e._R(4);if(e._R(2)!=3)throw new Error(\"Bad FileMoniker\");var s=e._R(i>>1,\"utf16le\").replace(N,\"\");return t+s}function ps(e,r){var t=e._R(16);r-=16;switch(t){case\"e0c9ea79f9bace118c8200aa004ba90b\":return ds(e,r);case\"0303000000000000c000000000000046\":return vs(e,r);default:throw new Error(\"Unsupported Moniker \"+t);}}function gs(e){var r=e._R(4);var t=r>0?e._R(r,\"utf16le\").replace(N,\"\"):\"\";return t}function ms(e,r){if(!r)r=ua(6+e.length*2);r._W(4,1+e.length);for(var t=0;t<e.length;++t)r._W(2,e.charCodeAt(t));r._W(2,0);return r}function bs(e,r){var t=e.l+r;var a=e._R(4);if(a!==2)throw new Error(\"Unrecognized streamVersion: \"+a);var n=e._R(2);e.l+=2;var i,s,f,o,l=\"\",c,h;if(n&16)i=gs(e,t-e.l);if(n&128)s=gs(e,t-e.l);if((n&257)===257)f=gs(e,t-e.l);if((n&257)===1)o=ps(e,t-e.l);if(n&8)l=gs(e,t-e.l);if(n&32)c=e._R(16);if(n&64)h=_i(e);e.l=t;var u=s||f||o||\"\";if(u&&l)u+=\"#\"+l;if(!u)u=\"#\"+l;if(n&2&&u.charAt(0)==\"/\"&&u.charAt(1)!=\"/\")u=\"file://\"+u;var d={Target:u};if(c)d.guid=c;if(h)d.time=h;if(i)d.Tooltip=i;return d}function ws(e){var r=ua(512),t=0;var a=e.Target;if(a.slice(0,7)==\"file://\")a=a.slice(7);var n=a.indexOf(\"#\");var i=n>-1?31:23;switch(a.charAt(0)){case\"#\":i=28;break;case\".\":i&=~2;break;}r._W(4,2);r._W(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)r._W(4,s[t]);if(i==28){a=a.slice(1);ms(a,r)}else if(i&2){s=\"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");for(t=0;t<s.length;++t)r._W(1,parseInt(s[t],16));var f=n>-1?a.slice(0,n):a;r._W(4,2*(f.length+1));for(t=0;t<f.length;++t)r._W(2,f.charCodeAt(t));r._W(2,0);if(i&8)ms(n>-1?a.slice(n+1):\"\",r)}else{s=\"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");for(t=0;t<s.length;++t)r._W(1,parseInt(s[t],16));var o=0;while(a.slice(o*3,o*3+3)==\"../\"||a.slice(o*3,o*3+3)==\"..\\\\\")++o;r._W(2,o);r._W(4,a.length-3*o+1);for(t=0;t<a.length-3*o;++t)r._W(1,a.charCodeAt(t+3*o)&255);r._W(1,0);r._W(2,65535);r._W(2,57005);for(t=0;t<6;++t)r._W(4,0)}return r.slice(0,r.l)}function ks(e){var r=e._R(1),t=e._R(1),a=e._R(1),n=e._R(1);return[r,t,a,n]}function Ts(e,r){var t=ks(e,r);t[3]=0;return t}function As(e){var r=e._R(2);var t=e._R(2);var a=e._R(2);return{r:r,c:t,ixfe:a}}function Es(e,r,t,a){if(!a)a=ua(6);a._W(2,e);a._W(2,r);a._W(2,t||0);return a}function Cs(e){var r=e._R(2);var t=e._R(2);e.l+=8;return{type:r,flags:t}}function ys(e,r,t){return r===0?\"\":cs(e,r,t)}function Ss(e,r,t){var a=t.biff>8?4:2;var n=e._R(a),i=e._R(a,\"i\"),s=e._R(a,\"i\");return[n,i,s]}function _s(e){var r=e._R(2);var t=fn(e);return[r,t]}function xs(e,r,t){e.l+=4;r-=4;var a=e.l+r;var n=is(e,r,t);var i=e._R(2);a-=e.l;if(i!==a)throw new Error(\"Malformed AddinUdf: padding = \"+a+\" != \"+i);e.l+=i;return n}function Os(e){var r=e._R(2);var t=e._R(2);var a=e._R(2);var n=e._R(2);return{s:{c:a,r:r},e:{c:n,r:t}}}function Rs(e,r){if(!r)r=ua(8);r._W(2,e.s.r);r._W(2,e.e.r);r._W(2,e.s.c);r._W(2,e.e.c);return r}function Is(e){var r=e._R(2);var t=e._R(2);var a=e._R(1);var n=e._R(1);return{s:{c:a,r:r},e:{c:n,r:t}}}var Ns=Is;function Ds(e){e.l+=4;var r=e._R(2);var t=e._R(2);var a=e._R(2);e.l+=12;return[t,r,a]}function Fs(e){var r={};e.l+=4;e.l+=16;r.fSharedNote=e._R(2);e.l+=4;return r}function Ps(e){var r={};e.l+=4;e.cf=e._R(2);return r}function Ls(e){e.l+=2;e.l+=e._R(2)}var Ms={0:Ls,4:Ls,5:Ls,6:Ls,7:Ps,8:Ls,9:Ls,10:Ls,11:Ls,12:Ls,13:Fs,14:Ls,15:Ls,16:Ls,17:Ls,18:Ls,19:Ls,20:Ls,21:Ds};function Us(e,r){var t=e.l+r;var a=[];while(e.l<t){var n=e._R(2);e.l-=2;try{a.push(Ms[n](e,t-e.l))}catch(i){e.l=t;return a}}if(e.l!=t)e.l=t;return a}function Bs(e,r){var t={BIFFVer:0,dt:0};t.BIFFVer=e._R(2);r-=2;if(r>=2){t.dt=e._R(2);e.l-=2}switch(t.BIFFVer){case 1536:;case 1280:;case 1024:;case 768:;case 512:;case 2:;case 7:break;default:if(r>6)throw new Error(\"Unexpected BIFF Ver \"+t.BIFFVer);}e._R(r);return t}function Ws(e,r,t){var a=1536,n=16;switch(t.bookType){case\"biff8\":break;case\"biff5\":a=1280;n=8;break;case\"biff4\":a=4;n=6;break;case\"biff3\":a=3;n=6;break;case\"biff2\":a=2;n=4;break;case\"xla\":break;default:throw new Error(\"unsupported BIFF version\");}var i=ua(n);i._W(2,a);i._W(2,r);if(n>4)i._W(2,29282);if(n>6)i._W(2,1997);if(n>8){i._W(2,49161);i._W(2,1);i._W(2,1798);i._W(2,0)}return i}function Hs(e,r){if(r===0)return 1200;if(e._R(2)!==1200){}return 1200}function zs(e,r,t){if(t.enc){e.l+=r;return\"\"}var a=e.l;var n=cs(e,0,t);e._R(r+a-e.l);return n}function Vs(e,r){var t=!r||r.biff==8;var a=ua(t?112:54);a._W(r.biff==8?2:1,7);if(t)a._W(1,0);a._W(4,859007059);a._W(4,5458548|(t?0:536870912));while(a.l<a.length)a._W(1,t?0:32);return a}function Gs(e,r,t){var a=t&&t.biff==8||r==2?e._R(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function js(e,r,t){var a=e._R(4);var n=e._R(1)&3;var i=e._R(1);switch(i){case 0:i=\"Worksheet\";break;case 1:i=\"Macrosheet\";break;case 2:i=\"Chartsheet\";break;case 6:i=\"VBAModule\";break;}var s=is(e,0,t);if(s.length===0)s=\"Sheet1\";return{pos:a,hs:n,dt:i,name:s}}function Xs(e,r){var t=!r||r.biff>=8?2:1;var a=ua(8+t*e.name.length);a._W(4,e.pos);a._W(1,e.hs||0);a._W(1,e.dt);a._W(1,e.name.length);if(r.biff>=8)a._W(1,1);a._W(t*e.name.length,e.name,r.biff<8?\"sbcs\":\"utf16le\");var n=a.slice(0,a.l);n.l=a.l;return n}function $s(e,r){var t=e.l+r;var a=e._R(4);var n=e._R(4);var i=[];for(var s=0;s!=n&&e.l<t;++s){i.push(ss(e))}i.Count=a;i.Unique=n;return i}function Ys(e,r){var t=ua(8);t._W(4,e.Count);t._W(4,e.Unique);var a=[];for(var n=0;n<e.length;++n)a[n]=fs(e[n],r);var i=R([t].concat(a));i.parts=[t.length].concat(a.map(function(e){return e.length}));return i}function Ks(e,r){var t={};t.dsst=e._R(2);e.l+=r-2;return t}function Js(e){var r={};r.r=e._R(2);r.c=e._R(2);r.cnt=e._R(2)-r.c;var t=e._R(2);e.l+=4;var a=e._R(1);e.l+=3;if(a&7)r.level=a&7;if(a&32)r.hidden=true;if(a&64)r.hpt=t/20;return r}function qs(e){var r=Cs(e);if(r.type!=2211)throw new Error(\"Invalid Future Record \"+r.type);var t=e._R(4);return t!==0}function Zs(e){e._R(2);return e._R(4)}function Qs(e,r,t){var a=0;if(!(t&&t.biff==2)){a=e._R(2)}var n=e._R(2);if(t&&t.biff==2){a=1-(n>>15);n&=32767}var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function ef(e){var r=e._R(2),t=e._R(2),a=e._R(2),n=e._R(2);var i=e._R(2),s=e._R(2),f=e._R(2);var o=e._R(2),l=e._R(2);return{Pos:[r,t],Dim:[a,n],Flags:i,CurTab:s,FirstTab:f,Selected:o,TabRatio:l}}function rf(){var e=ua(18);e._W(2,0);e._W(2,0);e._W(2,29280);e._W(2,17600);e._W(2,56);e._W(2,0);e._W(2,0);e._W(2,1);e._W(2,500);return e}function tf(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e._R(2);return{RTL:a&64}}function af(e){var r=ua(18),t=1718;if(e&&e.RTL)t|=64;r._W(2,t);r._W(4,0);r._W(4,64);r._W(4,0);r._W(4,0);return r}function nf(){}function sf(e,r,t){var a={dyHeight:e._R(2),fl:e._R(2)};switch(t&&t.biff||8){case 2:break;case 3:;case 4:e.l+=2;break;default:e.l+=10;break;}a.name=is(e,0,t);return a}function ff(e,r){var t=e.name||\"Arial\";var a=r&&r.biff==5,n=a?15+t.length:16+2*t.length;var i=ua(n);i._W(2,(e.sz||12)*20);i._W(4,0);i._W(2,400);i._W(4,0);i._W(2,0);i._W(1,t.length);if(!a)i._W(1,1);i._W((a?1:2)*t.length,t,a?\"sbcs\":\"utf16le\");return i}function of(e){var r=As(e);r.isst=e._R(4);return r}function lf(e,r,t,a){var n=ua(10);Es(e,r,a,n);n._W(4,t);return n}function cf(e,r,t){if(t.biffguess&&t.biff==2)t.biff=5;var a=e.l+r;var n=As(e,6);if(t.biff==2)e.l++;var i=ls(e,a-e.l,t);n.val=i;return n}function hf(e,r,t,a,n){var i=!n||n.biff==8;var s=ua(6+2+ +i+(1+i)*t.length);Es(e,r,a,s);s._W(2,t.length);if(i)s._W(1,1);s._W((1+i)*t.length,t,i?\"utf16le\":\"sbcs\");return s}function uf(e,r,t){var a=e._R(2);var n=cs(e,0,t);return[a,n]}function df(e,r,t,a){var n=t&&t.biff==5;if(!a)a=ua(n?3+r.length:5+2*r.length);a._W(2,e);a._W(n?1:2,r.length);if(!n)a._W(1,1);a._W((n?1:2)*r.length,r,n?\"sbcs\":\"utf16le\");var i=a.length>a.l?a.slice(0,a.l):a;if(i.l==null)i.l=i.length;return i}var vf=cs;function pf(e,r,t){var a=e.l+r;var n=t.biff==8||!t.biff?4:2;var i=e._R(n),s=e._R(n);var f=e._R(2),o=e._R(2);e.l=a;return{s:{r:i,c:f},e:{r:s,c:o}}}function gf(e,r){var t=r.biff==8||!r.biff?4:2;var a=ua(2*t+6);a._W(t,e.s.r);a._W(t,e.e.r+1);a._W(2,e.s.c);a._W(2,e.e.c+1);a._W(2,0);return a}function mf(e){var r=e._R(2),t=e._R(2);var a=_s(e);return{r:r,c:t,ixfe:a[0],rknum:a[1]}}function bf(e,r){var t=e.l+r-2;var a=e._R(2),n=e._R(2);var i=[];while(e.l<t)i.push(_s(e));if(e.l!==t)throw new Error(\"MulRK read error\");var s=e._R(2);if(i.length!=s-n+1)throw new Error(\"MulRK length mismatch\");return{r:a,c:n,C:s,rkrec:i}}function wf(e,r){var t=e.l+r-2;var a=e._R(2),n=e._R(2);var i=[];while(e.l<t)i.push(e._R(2));if(e.l!==t)throw new Error(\"MulBlank read error\");var s=e._R(2);if(i.length!=s-n+1)throw new Error(\"MulBlank length mismatch\");return{r:a,c:n,C:s,ixfe:i}}function kf(e,r,t,a){var n={};var i=e._R(4),s=e._R(4);var f=e._R(4),o=e._R(2);n.patternType=Wn[f>>26];if(!a.cellStyles)return n;n.alc=i&7;n.fWrap=i>>3&1;n.alcV=i>>4&7;n.fJustLast=i>>7&1;n.trot=i>>8&255;n.cIndent=i>>16&15;n.fShrinkToFit=i>>20&1;n.iReadOrder=i>>22&2;n.fAtrNum=i>>26&1;n.fAtrFnt=i>>27&1;n.fAtrAlc=i>>28&1;n.fAtrBdr=i>>29&1;n.fAtrPat=i>>30&1;n.fAtrProt=i>>31&1;n.dgLeft=s&15;n.dgRight=s>>4&15;n.dgTop=s>>8&15;n.dgBottom=s>>12&15;n.icvLeft=s>>16&127;n.icvRight=s>>23&127;n.grbitDiag=s>>30&3;n.icvTop=f&127;n.icvBottom=f>>7&127;n.icvDiag=f>>14&127;n.dgDiag=f>>21&15;n.icvFore=o&127;n.icvBack=o>>7&127;n.fsxButton=o>>14&1;return n}function Tf(e,r,t){var a={};a.ifnt=e._R(2);a.numFmtId=e._R(2);a.flags=e._R(2);a.fStyle=a.flags>>2&1;r-=6;a.data=kf(e,r,a.fStyle,t);return a}function Af(e,r,t,a){var n=t&&t.biff==5;if(!a)a=ua(n?16:20);a._W(2,0);if(e.style){a._W(2,e.numFmtId||0);a._W(2,65524)}else{a._W(2,e.numFmtId||0);a._W(2,r<<4)}var i=0;if(e.numFmtId>0&&n)i|=1024;a._W(4,i);a._W(4,0);if(!n)a._W(4,0);a._W(2,0);return a}function Ef(e){e.l+=4;var r=[e._R(2),e._R(2)];if(r[0]!==0)r[0]--;if(r[1]!==0)r[1]--;if(r[0]>7||r[1]>7)throw new Error(\"Bad Gutters: \"+r.join(\"|\"));return r}function Cf(e){var r=ua(8);r._W(4,0);r._W(2,e[0]?e[0]+1:0);r._W(2,e[1]?e[1]+1:0);return r}function yf(e,r,t){var a=As(e,6);if(t.biff==2||r==9)++e.l;var n=as(e,2);a.val=n;a.t=n===true||n===false?\"b\":\"e\";return a}function Sf(e,r,t,a,n,i){var s=ua(8);Es(e,r,a,s);ns(t,i,s);return s}function _f(e,r,t){if(t.biffguess&&t.biff==2)t.biff=5;var a=As(e,6);var n=dn(e,8);a.val=n;return a}function xf(e,r,t,a){var n=ua(14);Es(e,r,a,n);vn(t,n);return n}var Of=ys;function Rf(e,r,t){var a=e.l+r;var n=e._R(2);var i=e._R(2);t.sbcch=i;if(i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error(\"Unexpected SupBook type: \"+i);var s=os(e,i);var f=[];while(a>e.l)f.push(ls(e));return[i,n,s,f]}function If(e,r,t){var a=e._R(2);var n;var i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};if(t.sbcch===14849)n=xs(e,r-2,t);i.body=n||e._R(r-2);if(typeof n===\"string\")i.Name=n;return i}var Nf=[\"_xlnm.Consolidate_Area\",\"_xlnm.Auto_Open\",\"_xlnm.Auto_Close\",\"_xlnm.Extract\",\"_xlnm.Database\",\"_xlnm.Criteria\",\"_xlnm.Print_Area\",\"_xlnm.Print_Titles\",\"_xlnm.Recorder\",\"_xlnm.Data_Form\",\"_xlnm.Auto_Activate\",\"_xlnm.Auto_Deactivate\",\"_xlnm.Sheet_Title\",\"_xlnm._FilterDatabase\"];function Df(e,r,t){var a=e.l+r;var n=e._R(2);var i=e._R(1);var s=e._R(1);var f=e._R(t&&t.biff==2?1:2);var o=0;if(!t||t.biff>=5){if(t.biff!=5)e.l+=2;o=e._R(2);if(t.biff==5)e.l+=2;e.l+=4}var l=os(e,s,t);if(n&32)l=Nf[l.charCodeAt(0)];var c=a-e.l;if(t&&t.biff==2)--c;var h=a==e.l||f===0||!(c>0)?[]:cd(e,c,t,f);return{chKey:i,Name:l,itab:o,rgce:h}}function Ff(e,r,t){if(t.biff<8)return Pf(e,r,t);var a=[],n=e.l+r,i=e._R(t.biff>8?4:2);while(i--!==0)a.push(Ss(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error(\"Bad ExternSheet: \"+e.l+\" != \"+n);return a}function Pf(e,r,t){if(e[e.l+1]==3)e[e.l]++;var a=is(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function Lf(e,r,t){if(t.biff<8){e.l+=r;return}var a=e._R(2);var n=e._R(2);var i=os(e,a,t);var s=os(e,n,t);return[i,s]}function Mf(e,r,t){var a=Is(e,6);e.l++;var n=e._R(1);r-=8;return[hd(e,r,t),n,a]}function Uf(e,r,t){var a=Ns(e,6);switch(t.biff){case 2:e.l++;r-=7;break;case 3:;case 4:e.l+=2;r-=8;break;default:e.l+=6;r-=12;}return[a,od(e,r,t,a)]}function Bf(e){var r=e._R(4)!==0;var t=e._R(4)!==0;var a=e._R(4);return[r,t,a]}function Wf(e,r,t){if(t.biff<8)return;var a=e._R(2),n=e._R(2);var i=e._R(2),s=e._R(2);var f=cs(e,0,t);if(t.biff<8)e._R(1);return[{r:a,c:n},f,s,i]}function Hf(e,r,t){return Wf(e,r,t)}function zf(e,r){var t=[];var a=e._R(2);while(a--)t.push(Os(e,r));return t}function Vf(e){var r=ua(2+e.length*8);r._W(2,e.length);for(var t=0;t<e.length;++t)Rs(e[t],r);return r}function Gf(e,r,t){if(t&&t.biff<8)return Xf(e,r,t);var a=Ds(e,22);var n=Us(e,r-22,a[1]);return{cmo:a,ft:n}}var jf={8:function(e,r){var t=e.l+r;e.l+=10;var a=e._R(2);e.l+=4;e.l+=2;e.l+=2;e.l+=2;e.l+=4;var n=e._R(1);e.l+=n;e.l=t;return{fmt:a}}};function Xf(e,r,t){e.l+=4;var a=e._R(2);var n=e._R(2);var i=e._R(2);e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=2;e.l+=6;r-=36;var s=[];s.push((jf[a]||ha)(e,r,t));return{cmo:[n,a,i],ft:s}}function $f(e,r,t){var a=e.l;var n=\"\";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1];var s;if([0,5,7,11,12,14].indexOf(i)==-1)e.l+=6;else s=us(e,6,t);var f=e._R(2);e._R(2);es(e,2);var o=e._R(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error(\"TxO: bad continue record\");var c=e[e.l];var h=os(e,e.lens[l+1]-e.lens[l]-1);n+=h;if(n.length>=(c?f:2*f))break}if(n.length!==f&&n.length!==f*2){throw new Error(\"cchText: \"+f+\" != \"+n.length)}e.l=a+r;return{t:n}}catch(u){e.l=a+r;return{t:n}}}function Yf(e,r){var t=Os(e,8);e.l+=16;var a=bs(e,r-24);return[t,a]}function Kf(e){var r=ua(24);var t=Oa(e[0]);r._W(2,t.r);r._W(2,t.r);r._W(2,t.c);r._W(2,t.c);var a=\"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");for(var n=0;n<16;++n)r._W(1,parseInt(a[n],16));return R([r,ws(e[1])])}function Jf(e,r){e._R(2);var t=Os(e,8);var a=e._R((r-10)/2,\"dbcs-cont\");a=a.replace(N,\"\");return[t,a]}function qf(e){var r=e[1].Tooltip;var t=ua(10+2*(r.length+1));t._W(2,2048);var a=Oa(e[0]);t._W(2,a.r);t._W(2,a.r);t._W(2,a.c);t._W(2,a.c);for(var n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));t._W(2,0);return t}function Zf(e){var r=[0,0],t;t=e._R(2);r[0]=Bn[t]||t;t=e._R(2);r[1]=Bn[t]||t;return r}function Qf(e){if(!e)e=ua(4);e._W(2,1);e._W(2,1);return e}function eo(e){var r=e._R(2);var t=[];while(r-- >0)t.push(Ts(e,8));return t}function ro(e){var r=e._R(2);var t=[];while(r-- >0)t.push(Ts(e,8));return t}function to(e){e.l+=2;var r={cxfs:0,crc:0};r.cxfs=e._R(2);r.crc=e._R(4);return r}function ao(e,r,t){if(!t.cellStyles)return ha(e,r);var a=t&&t.biff>=12?4:2;var n=e._R(a);var i=e._R(a);var s=e._R(a);var f=e._R(a);var o=e._R(2);if(a==2)e.l+=2;var l={s:n,e:i,w:s,ixfe:f,flags:o};if(t.biff>=5||!t.biff)l.level=o>>8&7;return l}function no(e,r){var t=ua(12);t._W(2,r);t._W(2,r);t._W(2,e.width*256);t._W(2,0);var a=0;if(e.hidden)a|=1;t._W(1,a);a=e.level||0;t._W(1,a);t._W(2,0);return t}function io(e,r){var t={};if(r<32)return t;e.l+=16;t.header=dn(e,8);t.footer=dn(e,8);e.l+=2;return t}function so(e,r,t){var a={area:false};if(t.biff!=5){e.l+=r;return a}var n=e._R(1);e.l+=3;if(n&16)a.area=true;return a}function fo(e){var r=ua(2*e);for(var t=0;t<e;++t)r._W(2,t+1);return r}var oo=As;var lo=ts;var co=ls;function ho(e){var r=e._R(2);var t=e._R(2);var a=e._R(4);var n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};e.l+=a;return n}function uo(e,r,t){if(t.biffguess&&t.biff==5)t.biff=2;var a=As(e,6);++e.l;var n=cs(e,r-7,t);a.t=\"str\";a.val=n;return a}function vo(e){var r=As(e,6);++e.l;var t=dn(e,8);r.t=\"n\";r.val=t;return r}function po(e,r,t){var a=ua(15);km(a,e,r);a._W(8,t,\"f\");return a}function go(e){var r=As(e,6);++e.l;var t=e._R(2);r.t=\"n\";r.val=t;return r}function mo(e,r,t){var a=ua(9);km(a,e,r);a._W(2,t);return a}function bo(e){var r=e._R(1);if(r===0){e.l++;return\"\"}return e._R(r,\"sbcs-cont\")}function wo(e,r){e.l+=6;e.l+=2;e.l+=1;e.l+=3;e.l+=1;e.l+=r-13}function ko(e,r,t){var a=e.l+r;var n=As(e,6);var i=e._R(2);var s=os(e,i,t);e.l=a;n.t=\"str\";n.val=s;return n}var To=[2,3,48,49,131,139,140,245];var Ao=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969};var r=ar({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(r,t){var n=[];var i=E(1);switch(t.type){case\"base64\":i=y(k(r));break;case\"binary\":i=y(r);break;case\"buffer\":;case\"array\":i=r;break;}ca(i,0);var s=i._R(1);var f=!!(s&136);var o=false,l=false;switch(s){case 2:break;case 3:break;case 48:o=true;f=true;break;case 49:o=true;f=true;break;case 131:break;case 139:break;case 140:l=true;break;case 245:break;default:throw new Error(\"DBF Unsupported Version: \"+s.toString(16));}var c=0,h=521;if(s==2)c=i._R(2);i.l+=3;if(s!=2)c=i._R(4);if(c>1048576)c=1e6;if(s!=2)h=i._R(2);var u=i._R(2);var d=t.codepage||1252;if(s!=2){i.l+=16;i._R(1);if(i[i.l]!==0)d=e[i[i.l]];i.l+=1;i.l+=2}if(l)i.l+=36;var v=[],p={};var g=Math.min(i.length,s==2?521:h-10-(o?264:0));var m=l?32:11;while(i.l<g&&i[i.l]!=13){p={};p.name=a.utils.decode(d,i.slice(i.l,i.l+m)).replace(/[\\u0000\\r\\n].*$/g,\"\");i.l+=m;p.type=String.fromCharCode(i._R(1));if(s!=2&&!l)p.offset=i._R(4);p.len=i._R(1);if(s==2)p.offset=i._R(2);p.dec=i._R(1);if(p.name.length)v.push(p);if(s!=2)i.l+=l?13:14;switch(p.type){case\"B\":if((!o||p.len!=8)&&t.WTF)console.log(\"Skipping \"+p.name+\":\"+p.type);break;case\"G\":;case\"P\":if(t.WTF)console.log(\"Skipping \"+p.name+\":\"+p.type);break;case\"+\":;case\"0\":;case\"@\":;case\"C\":;case\"D\":;case\"F\":;case\"I\":;case\"L\":;case\"M\":;case\"N\":;case\"O\":;case\"T\":;case\"Y\":break;default:throw new Error(\"Unknown Field Type: \"+p.type);}}if(i[i.l]!==13)i.l=h-1;if(i._R(1)!==13)throw new Error(\"DBF Terminator not found \"+i.l+\" \"+i[i.l]);i.l=h;var b=0,w=0;n[0]=[];for(w=0;w!=v.length;++w)n[0][w]=v[w].name;while(c-- >0){if(i[i.l]===42){i.l+=u;continue}++i.l;n[++b]=[];w=0;for(w=0;w!=v.length;++w){var T=i.slice(i.l,i.l+v[w].len);i.l+=v[w].len;ca(T,0);var A=a.utils.decode(d,T);switch(v[w].type){case\"C\":if(A.trim().length)n[b][w]=A.replace(/\\s+$/,\"\");\nbreak;case\"D\":if(A.length===8)n[b][w]=new Date(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8));else n[b][w]=A;break;case\"F\":n[b][w]=parseFloat(A.trim());break;case\"+\":;case\"I\":n[b][w]=l?T._R(-4,\"i\")^2147483648:T._R(4,\"i\");break;case\"L\":switch(A.trim().toUpperCase()){case\"Y\":;case\"T\":n[b][w]=true;break;case\"N\":;case\"F\":n[b][w]=false;break;case\"\":;case\"?\":break;default:throw new Error(\"DBF Unrecognized L:|\"+A+\"|\");}break;case\"M\":if(!f)throw new Error(\"DBF Unexpected MEMO for type \"+s.toString(16));n[b][w]=\"##MEMO##\"+(l?parseInt(A.trim(),10):T._R(4));break;case\"N\":A=A.replace(/\\u0000/g,\"\").trim();if(A&&A!=\".\")n[b][w]=+A||0;break;case\"@\":n[b][w]=new Date(T._R(-8,\"f\")-621356832e5);break;case\"T\":n[b][w]=new Date((T._R(4)-2440588)*864e5+T._R(4));break;case\"Y\":n[b][w]=T._R(4,\"i\")/1e4+T._R(4,\"i\")/1e4*Math.pow(2,32);break;case\"O\":n[b][w]=-T._R(-8,\"f\");break;case\"B\":if(o&&v[w].len==8){n[b][w]=T._R(8,\"f\");break};case\"G\":;case\"P\":T.l+=v[w].len;break;case\"0\":if(v[w].name===\"_NullFlags\")break;default:throw new Error(\"DBF Unsupported data type \"+v[w].type);}}}if(s!=2)if(i.l<i.length&&i[i.l++]!=26)throw new Error(\"DBF EOF Marker missing \"+(i.l-1)+\" of \"+i.length+\" \"+i[i.l-1].toString(16));if(t&&t.sheetRows)n=n.slice(0,t.sheetRows);t.DBF=v;return n}function i(e,r){var t=r||{};if(!t.dateNF)t.dateNF=\"yyyymmdd\";var a=Ua(n(e,t),t);a[\"!cols\"]=t.DBF.map(function(e){return{wch:e.len,DBF:e}});delete t.DBF;return a}function s(e,r){try{return La(i(e,r),r)}catch(t){if(r&&r.WTF)throw t}return{SheetNames:[],Sheets:{}}}var f={B:8,C:250,L:1,D:8,\"?\":0,\"\":0};function l(e,a){var n=a||{};if(+n.codepage>=0)o(+n.codepage);if(n.type==\"string\")throw new Error(\"Cannot write DBF to JS string\");var i=va();var s=Aw(e,{header:1,raw:true,cellDates:true});var l=s[0],c=s.slice(1),h=e[\"!cols\"]||[];var u=0,d=0,v=0,p=1;for(u=0;u<l.length;++u){if(((h[u]||{}).DBF||{}).name){l[u]=h[u].DBF.name;++v;continue}if(l[u]==null)continue;++v;if(typeof l[u]===\"number\")l[u]=l[u].toString(10);if(typeof l[u]!==\"string\")throw new Error(\"DBF Invalid column name \"+l[u]+\" |\"+typeof l[u]+\"|\");if(l.indexOf(l[u])!==u)for(d=0;d<1024;++d)if(l.indexOf(l[u]+\"_\"+d)==-1){l[u]+=\"_\"+d;break}}var g=Da(e[\"!ref\"]);var m=[];var b=[];var w=[];for(u=0;u<=g.e.c-g.s.c;++u){var k=\"\",T=\"\",A=0;var E=[];for(d=0;d<c.length;++d){if(c[d][u]!=null)E.push(c[d][u])}if(E.length==0||l[u]==null){m[u]=\"?\";continue}for(d=0;d<E.length;++d){switch(typeof E[d]){case\"number\":T=\"B\";break;case\"string\":T=\"C\";break;case\"boolean\":T=\"L\";break;case\"object\":T=E[d]instanceof Date?\"D\":\"C\";break;default:T=\"C\";}A=Math.max(A,String(E[d]).length);k=k&&k!=T?\"C\":T}if(A>250)A=250;T=((h[u]||{}).DBF||{}).type;if(T==\"C\"){if(h[u].DBF.len>A)A=h[u].DBF.len}if(k==\"B\"&&T==\"N\"){k=\"N\";w[u]=h[u].DBF.dec;A=h[u].DBF.len}b[u]=k==\"C\"||T==\"N\"?A:f[k]||0;p+=b[u];m[u]=k}var C=i.next(32);C._W(4,318902576);C._W(4,c.length);C._W(2,296+32*v);C._W(2,p);for(u=0;u<4;++u)C._W(4,0);C._W(4,0|(+r[t]||3)<<8);for(u=0,d=0;u<l.length;++u){if(l[u]==null)continue;var y=i.next(32);var S=(l[u].slice(-10)+\"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\").slice(0,11);y._W(1,S,\"sbcs\");y._W(1,m[u]==\"?\"?\"C\":m[u],\"sbcs\");y._W(4,d);y._W(1,b[u]||f[m[u]]||0);y._W(1,w[u]||0);y._W(1,2);y._W(4,0);y._W(1,0);y._W(4,0);y._W(4,0);d+=b[u]||f[m[u]]||0}var _=i.next(264);_._W(4,13);for(u=0;u<65;++u)_._W(4,0);for(u=0;u<c.length;++u){var x=i.next(p);x._W(1,0);for(d=0;d<l.length;++d){if(l[d]==null)continue;switch(m[d]){case\"L\":x._W(1,c[u][d]==null?63:c[u][d]?84:70);break;case\"B\":x._W(8,c[u][d]||0,\"f\");break;case\"N\":var O=\"0\";if(typeof c[u][d]==\"number\")O=c[u][d].toFixed(w[d]||0);for(v=0;v<b[d]-O.length;++v)x._W(1,32);x._W(1,O,\"sbcs\");break;case\"D\":if(!c[u][d])x._W(8,\"00000000\",\"sbcs\");else{x._W(4,(\"0000\"+c[u][d].getFullYear()).slice(-4),\"sbcs\");x._W(2,(\"00\"+(c[u][d].getMonth()+1)).slice(-2),\"sbcs\");x._W(2,(\"00\"+c[u][d].getDate()).slice(-2),\"sbcs\")}break;case\"C\":var R=String(c[u][d]!=null?c[u][d]:\"\").slice(0,b[d]);x._W(1,R,\"sbcs\");for(v=0;v<b[d]-R.length;++v)x._W(1,32);break;}}}i.next(1)._W(1,26);return i.end()}return{to_workbook:s,to_sheet:i,from_sheet:l}}();var Eo=function(){var e={AA:\"\",BA:\"\",CA:\"\",DA:195,HA:\"\",JA:197,AE:\"\",BE:\"\",CE:\"\",HE:\"\",AI:\"\",BI:\"\",CI:\"\",HI:\"\",AO:\"\",BO:\"\",CO:\"\",DO:213,HO:\"\",AU:\"\",BU:\"\",CU:\"\",HU:\"\",Aa:\"\",Ba:\"\",Ca:\"\",Da:227,Ha:\"\",Ja:229,Ae:\"\",Be:\"\",Ce:\"\",He:\"\",Ai:\"\",Bi:\"\",Ci:\"\",Hi:\"\",Ao:\"\",Bo:\"\",Co:\"\",Do:245,Ho:\"\",Au:\"\",Bu:\"\",Cu:\"\",Hu:\"\",KC:\"\",Kc:\"\",q:\"\",z:\"\",a:\"\",j:\"\",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,\"B \":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,\"!\":161,'\"':162,\"#\":163,\"(\":164,\"%\":165,\"'\":167,\"H \":168,\"+\":171,\";\":187,\"<\":188,\"=\":189,\">\":190,\"?\":191,\"{\":223};var r=new RegExp(\"\u001bN(\"+rr(e).join(\"|\").replace(/\\|\\|\\|/,\"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\")+\"|\\\\|)\",\"gm\");var t=function(r,t){var a=e[t];return typeof a==\"number\"?p(a):a};var n=function(e,r,t){var a=r.charCodeAt(0)-32<<4|t.charCodeAt(0)-48;return a==59?e:p(a)};e[\"|\"]=254;function i(e,r){switch(r.type){case\"base64\":return s(k(e),r);case\"binary\":return s(e,r);case\"buffer\":return s(T&&Buffer.isBuffer(e)?e.toString(\"binary\"):_(e),r);case\"array\":return s(mr(e),r);}throw new Error(\"Unrecognized type \"+r.type)}function s(e,i){var s=e.split(/[\\n\\r]+/),f=-1,l=-1,c=0,h=0,u=[];var d=[];var v=null;var p={},g=[],m=[],b=[];var w=0,k;if(+i.codepage>=0)o(+i.codepage);for(;c!==s.length;++c){w=0;var T=s[c].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g,n).replace(r,t);var A=T.replace(/;;/g,\"\\0\").split(\";\").map(function(e){return e.replace(/\\u0000/g,\";\")});var E=A[0],C;if(T.length>0)switch(E){case\"ID\":break;case\"E\":break;case\"B\":break;case\"O\":break;case\"W\":break;case\"P\":if(A[1].charAt(0)==\"P\")d.push(T.slice(3).replace(/;;/g,\";\"));break;case\"C\":var y=false,S=false,_=false,x=false,O=-1,R=-1;for(h=1;h<A.length;++h)switch(A[h].charAt(0)){case\"A\":break;case\"X\":l=parseInt(A[h].slice(1))-1;S=true;break;case\"Y\":f=parseInt(A[h].slice(1))-1;if(!S)l=0;for(k=u.length;k<=f;++k)u[k]=[];break;case\"K\":C=A[h].slice(1);if(C.charAt(0)==='\"')C=C.slice(1,C.length-1);else if(C===\"TRUE\")C=true;else if(C===\"FALSE\")C=false;else if(!isNaN(kr(C))){C=kr(C);if(v!==null&&Fe(v))C=hr(C)}else if(!isNaN(Ar(C).getDate())){C=gr(C)}if(typeof a!==\"undefined\"&&typeof C==\"string\"&&(i||{}).type!=\"string\"&&(i||{}).codepage)C=a.utils.decode(i.codepage,C);y=true;break;case\"E\":x=true;var I=Sh(A[h].slice(1),{r:f,c:l});u[f][l]=[u[f][l],I];break;case\"S\":_=true;u[f][l]=[u[f][l],\"S5S\"];break;case\"G\":break;case\"R\":O=parseInt(A[h].slice(1))-1;break;case\"C\":R=parseInt(A[h].slice(1))-1;break;default:if(i&&i.WTF)throw new Error(\"SYLK bad record \"+T);}if(y){if(u[f][l]&&u[f][l].length==2)u[f][l][0]=C;else u[f][l]=C;v=null}if(_){if(x)throw new Error(\"SYLK shared formula cannot have own formula\");var N=O>-1&&u[O][R];if(!N||!N[1])throw new Error(\"SYLK shared formula cannot find base\");u[f][l][1]=Oh(N[1],{r:f-O,c:l-R})}break;case\"F\":var D=0;for(h=1;h<A.length;++h)switch(A[h].charAt(0)){case\"X\":l=parseInt(A[h].slice(1))-1;++D;break;case\"Y\":f=parseInt(A[h].slice(1))-1;for(k=u.length;k<=f;++k)u[k]=[];break;case\"M\":w=parseInt(A[h].slice(1))/20;break;case\"F\":break;case\"G\":break;case\"P\":v=d[parseInt(A[h].slice(1))];break;case\"S\":break;case\"D\":break;case\"N\":break;case\"W\":b=A[h].slice(1).split(\" \");for(k=parseInt(b[0],10);k<=parseInt(b[1],10);++k){w=parseInt(b[2],10);m[k-1]=w===0?{hidden:true}:{wch:w};Il(m[k-1])}break;case\"C\":l=parseInt(A[h].slice(1))-1;if(!m[l])m[l]={};break;case\"R\":f=parseInt(A[h].slice(1))-1;if(!g[f])g[f]={};if(w>0){g[f].hpt=w;g[f].hpx=Pl(w)}else if(w===0)g[f].hidden=true;break;default:if(i&&i.WTF)throw new Error(\"SYLK bad record \"+T);}if(D<1)v=null;break;default:if(i&&i.WTF)throw new Error(\"SYLK bad record \"+T);}}if(g.length>0)p[\"!rows\"]=g;if(m.length>0)p[\"!cols\"]=m;if(i&&i.sheetRows)u=u.slice(0,i.sheetRows);return[u,p]}function f(e,r){var t=i(e,r);var a=t[0],n=t[1];var s=Ua(a,r);rr(n).forEach(function(e){s[e]=n[e]});return s}function l(e,r){return La(f(e,r),r)}function c(e,r,t,a){var n=\"C;Y\"+(t+1)+\";X\"+(a+1)+\";K\";switch(e.t){case\"n\":n+=e.v||0;if(e.f&&!e.F)n+=\";E\"+xh(e.f,{r:t,c:a});break;case\"b\":n+=e.v?\"TRUE\":\"FALSE\";break;case\"e\":n+=e.w||e.v;break;case\"d\":n+='\"'+(e.w||e.v)+'\"';break;case\"s\":n+='\"'+e.v.replace(/\"/g,\"\").replace(/;/g,\";;\")+'\"';break;}return n}function h(e,r){r.forEach(function(r,t){var a=\"F;W\"+(t+1)+\" \"+(t+1)+\" \";if(r.hidden)a+=\"0\";else{if(typeof r.width==\"number\"&&!r.wpx)r.wpx=Sl(r.width);if(typeof r.wpx==\"number\"&&!r.wch)r.wch=_l(r.wpx);if(typeof r.wch==\"number\")a+=Math.round(r.wch)}if(a.charAt(a.length-1)!=\" \")e.push(a)})}function u(e,r){r.forEach(function(r,t){var a=\"F;\";if(r.hidden)a+=\"M0;\";else if(r.hpt)a+=\"M\"+20*r.hpt+\";\";else if(r.hpx)a+=\"M\"+20*Fl(r.hpx)+\";\";if(a.length>2)e.push(a+\"R\"+(t+1))})}function d(e,r){var t=[\"ID;PWXL;N;E\"],a=[];var n=Da(e[\"!ref\"]),i;var s=Array.isArray(e);var f=\"\\r\\n\";t.push(\"P;PGeneral\");t.push(\"F;P0;DG0G8;M255\");if(e[\"!cols\"])h(t,e[\"!cols\"]);if(e[\"!rows\"])u(t,e[\"!rows\"]);t.push(\"B;Y\"+(n.e.r-n.s.r+1)+\";X\"+(n.e.c-n.s.c+1)+\";D\"+[n.s.c,n.s.r,n.e.c,n.e.r].join(\" \"));for(var o=n.s.r;o<=n.e.r;++o){for(var l=n.s.c;l<=n.e.c;++l){var d=Ra({r:o,c:l});i=s?(e[o]||[])[l]:e[d];if(!i||i.v==null&&(!i.f||i.F))continue;a.push(c(i,e,o,l,r))}}return t.join(f)+f+a.join(f)+f+\"E\"+f}return{to_workbook:l,to_sheet:f,from_sheet:d}}();var Co=function(){function e(e,t){switch(t.type){case\"base64\":return r(k(e),t);case\"binary\":return r(e,t);case\"buffer\":return r(T&&Buffer.isBuffer(e)?e.toString(\"binary\"):_(e),t);case\"array\":return r(mr(e),t);}throw new Error(\"Unrecognized type \"+t.type)}function r(e,r){var t=e.split(\"\\n\"),a=-1,n=-1,i=0,s=[];for(;i!==t.length;++i){if(t[i].trim()===\"BOT\"){s[++a]=[];n=0;continue}if(a<0)continue;var f=t[i].trim().split(\",\");var o=f[0],l=f[1];++i;var c=t[i]||\"\";while((c.match(/[\"]/g)||[]).length&1&&i<t.length-1)c+=\"\\n\"+t[++i];c=c.trim();switch(+o){case-1:if(c===\"BOT\"){s[++a]=[];n=0;continue}else if(c!==\"EOD\")throw new Error(\"Unrecognized DIF special command \"+c);break;case 0:if(c===\"TRUE\")s[a][n]=true;else if(c===\"FALSE\")s[a][n]=false;else if(!isNaN(kr(l)))s[a][n]=kr(l);else if(!isNaN(Ar(l).getDate()))s[a][n]=gr(l);else s[a][n]=l;++n;break;case 1:c=c.slice(1,c.length-1);c=c.replace(/\"\"/g,'\"');if(m&&c&&c.match(/^=\".*\"$/))c=c.slice(2,-1);s[a][n++]=c!==\"\"?c:null;break;}if(c===\"EOD\")break}if(r&&r.sheetRows)s=s.slice(0,r.sheetRows);return s}function t(r,t){return Ua(e(r,t),t)}function a(e,r){return La(t(e,r),r)}var n=function(){var e=function t(e,r,a,n,i){e.push(r);e.push(a+\",\"+n);e.push('\"'+i.replace(/\"/g,'\"\"')+'\"')};var r=function a(e,r,t,n){e.push(r+\",\"+t);e.push(r==1?'\"'+n.replace(/\"/g,'\"\"')+'\"':n)};return function n(t){var a=[];var n=Da(t[\"!ref\"]),i;var s=Array.isArray(t);e(a,\"TABLE\",0,1,\"sheetjs\");e(a,\"VECTORS\",0,n.e.r-n.s.r+1,\"\");e(a,\"TUPLES\",0,n.e.c-n.s.c+1,\"\");e(a,\"DATA\",0,0,\"\");for(var f=n.s.r;f<=n.e.r;++f){r(a,-1,0,\"BOT\");for(var o=n.s.c;o<=n.e.c;++o){var l=Ra({r:f,c:o});i=s?(t[f]||[])[o]:t[l];if(!i){r(a,1,0,\"\");continue}switch(i.t){case\"n\":var c=m?i.w:i.v;if(!c&&i.v!=null)c=i.v;if(c==null){if(m&&i.f&&!i.F)r(a,1,0,\"=\"+i.f);else r(a,1,0,\"\")}else r(a,0,c,\"V\");break;case\"b\":r(a,0,i.v?1:0,i.v?\"TRUE\":\"FALSE\");break;case\"s\":r(a,1,0,!m||isNaN(i.v)?i.v:'=\"'+i.v+'\"');break;case\"d\":if(!i.w)i.w=Be(i.z||X[14],fr(gr(i.v)));if(m)r(a,0,i.w,\"V\");else r(a,1,0,i.w);break;default:r(a,1,0,\"\");}}}r(a,-1,0,\"EOD\");var h=\"\\r\\n\";var u=a.join(h);return u}}();return{to_workbook:a,to_sheet:t,from_sheet:n}}();var yo=function(){function e(e){return e.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\")}function r(e){return e.replace(/\\\\/g,\"\\\\b\").replace(/:/g,\"\\\\c\").replace(/\\n/g,\"\\\\n\")}function t(r,t){var a=r.split(\"\\n\"),n=-1,i=-1,s=0,f=[];for(;s!==a.length;++s){var o=a[s].trim().split(\":\");if(o[0]!==\"cell\")continue;var l=Oa(o[1]);if(f.length<=l.r)for(n=f.length;n<=l.r;++n)if(!f[n])f[n]=[];n=l.r;i=l.c;switch(o[2]){case\"t\":f[n][i]=e(o[3]);break;case\"v\":f[n][i]=+o[3];break;case\"vtf\":var c=o[o.length-1];case\"vtc\":switch(o[3]){case\"nl\":f[n][i]=+o[4]?true:false;break;default:f[n][i]=+o[4];break;}if(o[2]==\"vtf\")f[n][i]=[f[n][i],c];}}if(t&&t.sheetRows)f=f.slice(0,t.sheetRows);return f}function a(e,r){return Ua(t(e,r),r)}function n(e,r){return La(a(e,r),r)}var i=[\"socialcalc:version:1.5\",\"MIME-Version: 1.0\",\"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"].join(\"\\n\");var s=[\"--SocialCalcSpreadsheetControlSave\",\"Content-type: text/plain; charset=UTF-8\"].join(\"\\n\")+\"\\n\";var f=[\"# SocialCalc Spreadsheet Control Save\",\"part:sheet\"].join(\"\\n\");var o=\"--SocialCalcSpreadsheetControlSave--\";function l(e){if(!e||!e[\"!ref\"])return\"\";var t=[],a=[],n,i=\"\";var s=Ia(e[\"!ref\"]);var f=Array.isArray(e);for(var o=s.s.r;o<=s.e.r;++o){for(var l=s.s.c;l<=s.e.c;++l){i=Ra({r:o,c:l});n=f?(e[o]||[])[l]:e[i];if(!n||n.v==null||n.t===\"z\")continue;a=[\"cell\",i,\"t\"];switch(n.t){case\"s\":;case\"str\":a.push(r(n.v));break;case\"n\":if(!n.f){a[2]=\"v\";a[3]=n.v}else{a[2]=\"vtf\";a[3]=\"n\";a[4]=n.v;a[5]=r(n.f)}break;case\"b\":a[2]=\"vt\"+(n.f?\"f\":\"c\");a[3]=\"nl\";a[4]=n.v?\"1\":\"0\";a[5]=r(n.f||(n.v?\"TRUE\":\"FALSE\"));break;case\"d\":var c=fr(gr(n.v));a[2]=\"vtc\";a[3]=\"nd\";a[4]=\"\"+c;a[5]=n.w||Be(n.z||X[14],c);break;case\"e\":continue;}t.push(a.join(\":\"))}}t.push(\"sheet:c:\"+(s.e.c-s.s.c+1)+\":r:\"+(s.e.r-s.s.r+1)+\":tvf:1\");t.push(\"valueformat:1:text-wiki\");return t.join(\"\\n\")}function c(e){return[i,s,f,s,l(e),o].join(\"\\n\")}return{to_workbook:n,to_sheet:a,from_sheet:c}}();var So=function(){function e(e,r,t,a,n){if(n.raw)r[t][a]=e;else if(e===\"\"){}else if(e===\"TRUE\")r[t][a]=true;else if(e===\"FALSE\")r[t][a]=false;else if(!isNaN(kr(e)))r[t][a]=kr(e);else if(!isNaN(Ar(e).getDate()))r[t][a]=gr(e);else r[t][a]=e}function r(r,t){var a=t||{};var n=[];if(!r||r.length===0)return n;var i=r.split(/[\\r\\n]/);var s=i.length-1;while(s>=0&&i[s].length===0)--s;var f=10,o=0;var l=0;for(;l<=s;++l){o=i[l].indexOf(\" \");if(o==-1)o=i[l].length;else o++;f=Math.max(f,o)}for(l=0;l<=s;++l){n[l]=[];var c=0;e(i[l].slice(0,f).trim(),n,l,c,a);for(c=1;c<=(i[l].length-f)/10+1;++c)e(i[l].slice(f+(c-1)*10,f+c*10).trim(),n,l,c,a)}if(a.sheetRows)n=n.slice(0,a.sheetRows);return n}var t={44:\",\",9:\"\\t\",59:\";\",124:\"|\"};var n={44:3,9:2,59:1,124:0};function i(e){var r={},a=false,i=0,s=0;for(;i<e.length;++i){if((s=e.charCodeAt(i))==34)a=!a;else if(!a&&s in t)r[s]=(r[s]||0)+1}s=[];for(i in r)if(Object.prototype.hasOwnProperty.call(r,i)){s.push([r[i],i])}if(!s.length){r=n;for(i in r)if(Object.prototype.hasOwnProperty.call(r,i)){s.push([r[i],i])}}s.sort(function(e,r){return e[0]-r[0]||n[e[1]]-n[r[1]]});return t[s.pop()[1]]||44}function s(e,r){var t=r||{};var a=\"\";if(g!=null&&t.dense==null)t.dense=g;var n=t.dense?[]:{};var s={s:{c:0,r:0},e:{c:0,r:0}};if(e.slice(0,4)==\"sep=\"){if(e.charCodeAt(5)==13&&e.charCodeAt(6)==10){a=e.charAt(4);e=e.slice(7)}else if(e.charCodeAt(5)==13||e.charCodeAt(5)==10){a=e.charAt(4);e=e.slice(6)}else a=i(e.slice(0,1024))}else if(t&&t.FS)a=t.FS;else a=i(e.slice(0,1024));var f=0,o=0,l=0;var c=0,h=0,u=a.charCodeAt(0),d=false,v=0,p=e.charCodeAt(0);e=e.replace(/\\r\\n/gm,\"\\n\");var m=t.dateNF!=null?Xe(t.dateNF):null;function b(){var r=e.slice(c,h);var a={};if(r.charAt(0)=='\"'&&r.charAt(r.length-1)=='\"')r=r.slice(1,-1).replace(/\"\"/g,'\"');if(r.length===0)a.t=\"z\";else if(t.raw){a.t=\"s\";a.v=r}else if(r.trim().length===0){a.t=\"s\";a.v=r}else if(r.charCodeAt(0)==61){if(r.charCodeAt(1)==34&&r.charCodeAt(r.length-1)==34){a.t=\"s\";a.v=r.slice(2,-1).replace(/\"\"/g,'\"')}else if(Ih(r)){a.t=\"n\";a.f=r.slice(1)}else{a.t=\"s\";a.v=r}}else if(r==\"TRUE\"){a.t=\"b\";a.v=true}else if(r==\"FALSE\"){a.t=\"b\";a.v=false}else if(!isNaN(l=kr(r))){a.t=\"n\";if(t.cellText!==false)a.w=r;a.v=l}else if(!isNaN(Ar(r).getDate())||m&&r.match(m)){a.z=t.dateNF||X[14];var i=0;if(m&&r.match(m)){r=$e(r,t.dateNF,r.match(m)||[]);i=1}if(t.cellDates){a.t=\"d\";a.v=gr(r,i)}else{a.t=\"n\";a.v=fr(gr(r,i))}if(t.cellText!==false)a.w=Be(a.z,a.v instanceof Date?fr(a.v):a.v);if(!t.cellNF)delete a.z}else{a.t=\"s\";a.v=r}if(a.t==\"z\"){}else if(t.dense){if(!n[f])n[f]=[];n[f][o]=a}else n[Ra({c:o,r:f})]=a;c=h+1;p=e.charCodeAt(c);if(s.e.c<o)s.e.c=o;if(s.e.r<f)s.e.r=f;if(v==u)++o;else{o=0;++f;if(t.sheetRows&&t.sheetRows<=f)return true}}e:for(;h<e.length;++h)switch(v=e.charCodeAt(h)){case 34:if(p===34)d=!d;break;case u:;case 10:;case 13:if(!d&&b())break e;break;default:break;}if(h-c>0)b();n[\"!ref\"]=Na(s);return n}function f(e,t){if(!(t&&t.PRN))return s(e,t);if(t.FS)return s(e,t);if(e.slice(0,4)==\"sep=\")return s(e,t);if(e.indexOf(\"\\t\")>=0||e.indexOf(\",\")>=0||e.indexOf(\";\")>=0)return s(e,t);return Ua(r(e,t),t)}function o(e,r){var t=\"\",n=r.type==\"string\"?[0,0,0,0]:qb(e,r);switch(r.type){case\"base64\":t=k(e);break;case\"binary\":t=e;break;case\"buffer\":if(r.codepage==65001)t=e.toString(\"utf8\");else if(r.codepage&&typeof a!==\"undefined\")t=a.utils.decode(r.codepage,e);else t=T&&Buffer.isBuffer(e)?e.toString(\"binary\"):_(e);break;case\"array\":t=mr(e);break;case\"string\":t=e;break;default:throw new Error(\"Unrecognized type \"+r.type);}if(n[0]==239&&n[1]==187&&n[2]==191)t=lt(t.slice(3));else if(r.type!=\"string\"&&r.type!=\"buffer\"&&r.codepage==65001)t=lt(t);else if(r.type==\"binary\"&&typeof a!==\"undefined\"&&r.codepage)t=a.utils.decode(r.codepage,a.utils.encode(28591,t));if(t.slice(0,19)==\"socialcalc:version:\")return yo.to_sheet(r.type==\"string\"?t:lt(t),r);return f(t,r)}function l(e,r){return La(o(e,r),r)}function c(e){var r=[];var t=Da(e[\"!ref\"]),a;var n=Array.isArray(e);for(var i=t.s.r;i<=t.e.r;++i){var s=[];for(var f=t.s.c;f<=t.e.c;++f){var o=Ra({r:i,c:f});a=n?(e[i]||[])[f]:e[o];if(!a||a.v==null){s.push(\"          \");continue}var l=(a.w||(Pa(a),a.w)||\"\").slice(0,10);while(l.length<10)l+=\" \";s.push(l+(f===0?\" \":\"\"))}r.push(s.join(\"\"))}return r.join(\"\\n\")}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function _o(e,r){var t=r||{},a=!!t.WTF;t.WTF=true;try{var n=Eo.to_workbook(e,t);t.WTF=a;return n}catch(i){t.WTF=a;if(!i.message.match(/SYLK bad record ID/)&&a)throw i;return So.to_workbook(e,r)}}var xo=function(){function e(e,r,t){if(!e)return;ca(e,e.l||0);var a=t.Enum||W;while(e.l<e.length){var n=e._R(2);var i=a[n]||a[65535];var s=e._R(2);var f=e.l+s;var o=i.f&&i.f(e,s,t);e.l=f;if(r(o,i,n))return}}function r(e,r){switch(r.type){case\"base64\":return t(y(k(e)),r);case\"binary\":return t(y(e),r);case\"buffer\":;case\"array\":return t(e,r);}throw\"Unsupported type \"+r.type}function t(r,t){if(!r)return r;var a=t||{};if(g!=null&&a.dense==null)a.dense=g;var n=a.dense?[]:{},i=\"Sheet1\",s=\"\",f=0;var o={},l=[],c=[];var h={s:{r:0,c:0},e:{r:0,c:0}};var u=a.sheetRows||0;if(r[2]==0){if(r[3]==8||r[3]==9){if(r.length>=16&&r[14]==5&&r[15]===108)throw new Error(\"Unsupported Works 3 for Mac file\")}}if(r[2]==2){a.Enum=W;e(r,function(e,r,t){switch(t){case 0:a.vers=e;if(e>=4096)a.qpro=true;break;case 6:h=e;break;case 204:if(e)s=e;break;case 222:s=e;break;case 15:;case 51:if(!a.qpro)e[1].v=e[1].v.slice(1);case 13:;case 14:;case 16:if(t==14&&(e[2]&112)==112&&(e[2]&15)>1&&(e[2]&15)<15){e[1].z=a.dateNF||X[14];if(a.cellDates){e[1].t=\"d\";e[1].v=hr(e[1].v)}}if(a.qpro){if(e[3]>f){n[\"!ref\"]=Na(h);o[i]=n;l.push(i);n=a.dense?[]:{};h={s:{r:0,c:0},e:{r:0,c:0}};f=e[3];i=s||\"Sheet\"+(f+1);s=\"\"}}var c=a.dense?(n[e[0].r]||[])[e[0].c]:n[Ra(e[0])];if(c){c.t=e[1].t;c.v=e[1].v;if(e[1].z!=null)c.z=e[1].z;if(e[1].f!=null)c.f=e[1].f;break}if(a.dense){if(!n[e[0].r])n[e[0].r]=[];n[e[0].r][e[0].c]=e[1]}else n[Ra(e[0])]=e[1];break;default:;}},a)}else if(r[2]==26||r[2]==14){a.Enum=H;if(r[2]==14){a.qpro=true;r.l=0}e(r,function(e,r,t){switch(t){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:;case 24:;case 25:;case 37:;case 39:;case 40:if(e[3]>f){n[\"!ref\"]=Na(h);o[i]=n;l.push(i);n=a.dense?[]:{};h={s:{r:0,c:0},e:{r:0,c:0}};f=e[3];i=\"Sheet\"+(f+1)}if(u>0&&e[0].r>=u)break;if(a.dense){if(!n[e[0].r])n[e[0].r]=[];n[e[0].r][e[0].c]=e[1]}else n[Ra(e[0])]=e[1];if(h.e.c<e[0].c)h.e.c=e[0].c;if(h.e.r<e[0].r)h.e.r=e[0].r;break;case 27:if(e[14e3])c[e[14e3][0]]=e[14e3][1];break;case 1537:c[e[0]]=e[1];if(e[0]==f)i=e[1];break;default:break;}},a)}else throw new Error(\"Unrecognized LOTUS BOF \"+r[2]);n[\"!ref\"]=Na(h);o[s||i]=n;l.push(s||i);if(!c.length)return{SheetNames:l,Sheets:o};var d={},v=[];for(var p=0;p<c.length;++p)if(o[l[p]]){v.push(c[p]||l[p]);d[c[p]]=o[c[p]]||o[l[p]]}else{v.push(c[p]);d[c[p]]={\"!ref\":\"A1\"}}return{SheetNames:v,Sheets:d}}function a(e,r){var t=r||{};if(+t.codepage>=0)o(+t.codepage);if(t.type==\"string\")throw new Error(\"Cannot write WK1 to JS string\");var a=va();var n=Da(e[\"!ref\"]);var s=Array.isArray(e);var f=[];bm(a,0,i(1030));bm(a,6,l(n));var c=Math.min(n.e.r,8191);for(var h=n.s.r;h<=c;++h){var d=Ta(h);for(var p=n.s.c;p<=n.e.c;++p){if(h===n.s.r)f[p]=ya(p);var g=f[p]+d;var b=s?(e[h]||[])[p]:e[g];if(!b||b.t==\"z\")continue;if(b.t==\"n\"){if((b.v|0)==b.v&&b.v>=-32768&&b.v<=32767)bm(a,13,v(h,p,b.v));else bm(a,14,m(h,p,b.v))}else{var w=Pa(b);bm(a,15,u(h,p,w.slice(0,239)))}}}bm(a,1);return a.end()}function n(e,r){var t=r||{};if(+t.codepage>=0)o(+t.codepage);if(t.type==\"string\")throw new Error(\"Cannot write WK3 to JS string\");var a=va();bm(a,0,s(e));for(var n=0,i=0;n<e.SheetNames.length;++n)if((e.Sheets[e.SheetNames[n]]||{})[\"!ref\"])bm(a,27,B(e.SheetNames[n],i++));var f=0;for(n=0;n<e.SheetNames.length;++n){var l=e.Sheets[e.SheetNames[n]];if(!l||!l[\"!ref\"])continue;var c=Da(l[\"!ref\"]);var h=Array.isArray(l);var u=[];var d=Math.min(c.e.r,8191);for(var v=c.s.r;v<=d;++v){var p=Ta(v);for(var g=c.s.c;g<=c.e.c;++g){if(v===c.s.r)u[g]=ya(g);var m=u[g]+p;var b=h?(l[v]||[])[g]:l[m];if(!b||b.t==\"z\")continue;if(b.t==\"n\"){bm(a,23,R(v,g,f,b.v))}else{var w=Pa(b);bm(a,22,_(v,g,f,w.slice(0,239)))}}}++f}bm(a,1);return a.end()}function i(e){var r=ua(2);r._W(2,e);return r}function s(e){var r=ua(26);r._W(2,4096);r._W(2,4);r._W(4,0);var t=0,a=0,n=0;for(var i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i];var f=e.Sheets[s];if(!f||!f[\"!ref\"])continue;++n;var o=Ia(f[\"!ref\"]);if(t<o.e.r)t=o.e.r;if(a<o.e.c)a=o.e.c}if(t>8191)t=8191;r._W(2,t);r._W(1,n);r._W(1,a);r._W(2,0);r._W(2,0);r._W(1,1);r._W(1,2);r._W(4,0);r._W(4,0);return r}function f(e,r,t){var a={s:{c:0,r:0},e:{c:0,r:0}};if(r==8&&t.qpro){a.s.c=e._R(1);e.l++;a.s.r=e._R(2);a.e.c=e._R(1);e.l++;a.e.r=e._R(2);return a}a.s.c=e._R(2);a.s.r=e._R(2);if(r==12&&t.qpro)e.l+=2;a.e.c=e._R(2);a.e.r=e._R(2);if(r==12&&t.qpro)e.l+=2;if(a.s.c==65535)a.s.c=a.e.c=a.s.r=a.e.r=0;return a}function l(e){var r=ua(8);r._W(2,e.s.c);r._W(2,e.s.r);r._W(2,e.e.c);r._W(2,e.e.r);return r}function c(e,r,t){var a=[{c:0,r:0},{t:\"n\",v:0},0,0];if(t.qpro&&t.vers!=20768){a[0].c=e._R(1);a[3]=e._R(1);a[0].r=e._R(2);e.l+=2}else{a[2]=e._R(1);a[0].c=e._R(2);a[0].r=e._R(2)}return a}function h(e,r,t){var a=e.l+r;var n=c(e,r,t);n[1].t=\"s\";if(t.vers==20768){e.l++;var i=e._R(1);n[1].v=e._R(i,\"utf8\");return n}if(t.qpro)e.l++;n[1].v=e._R(a-e.l,\"cstr\");return n}function u(e,r,t){var a=ua(7+t.length);a._W(1,255);a._W(2,r);a._W(2,e);a._W(1,39);for(var n=0;n<a.length;++n){var i=t.charCodeAt(n);a._W(1,i>=128?95:i)}a._W(1,0);return a}function d(e,r,t){var a=c(e,r,t);a[1].v=e._R(2,\"i\");return a}function v(e,r,t){var a=ua(7);a._W(1,255);a._W(2,r);a._W(2,e);a._W(2,t,\"i\");return a}function p(e,r,t){var a=c(e,r,t);a[1].v=e._R(8,\"f\");return a}function m(e,r,t){var a=ua(13);a._W(1,255);a._W(2,r);a._W(2,e);a._W(8,t,\"f\");return a}function b(e,r,t){var a=e.l+r;var n=c(e,r,t);n[1].v=e._R(8,\"f\");if(t.qpro)e.l=a;else{var i=e._R(2);E(e.slice(e.l,e.l+i),n);e.l+=i}return n}function w(e,r,t){var a=r&32768;r&=~32768;r=(a?e:0)+(r>=8192?r-16384:r);return(a?\"\":\"$\")+(t?ya(r):Ta(r))}var T={51:[\"FALSE\",0],52:[\"TRUE\",0],70:[\"LEN\",1],80:[\"SUM\",69],81:[\"AVERAGEA\",69],82:[\"COUNTA\",69],83:[\"MINA\",69],84:[\"MAXA\",69],111:[\"T\",1]};var A=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"+\",\"-\",\"*\",\"/\",\"^\",\"=\",\"<>\",\"<=\",\">=\",\"<\",\">\",\"\",\"\",\"\",\"\",\"&\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"];function E(e,r){ca(e,0);var t=[],a=0,n=\"\",i=\"\",s=\"\",f=\"\";while(e.l<e.length){var o=e[e.l++];switch(o){case 0:t.push(e._R(8,\"f\"));break;case 1:{i=w(r[0].c,e._R(2),true);n=w(r[0].r,e._R(2),false);t.push(i+n)}break;case 2:{var l=w(r[0].c,e._R(2),true);var c=w(r[0].r,e._R(2),false);i=w(r[0].c,e._R(2),true);n=w(r[0].r,e._R(2),false);t.push(l+c+\":\"+i+n)}break;case 3:if(e.l<e.length){console.error(\"WK1 premature formula end\");return}break;case 4:t.push(\"(\"+t.pop()+\")\");break;case 5:t.push(e._R(2));break;case 6:{var h=\"\";while(o=e[e.l++])h+=String.fromCharCode(o);t.push('\"'+h.replace(/\"/g,'\"\"')+'\"')}break;case 8:t.push(\"-\"+t.pop());break;case 23:t.push(\"+\"+t.pop());break;case 22:t.push(\"NOT(\"+t.pop()+\")\");break;case 20:;case 21:{f=t.pop();s=t.pop();t.push([\"AND\",\"OR\"][o-20]+\"(\"+s+\",\"+f+\")\")}break;default:if(o<32&&A[o]){f=t.pop();s=t.pop();t.push(s+A[o]+f)}else if(T[o]){a=T[o][1];if(a==69)a=e[e.l++];if(a>t.length){console.error(\"WK1 bad formula parse 0x\"+o.toString(16)+\":|\"+t.join(\"|\")+\"|\");return}var u=t.slice(-a);t.length-=a;t.push(T[o][0]+\"(\"+u.join(\",\")+\")\")}else if(o<=7)return console.error(\"WK1 invalid opcode \"+o.toString(16));else if(o<=24)return console.error(\"WK1 unsupported op \"+o.toString(16));else if(o<=30)return console.error(\"WK1 invalid opcode \"+o.toString(16));else if(o<=115)return console.error(\"WK1 unsupported function opcode \"+o.toString(16));else return console.error(\"WK1 unrecognized opcode \"+o.toString(16));}}if(t.length==1)r[1].f=\"\"+t[0];else console.error(\"WK1 bad formula parse |\"+t.join(\"|\")+\"|\")}function C(e){var r=[{c:0,r:0},{t:\"n\",v:0},0];r[0].r=e._R(2);r[3]=e[e.l++];r[0].c=e[e.l++];return r}function S(e,r){var t=C(e,r);t[1].t=\"s\";t[1].v=e._R(r-4,\"cstr\");return t}function _(e,r,t,a){var n=ua(6+a.length);n._W(2,e);n._W(1,t);n._W(1,r);n._W(1,39);for(var i=0;i<a.length;++i){var s=a.charCodeAt(i);n._W(1,s>=128?95:s)}n._W(1,0);return n}function x(e,r){var t=C(e,r);t[1].v=e._R(2);var a=t[1].v>>1;if(t[1].v&1){switch(a&7){case 0:a=(a>>3)*5e3;break;case 1:a=(a>>3)*500;break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64;break;}}t[1].v=a;return t}function O(e,r){var t=C(e,r);var a=e._R(4);var n=e._R(4);var i=e._R(2);if(i==65535){if(a===0&&n===3221225472){t[1].t=\"e\";t[1].v=15}else if(a===0&&n===3489660928){t[1].t=\"e\";t[1].v=42}else t[1].v=0;return t}var s=i&32768;i=(i&32767)-16446;t[1].v=(1-s*2)*(n*Math.pow(2,i+32)+a*Math.pow(2,i));return t}function R(e,r,t,a){var n=ua(14);n._W(2,e);n._W(1,t);n._W(1,r);if(a==0){n._W(4,0);n._W(4,0);n._W(2,65535);return n}var i=0,s=0,f=0,o=0;if(a<0){i=1;a=-a}s=Math.log2(a)|0;a/=Math.pow(2,s-31);o=a>>>0;if((o&2147483648)==0){a/=2;++s;o=a>>>0}a-=o;o|=2147483648;o>>>=0;a*=Math.pow(2,32);f=a>>>0;n._W(4,f);n._W(4,o);s+=16383+(i?32768:0);n._W(2,s);return n}function I(e,r){var t=O(e,14);e.l+=r-14;return t}function N(e,r){var t=C(e,r);var a=e._R(4);t[1].v=a>>6;return t}function D(e,r){var t=C(e,r);var a=e._R(8,\"f\");t[1].v=a;return t}function F(e,r){var t=D(e,14);e.l+=r-10;return t}function P(e,r){return e[e.l+r-1]==0?e._R(r,\"cstr\"):\"\"}function L(e,r){var t=e[e.l++];if(t>r-1)t=r-1;var a=\"\";while(a.length<t)a+=String.fromCharCode(e[e.l++]);return a}function M(e,r,t){if(!t.qpro||r<21)return;var a=e._R(1);e.l+=17;e.l+=1;e.l+=2;var n=e._R(r-21,\"cstr\");return[a,n]}function U(e,r){var t={},a=e.l+r;while(e.l<a){var n=e._R(2);if(n==14e3){t[n]=[0,\"\"];t[n][0]=e._R(2);while(e[e.l]){t[n][1]+=String.fromCharCode(e[e.l]);e.l++}e.l++}}return t}function B(e,r){var t=ua(5+e.length);t._W(2,14e3);t._W(2,r);for(var a=0;a<e.length;++a){var n=e.charCodeAt(a);t[t.l++]=n>127?95:n}t[t.l++]=0;return t}var W={0:{n:\"BOF\",f:es},1:{n:\"EOF\"},2:{n:\"CALCMODE\"},3:{n:\"CALCORDER\"},4:{n:\"SPLIT\"},5:{n:\"SYNC\"},6:{n:\"RANGE\",f:f},7:{n:\"WINDOW1\"},8:{n:\"COLW1\"},9:{n:\"WINTWO\"},10:{n:\"COLW2\"},11:{n:\"NAME\"},12:{n:\"BLANK\"},13:{n:\"INTEGER\",f:d},14:{n:\"NUMBER\",f:p},15:{n:\"LABEL\",f:h},16:{n:\"FORMULA\",f:b},24:{n:\"TABLE\"},25:{n:\"ORANGE\"},26:{n:\"PRANGE\"},27:{n:\"SRANGE\"},28:{n:\"FRANGE\"},29:{n:\"KRANGE1\"},32:{n:\"HRANGE\"},35:{n:\"KRANGE2\"},36:{n:\"PROTEC\"},37:{n:\"FOOTER\"},38:{n:\"HEADER\"},39:{n:\"SETUP\"},40:{n:\"MARGINS\"},41:{n:\"LABELFMT\"},42:{n:\"TITLES\"},43:{n:\"SHEETJS\"},45:{n:\"GRAPH\"},46:{n:\"NGRAPH\"},47:{n:\"CALCCOUNT\"},48:{n:\"UNFORMATTED\"},49:{n:\"CURSORW12\"},50:{n:\"WINDOW\"},51:{n:\"STRING\",f:h},55:{n:\"PASSWORD\"},56:{n:\"LOCKED\"},60:{n:\"QUERY\"},61:{n:\"QUERYNAME\"},62:{n:\"PRINT\"},63:{n:\"PRINTNAME\"},64:{n:\"GRAPH2\"},65:{n:\"GRAPHNAME\"},66:{n:\"ZOOM\"},67:{n:\"SYMSPLIT\"},68:{n:\"NSROWS\"},69:{n:\"NSCOLS\"},70:{n:\"RULER\"},71:{n:\"NNAME\"},72:{n:\"ACOMM\"},73:{n:\"AMACRO\"},74:{n:\"PARSE\"},102:{n:\"PRANGES??\"},103:{n:\"RRANGES??\"},104:{n:\"FNAME??\"},105:{n:\"MRANGES??\"},204:{n:\"SHEETNAMECS\",f:P},222:{n:\"SHEETNAMELP\",f:L},65535:{n:\"\"}};var H={0:{n:\"BOF\"},1:{n:\"EOF\"},2:{n:\"PASSWORD\"},3:{n:\"CALCSET\"},4:{n:\"WINDOWSET\"},5:{n:\"SHEETCELLPTR\"},6:{n:\"SHEETLAYOUT\"},7:{n:\"COLUMNWIDTH\"},8:{n:\"HIDDENCOLUMN\"},9:{n:\"USERRANGE\"},10:{n:\"SYSTEMRANGE\"},11:{n:\"ZEROFORCE\"},12:{n:\"SORTKEYDIR\"},13:{n:\"FILESEAL\"},14:{n:\"DATAFILLNUMS\"},15:{n:\"PRINTMAIN\"},16:{n:\"PRINTSTRING\"},17:{n:\"GRAPHMAIN\"},18:{n:\"GRAPHSTRING\"},19:{n:\"??\"},20:{n:\"ERRCELL\"},21:{n:\"NACELL\"},22:{n:\"LABEL16\",f:S},23:{n:\"NUMBER17\",f:O},24:{n:\"NUMBER18\",f:x},25:{n:\"FORMULA19\",f:I},26:{n:\"FORMULA1A\"},27:{n:\"XFORMAT\",f:U},28:{n:\"DTLABELMISC\"},29:{n:\"DTLABELCELL\"},30:{n:\"GRAPHWINDOW\"},31:{n:\"CPA\"},32:{n:\"LPLAUTO\"},33:{n:\"QUERY\"},34:{n:\"HIDDENSHEET\"},35:{n:\"??\"},37:{n:\"NUMBER25\",f:N},38:{n:\"??\"},39:{n:\"NUMBER27\",f:D},40:{n:\"FORMULA28\",f:F},142:{n:\"??\"},147:{n:\"??\"},150:{n:\"??\"},151:{n:\"??\"},152:{n:\"??\"},153:{n:\"??\"},154:{n:\"??\"},155:{n:\"??\"},156:{n:\"??\"},163:{n:\"??\"},174:{n:\"??\"},175:{n:\"??\"},176:{n:\"??\"},177:{n:\"??\"},184:{n:\"??\"},185:{n:\"??\"},186:{n:\"??\"},187:{n:\"??\"},188:{n:\"??\"},195:{n:\"??\"},201:{n:\"??\"},204:{n:\"SHEETNAMECS\",f:P},205:{n:\"??\"},206:{n:\"??\"},207:{n:\"??\"},208:{n:\"??\"},256:{n:\"??\"},259:{n:\"??\"},260:{n:\"??\"},261:{n:\"??\"},262:{n:\"??\"},263:{n:\"??\"},265:{n:\"??\"},266:{n:\"??\"},267:{n:\"??\"},268:{n:\"??\"},270:{n:\"??\"},271:{n:\"??\"},384:{n:\"??\"},389:{n:\"??\"},390:{n:\"??\"},393:{n:\"??\"},396:{n:\"??\"},512:{n:\"??\"},514:{n:\"??\"},513:{n:\"??\"},516:{n:\"??\"},517:{n:\"??\"},640:{n:\"??\"},641:{n:\"??\"},642:{n:\"??\"},643:{n:\"??\"},644:{n:\"??\"},645:{n:\"??\"},646:{n:\"??\"},647:{n:\"??\"},648:{n:\"??\"},658:{n:\"??\"},659:{n:\"??\"},660:{n:\"??\"},661:{n:\"??\"},662:{n:\"??\"},665:{n:\"??\"},666:{n:\"??\"},768:{n:\"??\"},772:{n:\"??\"},1537:{n:\"SHEETINFOQP\",f:M},1600:{n:\"??\"},1602:{n:\"??\"},1793:{n:\"??\"},1794:{n:\"??\"},1795:{n:\"??\"},1796:{n:\"??\"},1920:{n:\"??\"},2048:{n:\"??\"},2049:{n:\"??\"},2052:{n:\"??\"},2688:{n:\"??\"},10998:{n:\"??\"},12849:{n:\"??\"},28233:{n:\"??\"},28484:{n:\"??\"},65535:{n:\"\"}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}}();function Oo(e){var r={},t=e.match(Hr),a=0;var n=false;if(t)for(;a!=t.length;++a){var s=Gr(t[a]);switch(s[0].replace(/\\w*:/g,\"\")){case\"<condense\":break;case\"<extend\":break;case\"<shadow\":if(!s.val)break;case\"<shadow>\":;case\"<shadow/>\":r.shadow=1;break;case\"</shadow>\":break;case\"<charset\":if(s.val==\"1\")break;r.cp=i[parseInt(s.val,10)];break;case\"<outline\":if(!s.val)break;case\"<outline>\":;case\"<outline/>\":r.outline=1;break;case\"</outline>\":break;case\"<rFont\":r.name=s.val;break;case\"<sz\":r.sz=s.val;break;case\"<strike\":if(!s.val)break;case\"<strike>\":;case\"<strike/>\":r.strike=1;break;case\"</strike>\":break;case\"<u\":if(!s.val)break;\nswitch(s.val){case\"double\":r.uval=\"double\";break;case\"singleAccounting\":r.uval=\"single-accounting\";break;case\"doubleAccounting\":r.uval=\"double-accounting\";break;};case\"<u>\":;case\"<u/>\":r.u=1;break;case\"</u>\":break;case\"<b\":if(s.val==\"0\")break;case\"<b>\":;case\"<b/>\":r.b=1;break;case\"</b>\":break;case\"<i\":if(s.val==\"0\")break;case\"<i>\":;case\"<i/>\":r.i=1;break;case\"</i>\":break;case\"<color\":if(s.rgb)r.color=s.rgb.slice(2,8);break;case\"<color>\":;case\"<color/>\":;case\"</color>\":break;case\"<family\":r.family=s.val;break;case\"<family>\":;case\"<family/>\":;case\"</family>\":break;case\"<vertAlign\":r.valign=s.val;break;case\"<vertAlign>\":;case\"<vertAlign/>\":;case\"</vertAlign>\":break;case\"<scheme\":break;case\"<scheme>\":;case\"<scheme/>\":;case\"</scheme>\":break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":break;case\"<ext\":n=true;break;case\"</ext>\":n=false;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error(\"Unrecognized rich format \"+s[0]);}}return r}var Ro=function(){var e=ht(\"t\"),r=ht(\"rPr\");function t(t){var a=t.match(e);if(!a)return{t:\"s\",v:\"\"};var n={t:\"s\",v:Yr(a[1])};var i=t.match(r);if(i)n.s=Oo(i[1]);return n}var a=/<(?:\\w+:)?r>/g,n=/<\\/(?:\\w+:)?r>/;return function i(e){return e.replace(a,\"\").split(n).map(t).filter(function(e){return e.v})}}();var Io=function hk(){var e=/(\\r\\n|\\n)/g;function r(e,r,t){var a=[];if(e.u)a.push(\"text-decoration: underline;\");if(e.uval)a.push(\"text-underline-style:\"+e.uval+\";\");if(e.sz)a.push(\"font-size:\"+e.sz+\"pt;\");if(e.outline)a.push(\"text-effect: outline;\");if(e.shadow)a.push(\"text-shadow: auto;\");r.push('<span style=\"'+a.join(\"\")+'\">');if(e.b){r.push(\"<b>\");t.push(\"</b>\")}if(e.i){r.push(\"<i>\");t.push(\"</i>\")}if(e.strike){r.push(\"<s>\");t.push(\"</s>\")}var n=e.valign||\"\";if(n==\"superscript\"||n==\"super\")n=\"sup\";else if(n==\"subscript\")n=\"sub\";if(n!=\"\"){r.push(\"<\"+n+\">\");t.push(\"</\"+n+\">\")}t.push(\"</span>\");return e}function t(t){var a=[[],t.v,[]];if(!t.v)return\"\";if(t.s)r(t.s,a[0],a[2]);return a[0].join(\"\")+a[1].replace(e,\"<br/>\")+a[2].join(\"\")}return function a(e){return e.map(t).join(\"\")}}();var No=/<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g,Do=/<(?:\\w+:)?r>/;var Fo=/<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;function Po(e,r){var t=r?r.cellHTML:true;var a={};if(!e)return{t:\"\"};if(e.match(/^\\s*<(?:\\w+:)?t[^>]*>/)){a.t=Yr(lt(e.slice(e.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"));a.r=lt(e);if(t)a.h=et(a.t)}else if(e.match(Do)){a.r=lt(e);a.t=Yr(lt((e.replace(Fo,\"\").match(No)||[]).join(\"\").replace(Hr,\"\")));if(t)a.h=Io(Ro(a.r))}return a}var Lo=/<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;var Mo=/<(?:\\w+:)?(?:si|sstItem)>/g;var Uo=/<\\/(?:\\w+:)?(?:si|sstItem)>/;function Bo(e,r){var t=[],a=\"\";if(!e)return t;var n=e.match(Lo);if(n){a=n[2].replace(Mo,\"\").split(Uo);for(var i=0;i!=a.length;++i){var s=Po(a[i].trim(),r);if(s!=null)t[t.length]=s}n=Gr(n[1]);t.Count=n.count;t.Unique=n.uniqueCount}return t}var Wo=/^\\s|\\s$|[\\t\\n\\r]/;function Ho(e,r){if(!r.bookSST)return\"\";var t=[Mr];t[t.length]=kt(\"sst\",null,{xmlns:St[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a){if(e[a]==null)continue;var n=e[a];var i=\"<si>\";if(n.r)i+=n.r;else{i+=\"<t\";if(!n.t)n.t=\"\";if(n.t.match(Wo))i+=' xml:space=\"preserve\"';i+=\">\"+qr(n.t)+\"</t>\"}i+=\"</si>\";t[t.length]=i}if(t.length>2){t[t.length]=\"</sst>\";t[1]=t[1].replace(\"/>\",\">\")}return t.join(\"\")}function zo(e){return[e._R(4),e._R(4)]}function Vo(e,r){var t=[];var a=false;da(e,function n(e,i,s){switch(s){case 159:t.Count=e[0];t.Unique=e[1];break;case 19:t.push(e);break;case 160:return true;case 35:a=true;break;case 36:a=false;break;default:if(i.T){}if(!a||r.WTF)throw new Error(\"Unexpected record 0x\"+s.toString(16));}});return t}function Go(e,r){if(!r)r=ua(8);r._W(4,e.Count);r._W(4,e.Unique);return r}var jo=Xa;function Xo(e){var r=va();pa(r,159,Go(e));for(var t=0;t<e.length;++t)pa(r,19,jo(e[t]));pa(r,160);return r.end()}function $o(e){if(typeof a!==\"undefined\")return a.utils.encode(t,e);var r=[],n=e.split(\"\");for(var i=0;i<n.length;++i)r[i]=n[i].charCodeAt(0);return r}function Yo(e,r){var t={};t.Major=e._R(2);t.Minor=e._R(2);if(r>=4)e.l+=r-4;return t}function Ko(e){var r={};r.id=e._R(0,\"lpp4\");r.R=Yo(e,4);r.U=Yo(e,4);r.W=Yo(e,4);return r}function Jo(e){var r=e._R(4);var t=e.l+r-4;var a={};var n=e._R(4);var i=[];while(n-- >0)i.push({t:e._R(4),v:e._R(0,\"lpp4\")});a.name=e._R(0,\"lpp4\");a.comps=i;if(e.l!=t)throw new Error(\"Bad DataSpaceMapEntry: \"+e.l+\" != \"+t);return a}function qo(e){var r=[];e.l+=4;var t=e._R(4);while(t-- >0)r.push(Jo(e));return r}function Zo(e){var r=[];e.l+=4;var t=e._R(4);while(t-- >0)r.push(e._R(0,\"lpp4\"));return r}function Qo(e){var r={};e._R(4);e.l+=4;r.id=e._R(0,\"lpp4\");r.name=e._R(0,\"lpp4\");r.R=Yo(e,4);r.U=Yo(e,4);r.W=Yo(e,4);return r}function el(e){var r=Qo(e);r.ename=e._R(0,\"8lpp4\");r.blksz=e._R(4);r.cmode=e._R(4);if(e._R(4)!=4)throw new Error(\"Bad !Primary record\");return r}function rl(e,r){var t=e.l+r;var a={};a.Flags=e._R(4)&63;e.l+=4;a.AlgID=e._R(4);var n=false;switch(a.AlgID){case 26126:;case 26127:;case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw\"Unrecognized encryption algorithm: \"+a.AlgID;}if(!n)throw new Error(\"Encryption Flags/AlgID mismatch\");a.AlgIDHash=e._R(4);a.KeySize=e._R(4);a.ProviderType=e._R(4);e.l+=8;a.CSPName=e._R(t-e.l>>1,\"utf16le\");e.l=t;return a}function tl(e,r){var t={},a=e.l+r;e.l+=4;t.Salt=e.slice(e.l,e.l+16);e.l+=16;t.Verifier=e.slice(e.l,e.l+16);e.l+=16;e._R(4);t.VerifierHash=e.slice(e.l,a);e.l=a;return t}function al(e){var r=Yo(e);switch(r.Minor){case 2:return[r.Minor,nl(e,r)];case 3:return[r.Minor,il(e,r)];case 4:return[r.Minor,sl(e,r)];}throw new Error(\"ECMA-376 Encrypted file unrecognized Version: \"+r.Minor)}function nl(e){var r=e._R(4);if((r&63)!=36)throw new Error(\"EncryptionInfo mismatch\");var t=e._R(4);var a=rl(e,t);var n=tl(e,e.length-e.l);return{t:\"Std\",h:a,v:n}}function il(){throw new Error(\"File is password-protected: ECMA-376 Extensible\")}function sl(e){var r=[\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];e.l+=4;var t=e._R(e.length-e.l,\"utf8\");var a={};t.replace(Hr,function n(e){var t=Gr(e);switch(jr(t[0])){case\"<?xml\":break;case\"<encryption\":;case\"</encryption>\":break;case\"<keyData\":r.forEach(function(e){a[e]=t[e]});break;case\"<dataIntegrity\":a.encryptedHmacKey=t.encryptedHmacKey;a.encryptedHmacValue=t.encryptedHmacValue;break;case\"<keyEncryptors>\":;case\"<keyEncryptors\":a.encs=[];break;case\"</keyEncryptors>\":break;case\"<keyEncryptor\":a.uri=t.uri;break;case\"</keyEncryptor>\":break;case\"<encryptedKey\":a.encs.push(t);break;default:throw t[0];}});return a}function fl(e,r){var t={};var a=t.EncryptionVersionInfo=Yo(e,4);r-=4;if(a.Minor!=2)throw new Error(\"unrecognized minor version code: \"+a.Minor);if(a.Major>4||a.Major<2)throw new Error(\"unrecognized major version code: \"+a.Major);t.Flags=e._R(4);r-=4;var n=e._R(4);r-=4;t.EncryptionHeader=rl(e,n);r-=n;t.EncryptionVerifier=tl(e,r);return t}function ol(e){var r={};var t=r.EncryptionVersionInfo=Yo(e,4);if(t.Major!=1||t.Minor!=1)throw\"unrecognized version code \"+t.Major+\" : \"+t.Minor;r.Salt=e._R(16);r.EncryptedVerifier=e._R(16);r.EncryptedVerifierHash=e._R(16);return r}function ll(e){var r=0,t;var a=$o(e);var n=a.length+1,i,s;var f,o,l;t=E(n);t[0]=a.length;for(i=1;i!=n;++i)t[i]=a[i-1];for(i=n-1;i>=0;--i){s=t[i];f=(r&16384)===0?0:1;o=r<<1&32767;l=f|o;r=l^s}return r^52811}var cl=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0];var r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163];var t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628];var a=function(e){return(e/2|e*128)&255};var n=function(e,r){return a(e^r)};var i=function(e){var a=r[e.length-1];var n=104;for(var i=e.length-1;i>=0;--i){var s=e[i];for(var f=0;f!=7;++f){if(s&64)a^=t[n];s*=2;--n}}return a};return function(r){var t=$o(r);var a=i(t);var s=t.length;var f=E(16);for(var o=0;o!=16;++o)f[o]=0;var l,c,h;if((s&1)===1){l=a>>8;f[s]=n(e[0],l);--s;l=a&255;c=t[t.length-1];f[s]=n(c,l)}while(s>0){--s;l=a>>8;f[s]=n(t[s],l);--s;l=a&255;f[s]=n(t[s],l)}s=15;h=15-t.length;while(h>0){l=a>>8;f[s]=n(e[h],l);--s;--h;l=a&255;f[s]=n(t[s],l);--s;--h}return f}}();var hl=function(e,r,t,a,n){if(!n)n=r;if(!a)a=cl(e);var i,s;for(i=0;i!=r.length;++i){s=r[i];s^=a[t];s=(s>>5|s<<3)&255;n[i]=s;++t}return[n,t,a]};var ul=function(e){var r=0,t=cl(e);return function(e){var a=hl(\"\",e,r,t);r=a[1];return a[0]}};function dl(e,r,t,a){var n={key:es(e),verificationBytes:es(e)};if(t.password)n.verifier=ll(t.password);a.valid=n.verificationBytes===n.verifier;if(a.valid)a.insitu=ul(t.password);return n}function vl(e,r,t){var a=t||{};a.Info=e._R(2);e.l-=2;if(a.Info===1)a.Data=ol(e,r);else a.Data=fl(e,r);return a}function pl(e,r,t){var a={Type:t.biff>=8?e._R(2):0};if(a.Type)vl(e,r-2,a);else dl(e,t.biff>=8?r:r-2,t,a);return a}var gl=function(){function e(e,t){switch(t.type){case\"base64\":return r(k(e),t);case\"binary\":return r(e,t);case\"buffer\":return r(T&&Buffer.isBuffer(e)?e.toString(\"binary\"):_(e),t);case\"array\":return r(mr(e),t);}throw new Error(\"Unrecognized type \"+t.type)}function r(e,r){var t=r||{};var a=t.dense?[]:{};var n=e.match(/\\\\trowd.*?\\\\row\\b/g);if(!n.length)throw new Error(\"RTF missing table\");var i={s:{c:0,r:0},e:{c:0,r:n.length-1}};n.forEach(function(e,r){if(Array.isArray(a))a[r]=[];var t=/\\\\\\w+\\b/g;var n=0;var s;var f=-1;while(s=t.exec(e)){switch(s[0]){case\"\\\\cell\":var o=e.slice(n,t.lastIndex-s[0].length);if(o[0]==\" \")o=o.slice(1);++f;if(o.length){var l={v:o,t:\"s\"};if(Array.isArray(a))a[r][f]=l;else a[Ra({r:r,c:f})]=l}break;}n=t.lastIndex}if(f>i.e.c)i.e.c=f});a[\"!ref\"]=Na(i);return a}function t(r,t){return La(e(r,t),t)}function a(e){var r=[\"{\\\\rtf1\\\\ansi\"];var t=Da(e[\"!ref\"]),a;var n=Array.isArray(e);for(var i=t.s.r;i<=t.e.r;++i){r.push(\"\\\\trowd\\\\trautofit1\");for(var s=t.s.c;s<=t.e.c;++s)r.push(\"\\\\cellx\"+(s+1));r.push(\"\\\\pard\\\\intbl\");for(s=t.s.c;s<=t.e.c;++s){var f=Ra({r:i,c:s});a=n?(e[i]||[])[s]:e[f];if(!a||a.v==null&&(!a.f||a.F))continue;r.push(\" \"+(a.w||(Pa(a),a.w)));r.push(\"\\\\cell\")}r.push(\"\\\\pard\\\\intbl\\\\row\")}return r.join(\"\")+\"}\"}return{to_workbook:t,to_sheet:e,from_sheet:a}}();function ml(e){var r=e.slice(e[0]===\"#\"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function bl(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function wl(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255;var n=Math.max(r,t,a),i=Math.min(r,t,a),s=n-i;if(s===0)return[0,0,r];var f=0,o=0,l=n+i;o=s/(l>1?2-l:l);switch(n){case r:f=((t-a)/s+6)%6;break;case t:f=(a-r)/s+2;break;case a:f=(r-t)/s+4;break;}return[f/6,o,l/2]}function kl(e){var r=e[0],t=e[1],a=e[2];var n=t*2*(a<.5?a:1-a),i=a-n/2;var s=[i,i,i],f=6*r;var o;if(t!==0)switch(f|0){case 0:;case 6:o=n*f;s[0]+=n;s[1]+=o;break;case 1:o=n*(2-f);s[0]+=o;s[1]+=n;break;case 2:o=n*(f-2);s[1]+=n;s[2]+=o;break;case 3:o=n*(4-f);s[1]+=o;s[2]+=n;break;case 4:o=n*(f-4);s[2]+=n;s[0]+=o;break;case 5:o=n*(6-f);s[2]+=o;s[0]+=n;break;}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function Tl(e,r){if(r===0)return e;var t=wl(ml(e));if(r<0)t[2]=t[2]*(1+r);else t[2]=1-(1-t[2])*(1-r);return bl(kl(t))}var Al=6,El=15,Cl=1,yl=Al;function Sl(e){return Math.floor((e+Math.round(128/yl)/256)*yl)}function _l(e){return Math.floor((e-5)/yl*100+.5)/100}function xl(e){return Math.round((e*yl+5)/yl*256)/256}function Ol(e){return xl(_l(Sl(e)))}function Rl(e){var r=Math.abs(e-Ol(e)),t=yl;if(r>.005)for(yl=Cl;yl<El;++yl)if(Math.abs(e-Ol(e))<=r){r=Math.abs(e-Ol(e));t=yl}yl=t}function Il(e){if(e.width){e.wpx=Sl(e.width);e.wch=_l(e.wpx);e.MDW=yl}else if(e.wpx){e.wch=_l(e.wpx);e.width=xl(e.wch);e.MDW=yl}else if(typeof e.wch==\"number\"){e.width=xl(e.wch);e.wpx=Sl(e.width);e.MDW=yl}if(e.customWidth)delete e.customWidth}var Nl=96,Dl=Nl;function Fl(e){return e*96/Dl}function Pl(e){return e*Dl/96}var Ll={None:\"none\",Solid:\"solid\",Gray50:\"mediumGray\",Gray75:\"darkGray\",Gray25:\"lightGray\",HorzStripe:\"darkHorizontal\",VertStripe:\"darkVertical\",ReverseDiagStripe:\"darkDown\",DiagStripe:\"darkUp\",DiagCross:\"darkGrid\",ThickDiagCross:\"darkTrellis\",ThinHorzStripe:\"lightHorizontal\",ThinVertStripe:\"lightVertical\",ThinReverseDiagStripe:\"lightDown\",ThinHorzCross:\"lightGrid\"};function Ml(e,r,t,a){r.Borders=[];var n={};var i=false;(e[0].match(Hr)||[]).forEach(function(e){var t=Gr(e);switch(jr(t[0])){case\"<borders\":;case\"<borders>\":;case\"</borders>\":break;case\"<border\":;case\"<border>\":;case\"<border/>\":n={};if(t.diagonalUp)n.diagonalUp=nt(t.diagonalUp);if(t.diagonalDown)n.diagonalDown=nt(t.diagonalDown);r.Borders.push(n);break;case\"</border>\":break;case\"<left/>\":break;case\"<left\":;case\"<left>\":break;case\"</left>\":break;case\"<right/>\":break;case\"<right\":;case\"<right>\":break;case\"</right>\":break;case\"<top/>\":break;case\"<top\":;case\"<top>\":break;case\"</top>\":break;case\"<bottom/>\":break;case\"<bottom\":;case\"<bottom>\":break;case\"</bottom>\":break;case\"<diagonal\":;case\"<diagonal>\":;case\"<diagonal/>\":break;case\"</diagonal>\":break;case\"<horizontal\":;case\"<horizontal>\":;case\"<horizontal/>\":break;case\"</horizontal>\":break;case\"<vertical\":;case\"<vertical>\":;case\"<vertical/>\":break;case\"</vertical>\":break;case\"<start\":;case\"<start>\":;case\"<start/>\":break;case\"</start>\":break;case\"<end\":;case\"<end>\":;case\"<end/>\":break;case\"</end>\":break;case\"<color\":;case\"<color>\":break;case\"<color/>\":;case\"</color>\":break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":break;case\"<ext\":i=true;break;case\"</ext>\":i=false;break;default:if(a&&a.WTF){if(!i)throw new Error(\"unrecognized \"+t[0]+\" in borders\")};}})}function Ul(e,r,t,a){r.Fills=[];var n={};var i=false;(e[0].match(Hr)||[]).forEach(function(e){var t=Gr(e);switch(jr(t[0])){case\"<fills\":;case\"<fills>\":;case\"</fills>\":break;case\"<fill>\":;case\"<fill\":;case\"<fill/>\":n={};r.Fills.push(n);break;case\"</fill>\":break;case\"<gradientFill>\":break;case\"<gradientFill\":;case\"</gradientFill>\":r.Fills.push(n);n={};break;case\"<patternFill\":;case\"<patternFill>\":if(t.patternType)n.patternType=t.patternType;break;case\"<patternFill/>\":;case\"</patternFill>\":break;case\"<bgColor\":if(!n.bgColor)n.bgColor={};if(t.indexed)n.bgColor.indexed=parseInt(t.indexed,10);if(t.theme)n.bgColor.theme=parseInt(t.theme,10);if(t.tint)n.bgColor.tint=parseFloat(t.tint);if(t.rgb)n.bgColor.rgb=t.rgb.slice(-6);break;case\"<bgColor/>\":;case\"</bgColor>\":break;case\"<fgColor\":if(!n.fgColor)n.fgColor={};if(t.theme)n.fgColor.theme=parseInt(t.theme,10);if(t.tint)n.fgColor.tint=parseFloat(t.tint);if(t.rgb!=null)n.fgColor.rgb=t.rgb.slice(-6);break;case\"<fgColor/>\":;case\"</fgColor>\":break;case\"<stop\":;case\"<stop/>\":break;case\"</stop>\":break;case\"<color\":;case\"<color/>\":break;case\"</color>\":break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":break;case\"<ext\":i=true;break;case\"</ext>\":i=false;break;default:if(a&&a.WTF){if(!i)throw new Error(\"unrecognized \"+t[0]+\" in fills\")};}})}function Bl(e,r,t,a){r.Fonts=[];var n={};var s=false;(e[0].match(Hr)||[]).forEach(function(e){var f=Gr(e);switch(jr(f[0])){case\"<fonts\":;case\"<fonts>\":;case\"</fonts>\":break;case\"<font\":;case\"<font>\":break;case\"</font>\":;case\"<font/>\":r.Fonts.push(n);n={};break;case\"<name\":if(f.val)n.name=lt(f.val);break;case\"<name/>\":;case\"</name>\":break;case\"<b\":n.bold=f.val?nt(f.val):1;break;case\"<b/>\":n.bold=1;break;case\"<i\":n.italic=f.val?nt(f.val):1;break;case\"<i/>\":n.italic=1;break;case\"<u\":switch(f.val){case\"none\":n.underline=0;break;case\"single\":n.underline=1;break;case\"double\":n.underline=2;break;case\"singleAccounting\":n.underline=33;break;case\"doubleAccounting\":n.underline=34;break;}break;case\"<u/>\":n.underline=1;break;case\"<strike\":n.strike=f.val?nt(f.val):1;break;case\"<strike/>\":n.strike=1;break;case\"<outline\":n.outline=f.val?nt(f.val):1;break;case\"<outline/>\":n.outline=1;break;case\"<shadow\":n.shadow=f.val?nt(f.val):1;break;case\"<shadow/>\":n.shadow=1;break;case\"<condense\":n.condense=f.val?nt(f.val):1;break;case\"<condense/>\":n.condense=1;break;case\"<extend\":n.extend=f.val?nt(f.val):1;break;case\"<extend/>\":n.extend=1;break;case\"<sz\":if(f.val)n.sz=+f.val;break;case\"<sz/>\":;case\"</sz>\":break;case\"<vertAlign\":if(f.val)n.vertAlign=f.val;break;case\"<vertAlign/>\":;case\"</vertAlign>\":break;case\"<family\":if(f.val)n.family=parseInt(f.val,10);break;case\"<family/>\":;case\"</family>\":break;case\"<scheme\":if(f.val)n.scheme=f.val;break;case\"<scheme/>\":;case\"</scheme>\":break;case\"<charset\":if(f.val==\"1\")break;f.codepage=i[parseInt(f.val,10)];break;case\"<color\":if(!n.color)n.color={};if(f.auto)n.color.auto=nt(f.auto);if(f.rgb)n.color.rgb=f.rgb.slice(-6);else if(f.indexed){n.color.index=parseInt(f.indexed,10);var o=Vn[n.color.index];if(n.color.index==81)o=Vn[1];if(!o)o=Vn[1];n.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else if(f.theme){n.color.theme=parseInt(f.theme,10);if(f.tint)n.color.tint=parseFloat(f.tint);if(f.theme&&t.themeElements&&t.themeElements.clrScheme){n.color.rgb=Tl(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)}}break;case\"<color/>\":;case\"</color>\":break;case\"<AlternateContent\":s=true;break;case\"</AlternateContent>\":s=false;break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":break;case\"<ext\":s=true;break;case\"</ext>\":s=false;break;default:if(a&&a.WTF){if(!s)throw new Error(\"unrecognized \"+f[0]+\" in fonts\")};}})}function Wl(e,r,t){r.NumberFmt=[];var a=rr(X);for(var n=0;n<a.length;++n)r.NumberFmt[a[n]]=X[a[n]];var i=e[0].match(Hr);if(!i)return;for(n=0;n<i.length;++n){var s=Gr(i[n]);switch(jr(s[0])){case\"<numFmts\":;case\"</numFmts>\":;case\"<numFmts/>\":;case\"<numFmts>\":break;case\"<numFmt\":{var f=Yr(lt(s.formatCode)),o=parseInt(s.numFmtId,10);r.NumberFmt[o]=f;if(o>0){if(o>392){for(o=392;o>60;--o)if(r.NumberFmt[o]==null)break;r.NumberFmt[o]=f}We(f,o)}}break;case\"</numFmt>\":break;default:if(t.WTF)throw new Error(\"unrecognized \"+s[0]+\" in numFmts\");}}}function Hl(e){var r=[\"<numFmts>\"];[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)if(e[a]!=null)r[r.length]=kt(\"numFmt\",null,{numFmtId:a,formatCode:qr(e[a])})});if(r.length===1)return\"\";r[r.length]=\"</numFmts>\";r[0]=kt(\"numFmts\",null,{count:r.length-2}).replace(\"/>\",\">\");return r.join(\"\")}var zl=[\"numFmtId\",\"fillId\",\"fontId\",\"borderId\",\"xfId\"];var Vl=[\"applyAlignment\",\"applyBorder\",\"applyFill\",\"applyFont\",\"applyNumberFormat\",\"applyProtection\",\"pivotButton\",\"quotePrefix\"];function Gl(e,r,t){r.CellXf=[];var a;var n=false;(e[0].match(Hr)||[]).forEach(function(e){var i=Gr(e),s=0;switch(jr(i[0])){case\"<cellXfs\":;case\"<cellXfs>\":;case\"<cellXfs/>\":;case\"</cellXfs>\":break;case\"<xf\":;case\"<xf/>\":a=i;delete a[0];for(s=0;s<zl.length;++s)if(a[zl[s]])a[zl[s]]=parseInt(a[zl[s]],10);for(s=0;s<Vl.length;++s)if(a[Vl[s]])a[Vl[s]]=nt(a[Vl[s]]);if(r.NumberFmt&&a.numFmtId>392){for(s=392;s>60;--s)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[s]){a.numFmtId=s;break}}r.CellXf.push(a);break;case\"</xf>\":break;case\"<alignment\":;case\"<alignment/>\":var f={};if(i.vertical)f.vertical=i.vertical;if(i.horizontal)f.horizontal=i.horizontal;if(i.textRotation!=null)f.textRotation=i.textRotation;if(i.indent)f.indent=i.indent;if(i.wrapText)f.wrapText=nt(i.wrapText);a.alignment=f;break;case\"</alignment>\":break;case\"<protection\":break;case\"</protection>\":;case\"<protection/>\":break;case\"<AlternateContent\":n=true;break;case\"</AlternateContent>\":n=false;break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":break;case\"<ext\":n=true;break;case\"</ext>\":n=false;break;default:if(t&&t.WTF){if(!n)throw new Error(\"unrecognized \"+i[0]+\" in cellXfs\")};}})}function jl(e){var r=[];r[r.length]=kt(\"cellXfs\",null);e.forEach(function(e){r[r.length]=kt(\"xf\",null,e)});r[r.length]=\"</cellXfs>\";if(r.length===2)return\"\";r[0]=kt(\"cellXfs\",null,{count:r.length-2}).replace(\"/>\",\">\");return r.join(\"\")}var Xl=function uk(){var e=/<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;var r=/<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;var t=/<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;var a=/<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;var n=/<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;return function i(s,f,o){var l={};if(!s)return l;s=s.replace(/<!--([\\s\\S]*?)-->/gm,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");var c;if(c=s.match(e))Wl(c,l,o);if(c=s.match(a))Bl(c,l,f,o);if(c=s.match(t))Ul(c,l,f,o);if(c=s.match(n))Ml(c,l,f,o);if(c=s.match(r))Gl(c,l,o);return l}}();function $l(e,r){var t=[Mr,kt(\"styleSheet\",null,{xmlns:St[0],\"xmlns:vt\":yt.vt})],a;if(e.SSF&&(a=Hl(e.SSF))!=null)t[t.length]=a;t[t.length]='<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>';t[t.length]='<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>';t[t.length]='<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';t[t.length]='<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';if(a=jl(r.cellXfs))t[t.length]=a;t[t.length]='<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>';t[t.length]='<dxfs count=\"0\"/>';t[t.length]='<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>';if(t.length>2){t[t.length]=\"</styleSheet>\";t[1]=t[1].replace(\"/>\",\">\")}return t.join(\"\")}function Yl(e,r){var t=e._R(2);var a=Ha(e,r-2);return[t,a]}function Kl(e,r,t){if(!t)t=ua(6+4*r.length);t._W(2,e);za(r,t);var a=t.length>t.l?t.slice(0,t.l):t;if(t.l==null)t.l=t.length;return a}function Jl(e,r,t){var a={};a.sz=e._R(2)/20;var n=mn(e,2,t);if(n.fItalic)a.italic=1;if(n.fCondense)a.condense=1;if(n.fExtend)a.extend=1;if(n.fShadow)a.shadow=1;if(n.fOutline)a.outline=1;if(n.fStrikeout)a.strike=1;var i=e._R(2);if(i===700)a.bold=1;switch(e._R(2)){case 1:a.vertAlign=\"superscript\";break;case 2:a.vertAlign=\"subscript\";break;}var s=e._R(1);if(s!=0)a.underline=s;var f=e._R(1);if(f>0)a.family=f;var o=e._R(1);if(o>0)a.charset=o;e.l++;a.color=pn(e,8);switch(e._R(1)){case 1:a.scheme=\"major\";break;case 2:a.scheme=\"minor\";break;}a.name=Ha(e,r-21);return a}function ql(e,r){if(!r)r=ua(25+4*32);r._W(2,e.sz*20);bn(e,r);r._W(2,e.bold?700:400);var t=0;if(e.vertAlign==\"superscript\")t=1;else if(e.vertAlign==\"subscript\")t=2;r._W(2,t);r._W(1,e.underline||0);r._W(1,e.family||0);r._W(1,e.charset||0);r._W(1,0);gn(e.color,r);var a=0;if(e.scheme==\"major\")a=1;if(e.scheme==\"minor\")a=2;r._W(1,a);za(e.name,r);return r.length>r.l?r.slice(0,r.l):r}var Zl=[\"none\",\"solid\",\"mediumGray\",\"darkGray\",\"lightGray\",\"darkHorizontal\",\"darkVertical\",\"darkDown\",\"darkUp\",\"darkGrid\",\"darkTrellis\",\"lightHorizontal\",\"lightVertical\",\"lightDown\",\"lightUp\",\"lightGrid\",\"lightTrellis\",\"gray125\",\"gray0625\"];var Ql;var ec=ha;function rc(e,r){if(!r)r=ua(4*3+8*7+16*1);if(!Ql)Ql=ar(Zl);var t=Ql[e.patternType];if(t==null)t=40;r._W(4,t);var a=0;if(t!=40){gn({auto:1},r);gn({auto:1},r);for(;a<12;++a)r._W(4,0)}else{for(;a<4;++a)r._W(4,0);for(;a<12;++a)r._W(4,0)}return r.length>r.l?r.slice(0,r.l):r}function tc(e,r){var t=e.l+r;var a=e._R(2);var n=e._R(2);e.l=t;return{ixfe:a,numFmtId:n}}function ac(e,r,t){if(!t)t=ua(16);t._W(2,r||0);t._W(2,e.numFmtId||0);t._W(2,0);t._W(2,0);t._W(2,0);t._W(1,0);t._W(1,0);var a=0;t._W(1,a);t._W(1,0);t._W(1,0);t._W(1,0);return t}function nc(e,r){if(!r)r=ua(10);r._W(1,0);r._W(1,0);r._W(4,0);r._W(4,0);return r}var ic=ha;function sc(e,r){if(!r)r=ua(51);r._W(1,0);nc(null,r);nc(null,r);nc(null,r);nc(null,r);nc(null,r);return r.length>r.l?r.slice(0,r.l):r}function fc(e,r){if(!r)r=ua(12+4*10);r._W(4,e.xfId);r._W(2,1);r._W(1,+e.builtinId);r._W(1,0);tn(e.name||\"\",r);return r.length>r.l?r.slice(0,r.l):r}function oc(e,r,t){var a=ua(4+256*2*4);a._W(4,e);tn(r,a);tn(t,a);return a.length>a.l?a.slice(0,a.l):a}function lc(e,r,t){var a={};a.NumberFmt=[];for(var n in X)a.NumberFmt[n]=X[n];a.CellXf=[];a.Fonts=[];var i=[];var s=false;da(e,function f(e,n,o){switch(o){case 44:a.NumberFmt[e[0]]=e[1];We(e[1],e[0]);break;case 43:a.Fonts.push(e);if(e.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme){e.color.rgb=Tl(r.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0)}break;case 1025:break;case 45:break;case 46:break;case 47:if(i[i.length-1]==617){a.CellXf.push(e)}break;case 48:;case 507:;case 572:;case 475:break;case 1171:;case 2102:;case 1130:;case 512:;case 2095:;case 3072:break;case 35:s=true;break;case 36:s=false;break;case 37:i.push(o);s=true;break;case 38:i.pop();s=false;break;default:if(n.T>0)i.push(o);else if(n.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error(\"Unexpected record 0x\"+o.toString(16));}});return a}function cc(e,r){if(!r)return;var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)if(r[a]!=null)++t});if(t==0)return;pa(e,615,Wa(t));[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)if(r[a]!=null)pa(e,44,Kl(a,r[a]))});pa(e,616)}function hc(e){var r=1;if(r==0)return;pa(e,611,Wa(r));pa(e,43,ql({sz:12,color:{theme:1},name:\"Calibri\",family:2,scheme:\"minor\"}));pa(e,612)}function uc(e){var r=2;if(r==0)return;pa(e,603,Wa(r));pa(e,45,rc({patternType:\"none\"}));pa(e,45,rc({patternType:\"gray125\"}));pa(e,604)}function dc(e){var r=1;if(r==0)return;pa(e,613,Wa(r));pa(e,46,sc({}));pa(e,614)}function vc(e){var r=1;pa(e,626,Wa(r));pa(e,47,ac({numFmtId:0,fontId:0,fillId:0,borderId:0},65535));pa(e,627)}function pc(e,r){pa(e,617,Wa(r.length));r.forEach(function(r){pa(e,47,ac(r,0))});pa(e,618)}function gc(e){var r=1;pa(e,619,Wa(r));pa(e,48,fc({xfId:0,builtinId:0,name:\"Normal\"}));pa(e,620)}function mc(e){var r=0;pa(e,505,Wa(r));pa(e,506)}function bc(e){var r=0;pa(e,508,oc(r,\"TableStyleMedium9\",\"PivotStyleMedium4\"));pa(e,509)}function wc(){return}function kc(e,r){var t=va();pa(t,278);cc(t,e.SSF);hc(t,e);uc(t,e);dc(t,e);vc(t,e);pc(t,r.cellXfs);gc(t,e);mc(t,e);bc(t,e);wc(t,e);pa(t,279);return t.end()}var Tc=[\"</a:lt1>\",\"</a:dk1>\",\"</a:lt2>\",\"</a:dk2>\",\"</a:accent1>\",\"</a:accent2>\",\"</a:accent3>\",\"</a:accent4>\",\"</a:accent5>\",\"</a:accent6>\",\"</a:hlink>\",\"</a:folHlink>\"];function Ac(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Hr)||[]).forEach(function(e){var n=Gr(e);switch(n[0]){case\"<a:clrScheme\":;case\"</a:clrScheme>\":break;case\"<a:srgbClr\":a.rgb=n.val;break;case\"<a:sysClr\":a.rgb=n.lastClr;break;case\"<a:dk1>\":;case\"</a:dk1>\":;case\"<a:lt1>\":;case\"</a:lt1>\":;case\"<a:dk2>\":;case\"</a:dk2>\":;case\"<a:lt2>\":;case\"</a:lt2>\":;case\"<a:accent1>\":;case\"</a:accent1>\":;case\"<a:accent2>\":;case\"</a:accent2>\":;case\"<a:accent3>\":;case\"</a:accent3>\":;case\"<a:accent4>\":;case\"</a:accent4>\":;case\"<a:accent5>\":;case\"</a:accent5>\":;case\"<a:accent6>\":;case\"</a:accent6>\":;case\"<a:hlink>\":;case\"</a:hlink>\":;case\"<a:folHlink>\":;case\"</a:folHlink>\":if(n[0].charAt(1)===\"/\"){r.themeElements.clrScheme[Tc.indexOf(n[0])]=a;a={}}else{a.name=n[0].slice(3,n[0].length-1)}break;default:if(t&&t.WTF)throw new Error(\"Unrecognized \"+n[0]+\" in clrScheme\");}})}function Ec(){}function Cc(){}var yc=/<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;var Sc=/<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;var _c=/<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;function xc(e,r,t){r.themeElements={};var a;[[\"clrScheme\",yc,Ac],[\"fontScheme\",Sc,Ec],[\"fmtScheme\",_c,Cc]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+\" not found in themeElements\");n[2](a,r,t)})}var Oc=/<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;function Rc(e,r){if(!e||e.length===0)e=Ic();var t;var a={};if(!(t=e.match(Oc)))throw new Error(\"themeElements not found in theme\");xc(t[0],a,r);a.raw=e;return a}function Ic(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw==\"string\")return e.raw;var t=[Mr];t[t.length]='<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';t[t.length]=\"<a:themeElements>\";t[t.length]='<a:clrScheme name=\"Office\">';t[t.length]='<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';t[t.length]='<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';t[t.length]='<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';t[t.length]='<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';t[t.length]='<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';t[t.length]='<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';t[t.length]='<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';t[t.length]='<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';t[t.length]='<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';t[t.length]='<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';t[t.length]='<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';t[t.length]='<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';t[t.length]=\"</a:clrScheme>\";t[t.length]='<a:fontScheme name=\"Office\">';t[t.length]=\"<a:majorFont>\";t[t.length]='<a:latin typeface=\"Cambria\"/>';t[t.length]='<a:ea typeface=\"\"/>';t[t.length]='<a:cs typeface=\"\"/>';t[t.length]='<a:font script=\"Jpan\" typeface=\" \"/>';t[t.length]='<a:font script=\"Hang\" typeface=\" \"/>';t[t.length]='<a:font script=\"Hans\" typeface=\"\"/>';t[t.length]='<a:font script=\"Hant\" typeface=\"\"/>';t[t.length]='<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';t[t.length]='<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';t[t.length]='<a:font script=\"Thai\" typeface=\"Tahoma\"/>';t[t.length]='<a:font script=\"Ethi\" typeface=\"Nyala\"/>';t[t.length]='<a:font script=\"Beng\" typeface=\"Vrinda\"/>';t[t.length]='<a:font script=\"Gujr\" typeface=\"Shruti\"/>';t[t.length]='<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';t[t.length]='<a:font script=\"Knda\" typeface=\"Tunga\"/>';t[t.length]='<a:font script=\"Guru\" typeface=\"Raavi\"/>';t[t.length]='<a:font script=\"Cans\" typeface=\"Euphemia\"/>';t[t.length]='<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';t[t.length]='<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';t[t.length]='<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';t[t.length]='<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';t[t.length]='<a:font script=\"Deva\" typeface=\"Mangal\"/>';t[t.length]='<a:font script=\"Telu\" typeface=\"Gautami\"/>';t[t.length]='<a:font script=\"Taml\" typeface=\"Latha\"/>';t[t.length]='<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';t[t.length]='<a:font script=\"Orya\" typeface=\"Kalinga\"/>';t[t.length]='<a:font script=\"Mlym\" typeface=\"Kartika\"/>';t[t.length]='<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';t[t.length]='<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';t[t.length]='<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';t[t.length]='<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';t[t.length]='<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';t[t.length]='<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';t[t.length]=\"</a:majorFont>\";t[t.length]=\"<a:minorFont>\";t[t.length]='<a:latin typeface=\"Calibri\"/>';t[t.length]='<a:ea typeface=\"\"/>';t[t.length]='<a:cs typeface=\"\"/>';t[t.length]='<a:font script=\"Jpan\" typeface=\" \"/>';\nt[t.length]='<a:font script=\"Hang\" typeface=\" \"/>';t[t.length]='<a:font script=\"Hans\" typeface=\"\"/>';t[t.length]='<a:font script=\"Hant\" typeface=\"\"/>';t[t.length]='<a:font script=\"Arab\" typeface=\"Arial\"/>';t[t.length]='<a:font script=\"Hebr\" typeface=\"Arial\"/>';t[t.length]='<a:font script=\"Thai\" typeface=\"Tahoma\"/>';t[t.length]='<a:font script=\"Ethi\" typeface=\"Nyala\"/>';t[t.length]='<a:font script=\"Beng\" typeface=\"Vrinda\"/>';t[t.length]='<a:font script=\"Gujr\" typeface=\"Shruti\"/>';t[t.length]='<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';t[t.length]='<a:font script=\"Knda\" typeface=\"Tunga\"/>';t[t.length]='<a:font script=\"Guru\" typeface=\"Raavi\"/>';t[t.length]='<a:font script=\"Cans\" typeface=\"Euphemia\"/>';t[t.length]='<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';t[t.length]='<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';t[t.length]='<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';t[t.length]='<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';t[t.length]='<a:font script=\"Deva\" typeface=\"Mangal\"/>';t[t.length]='<a:font script=\"Telu\" typeface=\"Gautami\"/>';t[t.length]='<a:font script=\"Taml\" typeface=\"Latha\"/>';t[t.length]='<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';t[t.length]='<a:font script=\"Orya\" typeface=\"Kalinga\"/>';t[t.length]='<a:font script=\"Mlym\" typeface=\"Kartika\"/>';t[t.length]='<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';t[t.length]='<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';t[t.length]='<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';t[t.length]='<a:font script=\"Viet\" typeface=\"Arial\"/>';t[t.length]='<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';t[t.length]='<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';t[t.length]=\"</a:minorFont>\";t[t.length]=\"</a:fontScheme>\";t[t.length]='<a:fmtScheme name=\"Office\">';t[t.length]=\"<a:fillStyleLst>\";t[t.length]='<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';t[t.length]='<a:gradFill rotWithShape=\"1\">';t[t.length]=\"<a:gsLst>\";t[t.length]='<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';t[t.length]=\"</a:gsLst>\";t[t.length]='<a:lin ang=\"16200000\" scaled=\"1\"/>';t[t.length]=\"</a:gradFill>\";t[t.length]='<a:gradFill rotWithShape=\"1\">';t[t.length]=\"<a:gsLst>\";t[t.length]='<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';t[t.length]=\"</a:gsLst>\";t[t.length]='<a:lin ang=\"16200000\" scaled=\"0\"/>';t[t.length]=\"</a:gradFill>\";t[t.length]=\"</a:fillStyleLst>\";t[t.length]=\"<a:lnStyleLst>\";t[t.length]='<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';t[t.length]='<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';t[t.length]='<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';t[t.length]=\"</a:lnStyleLst>\";t[t.length]=\"<a:effectStyleLst>\";t[t.length]=\"<a:effectStyle>\";t[t.length]=\"<a:effectLst>\";t[t.length]='<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';t[t.length]=\"</a:effectLst>\";t[t.length]=\"</a:effectStyle>\";t[t.length]=\"<a:effectStyle>\";t[t.length]=\"<a:effectLst>\";t[t.length]='<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';t[t.length]=\"</a:effectLst>\";t[t.length]=\"</a:effectStyle>\";t[t.length]=\"<a:effectStyle>\";t[t.length]=\"<a:effectLst>\";t[t.length]='<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';t[t.length]=\"</a:effectLst>\";t[t.length]='<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';t[t.length]='<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';t[t.length]=\"</a:effectStyle>\";t[t.length]=\"</a:effectStyleLst>\";t[t.length]=\"<a:bgFillStyleLst>\";t[t.length]='<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';t[t.length]='<a:gradFill rotWithShape=\"1\">';t[t.length]=\"<a:gsLst>\";t[t.length]='<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';t[t.length]=\"</a:gsLst>\";t[t.length]='<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';t[t.length]=\"</a:gradFill>\";t[t.length]='<a:gradFill rotWithShape=\"1\">';t[t.length]=\"<a:gsLst>\";t[t.length]='<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';t[t.length]='<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';t[t.length]=\"</a:gsLst>\";t[t.length]='<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';t[t.length]=\"</a:gradFill>\";t[t.length]=\"</a:bgFillStyleLst>\";t[t.length]=\"</a:fmtScheme>\";t[t.length]=\"</a:themeElements>\";t[t.length]=\"<a:objectDefaults>\";t[t.length]=\"<a:spDef>\";t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';t[t.length]=\"</a:spDef>\";t[t.length]=\"<a:lnDef>\";t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';t[t.length]=\"</a:lnDef>\";t[t.length]=\"</a:objectDefaults>\";t[t.length]=\"<a:extraClrSchemeLst/>\";t[t.length]=\"</a:theme>\";return t.join(\"\")}function Nc(e,r,t){var a=e.l+r;var n=e._R(4);if(n===124226)return;if(!t.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var s;try{s=Pr(i,{type:\"array\"})}catch(f){return}var o=Rr(s,\"theme/theme/theme1.xml\",true);if(!o)return;return Rc(o,t)}function Dc(e){return e._R(4)}function Fc(e){var r={};r.xclrType=e._R(2);r.nTintShade=e._R(2);switch(r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Pc(e,4);break;case 2:r.xclrValue=ks(e,4);break;case 3:r.xclrValue=Dc(e,4);break;case 4:e.l+=4;break;}e.l+=8;return r}function Pc(e,r){return ha(e,r)}function Lc(e,r){return ha(e,r)}function Mc(e){var r=e._R(2);var t=e._R(2)-4;var a=[r];switch(r){case 4:;case 5:;case 7:;case 8:;case 9:;case 10:;case 11:;case 13:a[1]=Fc(e,t);break;case 6:a[1]=Lc(e,t);break;case 14:;case 15:a[1]=e._R(t===1?1:2);break;default:throw new Error(\"Unrecognized ExtProp type: \"+r+\" \"+t);}return a}function Uc(e,r){var t=e.l+r;e.l+=2;var a=e._R(2);e.l+=2;var n=e._R(2);var i=[];while(n-- >0)i.push(Mc(e,t-e.l));return{ixfe:a,ext:i}}function Bc(e,r){r.forEach(function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break;}})}function Wc(e,r){return{flags:e._R(4),version:e._R(4),name:Ha(e,r-8)}}function Hc(e){var r=ua(12+2*e.name.length);r._W(4,e.flags);r._W(4,e.version);za(e.name,r);return r.slice(0,r.l)}function zc(e){var r=[];var t=e._R(4);while(t-- >0)r.push([e._R(4),e._R(4)]);return r}function Vc(e){var r=ua(4+8*e.length);r._W(4,e.length);for(var t=0;t<e.length;++t){r._W(4,e[t][0]);r._W(4,e[t][1])}return r}function Gc(e,r){var t=ua(8+2*r.length);t._W(4,e);za(r,t);return t.slice(0,t.l)}function jc(e){e.l+=4;return e._R(4)!=0}function Xc(e,r){var t=ua(8);t._W(4,e);t._W(4,r?1:0);return t}function $c(e,r,t){var a={Types:[],Cell:[],Value:[]};var n=t||{};var i=[];var s=false;var f=2;da(e,function(e,r,t){switch(t){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){if(f==1)a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]});else if(f==0)a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:f=e?1:0;break;case 338:f=2;break;case 35:i.push(t);s=true;break;case 36:i.pop();s=false;break;default:if(r.T){}else if(!s||n.WTF&&i[i.length-1]!=35)throw new Error(\"Unexpected record 0x\"+t.toString(16));}});return a}function Yc(){var e=va();pa(e,332);pa(e,334,Wa(1));pa(e,335,Hc({name:\"XLDAPR\",version:12e4,flags:3496657072}));pa(e,336);pa(e,339,Gc(1,\"XLDAPR\"));pa(e,52);pa(e,35,Wa(514));pa(e,4096,Wa(0));pa(e,4097,rs(1));pa(e,36);pa(e,53);pa(e,340);pa(e,337,Xc(1,true));pa(e,51,Vc([[1,0]]));pa(e,338);pa(e,333);return e.end()}function Kc(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=false;var i=2;var s;e.replace(Hr,function(e){var r=Gr(e);switch(jr(r[0])){case\"<?xml\":break;case\"<metadata\":;case\"</metadata>\":break;case\"<metadataTypes\":;case\"</metadataTypes>\":break;case\"<metadataType\":a.Types.push({name:r.name});break;case\"</metadataType>\":break;case\"<futureMetadata\":for(var f=0;f<a.Types.length;++f)if(a.Types[f].name==r.name)s=a.Types[f];break;case\"</futureMetadata>\":break;case\"<bk>\":break;case\"</bk>\":break;case\"<rc\":if(i==1)a.Cell.push({type:a.Types[r.t-1].name,index:+r.v});else if(i==0)a.Value.push({type:a.Types[r.t-1].name,index:+r.v});break;case\"</rc>\":break;case\"<cellMetadata\":i=1;break;case\"</cellMetadata>\":i=2;break;case\"<valueMetadata\":i=0;break;case\"</valueMetadata>\":i=2;break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":;case\"<extLst/>\":break;case\"<ext\":n=true;break;case\"</ext>\":n=false;break;case\"<rvb\":if(!s)break;if(!s.offsets)s.offsets=[];s.offsets.push(+r.i);break;default:if(!n&&t.WTF)throw new Error(\"unrecognized \"+r[0]+\" in metadata\");}return e});return a}function Jc(){var e=[Mr];e.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');return e.join(\"\")}function qc(e){var r=[];if(!e)return r;var t=1;(e.match(Hr)||[]).forEach(function(e){var a=Gr(e);switch(a[0]){case\"<?xml\":break;case\"<calcChain\":;case\"<calcChain>\":;case\"</calcChain>\":break;case\"<c\":delete a[0];if(a.i)t=a.i;else a.i=t;r.push(a);break;}});return r}function Zc(e){var r={};r.i=e._R(4);var t={};t.r=e._R(4);t.c=e._R(4);r.r=Ra(t);var a=e._R(1);if(a&2)r.l=\"1\";if(a&8)r.a=\"1\";return r}function Qc(e,r,t){var a=[];var n=false;da(e,function i(e,r,s){switch(s){case 63:a.push(e);break;default:if(r.T){}else if(!n||t.WTF)throw new Error(\"Unexpected record 0x\"+s.toString(16));}});return a}function eh(){}function rh(e,r,t,a){if(!e)return e;var n=a||{};var i=false,s=false;da(e,function f(e,r,t){if(s)return;switch(t){case 359:;case 363:;case 364:;case 366:;case 367:;case 368:;case 369:;case 370:;case 371:;case 472:;case 577:;case 578:;case 579:;case 580:;case 581:;case 582:;case 583:;case 584:;case 585:;case 586:;case 587:break;case 35:i=true;break;case 36:i=false;break;default:if(r.T){}else if(!i||n.WTF)throw new Error(\"Unexpected record 0x\"+t.toString(16));}},n)}function th(e,r){if(!e)return\"??\";var t=(e.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/)||[\"\",\"\"])[1];return r[\"!id\"][t].Target}var ah=1024;function nh(e,r){var t=[21600,21600];var a=[\"m0,0l0\",t[1],t[0],t[1],t[0],\"0xe\"].join(\",\");var n=[kt(\"xml\",null,{\"xmlns:v\":_t.v,\"xmlns:o\":_t.o,\"xmlns:x\":_t.x,\"xmlns:mv\":_t.mv}).replace(/\\/>/,\">\"),kt(\"o:shapelayout\",kt(\"o:idmap\",null,{\"v:ext\":\"edit\",data:e}),{\"v:ext\":\"edit\"}),kt(\"v:shapetype\",[kt(\"v:stroke\",null,{joinstyle:\"miter\"}),kt(\"v:path\",null,{gradientshapeok:\"t\",\"o:connecttype\":\"rect\"})].join(\"\"),{id:\"_x0000_t202\",\"o:spt\":202,coordsize:t.join(\",\"),path:a})];while(ah<e*1e3)ah+=1e3;r.forEach(function(e){var r=Oa(e[0]);var t={color2:\"#BEFF82\",type:\"gradient\"};if(t.type==\"gradient\")t.angle=\"-180\";var a=t.type==\"gradient\"?kt(\"o:fill\",null,{type:\"gradientUnscaled\",\"v:ext\":\"view\"}):null;var i=kt(\"v:fill\",a,t);var s={on:\"t\",obscured:\"t\"};++ah;n=n.concat([\"<v:shape\"+wt({id:\"_x0000_s\"+ah,type:\"#_x0000_t202\",style:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\"+(e[1].hidden?\";visibility:hidden\":\"\"),fillcolor:\"#ECFAD4\",strokecolor:\"#edeaa1\"})+\">\",i,kt(\"v:shadow\",null,s),kt(\"v:path\",null,{\"o:connecttype\":\"none\"}),'<v:textbox><div style=\"text-align:left\"></div></v:textbox>','<x:ClientData ObjectType=\"Note\">',\"<x:MoveWithCells/>\",\"<x:SizeWithCells/>\",bt(\"x:Anchor\",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(\",\")),bt(\"x:AutoFill\",\"False\"),bt(\"x:Row\",String(r.r)),bt(\"x:Column\",String(r.c)),e[1].hidden?\"\":\"<x:Visible/>\",\"</x:ClientData>\",\"</v:shape>\"])});n.push(\"</xml>\");return n.join(\"\")}function ih(e,r,t,a){var n=Array.isArray(e);var i;r.forEach(function(r){var s=Oa(r.ref);if(n){if(!e[s.r])e[s.r]=[];i=e[s.r][s.c]}else i=e[r.ref];if(!i){i={t:\"z\"};if(n)e[s.r][s.c]=i;else e[r.ref]=i;var f=Da(e[\"!ref\"]||\"BDWGO1000001:A1\");if(f.s.r>s.r)f.s.r=s.r;if(f.e.r<s.r)f.e.r=s.r;if(f.s.c>s.c)f.s.c=s.c;if(f.e.c<s.c)f.e.c=s.c;var o=Na(f);if(o!==e[\"!ref\"])e[\"!ref\"]=o}if(!i.c)i.c=[];var l={a:r.author,t:r.t,r:r.r,T:t};if(r.h)l.h=r.h;for(var c=i.c.length-1;c>=0;--c){if(!t&&i.c[c].T)return;if(t&&!i.c[c].T)i.c.splice(c,1)}if(t&&a)for(c=0;c<a.length;++c){if(l.a==a[c].id){l.a=a[c].name||l.a;break}}i.c.push(l)})}function sh(e,r){if(e.match(/<(?:\\w+:)?comments *\\/>/))return[];var t=[];var a=[];var n=e.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);if(n&&n[1])n[1].split(/<\\/\\w*:?author>/).forEach(function(e){if(e===\"\"||e.trim()===\"\")return;var r=e.match(/<(?:\\w+:)?author[^>]*>(.*)/);if(r)t.push(r[1])});var i=e.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);if(i&&i[1])i[1].split(/<\\/\\w*:?comment>/).forEach(function(e){if(e===\"\"||e.trim()===\"\")return;var n=e.match(/<(?:\\w+:)?comment[^>]*>/);if(!n)return;var i=Gr(n[0]);var s={author:i.authorId&&t[i.authorId]||\"sheetjsghost\",ref:i.ref,guid:i.guid};var f=Oa(i.ref);if(r.sheetRows&&r.sheetRows<=f.r)return;var o=e.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);var l=!!o&&!!o[1]&&Po(o[1])||{r:\"\",t:\"\",h:\"\"};s.r=l.r;if(l.r==\"<t></t>\")l.t=l.h=\"\";s.t=(l.t||\"\").replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");if(r.cellHTML)s.h=l.h;a.push(s)});return a}function fh(e){var r=[Mr,kt(\"comments\",null,{xmlns:St[0]})];var t=[];r.push(\"<authors>\");e.forEach(function(e){e[1].forEach(function(e){var a=qr(e.a);if(t.indexOf(a)==-1){t.push(a);r.push(\"<author>\"+a+\"</author>\")}if(e.T&&e.ID&&t.indexOf(\"tc=\"+e.ID)==-1){t.push(\"tc=\"+e.ID);r.push(\"<author>\"+\"tc=\"+e.ID+\"</author>\")}})});if(t.length==0){t.push(\"SheetJ5\");r.push(\"<author>SheetJ5</author>\")}r.push(\"</authors>\");r.push(\"<commentList>\");e.forEach(function(e){var a=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID)a=t.indexOf(\"tc=\"+e[1][0].ID);else e[1].forEach(function(e){if(e.a)a=t.indexOf(qr(e.a));n.push(e.t||\"\")});r.push('<comment ref=\"'+e[0]+'\" authorId=\"'+a+'\"><text>');if(n.length<=1)r.push(bt(\"t\",qr(n[0]||\"\")));else{var i=\"Comment:\\n    \"+n[0]+\"\\n\";for(var s=1;s<n.length;++s)i+=\"Reply:\\n    \"+n[s]+\"\\n\";r.push(bt(\"t\",qr(i)))}r.push(\"</text></comment>\")});r.push(\"</commentList>\");if(r.length>2){r[r.length]=\"</comments>\";r[1]=r[1].replace(\"/>\",\">\")}return r.join(\"\")}function oh(e,r){var t=[];var a=false,n={},i=0;e.replace(Hr,function s(f,o){var l=Gr(f);switch(jr(l[0])){case\"<?xml\":break;case\"<ThreadedComments\":break;case\"</ThreadedComments>\":break;case\"<threadedComment\":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case\"</threadedComment>\":if(n.t!=null)t.push(n);break;case\"<text>\":;case\"<text\":i=o+f.length;break;case\"</text>\":n.t=e.slice(i,o).replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");break;case\"<mentions\":;case\"<mentions>\":a=true;break;case\"</mentions>\":a=false;break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":;case\"<extLst/>\":break;case\"<ext\":a=true;break;case\"</ext>\":a=false;break;default:if(!a&&r.WTF)throw new Error(\"unrecognized \"+l[0]+\" in threaded comments\");}return f});return t}function lh(e,r,t){var a=[Mr,kt(\"ThreadedComments\",null,{xmlns:yt.TCMNT}).replace(/[\\/]>/,\">\")];e.forEach(function(e){var n=\"\";(e[1]||[]).forEach(function(i,s){if(!i.T){delete i.ID;return}if(i.a&&r.indexOf(i.a)==-1)r.push(i.a);var f={ref:e[0],id:\"{54EE7951-7262-4200-6969-\"+(\"000000000000\"+t.tcid++).slice(-12)+\"}\"};if(s==0)n=f.id;else f.parentId=n;i.ID=f.id;if(i.a)f.personId=\"{54EE7950-7262-4200-6969-\"+(\"000000000000\"+r.indexOf(i.a)).slice(-12)+\"}\";a.push(kt(\"threadedComment\",bt(\"text\",i.t||\"\"),f))})});a.push(\"</ThreadedComments>\");return a.join(\"\")}function ch(e,r){var t=[];var a=false;e.replace(Hr,function n(e){var n=Gr(e);switch(jr(n[0])){case\"<?xml\":break;case\"<personList\":break;case\"</personList>\":break;case\"<person\":t.push({name:n.displayname,id:n.id});break;case\"</person>\":break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":;case\"<extLst/>\":break;case\"<ext\":a=true;break;case\"</ext>\":a=false;break;default:if(!a&&r.WTF)throw new Error(\"unrecognized \"+n[0]+\" in threaded comments\");}return e});return t}function hh(e){var r=[Mr,kt(\"personList\",null,{xmlns:yt.TCMNT,\"xmlns:x\":St[0]}).replace(/[\\/]>/,\">\")];e.forEach(function(e,t){r.push(kt(\"person\",null,{displayName:e,id:\"{54EE7950-7262-4200-6969-\"+(\"000000000000\"+t).slice(-12)+\"}\",userId:e,providerId:\"None\"}))});r.push(\"</personList>\");return r.join(\"\")}function uh(e){var r={};r.iauthor=e._R(4);var t=hn(e,16);r.rfx=t.s;r.ref=Ra(t.s);e.l+=16;return r}function dh(e,r){if(r==null)r=ua(36);r._W(4,e[1].iauthor);un(e[0],r);r._W(4,0);r._W(4,0);r._W(4,0);r._W(4,0);return r}var vh=Ha;function ph(e){return za(e.slice(0,54))}function gh(e,r){var t=[];var a=[];var n={};var i=false;da(e,function s(e,f,o){switch(o){case 632:a.push(e);break;case 635:n=e;break;case 637:n.t=e.t;n.h=e.h;n.r=e.r;break;case 636:n.author=a[n.iauthor];delete n.iauthor;if(r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;if(!n.t)n.t=\"\";delete n.rfx;t.push(n);break;case 3072:break;case 35:i=true;break;case 36:i=false;break;case 37:break;case 38:break;default:if(f.T){}else if(!i||r.WTF)throw new Error(\"Unexpected record 0x\"+o.toString(16));}});return t}function mh(e){var r=va();var t=[];pa(r,628);pa(r,630);e.forEach(function(e){e[1].forEach(function(e){if(t.indexOf(e.a)>-1)return;t.push(e.a.slice(0,54));pa(r,632,ph(e.a))})});pa(r,631);pa(r,633);e.forEach(function(e){e[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var n={s:Oa(e[0]),e:Oa(e[0])};pa(r,635,dh([n,a]));if(a.t&&a.t.length>0)pa(r,637,Ya(a));pa(r,636);delete a.iauthor})});pa(r,634);pa(r,629);return r.end()}var bh=\"application/vnd.ms-office.vbaProject\";function wh(e){var r=Ke.utils.cfb_new({root:\"R\"});e.FullPaths.forEach(function(t,a){if(t.slice(-1)===\"/\"||!t.match(/_VBA_PROJECT_CUR/))return;var n=t.replace(/^[^\\/]*/,\"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/,\"\");Ke.utils.cfb_add(r,n,e.FileIndex[a].content)});return Ke.write(r)}function kh(e,r){r.FullPaths.forEach(function(t,a){if(a==0)return;var n=t.replace(/[^\\/]*[\\/]/,\"/_VBA_PROJECT_CUR/\");if(n.slice(-1)!==\"/\")Ke.utils.cfb_add(e,n,r.FileIndex[a].content)})}var Th=[\"xlsb\",\"xlsm\",\"xlam\",\"biff8\",\"xla\"];function Ah(){return{\"!type\":\"dialog\"}}function Eh(){return{\"!type\":\"dialog\"}}function Ch(){return{\"!type\":\"macro\"}}function yh(){return{\"!type\":\"macro\"}}var Sh=function(){var e=/(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;var r={r:0,c:0};function t(e,t,a,n){var i=false,s=false;if(a.length==0)s=true;else if(a.charAt(0)==\"[\"){s=true;a=a.slice(1,-1)}if(n.length==0)i=true;else if(n.charAt(0)==\"[\"){i=true;n=n.slice(1,-1)}var f=a.length>0?parseInt(a,10)|0:0,o=n.length>0?parseInt(n,10)|0:0;if(i)o+=r.c;else--o;if(s)f+=r.r;else--f;return t+(i?\"\":\"$\")+ya(o)+(s?\"\":\"$\")+Ta(f)}return function a(n,i){r=i;return n.replace(e,t)}}();var _h=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;var xh=function(){return function e(r,t){return r.replace(_h,function(e,r,a,n,i,s){var f=Ca(n)-(a?0:t.c);var o=ka(s)-(i?0:t.r);var l=o==0?\"\":!i?\"[\"+o+\"]\":o+1;var c=f==0?\"\":!a?\"[\"+f+\"]\":f+1;return r+\"R\"+l+\"C\"+c})}}();function Oh(e,r){return e.replace(_h,function(e,t,a,n,i,s){return t+(a==\"$\"?a+n:ya(Ca(n)+r.c))+(i==\"$\"?i+s:Ta(ka(s)+r.r))})}function Rh(e,r,t){var a=Ia(r),n=a.s,i=Oa(t);var s={r:i.r-n.r,c:i.c-n.c};return Oh(e,s)}function Ih(e){if(e.length==1)return false;return true}function Nh(e){return e.replace(/_xlfn\\./g,\"\")}function Dh(e){e.l+=1;return}function Fh(e,r){var t=e._R(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function Ph(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return Lh(e,r,t);else if(t.biff==12)a=4}var n=e._R(a),i=e._R(a);var s=Fh(e,2);var f=Fh(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:f[0],cRel:f[1],rRel:f[2]}}}function Lh(e){var r=Fh(e,2),t=Fh(e,2);var a=e._R(1);var n=e._R(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function Mh(e,r,t){if(t.biff<8)return Lh(e,r,t);var a=e._R(t.biff==12?4:2),n=e._R(t.biff==12?4:2);var i=Fh(e,2);var s=Fh(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function Uh(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Bh(e,r,t);var a=e._R(t&&t.biff==12?4:2);var n=Fh(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Bh(e){var r=Fh(e,2);var t=e._R(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Wh(e){var r=e._R(2);var t=e._R(2);return{r:r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Hh(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return zh(e,r,t);var n=e._R(a>=12?4:2);var i=e._R(2);var s=(i&16384)>>14,f=(i&32768)>>15;i&=16383;if(f==1)while(n>524287)n-=1048576;if(s==1)while(i>8191)i=i-16384;return{r:n,c:i,cRel:s,rRel:f}}function zh(e){var r=e._R(2);var t=e._R(1);var a=(r&32768)>>15,n=(r&16384)>>14;r&=16383;if(a==1&&r>=8192)r=r-16384;if(n==1&&t>=128)t=t-256;return{r:r,c:t,cRel:n,rRel:a}}function Vh(e,r,t){var a=(e[e.l++]&96)>>5;var n=Ph(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function Gh(e,r,t){var a=(e[e.l++]&96)>>5;var n=e._R(2,\"i\");var i=8;if(t)switch(t.biff){case 5:e.l+=12;i=6;break;case 12:i=12;break;}var s=Ph(e,i,t);return[a,n,s]}function jh(e,r,t){var a=(e[e.l++]&96)>>5;e.l+=t&&t.biff>8?12:t.biff<8?6:8;return[a]}function Xh(e,r,t){var a=(e[e.l++]&96)>>5;var n=e._R(2);var i=8;if(t)switch(t.biff){case 5:e.l+=12;i=6;break;case 12:i=12;break;}e.l+=i;return[a,n]}function $h(e,r,t){var a=(e[e.l++]&96)>>5;var n=Mh(e,r-1,t);return[a,n]}function Yh(e,r,t){var a=(e[e.l++]&96)>>5;e.l+=t.biff==2?6:t.biff==12?14:7;return[a]}function Kh(e){var r=e[e.l+1]&1;var t=1;e.l+=4;return[r,t]}function Jh(e,r,t){e.l+=2;var a=e._R(t&&t.biff==2?1:2);var n=[];for(var i=0;i<=a;++i)n.push(e._R(t&&t.biff==2?1:2));return n}function qh(e,r,t){var a=e[e.l+1]&255?1:0;e.l+=2;return[a,e._R(t&&t.biff==2?1:2)]}function Zh(e,r,t){var a=e[e.l+1]&255?1:0;e.l+=2;return[a,e._R(t&&t.biff==2?1:2)]}function Qh(e){var r=e[e.l+1]&255?1:0;e.l+=2;return[r,e._R(2)]}function eu(e,r,t){var a=e[e.l+1]&255?1:0;e.l+=t&&t.biff==2?3:4;return[a]}function ru(e){var r=e._R(1),t=e._R(1);return[r,t]}function tu(e){e._R(2);return ru(e,2)}function au(e){e._R(2);return ru(e,2)}function nu(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=Uh(e,0,t);return[a,n]}function iu(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=Hh(e,0,t);return[a,n]}function su(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e._R(2);if(t&&t.biff==5)e.l+=12;var i=Uh(e,0,t);return[a,n,i]}function fu(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e._R(t&&t.biff<=3?1:2);return[Ed[n],Ad[n],a]}function ou(e,r,t){var a=e[e.l++];var n=e._R(1),i=t&&t.biff<=3?[a==88?-1:0,e._R(1)]:lu(e);return[n,(i[0]===0?Ad:Td)[i[1]]]}function lu(e){return[e[e.l+1]>>7,e._R(2)&32767]}function cu(e,r,t){e.l+=t&&t.biff==2?3:4;return}function hu(e,r,t){e.l++;if(t&&t.biff==12)return[e._R(4,\"i\"),0];var a=e._R(2);var n=e._R(t&&t.biff==2?1:2);return[a,n]}function uu(e){e.l++;return Gn[e._R(1)]}function du(e){e.l++;return e._R(2)}function vu(e){e.l++;return e._R(1)!==0}function pu(e){e.l++;return dn(e,8)}function gu(e,r,t){e.l++;return is(e,r-1,t)}function mu(e,r){var t=[e._R(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break;}switch(t[0]){case 4:t[1]=Zi(e,1)?\"TRUE\":\"FALSE\";if(r!=12)e.l+=7;break;case 37:;case 16:t[1]=Gn[e[e.l]];e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=dn(e,8);break;case 2:t[1]=cs(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error(\"Bad SerAr: \"+t[0]);}return t}function bu(e,r,t){var a=e._R(t.biff==12?4:2);var n=[];for(var i=0;i!=a;++i)n.push((t.biff==12?hn:Os)(e,8));return n}function wu(e,r,t){var a=0,n=0;if(t.biff==12){a=e._R(4);n=e._R(4)}else{n=1+e._R(1);a=1+e._R(2)}if(t.biff>=2&&t.biff<8){--a;if(--n==0)n=256}for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var f=0;f!=n;++f)s[i][f]=mu(e,t.biff);return s}function ku(e,r,t){var a=e._R(1)>>>5&3;var n=!t||t.biff>=8?4:2;var i=e._R(n);switch(t.biff){case 2:e.l+=5;break;case 3:;case 4:e.l+=8;break;case 5:e.l+=12;break;}return[a,0,i]}function Tu(e,r,t){if(t.biff==5)return Au(e,r,t);var a=e._R(1)>>>5&3;var n=e._R(2);var i=e._R(4);return[a,n,i]}function Au(e){var r=e._R(1)>>>5&3;var t=e._R(2,\"i\");e.l+=8;var a=e._R(2);e.l+=12;return[r,t,a]}function Eu(e,r,t){var a=e._R(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e._R(t&&t.biff==2?1:2);return[a,n]}function Cu(e,r,t){var a=e._R(1)>>>5&3;var n=e._R(t&&t.biff==2?1:2);return[a,n]}function yu(e,r,t){var a=e._R(1)>>>5&3;e.l+=4;if(t.biff<8)e.l--;if(t.biff==12)e.l+=2;return[a]}function Su(e,r,t){var a=(e[e.l++]&96)>>5;var n=e._R(2);var i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break;}e.l+=i;return[a,n]}var _u=ha;var xu=ha;var Ou=ha;function Ru(e,r,t){e.l+=2;return[Wh(e,4,t)]}function Iu(e){e.l+=6;return[]}var Nu=Ru;var Du=Iu;var Fu=Iu;var Pu=Ru;function Lu(e){e.l+=2;return[es(e),e._R(2)&1]}var Mu=Ru;var Uu=Lu;var Bu=Iu;var Wu=Ru;var Hu=Ru;var zu=[\"Data\",\"All\",\"Headers\",\"??\",\"?Data2\",\"??\",\"?DataHeaders\",\"??\",\"Totals\",\"??\",\"??\",\"??\",\"?DataTotals\",\"??\",\"??\",\"??\",\"?Current\"];function Vu(e){e.l+=2;var r=e._R(2);var t=e._R(2);var a=e._R(4);var n=e._R(2);var i=e._R(2);var s=zu[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:a,c:n,C:i}}function Gu(e){e.l+=2;return[e._R(4)]}function ju(e,r,t){e.l+=5;e.l+=2;e.l+=t.biff==2?1:4;return[\"PTGSHEET\"]}function Xu(e,r,t){e.l+=t.biff==2?4:5;return[\"PTGENDSHEET\"]}function $u(e){var r=e._R(1)>>>5&3;var t=e._R(2);return[r,t]}function Yu(e){var r=e._R(1)>>>5&3;var t=e._R(2);return[r,t]}function Ku(e){e.l+=4;return[0,0]}var Ju={1:{n:\"PtgExp\",f:hu},2:{n:\"PtgTbl\",f:Ou},3:{n:\"PtgAdd\",f:Dh},4:{n:\"PtgSub\",f:Dh},5:{n:\"PtgMul\",f:Dh},6:{n:\"PtgDiv\",f:Dh},7:{n:\"PtgPower\",f:Dh},8:{n:\"PtgConcat\",f:Dh},9:{n:\"PtgLt\",f:Dh},10:{n:\"PtgLe\",f:Dh},11:{n:\"PtgEq\",f:Dh},12:{n:\"PtgGe\",f:Dh},13:{n:\"PtgGt\",f:Dh},14:{n:\"PtgNe\",f:Dh},15:{n:\"PtgIsect\",f:Dh},16:{n:\"PtgUnion\",f:Dh},17:{n:\"PtgRange\",f:Dh},18:{n:\"PtgUplus\",f:Dh},19:{n:\"PtgUminus\",f:Dh},20:{n:\"PtgPercent\",f:Dh},21:{n:\"PtgParen\",f:Dh},22:{n:\"PtgMissArg\",f:Dh},23:{n:\"PtgStr\",f:gu},26:{n:\"PtgSheet\",f:ju},27:{n:\"PtgEndSheet\",f:Xu},28:{n:\"PtgErr\",f:uu},29:{n:\"PtgBool\",f:vu},30:{n:\"PtgInt\",f:du},31:{n:\"PtgNum\",f:pu},32:{n:\"PtgArray\",f:Yh},33:{n:\"PtgFunc\",f:fu},34:{n:\"PtgFuncVar\",f:ou},35:{n:\"PtgName\",f:ku},36:{n:\"PtgRef\",f:nu},37:{n:\"PtgArea\",f:Vh},38:{n:\"PtgMemArea\",f:Eu},39:{n:\"PtgMemErr\",f:_u},40:{n:\"PtgMemNoMem\",f:xu},41:{n:\"PtgMemFunc\",f:Cu},42:{n:\"PtgRefErr\",f:yu},43:{n:\"PtgAreaErr\",f:jh},44:{n:\"PtgRefN\",f:iu},45:{n:\"PtgAreaN\",f:$h},46:{n:\"PtgMemAreaN\",f:$u},47:{n:\"PtgMemNoMemN\",f:Yu},57:{n:\"PtgNameX\",f:Tu},58:{n:\"PtgRef3d\",f:su},59:{n:\"PtgArea3d\",f:Gh},60:{n:\"PtgRefErr3d\",f:Su},61:{n:\"PtgAreaErr3d\",f:Xh},255:{}};var qu={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};var Zu={1:{n:\"PtgElfLel\",f:Lu},2:{n:\"PtgElfRw\",f:Wu},3:{n:\"PtgElfCol\",f:Nu},6:{n:\"PtgElfRwV\",f:Hu},7:{n:\"PtgElfColV\",f:Pu},10:{n:\"PtgElfRadical\",f:Mu},11:{n:\"PtgElfRadicalS\",f:Bu},13:{n:\"PtgElfColS\",f:Du},15:{n:\"PtgElfColSV\",f:Fu},16:{n:\"PtgElfRadicalLel\",f:Uu},25:{n:\"PtgList\",f:Vu},29:{n:\"PtgSxName\",f:Gu},255:{}};var Qu={0:{n:\"PtgAttrNoop\",f:Ku},1:{n:\"PtgAttrSemi\",f:eu},2:{n:\"PtgAttrIf\",f:Zh},4:{n:\"PtgAttrChoose\",f:Jh},8:{n:\"PtgAttrGoto\",f:qh},16:{n:\"PtgAttrSum\",f:cu},32:{n:\"PtgAttrBaxcel\",f:Kh},33:{n:\"PtgAttrBaxcel\",f:Kh},64:{n:\"PtgAttrSpace\",f:tu},65:{n:\"PtgAttrSpaceSemi\",f:au},128:{n:\"PtgAttrIfError\",f:Qh},255:{}};function ed(e,r,t,a){if(a.biff<8)return ha(e,r);var n=e.l+r;var i=[];for(var s=0;s!==t.length;++s){switch(t[s][0]){case\"PtgArray\":t[s][1]=wu(e,0,a);i.push(t[s][1]);break;case\"PtgMemArea\":t[s][2]=bu(e,t[s][1],a);i.push(t[s][2]);break;case\"PtgExp\":if(a&&a.biff==12){t[s][1][1]=e._R(4);i.push(t[s][1])}break;case\"PtgList\":;case\"PtgElfRadicalS\":;case\"PtgElfColS\":;case\"PtgElfColSV\":throw\"Unsupported \"+t[s][0];default:break;}}r=n-e.l;if(r!==0)i.push(ha(e,r));return i}function rd(e,r,t){var a=e.l+r;var n,i,s=[];while(a!=e.l){r=a-e.l;i=e[e.l];n=Ju[i]||Ju[qu[i]];if(i===24||i===25)n=(i===24?Zu:Qu)[e[e.l+1]];if(!n||!n.f){ha(e,r)}else{s.push([n.n,n.f(e,r,t)])}}return s}function td(e){var r=[];for(var t=0;t<e.length;++t){var a=e[t],n=[];for(var i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('\"'+s[1].replace(/\"/g,'\"\"')+'\"');break;default:n.push(s[1]);}else n.push(\"\")}r.push(n.join(\",\"))}return r.join(\";\")}var ad={PtgAdd:\"+\",PtgConcat:\"&\",PtgDiv:\"/\",PtgEq:\"=\",PtgGe:\">=\",PtgGt:\">\",PtgLe:\"<=\",PtgLt:\"<\",PtgMul:\"*\",PtgNe:\"<>\",PtgPower:\"^\",PtgSub:\"-\"};function nd(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error(\"empty sheet name\");if(/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(e))return\"'\"+e+\"'\";return e}function id(e,r,t){if(!e)return\"SH33TJSERR0\";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return\"SH33TJSERR6\";\nvar a=e.XTI[r];if(t.biff<8){if(r>1e4)r-=65536;if(r<0)r=-r;return r==0?\"\":e.XTI[r-1]}if(!a)return\"SH33TJSERR1\";var n=\"\";if(t.biff>8)switch(e[a[0]][0]){case 357:n=a[1]==-1?\"#REF\":e.SheetNames[a[1]];return a[1]==a[2]?n:n+\":\"+e.SheetNames[a[2]];case 358:if(t.SID!=null)return e.SheetNames[t.SID];return\"SH33TJSSAME\"+e[a[0]][0];case 355:;default:return\"SH33TJSSRC\"+e[a[0]][0];}switch(e[a[0]][0][0]){case 1025:n=a[1]==-1?\"#REF\":e.SheetNames[a[1]]||\"SH33TJSERR3\";return a[1]==a[2]?n:n+\":\"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(\";;\");default:if(!e[a[0]][0][3])return\"SH33TJSERR2\";n=a[1]==-1?\"#REF\":e[a[0]][0][3][a[1]]||\"SH33TJSERR4\";return a[1]==a[2]?n:n+\":\"+e[a[0]][0][3][a[2]];}}function sd(e,r,t){var a=id(e,r,t);return a==\"#REF\"?a:nd(a,t)}function fd(e,r,t,a,n){var i=n&&n.biff||8;var s={s:{c:0,r:0},e:{c:0,r:0}};var f=[],o,l,c,h=0,u=0,d,v=\"\";if(!e[0]||!e[0][0])return\"\";var p=-1,g=\"\";for(var m=0,b=e[0].length;m<b;++m){var w=e[0][m];switch(w[0]){case\"PtgUminus\":f.push(\"-\"+f.pop());break;case\"PtgUplus\":f.push(\"+\"+f.pop());break;case\"PtgPercent\":f.push(f.pop()+\"%\");break;case\"PtgAdd\":;case\"PtgConcat\":;case\"PtgDiv\":;case\"PtgEq\":;case\"PtgGe\":;case\"PtgGt\":;case\"PtgLe\":;case\"PtgLt\":;case\"PtgMul\":;case\"PtgNe\":;case\"PtgPower\":;case\"PtgSub\":o=f.pop();l=f.pop();if(p>=0){switch(e[0][p][1][0]){case 0:g=wr(\" \",e[0][p][1][1]);break;case 1:g=wr(\"\\r\",e[0][p][1][1]);break;default:g=\"\";if(n.WTF)throw new Error(\"Unexpected PtgAttrSpaceType \"+e[0][p][1][0]);}l=l+g;p=-1}f.push(l+ad[w[0]]+o);break;case\"PtgIsect\":o=f.pop();l=f.pop();f.push(l+\" \"+o);break;case\"PtgUnion\":o=f.pop();l=f.pop();f.push(l+\",\"+o);break;case\"PtgRange\":o=f.pop();l=f.pop();f.push(l+\":\"+o);break;case\"PtgAttrChoose\":break;case\"PtgAttrGoto\":break;case\"PtgAttrIf\":break;case\"PtgAttrIfError\":break;case\"PtgRef\":c=ga(w[1][1],s,n);f.push(ba(c,i));break;case\"PtgRefN\":c=t?ga(w[1][1],t,n):w[1][1];f.push(ba(c,i));break;case\"PtgRef3d\":h=w[1][1];c=ga(w[1][2],s,n);v=sd(a,h,n);var k=v;f.push(v+\"!\"+ba(c,i));break;case\"PtgFunc\":;case\"PtgFuncVar\":var T=w[1][0],A=w[1][1];if(!T)T=0;T&=127;var E=T==0?[]:f.slice(-T);f.length-=T;if(A===\"User\")A=E.shift();f.push(A+\"(\"+E.join(\",\")+\")\");break;case\"PtgBool\":f.push(w[1]?\"TRUE\":\"FALSE\");break;case\"PtgInt\":f.push(w[1]);break;case\"PtgNum\":f.push(String(w[1]));break;case\"PtgStr\":f.push('\"'+w[1].replace(/\"/g,'\"\"')+'\"');break;case\"PtgErr\":f.push(w[1]);break;case\"PtgAreaN\":d=ma(w[1][1],t?{s:t}:s,n);f.push(wa(d,n));break;case\"PtgArea\":d=ma(w[1][1],s,n);f.push(wa(d,n));break;case\"PtgArea3d\":h=w[1][1];d=w[1][2];v=sd(a,h,n);f.push(v+\"!\"+wa(d,n));break;case\"PtgAttrSum\":f.push(\"SUM(\"+f.pop()+\")\");break;case\"PtgAttrBaxcel\":;case\"PtgAttrSemi\":break;case\"PtgName\":u=w[1][2];var C=(a.names||[])[u-1]||(a[0]||[])[u];var y=C?C.Name:\"SH33TJSNAME\"+String(u);if(y&&y.slice(0,6)==\"_xlfn.\"&&!n.xlfn)y=y.slice(6);f.push(y);break;case\"PtgNameX\":var S=w[1][1];u=w[1][2];var _;if(n.biff<=5){if(S<0)S=-S;if(a[S])_=a[S][u]}else{var x=\"\";if(((a[S]||[])[0]||[])[0]==14849){}else if(((a[S]||[])[0]||[])[0]==1025){if(a[S][u]&&a[S][u].itab>0){x=a.SheetNames[a[S][u].itab-1]+\"!\"}}else x=a.SheetNames[u-1]+\"!\";if(a[S]&&a[S][u])x+=a[S][u].Name;else if(a[0]&&a[0][u])x+=a[0][u].Name;else{var O=(id(a,S,n)||\"\").split(\";;\");if(O[u-1])x=O[u-1];else x+=\"SH33TJSERRX\"}f.push(x);break}if(!_)_={Name:\"SH33TJSERRY\"};f.push(_.Name);break;case\"PtgParen\":var R=\"(\",I=\")\";if(p>=0){g=\"\";switch(e[0][p][1][0]){case 2:R=wr(\" \",e[0][p][1][1])+R;break;case 3:R=wr(\"\\r\",e[0][p][1][1])+R;break;case 4:I=wr(\" \",e[0][p][1][1])+I;break;case 5:I=wr(\"\\r\",e[0][p][1][1])+I;break;default:if(n.WTF)throw new Error(\"Unexpected PtgAttrSpaceType \"+e[0][p][1][0]);}p=-1}f.push(R+f.pop()+I);break;case\"PtgRefErr\":f.push(\"#REF!\");break;case\"PtgRefErr3d\":f.push(\"#REF!\");break;case\"PtgExp\":c={c:w[1][1],r:w[1][0]};var N={c:t.c,r:t.r};if(a.sharedf[Ra(c)]){var D=a.sharedf[Ra(c)];f.push(fd(D,s,N,a,n))}else{var F=false;for(o=0;o!=a.arrayf.length;++o){l=a.arrayf[o];if(c.c<l[0].s.c||c.c>l[0].e.c)continue;if(c.r<l[0].s.r||c.r>l[0].e.r)continue;f.push(fd(l[1],s,N,a,n));F=true;break}if(!F)f.push(w[1])}break;case\"PtgArray\":f.push(\"{\"+td(w[1])+\"}\");break;case\"PtgMemArea\":break;case\"PtgAttrSpace\":;case\"PtgAttrSpaceSemi\":p=m;break;case\"PtgTbl\":break;case\"PtgMemErr\":break;case\"PtgMissArg\":f.push(\"\");break;case\"PtgAreaErr\":f.push(\"#REF!\");break;case\"PtgAreaErr3d\":f.push(\"#REF!\");break;case\"PtgList\":f.push(\"Table\"+w[1].idx+\"[#\"+w[1].rt+\"]\");break;case\"PtgMemAreaN\":;case\"PtgMemNoMemN\":;case\"PtgAttrNoop\":;case\"PtgSheet\":;case\"PtgEndSheet\":break;case\"PtgMemFunc\":break;case\"PtgMemNoMem\":break;case\"PtgElfCol\":;case\"PtgElfColS\":;case\"PtgElfColSV\":;case\"PtgElfColV\":;case\"PtgElfLel\":;case\"PtgElfRadical\":;case\"PtgElfRadicalLel\":;case\"PtgElfRadicalS\":;case\"PtgElfRw\":;case\"PtgElfRwV\":throw new Error(\"Unsupported ELFs\");case\"PtgSxName\":throw new Error(\"Unrecognized Formula Token: \"+String(w));default:throw new Error(\"Unrecognized Formula Token: \"+String(w));}var P=[\"PtgAttrSpace\",\"PtgAttrSpaceSemi\",\"PtgAttrGoto\"];if(n.biff!=3)if(p>=0&&P.indexOf(e[0][m][0])==-1){w=e[0][p];var L=true;switch(w[1][0]){case 4:L=false;case 0:g=wr(\" \",w[1][1]);break;case 5:L=false;case 1:g=wr(\"\\r\",w[1][1]);break;default:g=\"\";if(n.WTF)throw new Error(\"Unexpected PtgAttrSpaceType \"+w[1][0]);}f.push((L?g:\"\")+f.pop()+(L?\"\":g));p=-1}}if(f.length>1&&n.WTF)throw new Error(\"bad formula stack\");return f[0]}function od(e,r,t){var a=e.l+r,n=t.biff==2?1:2;var i,s=e._R(n);if(s==65535)return[[],ha(e,r-2)];var f=rd(e,s,t);if(r!==s+n)i=ed(e,r-s-n,f,t);e.l=a;return[f,i]}function ld(e,r,t){var a=e.l+r,n=t.biff==2?1:2;var i,s=e._R(n);if(s==65535)return[[],ha(e,r-2)];var f=rd(e,s,t);if(r!==s+n)i=ed(e,r-s-n,f,t);e.l=a;return[f,i]}function cd(e,r,t,a){var n=e.l+r;var i=rd(e,a,t);var s;if(n!==e.l)s=ed(e,n-e.l,i,t);return[i,s]}function hd(e,r,t){var a=e.l+r;var n,i=e._R(2);var s=rd(e,i,t);if(i==65535)return[[],ha(e,r-2)];if(r!==i+2)n=ed(e,a-i-2,s,t);return[s,n]}function ud(e){var r;if(Qt(e,e.l+6)!==65535)return[dn(e),\"n\"];switch(e[e.l]){case 0:e.l+=8;return[\"String\",\"s\"];case 1:r=e[e.l+2]===1;e.l+=8;return[r,\"b\"];case 2:r=e[e.l+2];e.l+=8;return[r,\"e\"];case 3:e.l+=8;return[\"\",\"s\"];}return[]}function dd(e){if(e==null){var r=ua(8);r._W(1,3);r._W(1,0);r._W(2,0);r._W(2,0);r._W(2,65535);return r}else if(typeof e==\"number\")return vn(e);return vn(0)}function vd(e,r,t){var a=e.l+r;var n=As(e,6);if(t.biff==2)++e.l;var i=ud(e,8);var s=e._R(1);if(t.biff!=2){e._R(1);if(t.biff>=5){e._R(4)}}var f=ld(e,a-e.l,t);return{cell:n,val:i[0],formula:f,shared:s>>3&1,tt:i[1]}}function pd(e,r,t,a,n){var i=Es(r,t,n);var s=dd(e.v);var f=ua(6);var o=1|32;f._W(2,o);f._W(4,0);var l=ua(e.bf.length);for(var c=0;c<e.bf.length;++c)l[c]=e.bf[c];var h=R([i,s,f,l]);return h}function gd(e,r,t){var a=e._R(4);var n=rd(e,a,t);var i=e._R(4);var s=i>0?ed(e,i,n,t):null;return[n,s]}var md=gd;var bd=gd;var wd=gd;var kd=gd;var Td={0:\"BEEP\",1:\"OPEN\",2:\"OPEN.LINKS\",3:\"CLOSE.ALL\",4:\"SAVE\",5:\"SAVE.AS\",6:\"FILE.DELETE\",7:\"PAGE.SETUP\",8:\"PRINT\",9:\"PRINTER.SETUP\",10:\"QUIT\",11:\"NEW.WINDOW\",12:\"ARRANGE.ALL\",13:\"WINDOW.SIZE\",14:\"WINDOW.MOVE\",15:\"FULL\",16:\"CLOSE\",17:\"RUN\",22:\"SET.PRINT.AREA\",23:\"SET.PRINT.TITLES\",24:\"SET.PAGE.BREAK\",25:\"REMOVE.PAGE.BREAK\",26:\"FONT\",27:\"DISPLAY\",28:\"PROTECT.DOCUMENT\",29:\"PRECISION\",30:\"A1.R1C1\",31:\"CALCULATE.NOW\",32:\"CALCULATION\",34:\"DATA.FIND\",35:\"EXTRACT\",36:\"DATA.DELETE\",37:\"SET.DATABASE\",38:\"SET.CRITERIA\",39:\"SORT\",40:\"DATA.SERIES\",41:\"TABLE\",42:\"FORMAT.NUMBER\",43:\"ALIGNMENT\",44:\"STYLE\",45:\"BORDER\",46:\"CELL.PROTECTION\",47:\"COLUMN.WIDTH\",48:\"UNDO\",49:\"CUT\",50:\"COPY\",51:\"PASTE\",52:\"CLEAR\",53:\"PASTE.SPECIAL\",54:\"EDIT.DELETE\",55:\"INSERT\",56:\"FILL.RIGHT\",57:\"FILL.DOWN\",61:\"DEFINE.NAME\",62:\"CREATE.NAMES\",63:\"FORMULA.GOTO\",64:\"FORMULA.FIND\",65:\"SELECT.LAST.CELL\",66:\"SHOW.ACTIVE.CELL\",67:\"GALLERY.AREA\",68:\"GALLERY.BAR\",69:\"GALLERY.COLUMN\",70:\"GALLERY.LINE\",71:\"GALLERY.PIE\",72:\"GALLERY.SCATTER\",73:\"COMBINATION\",74:\"PREFERRED\",75:\"ADD.OVERLAY\",76:\"GRIDLINES\",77:\"SET.PREFERRED\",78:\"AXES\",79:\"LEGEND\",80:\"ATTACH.TEXT\",81:\"ADD.ARROW\",82:\"SELECT.CHART\",83:\"SELECT.PLOT.AREA\",84:\"PATTERNS\",85:\"MAIN.CHART\",86:\"OVERLAY\",87:\"SCALE\",88:\"FORMAT.LEGEND\",89:\"FORMAT.TEXT\",90:\"EDIT.REPEAT\",91:\"PARSE\",92:\"JUSTIFY\",93:\"HIDE\",94:\"UNHIDE\",95:\"WORKSPACE\",96:\"FORMULA\",97:\"FORMULA.FILL\",98:\"FORMULA.ARRAY\",99:\"DATA.FIND.NEXT\",100:\"DATA.FIND.PREV\",101:\"FORMULA.FIND.NEXT\",102:\"FORMULA.FIND.PREV\",103:\"ACTIVATE\",104:\"ACTIVATE.NEXT\",105:\"ACTIVATE.PREV\",106:\"UNLOCKED.NEXT\",107:\"UNLOCKED.PREV\",108:\"COPY.PICTURE\",109:\"SELECT\",110:\"DELETE.NAME\",111:\"DELETE.FORMAT\",112:\"VLINE\",113:\"HLINE\",114:\"VPAGE\",115:\"HPAGE\",116:\"VSCROLL\",117:\"HSCROLL\",118:\"ALERT\",119:\"NEW\",120:\"CANCEL.COPY\",121:\"SHOW.CLIPBOARD\",122:\"MESSAGE\",124:\"PASTE.LINK\",125:\"APP.ACTIVATE\",126:\"DELETE.ARROW\",127:\"ROW.HEIGHT\",128:\"FORMAT.MOVE\",129:\"FORMAT.SIZE\",130:\"FORMULA.REPLACE\",131:\"SEND.KEYS\",132:\"SELECT.SPECIAL\",133:\"APPLY.NAMES\",134:\"REPLACE.FONT\",135:\"FREEZE.PANES\",136:\"SHOW.INFO\",137:\"SPLIT\",138:\"ON.WINDOW\",139:\"ON.DATA\",140:\"DISABLE.INPUT\",142:\"OUTLINE\",143:\"LIST.NAMES\",144:\"FILE.CLOSE\",145:\"SAVE.WORKBOOK\",146:\"DATA.FORM\",147:\"COPY.CHART\",148:\"ON.TIME\",149:\"WAIT\",150:\"FORMAT.FONT\",151:\"FILL.UP\",152:\"FILL.LEFT\",153:\"DELETE.OVERLAY\",155:\"SHORT.MENUS\",159:\"SET.UPDATE.STATUS\",161:\"COLOR.PALETTE\",162:\"DELETE.STYLE\",163:\"WINDOW.RESTORE\",164:\"WINDOW.MAXIMIZE\",166:\"CHANGE.LINK\",167:\"CALCULATE.DOCUMENT\",168:\"ON.KEY\",169:\"APP.RESTORE\",170:\"APP.MOVE\",171:\"APP.SIZE\",172:\"APP.MINIMIZE\",173:\"APP.MAXIMIZE\",174:\"BRING.TO.FRONT\",175:\"SEND.TO.BACK\",185:\"MAIN.CHART.TYPE\",186:\"OVERLAY.CHART.TYPE\",187:\"SELECT.END\",188:\"OPEN.MAIL\",189:\"SEND.MAIL\",190:\"STANDARD.FONT\",191:\"CONSOLIDATE\",192:\"SORT.SPECIAL\",193:\"GALLERY.3D.AREA\",194:\"GALLERY.3D.COLUMN\",195:\"GALLERY.3D.LINE\",196:\"GALLERY.3D.PIE\",197:\"VIEW.3D\",198:\"GOAL.SEEK\",199:\"WORKGROUP\",200:\"FILL.GROUP\",201:\"UPDATE.LINK\",202:\"PROMOTE\",203:\"DEMOTE\",204:\"SHOW.DETAIL\",206:\"UNGROUP\",207:\"OBJECT.PROPERTIES\",208:\"SAVE.NEW.OBJECT\",209:\"SHARE\",210:\"SHARE.NAME\",211:\"DUPLICATE\",212:\"APPLY.STYLE\",213:\"ASSIGN.TO.OBJECT\",214:\"OBJECT.PROTECTION\",215:\"HIDE.OBJECT\",216:\"SET.EXTRACT\",217:\"CREATE.PUBLISHER\",218:\"SUBSCRIBE.TO\",219:\"ATTRIBUTES\",220:\"SHOW.TOOLBAR\",222:\"PRINT.PREVIEW\",223:\"EDIT.COLOR\",224:\"SHOW.LEVELS\",225:\"FORMAT.MAIN\",226:\"FORMAT.OVERLAY\",227:\"ON.RECALC\",228:\"EDIT.SERIES\",229:\"DEFINE.STYLE\",240:\"LINE.PRINT\",243:\"ENTER.DATA\",249:\"GALLERY.RADAR\",250:\"MERGE.STYLES\",251:\"EDITION.OPTIONS\",252:\"PASTE.PICTURE\",253:\"PASTE.PICTURE.LINK\",254:\"SPELLING\",256:\"ZOOM\",259:\"INSERT.OBJECT\",260:\"WINDOW.MINIMIZE\",265:\"SOUND.NOTE\",266:\"SOUND.PLAY\",267:\"FORMAT.SHAPE\",268:\"EXTEND.POLYGON\",269:\"FORMAT.AUTO\",272:\"GALLERY.3D.BAR\",273:\"GALLERY.3D.SURFACE\",274:\"FILL.AUTO\",276:\"CUSTOMIZE.TOOLBAR\",277:\"ADD.TOOL\",278:\"EDIT.OBJECT\",279:\"ON.DOUBLECLICK\",280:\"ON.ENTRY\",281:\"WORKBOOK.ADD\",282:\"WORKBOOK.MOVE\",283:\"WORKBOOK.COPY\",284:\"WORKBOOK.OPTIONS\",285:\"SAVE.WORKSPACE\",288:\"CHART.WIZARD\",289:\"DELETE.TOOL\",290:\"MOVE.TOOL\",291:\"WORKBOOK.SELECT\",292:\"WORKBOOK.ACTIVATE\",293:\"ASSIGN.TO.TOOL\",295:\"COPY.TOOL\",296:\"RESET.TOOL\",297:\"CONSTRAIN.NUMERIC\",298:\"PASTE.TOOL\",302:\"WORKBOOK.NEW\",305:\"SCENARIO.CELLS\",306:\"SCENARIO.DELETE\",307:\"SCENARIO.ADD\",308:\"SCENARIO.EDIT\",309:\"SCENARIO.SHOW\",310:\"SCENARIO.SHOW.NEXT\",311:\"SCENARIO.SUMMARY\",312:\"PIVOT.TABLE.WIZARD\",313:\"PIVOT.FIELD.PROPERTIES\",314:\"PIVOT.FIELD\",315:\"PIVOT.ITEM\",316:\"PIVOT.ADD.FIELDS\",318:\"OPTIONS.CALCULATION\",319:\"OPTIONS.EDIT\",320:\"OPTIONS.VIEW\",321:\"ADDIN.MANAGER\",322:\"MENU.EDITOR\",323:\"ATTACH.TOOLBARS\",324:\"VBAActivate\",325:\"OPTIONS.CHART\",328:\"VBA.INSERT.FILE\",330:\"VBA.PROCEDURE.DEFINITION\",336:\"ROUTING.SLIP\",338:\"ROUTE.DOCUMENT\",339:\"MAIL.LOGON\",342:\"INSERT.PICTURE\",343:\"EDIT.TOOL\",344:\"GALLERY.DOUGHNUT\",350:\"CHART.TREND\",352:\"PIVOT.ITEM.PROPERTIES\",354:\"WORKBOOK.INSERT\",355:\"OPTIONS.TRANSITION\",356:\"OPTIONS.GENERAL\",370:\"FILTER.ADVANCED\",373:\"MAIL.ADD.MAILER\",374:\"MAIL.DELETE.MAILER\",375:\"MAIL.REPLY\",376:\"MAIL.REPLY.ALL\",377:\"MAIL.FORWARD\",378:\"MAIL.NEXT.LETTER\",379:\"DATA.LABEL\",380:\"INSERT.TITLE\",381:\"FONT.PROPERTIES\",382:\"MACRO.OPTIONS\",383:\"WORKBOOK.HIDE\",384:\"WORKBOOK.UNHIDE\",385:\"WORKBOOK.DELETE\",386:\"WORKBOOK.NAME\",388:\"GALLERY.CUSTOM\",390:\"ADD.CHART.AUTOFORMAT\",391:\"DELETE.CHART.AUTOFORMAT\",392:\"CHART.ADD.DATA\",393:\"AUTO.OUTLINE\",394:\"TAB.ORDER\",395:\"SHOW.DIALOG\",396:\"SELECT.ALL\",397:\"UNGROUP.SHEETS\",398:\"SUBTOTAL.CREATE\",399:\"SUBTOTAL.REMOVE\",400:\"RENAME.OBJECT\",412:\"WORKBOOK.SCROLL\",413:\"WORKBOOK.NEXT\",414:\"WORKBOOK.PREV\",415:\"WORKBOOK.TAB.SPLIT\",416:\"FULL.SCREEN\",417:\"WORKBOOK.PROTECT\",420:\"SCROLLBAR.PROPERTIES\",421:\"PIVOT.SHOW.PAGES\",422:\"TEXT.TO.COLUMNS\",423:\"FORMAT.CHARTTYPE\",424:\"LINK.FORMAT\",425:\"TRACER.DISPLAY\",430:\"TRACER.NAVIGATE\",431:\"TRACER.CLEAR\",432:\"TRACER.ERROR\",433:\"PIVOT.FIELD.GROUP\",434:\"PIVOT.FIELD.UNGROUP\",435:\"CHECKBOX.PROPERTIES\",436:\"LABEL.PROPERTIES\",437:\"LISTBOX.PROPERTIES\",438:\"EDITBOX.PROPERTIES\",439:\"PIVOT.REFRESH\",440:\"LINK.COMBO\",441:\"OPEN.TEXT\",442:\"HIDE.DIALOG\",443:\"SET.DIALOG.FOCUS\",444:\"ENABLE.OBJECT\",445:\"PUSHBUTTON.PROPERTIES\",446:\"SET.DIALOG.DEFAULT\",447:\"FILTER\",448:\"FILTER.SHOW.ALL\",449:\"CLEAR.OUTLINE\",450:\"FUNCTION.WIZARD\",451:\"ADD.LIST.ITEM\",452:\"SET.LIST.ITEM\",453:\"REMOVE.LIST.ITEM\",454:\"SELECT.LIST.ITEM\",455:\"SET.CONTROL.VALUE\",456:\"SAVE.COPY.AS\",458:\"OPTIONS.LISTS.ADD\",459:\"OPTIONS.LISTS.DELETE\",460:\"SERIES.AXES\",461:\"SERIES.X\",462:\"SERIES.Y\",463:\"ERRORBAR.X\",464:\"ERRORBAR.Y\",465:\"FORMAT.CHART\",466:\"SERIES.ORDER\",467:\"MAIL.LOGOFF\",468:\"CLEAR.ROUTING.SLIP\",469:\"APP.ACTIVATE.MICROSOFT\",470:\"MAIL.EDIT.MAILER\",471:\"ON.SHEET\",472:\"STANDARD.WIDTH\",473:\"SCENARIO.MERGE\",474:\"SUMMARY.INFO\",475:\"FIND.FILE\",476:\"ACTIVE.CELL.FONT\",477:\"ENABLE.TIPWIZARD\",478:\"VBA.MAKE.ADDIN\",480:\"INSERTDATATABLE\",481:\"WORKGROUP.OPTIONS\",482:\"MAIL.SEND.MAILER\",485:\"AUTOCORRECT\",489:\"POST.DOCUMENT\",491:\"PICKLIST\",493:\"VIEW.SHOW\",494:\"VIEW.DEFINE\",495:\"VIEW.DELETE\",509:\"SHEET.BACKGROUND\",510:\"INSERT.MAP.OBJECT\",511:\"OPTIONS.MENONO\",517:\"MSOCHECKS\",518:\"NORMAL\",519:\"LAYOUT\",520:\"RM.PRINT.AREA\",521:\"CLEAR.PRINT.AREA\",522:\"ADD.PRINT.AREA\",523:\"MOVE.BRK\",545:\"HIDECURR.NOTE\",546:\"HIDEALL.NOTES\",547:\"DELETE.NOTE\",548:\"TRAVERSE.NOTES\",549:\"ACTIVATE.NOTES\",620:\"PROTECT.REVISIONS\",621:\"UNPROTECT.REVISIONS\",647:\"OPTIONS.ME\",653:\"WEB.PUBLISH\",667:\"NEWWEBQUERY\",673:\"PIVOT.TABLE.CHART\",753:\"OPTIONS.SAVE\",755:\"OPTIONS.SPELL\",808:\"HIDEALL.INKANNOTS\"};var Ad={0:\"COUNT\",1:\"IF\",2:\"ISNA\",3:\"ISERROR\",4:\"SUM\",5:\"AVERAGE\",6:\"MIN\",7:\"MAX\",8:\"ROW\",9:\"COLUMN\",10:\"NA\",11:\"NPV\",12:\"STDEV\",13:\"DOLLAR\",14:\"FIXED\",15:\"SIN\",16:\"COS\",17:\"TAN\",18:\"ATAN\",19:\"PI\",20:\"SQRT\",21:\"EXP\",22:\"LN\",23:\"LOG10\",24:\"ABS\",25:\"INT\",26:\"SIGN\",27:\"ROUND\",28:\"LOOKUP\",29:\"INDEX\",30:\"REPT\",31:\"MID\",32:\"LEN\",33:\"VALUE\",34:\"TRUE\",35:\"FALSE\",36:\"AND\",37:\"OR\",38:\"NOT\",39:\"MOD\",40:\"DCOUNT\",41:\"DSUM\",42:\"DAVERAGE\",43:\"DMIN\",44:\"DMAX\",45:\"DSTDEV\",46:\"VAR\",47:\"DVAR\",48:\"TEXT\",49:\"LINEST\",50:\"TREND\",51:\"LOGEST\",52:\"GROWTH\",53:\"GOTO\",54:\"HALT\",55:\"RETURN\",56:\"PV\",57:\"FV\",58:\"NPER\",59:\"PMT\",60:\"RATE\",61:\"MIRR\",62:\"IRR\",63:\"RAND\",64:\"MATCH\",65:\"DATE\",66:\"TIME\",67:\"DAY\",68:\"MONTH\",69:\"YEAR\",70:\"WEEKDAY\",71:\"HOUR\",72:\"MINUTE\",73:\"SECOND\",74:\"NOW\",75:\"AREAS\",76:\"ROWS\",77:\"COLUMNS\",78:\"OFFSET\",79:\"ABSREF\",80:\"RELREF\",81:\"ARGUMENT\",82:\"SEARCH\",83:\"TRANSPOSE\",84:\"ERROR\",85:\"STEP\",86:\"TYPE\",87:\"ECHO\",88:\"SET.NAME\",89:\"CALLER\",90:\"DEREF\",91:\"WINDOWS\",92:\"SERIES\",93:\"DOCUMENTS\",94:\"ACTIVE.CELL\",95:\"SELECTION\",96:\"RESULT\",97:\"ATAN2\",98:\"ASIN\",99:\"ACOS\",100:\"CHOOSE\",101:\"HLOOKUP\",102:\"VLOOKUP\",103:\"LINKS\",104:\"INPUT\",105:\"ISREF\",106:\"GET.FORMULA\",107:\"GET.NAME\",108:\"SET.VALUE\",109:\"LOG\",110:\"EXEC\",111:\"CHAR\",112:\"LOWER\",113:\"UPPER\",114:\"PROPER\",115:\"LEFT\",116:\"RIGHT\",117:\"EXACT\",118:\"TRIM\",119:\"REPLACE\",120:\"SUBSTITUTE\",121:\"CODE\",122:\"NAMES\",123:\"DIRECTORY\",124:\"FIND\",125:\"CELL\",126:\"ISERR\",127:\"ISTEXT\",128:\"ISNUMBER\",129:\"ISBLANK\",130:\"T\",131:\"N\",132:\"FOPEN\",133:\"FCLOSE\",134:\"FSIZE\",135:\"FREADLN\",136:\"FREAD\",137:\"FWRITELN\",138:\"FWRITE\",139:\"FPOS\",140:\"DATEVALUE\",141:\"TIMEVALUE\",142:\"SLN\",143:\"SYD\",144:\"DDB\",145:\"GET.DEF\",146:\"REFTEXT\",147:\"TEXTREF\",148:\"INDIRECT\",149:\"REGISTER\",150:\"CALL\",151:\"ADD.BAR\",152:\"ADD.MENU\",153:\"ADD.COMMAND\",154:\"ENABLE.COMMAND\",155:\"CHECK.COMMAND\",156:\"RENAME.COMMAND\",157:\"SHOW.BAR\",158:\"DELETE.MENU\",159:\"DELETE.COMMAND\",160:\"GET.CHART.ITEM\",161:\"DIALOG.BOX\",162:\"CLEAN\",163:\"MDETERM\",164:\"MINVERSE\",165:\"MMULT\",166:\"FILES\",167:\"IPMT\",168:\"PPMT\",169:\"COUNTA\",170:\"CANCEL.KEY\",171:\"FOR\",172:\"WHILE\",173:\"BREAK\",174:\"NEXT\",175:\"INITIATE\",176:\"REQUEST\",177:\"POKE\",178:\"EXECUTE\",179:\"TERMINATE\",180:\"RESTART\",181:\"HELP\",182:\"GET.BAR\",183:\"PRODUCT\",184:\"FACT\",185:\"GET.CELL\",186:\"GET.WORKSPACE\",187:\"GET.WINDOW\",188:\"GET.DOCUMENT\",189:\"DPRODUCT\",190:\"ISNONTEXT\",191:\"GET.NOTE\",192:\"NOTE\",193:\"STDEVP\",194:\"VARP\",195:\"DSTDEVP\",196:\"DVARP\",197:\"TRUNC\",198:\"ISLOGICAL\",199:\"DCOUNTA\",200:\"DELETE.BAR\",201:\"UNREGISTER\",204:\"USDOLLAR\",205:\"FINDB\",206:\"SEARCHB\",207:\"REPLACEB\",208:\"LEFTB\",209:\"RIGHTB\",210:\"MIDB\",211:\"LENB\",212:\"ROUNDUP\",213:\"ROUNDDOWN\",214:\"ASC\",215:\"DBCS\",216:\"RANK\",219:\"ADDRESS\",220:\"DAYS360\",221:\"TODAY\",222:\"VDB\",223:\"ELSE\",224:\"ELSE.IF\",225:\"END.IF\",226:\"FOR.CELL\",227:\"MEDIAN\",228:\"SUMPRODUCT\",229:\"SINH\",230:\"COSH\",231:\"TANH\",232:\"ASINH\",233:\"ACOSH\",234:\"ATANH\",235:\"DGET\",236:\"CREATE.OBJECT\",237:\"VOLATILE\",238:\"LAST.ERROR\",239:\"CUSTOM.UNDO\",240:\"CUSTOM.REPEAT\",241:\"FORMULA.CONVERT\",242:\"GET.LINK.INFO\",243:\"TEXT.BOX\",244:\"INFO\",245:\"GROUP\",246:\"GET.OBJECT\",247:\"DB\",248:\"PAUSE\",251:\"RESUME\",252:\"FREQUENCY\",253:\"ADD.TOOLBAR\",254:\"DELETE.TOOLBAR\",255:\"User\",256:\"RESET.TOOLBAR\",257:\"EVALUATE\",258:\"GET.TOOLBAR\",259:\"GET.TOOL\",260:\"SPELLING.CHECK\",261:\"ERROR.TYPE\",262:\"APP.TITLE\",263:\"WINDOW.TITLE\",264:\"SAVE.TOOLBAR\",265:\"ENABLE.TOOL\",266:\"PRESS.TOOL\",267:\"REGISTER.ID\",268:\"GET.WORKBOOK\",269:\"AVEDEV\",270:\"BETADIST\",271:\"GAMMALN\",272:\"BETAINV\",273:\"BINOMDIST\",274:\"CHIDIST\",275:\"CHIINV\",276:\"COMBIN\",277:\"CONFIDENCE\",278:\"CRITBINOM\",279:\"EVEN\",280:\"EXPONDIST\",281:\"FDIST\",282:\"FINV\",283:\"FISHER\",284:\"FISHERINV\",285:\"FLOOR\",286:\"GAMMADIST\",287:\"GAMMAINV\",288:\"CEILING\",289:\"HYPGEOMDIST\",290:\"LOGNORMDIST\",291:\"LOGINV\",292:\"NEGBINOMDIST\",293:\"NORMDIST\",294:\"NORMSDIST\",295:\"NORMINV\",296:\"NORMSINV\",297:\"STANDARDIZE\",298:\"ODD\",299:\"PERMUT\",300:\"POISSON\",301:\"TDIST\",302:\"WEIBULL\",303:\"SUMXMY2\",304:\"SUMX2MY2\",305:\"SUMX2PY2\",306:\"CHITEST\",307:\"CORREL\",308:\"COVAR\",309:\"FORECAST\",310:\"FTEST\",311:\"INTERCEPT\",312:\"PEARSON\",313:\"RSQ\",314:\"STEYX\",315:\"SLOPE\",316:\"TTEST\",317:\"PROB\",318:\"DEVSQ\",319:\"GEOMEAN\",320:\"HARMEAN\",321:\"SUMSQ\",322:\"KURT\",323:\"SKEW\",324:\"ZTEST\",325:\"LARGE\",326:\"SMALL\",327:\"QUARTILE\",328:\"PERCENTILE\",329:\"PERCENTRANK\",330:\"MODE\",331:\"TRIMMEAN\",332:\"TINV\",334:\"MOVIE.COMMAND\",335:\"GET.MOVIE\",336:\"CONCATENATE\",337:\"POWER\",338:\"PIVOT.ADD.DATA\",339:\"GET.PIVOT.TABLE\",340:\"GET.PIVOT.FIELD\",341:\"GET.PIVOT.ITEM\",342:\"RADIANS\",343:\"DEGREES\",344:\"SUBTOTAL\",345:\"SUMIF\",346:\"COUNTIF\",347:\"COUNTBLANK\",348:\"SCENARIO.GET\",349:\"OPTIONS.LISTS.GET\",350:\"ISPMT\",351:\"DATEDIF\",352:\"DATESTRING\",353:\"NUMBERSTRING\",354:\"ROMAN\",355:\"OPEN.DIALOG\",356:\"SAVE.DIALOG\",357:\"VIEW.GET\",358:\"GETPIVOTDATA\",359:\"HYPERLINK\",360:\"PHONETIC\",361:\"AVERAGEA\",362:\"MAXA\",363:\"MINA\",364:\"STDEVPA\",365:\"VARPA\",366:\"STDEVA\",367:\"VARA\",368:\"BAHTTEXT\",369:\"THAIDAYOFWEEK\",370:\"THAIDIGIT\",371:\"THAIMONTHOFYEAR\",372:\"THAINUMSOUND\",373:\"THAINUMSTRING\",374:\"THAISTRINGLENGTH\",375:\"ISTHAIDIGIT\",376:\"ROUNDBAHTDOWN\",377:\"ROUNDBAHTUP\",378:\"THAIYEAR\",379:\"RTD\",380:\"CUBEVALUE\",381:\"CUBEMEMBER\",382:\"CUBEMEMBERPROPERTY\",383:\"CUBERANKEDMEMBER\",384:\"HEX2BIN\",385:\"HEX2DEC\",386:\"HEX2OCT\",387:\"DEC2BIN\",388:\"DEC2HEX\",389:\"DEC2OCT\",390:\"OCT2BIN\",391:\"OCT2HEX\",392:\"OCT2DEC\",393:\"BIN2DEC\",394:\"BIN2OCT\",395:\"BIN2HEX\",396:\"IMSUB\",397:\"IMDIV\",398:\"IMPOWER\",399:\"IMABS\",400:\"IMSQRT\",401:\"IMLN\",402:\"IMLOG2\",403:\"IMLOG10\",404:\"IMSIN\",405:\"IMCOS\",406:\"IMEXP\",407:\"IMARGUMENT\",408:\"IMCONJUGATE\",409:\"IMAGINARY\",410:\"IMREAL\",411:\"COMPLEX\",412:\"IMSUM\",413:\"IMPRODUCT\",414:\"SERIESSUM\",415:\"FACTDOUBLE\",416:\"SQRTPI\",417:\"QUOTIENT\",418:\"DELTA\",419:\"GESTEP\",420:\"ISEVEN\",421:\"ISODD\",422:\"MROUND\",423:\"ERF\",424:\"ERFC\",425:\"BESSELJ\",426:\"BESSELK\",427:\"BESSELY\",428:\"BESSELI\",429:\"XIRR\",430:\"XNPV\",431:\"PRICEMAT\",432:\"YIELDMAT\",433:\"INTRATE\",434:\"RECEIVED\",435:\"DISC\",436:\"PRICEDISC\",437:\"YIELDDISC\",438:\"TBILLEQ\",439:\"TBILLPRICE\",440:\"TBILLYIELD\",441:\"PRICE\",442:\"YIELD\",443:\"DOLLARDE\",444:\"DOLLARFR\",445:\"NOMINAL\",446:\"EFFECT\",447:\"CUMPRINC\",448:\"CUMIPMT\",449:\"EDATE\",450:\"EOMONTH\",451:\"YEARFRAC\",452:\"COUPDAYBS\",453:\"COUPDAYS\",454:\"COUPDAYSNC\",455:\"COUPNCD\",456:\"COUPNUM\",457:\"COUPPCD\",458:\"DURATION\",459:\"MDURATION\",460:\"ODDLPRICE\",461:\"ODDLYIELD\",462:\"ODDFPRICE\",463:\"ODDFYIELD\",464:\"RANDBETWEEN\",465:\"WEEKNUM\",466:\"AMORDEGRC\",467:\"AMORLINC\",468:\"CONVERT\",724:\"SHEETJS\",469:\"ACCRINT\",470:\"ACCRINTM\",471:\"WORKDAY\",472:\"NETWORKDAYS\",473:\"GCD\",474:\"MULTINOMIAL\",475:\"LCM\",476:\"FVSCHEDULE\",477:\"CUBEKPIMEMBER\",478:\"CUBESET\",479:\"CUBESETCOUNT\",480:\"IFERROR\",481:\"COUNTIFS\",482:\"SUMIFS\",483:\"AVERAGEIF\",484:\"AVERAGEIFS\"};var Ed={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cd(e){if(e.slice(0,3)==\"of:\")e=e.slice(3);if(e.charCodeAt(0)==61){e=e.slice(1);if(e.charCodeAt(0)==61)e=e.slice(1)}e=e.replace(/COM\\.MICROSOFT\\./g,\"\");e=e.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g,function(e,r){return r.replace(/\\./g,\"\")});e=e.replace(/\\[.(#[A-Z]*[?!])\\]/g,\"$1\");return e.replace(/[;~]/g,\",\").replace(/\\|/g,\";\")}function yd(e){var r=\"of:=\"+e.replace(_h,\"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");return r.replace(/;/g,\"|\").replace(/,/g,\";\")}function Sd(e){var r=e.split(\":\");var t=r[0].split(\".\")[0];return[t,r[0].split(\".\")[1]+(r.length>1?\":\"+(r[1].split(\".\")[1]||r[1].split(\".\")[0]):\"\")]}function _d(e){return e.replace(/\\./,\"!\")}var xd={};var Od={};var Rd=typeof Map!==\"undefined\";function Id(e,r,t){var a=0,n=e.length;if(t){if(Rd?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){var i=Rd?t.get(r):t[r];for(;a<i.length;++a){if(e[i[a]].t===r){e.Count++;return i[a]}}}}else for(;a<n;++a){if(e[a].t===r){e.Count++;return a}}e[n]={t:r};e.Count++;e.Unique++;if(t){if(Rd){if(!t.has(r))t.set(r,[]);t.get(r).push(n)}else{if(!Object.prototype.hasOwnProperty.call(t,r))t[r]=[];t[r].push(n)}}return n}function Nd(e,r){var t={min:e+1,max:e+1};var a=-1;if(r.MDW)yl=r.MDW;if(r.width!=null)t.customWidth=1;else if(r.wpx!=null)a=_l(r.wpx);else if(r.wch!=null)a=r.wch;if(a>-1){t.width=xl(a);t.customWidth=1}else if(r.width!=null)t.width=r.width;if(r.hidden)t.hidden=true;if(r.level!=null){t.outlineLevel=t.level=r.level}return t}function Dd(e,r){if(!e)return;var t=[.7,.7,.75,.75,.3,.3];if(r==\"xlml\")t=[1,1,1,1,.5,.5];if(e.left==null)e.left=t[0];if(e.right==null)e.right=t[1];if(e.top==null)e.top=t[2];if(e.bottom==null)e.bottom=t[3];if(e.header==null)e.header=t[4];if(e.footer==null)e.footer=t[5]}function Fd(e,r,t){var a=t.revssf[r.z!=null?r.z:\"General\"];var n=60,i=e.length;if(a==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){We(r.z,n);t.ssf[n]=r.z;t.revssf[r.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1};return i}function Pd(e,r,t,a,n,i){try{if(a.cellNF)e.z=X[r]}catch(s){if(a.WTF)throw s}if(e.t===\"z\"&&!a.cellStyles)return;if(e.t===\"d\"&&typeof e.v===\"string\")e.v=gr(e.v);if((!a||a.cellText!==false)&&e.t!==\"z\")try{if(X[r]==null)We(Ge[r]||\"General\",r);if(e.t===\"e\")e.w=e.w||Gn[e.v];else if(r===0){if(e.t===\"n\"){if((e.v|0)===e.v)e.w=e.v.toString(10);else e.w=se(e.v)}else if(e.t===\"d\"){var f=fr(e.v);if((f|0)===f)e.w=f.toString(10);else e.w=se(f)}else if(e.v===undefined)return\"\";else e.w=fe(e.v,Od)}else if(e.t===\"d\")e.w=Be(r,fr(e.v),Od);else e.w=Be(r,e.v,Od)}catch(s){if(a.WTF)throw s}if(!a.cellStyles)return;if(t!=null)try{e.s=i.Fills[t];if(e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb){e.s.fgColor.rgb=Tl(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0);if(a.WTF)e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb}if(e.s.bgColor&&e.s.bgColor.theme){e.s.bgColor.rgb=Tl(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0);if(a.WTF)e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb}}catch(s){if(a.WTF&&i.Fills)throw s}}function Ld(e,r,t){if(e&&e[\"!ref\"]){var a=Da(e[\"!ref\"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error(\"Bad range (\"+t+\"): \"+e[\"!ref\"])}}function Md(e,r){var t=Da(r);if(t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0)e[\"!ref\"]=Na(t)}var Ud=/<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;var Bd=/<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;var Wd=/<(?:\\w:)?hyperlink [^>]*>/gm;var Hd=/\"(\\w*:\\w*)\"/;var zd=/<(?:\\w:)?col\\b[^>]*[\\/]?>/g;var Vd=/<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;var Gd=/<(?:\\w:)?pageMargins[^>]*\\/>/g;var jd=/<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;var Xd=/<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;var $d=/<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;function Yd(e,r,t,a,n,i,s){if(!e)return e;if(!a)a={\"!id\":{}};if(g!=null&&r.dense==null)r.dense=g;var f=r.dense?[]:{};var o={s:{r:2e6,c:2e6},e:{r:0,c:0}};var l=\"\",c=\"\";var h=e.match(Bd);if(h){l=e.slice(0,h.index);c=e.slice(h.index+h[0].length)}else l=c=e;var u=l.match(jd);if(u)Jd(u[0],f,n,t);else if(u=l.match(Xd))qd(u[0],u[1]||\"\",f,n,t,s,i);var d=(l.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=l.slice(d,d+50).match(Hd);if(v)Md(f,v[1])}var p=l.match($d);if(p&&p[1])cv(p[1],n);var m=[];if(r.cellStyles){var b=l.match(zd);if(b)iv(m,b)}if(h)dv(h[1],f,r,o,i,s);var w=c.match(Vd);if(w)f[\"!autofilter\"]=fv(w[0]);var k=[];var T=c.match(Ud);if(T)for(d=0;d!=T.length;++d)k[d]=Da(T[d].slice(T[d].indexOf('\"')+1));var A=c.match(Wd);if(A)tv(f,A,a);var E=c.match(Gd);if(E)f[\"!margins\"]=av(Gr(E[0]));if(!f[\"!ref\"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r)f[\"!ref\"]=Na(o);if(r.sheetRows>0&&f[\"!ref\"]){var C=Da(f[\"!ref\"]);if(r.sheetRows<=+C.e.r){C.e.r=r.sheetRows-1;if(C.e.r>o.e.r)C.e.r=o.e.r;if(C.e.r<C.s.r)C.s.r=C.e.r;if(C.e.c>o.e.c)C.e.c=o.e.c;if(C.e.c<C.s.c)C.s.c=C.e.c;f[\"!fullref\"]=f[\"!ref\"];f[\"!ref\"]=Na(C)}}if(m.length>0)f[\"!cols\"]=m;if(k.length>0)f[\"!merges\"]=k;return f}function Kd(e){if(e.length===0)return\"\";var r='<mergeCells count=\"'+e.length+'\">';for(var t=0;t!=e.length;++t)r+='<mergeCell ref=\"'+Na(e[t])+'\"/>';return r+\"</mergeCells>\"}function Jd(e,r,t,a){var n=Gr(e);if(!t.Sheets[a])t.Sheets[a]={};if(n.codeName)t.Sheets[a].CodeName=Yr(lt(n.codeName))}function qd(e,r,t,a,n){Jd(e.slice(0,e.indexOf(\">\")),t,a,n)}function Zd(e,r,t,a,n){var i=false;var s={},f=null;if(a.bookType!==\"xlsx\"&&r.vbaraw){var o=r.SheetNames[t];try{if(r.Workbook)o=r.Workbook.Sheets[t].CodeName||o}catch(l){}i=true;s.codeName=ct(qr(o))}if(e&&e[\"!outline\"]){var c={summaryBelow:1,summaryRight:1};if(e[\"!outline\"].above)c.summaryBelow=0;if(e[\"!outline\"].left)c.summaryRight=0;f=(f||\"\")+kt(\"outlinePr\",null,c)}if(!i&&!f)return;n[n.length]=kt(\"sheetPr\",f,s)}var Qd=[\"objects\",\"scenarios\",\"selectLockedCells\",\"selectUnlockedCells\"];var ev=[\"formatColumns\",\"formatRows\",\"formatCells\",\"insertColumns\",\"insertRows\",\"insertHyperlinks\",\"deleteColumns\",\"deleteRows\",\"sort\",\"autoFilter\",\"pivotTables\"];function rv(e){var r={sheet:1};Qd.forEach(function(t){if(e[t]!=null&&e[t])r[t]=\"1\"});ev.forEach(function(t){if(e[t]!=null&&!e[t])r[t]=\"0\"});if(e.password)r.password=ll(e.password).toString(16).toUpperCase();return kt(\"sheetProtection\",null,r)}function tv(e,r,t){var a=Array.isArray(e);for(var n=0;n!=r.length;++n){var i=Gr(lt(r[n]),true);if(!i.ref)return;var s=((t||{})[\"!id\"]||[])[i.id];if(s){i.Target=s.Target;if(i.location)i.Target+=\"#\"+Yr(i.location)}else{i.Target=\"#\"+Yr(i.location);s={Target:i.Target,TargetMode:\"Internal\"}}i.Rel=s;if(i.tooltip){i.Tooltip=i.tooltip;delete i.tooltip}var f=Da(i.ref);for(var o=f.s.r;o<=f.e.r;++o)for(var l=f.s.c;l<=f.e.c;++l){var c=Ra({c:l,r:o});if(a){if(!e[o])e[o]=[];if(!e[o][l])e[o][l]={t:\"z\",v:undefined};e[o][l].l=i}else{if(!e[c])e[c]={t:\"z\",v:undefined};e[c].l=i}}}}function av(e){var r={};[\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"].forEach(function(t){if(e[t])r[t]=parseFloat(e[t])});return r}function nv(e){Dd(e);return kt(\"pageMargins\",null,e)}function iv(e,r){var t=false;for(var a=0;a!=r.length;++a){var n=Gr(r[a],true);if(n.hidden)n.hidden=nt(n.hidden);var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;if(n.outlineLevel)n.level=+n.outlineLevel||0;delete n.min;delete n.max;n.width=+n.width;if(!t&&n.width){t=true;Rl(n.width)}Il(n);while(i<=s)e[i++]=br(n)}}function sv(e,r){var t=[\"<cols>\"],a;for(var n=0;n!=r.length;++n){if(!(a=r[n]))continue;t[t.length]=kt(\"col\",null,Nd(n,a))}t[t.length]=\"</cols>\";return t.join(\"\")}function fv(e){var r={ref:(e.match(/ref=\"([^\"]*)\"/)||[])[1]};return r}function ov(e,r,t,a){var n=typeof e.ref==\"string\"?e.ref:Na(e.ref);if(!t.Workbook)t.Workbook={Sheets:[]};if(!t.Workbook.Names)t.Workbook.Names=[];var i=t.Workbook.Names;var s=Ia(n);if(s.s.r==s.e.r){s.e.r=Ia(r[\"!ref\"]).e.r;n=Na(s)}for(var f=0;f<i.length;++f){var o=i[f];if(o.Name!=\"_xlnm._FilterDatabase\")continue;if(o.Sheet!=a)continue;o.Ref=\"'\"+t.SheetNames[a]+\"'!\"+n;break}if(f==i.length)i.push({Name:\"_xlnm._FilterDatabase\",Sheet:a,Ref:\"'\"+t.SheetNames[a]+\"'!\"+n});return kt(\"autoFilter\",null,{ref:n})}var lv=/<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;function cv(e,r){if(!r.Views)r.Views=[{}];(e.match(lv)||[]).forEach(function(e,t){var a=Gr(e);if(!r.Views[t])r.Views[t]={};if(+a.zoomScale)r.Views[t].zoom=+a.zoomScale;if(nt(a.rightToLeft))r.Views[t].RTL=true})}function hv(e,r,t,a){var n={workbookViewId:\"0\"};if((((a||{}).Workbook||{}).Views||[])[0])n.rightToLeft=a.Workbook.Views[0].RTL?\"1\":\"0\";return kt(\"sheetViews\",kt(\"sheetView\",null,n),{})}function uv(e,r,t,a){if(e.c)t[\"!comments\"].push([r,e.c]);if(e.v===undefined&&typeof e.f!==\"string\"||e.t===\"z\"&&!e.f)return\"\";var n=\"\";var i=e.t,s=e.v;if(e.t!==\"z\")switch(e.t){case\"b\":n=e.v?\"1\":\"0\";break;case\"n\":n=\"\"+e.v;break;case\"e\":n=Gn[e.v];break;case\"d\":if(a&&a.cellDates)n=gr(e.v,-1).toISOString();else{e=br(e);e.t=\"n\";n=\"\"+(e.v=fr(gr(e.v)))}if(typeof e.z===\"undefined\")e.z=X[14];break;default:n=e.v;break;}var f=bt(\"v\",qr(n)),o={r:r};var l=Fd(a.cellXfs,e,a);if(l!==0)o.s=l;switch(e.t){case\"n\":break;case\"d\":o.t=\"d\";break;case\"b\":o.t=\"b\";break;case\"e\":o.t=\"e\";break;case\"z\":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error(\"Text length must not exceed 32767 characters\");if(a&&a.bookSST){f=bt(\"v\",\"\"+Id(a.Strings,e.v,a.revStrings));o.t=\"s\";break}o.t=\"str\";break;}if(e.t!=i){e.t=i;e.v=s}if(typeof e.f==\"string\"&&e.f){var c=e.F&&e.F.slice(0,r.length)==r?{t:\"array\",ref:e.F}:null;f=kt(\"f\",qr(e.f),c)+(e.v!=null?f:\"\")}if(e.l)t[\"!links\"].push([r,e.l]);if(e.D)o.cm=1;return kt(\"c\",f,o)}var dv=function(){var e=/<(?:\\w+:)?c[ \\/>]/,r=/<\\/(?:\\w+:)?row>/;var t=/r=[\"']([^\"']*)[\"']/,a=/<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\nvar n=/ref=[\"']([^\"']*)[\"']/;var i=ht(\"v\"),s=ht(\"f\");return function f(o,l,c,h,u,d){var v=0,p=\"\",g=[],m=[],b=0,w=0,k=0,T=\"\",A;var E,C=0,y=0;var S,_;var x=0,O=0;var R=Array.isArray(d.CellXf),I;var N=[];var D=[];var F=Array.isArray(l);var P=[],L={},M=false;var U=!!c.sheetStubs;for(var B=o.split(r),W=0,H=B.length;W!=H;++W){p=B[W].trim();var z=p.length;if(z===0)continue;var V=0;e:for(v=0;v<z;++v)switch(p[v]){case\">\":if(p[v-1]!=\"/\"){++v;break e}if(c&&c.cellStyles){E=Gr(p.slice(V,v),true);C=E.r!=null?parseInt(E.r,10):C+1;y=-1;if(c.sheetRows&&c.sheetRows<C)continue;L={};M=false;if(E.ht){M=true;L.hpt=parseFloat(E.ht);L.hpx=Pl(L.hpt)}if(E.hidden==\"1\"){M=true;L.hidden=true}if(E.outlineLevel!=null){M=true;L.level=+E.outlineLevel}if(M)P[C-1]=L}break;case\"<\":V=v;break;}if(V>=v)break;E=Gr(p.slice(V,v),true);C=E.r!=null?parseInt(E.r,10):C+1;y=-1;if(c.sheetRows&&c.sheetRows<C)continue;if(h.s.r>C-1)h.s.r=C-1;if(h.e.r<C-1)h.e.r=C-1;if(c&&c.cellStyles){L={};M=false;if(E.ht){M=true;L.hpt=parseFloat(E.ht);L.hpx=Pl(L.hpt)}if(E.hidden==\"1\"){M=true;L.hidden=true}if(E.outlineLevel!=null){M=true;L.level=+E.outlineLevel}if(M)P[C-1]=L}g=p.slice(v).split(e);for(var G=0;G!=g.length;++G)if(g[G].trim().charAt(0)!=\"<\")break;g=g.slice(G);for(v=0;v!=g.length;++v){p=g[v].trim();if(p.length===0)continue;m=p.match(t);b=v;w=0;k=0;p=\"<c \"+(p.slice(0,1)==\"<\"?\">\":\"\")+p;if(m!=null&&m.length===2){b=0;T=m[1];for(w=0;w!=T.length;++w){if((k=T.charCodeAt(w)-64)<1||k>26)break;b=26*b+k}--b;y=b}else++y;for(w=0;w!=p.length;++w)if(p.charCodeAt(w)===62)break;++w;E=Gr(p.slice(0,w),true);if(!E.r)E.r=Ra({r:C-1,c:y});T=p.slice(w);A={t:\"\"};if((m=T.match(i))!=null&&m[1]!==\"\")A.v=Yr(m[1]);if(c.cellFormula){if((m=T.match(s))!=null&&m[1]!==\"\"){A.f=Yr(lt(m[1])).replace(/\\r\\n/g,\"\\n\");if(!c.xlfn)A.f=Nh(A.f);if(m[0].indexOf('t=\"array\"')>-1){A.F=(T.match(n)||[])[1];if(A.F.indexOf(\":\")>-1)N.push([Da(A.F),A.F])}else if(m[0].indexOf('t=\"shared\"')>-1){_=Gr(m[0]);var j=Yr(lt(m[1]));if(!c.xlfn)j=Nh(j);D[parseInt(_.si,10)]=[_,j,E.r]}}else if(m=T.match(/<f[^>]*\\/>/)){_=Gr(m[0]);if(D[_.si])A.f=Rh(D[_.si][1],D[_.si][2],E.r)}var $=Oa(E.r);for(w=0;w<N.length;++w)if($.r>=N[w][0].s.r&&$.r<=N[w][0].e.r)if($.c>=N[w][0].s.c&&$.c<=N[w][0].e.c)A.F=N[w][1]}if(E.t==null&&A.v===undefined){if(A.f||A.F){A.v=0;A.t=\"n\"}else if(!U)continue;else A.t=\"z\"}else A.t=E.t||\"n\";if(h.s.c>y)h.s.c=y;if(h.e.c<y)h.e.c=y;switch(A.t){case\"n\":if(A.v==\"\"||A.v==null){if(!U)continue;A.t=\"z\"}else A.v=parseFloat(A.v);break;case\"s\":if(typeof A.v==\"undefined\"){if(!U)continue;A.t=\"z\"}else{S=xd[parseInt(A.v,10)];A.v=S.t;A.r=S.r;if(c.cellHTML)A.h=S.h}break;case\"str\":A.t=\"s\";A.v=A.v!=null?lt(A.v):\"\";if(c.cellHTML)A.h=et(A.v);break;case\"inlineStr\":m=T.match(a);A.t=\"s\";if(m!=null&&(S=Po(m[1]))){A.v=S.t;if(c.cellHTML)A.h=S.h}else A.v=\"\";break;case\"b\":A.v=nt(A.v);break;case\"d\":if(c.cellDates)A.v=gr(A.v,1);else{A.v=fr(gr(A.v,1));A.t=\"n\"}break;case\"e\":if(!c||c.cellText!==false)A.w=A.v;A.v=jn[A.v];break;}x=O=0;I=null;if(R&&E.s!==undefined){I=d.CellXf[E.s];if(I!=null){if(I.numFmtId!=null)x=I.numFmtId;if(c.cellStyles){if(I.fillId!=null)O=I.fillId}}}Pd(A,x,O,c,u,d);if(c.cellDates&&R&&A.t==\"n\"&&Fe(X[x])){A.t=\"d\";A.v=hr(A.v)}if(E.cm&&c.xlmeta){var Y=(c.xlmeta.Cell||[])[+E.cm-1];if(Y&&Y.type==\"XLDAPR\")A.D=true}if(F){var K=Oa(E.r);if(!l[K.r])l[K.r]=[];l[K.r][K.c]=A}else l[E.r]=A}}if(P.length>0)l[\"!rows\"]=P}}();function vv(e,r,t,a){var n=[],i=[],s=Da(e[\"!ref\"]),f=\"\",o,l=\"\",c=[],h=0,u=0,d=e[\"!rows\"];var v=Array.isArray(e);var p={r:l},g,m=-1;for(u=s.s.c;u<=s.e.c;++u)c[u]=ya(u);for(h=s.s.r;h<=s.e.r;++h){i=[];l=Ta(h);for(u=s.s.c;u<=s.e.c;++u){o=c[u]+l;var b=v?(e[h]||[])[u]:e[o];if(b===undefined)continue;if((f=uv(b,o,e,r,t,a))!=null)i.push(f)}if(i.length>0||d&&d[h]){p={r:l};if(d&&d[h]){g=d[h];if(g.hidden)p.hidden=1;m=-1;if(g.hpx)m=Fl(g.hpx);else if(g.hpt)m=g.hpt;if(m>-1){p.ht=m;p.customHeight=1}if(g.level){p.outlineLevel=g.level}}n[n.length]=kt(\"row\",i.join(\"\"),p)}}if(d)for(;h<d.length;++h){if(d&&d[h]){p={r:h+1};g=d[h];if(g.hidden)p.hidden=1;m=-1;if(g.hpx)m=Fl(g.hpx);else if(g.hpt)m=g.hpt;if(m>-1){p.ht=m;p.customHeight=1}if(g.level){p.outlineLevel=g.level}n[n.length]=kt(\"row\",\"\",p)}}return n.join(\"\")}function pv(e,r,t,a){var n=[Mr,kt(\"worksheet\",null,{xmlns:St[0],\"xmlns:r\":yt.r})];var i=t.SheetNames[e],s=0,f=\"\";var o=t.Sheets[i];if(o==null)o={};var l=o[\"!ref\"]||\"A1\";var c=Da(l);if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error(\"Range \"+l+\" exceeds format limit A1:XFD1048576\");c.e.c=Math.min(c.e.c,16383);c.e.r=Math.min(c.e.c,1048575);l=Na(c)}if(!a)a={};o[\"!comments\"]=[];var h=[];Zd(o,t,e,r,n);n[n.length]=kt(\"dimension\",null,{ref:l});n[n.length]=hv(o,r,e,t);if(r.sheetFormat)n[n.length]=kt(\"sheetFormatPr\",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||\"16\",baseColWidth:r.sheetFormat.baseColWidth||\"10\",outlineLevelRow:r.sheetFormat.outlineLevelRow||\"7\"});if(o[\"!cols\"]!=null&&o[\"!cols\"].length>0)n[n.length]=sv(o,o[\"!cols\"]);n[s=n.length]=\"<sheetData/>\";o[\"!links\"]=[];if(o[\"!ref\"]!=null){f=vv(o,r,e,t,a);if(f.length>0)n[n.length]=f}if(n.length>s+1){n[n.length]=\"</sheetData>\";n[s]=n[s].replace(\"/>\",\">\")}if(o[\"!protect\"])n[n.length]=rv(o[\"!protect\"]);if(o[\"!autofilter\"]!=null)n[n.length]=ov(o[\"!autofilter\"],o,t,e);if(o[\"!merges\"]!=null&&o[\"!merges\"].length>0)n[n.length]=Kd(o[\"!merges\"]);var u=-1,d,v=-1;if(o[\"!links\"].length>0){n[n.length]=\"<hyperlinks>\";o[\"!links\"].forEach(function(e){if(!e[1].Target)return;d={ref:e[0]};if(e[1].Target.charAt(0)!=\"#\"){v=ri(a,-1,qr(e[1].Target).replace(/#.*$/,\"\"),qn.HLINK);d[\"r:id\"]=\"rId\"+v}if((u=e[1].Target.indexOf(\"#\"))>-1)d.location=qr(e[1].Target.slice(u+1));if(e[1].Tooltip)d.tooltip=qr(e[1].Tooltip);n[n.length]=kt(\"hyperlink\",null,d)});n[n.length]=\"</hyperlinks>\"}delete o[\"!links\"];if(o[\"!margins\"]!=null)n[n.length]=nv(o[\"!margins\"]);if(!r||r.ignoreEC||r.ignoreEC==void 0)n[n.length]=bt(\"ignoredErrors\",kt(\"ignoredError\",null,{numberStoredAsText:1,sqref:l}));if(h.length>0){v=ri(a,-1,\"../drawings/drawing\"+(e+1)+\".xml\",qn.DRAW);n[n.length]=kt(\"drawing\",null,{\"r:id\":\"rId\"+v});o[\"!drawing\"]=h}if(o[\"!comments\"].length>0){v=ri(a,-1,\"../drawings/vmlDrawing\"+(e+1)+\".vml\",qn.VML);n[n.length]=kt(\"legacyDrawing\",null,{\"r:id\":\"rId\"+v});o[\"!legacy\"]=v}if(n.length>1){n[n.length]=\"</worksheet>\";n[1]=n[1].replace(\"/>\",\">\")}return n.join(\"\")}function gv(e,r){var t={};var a=e.l+r;t.r=e._R(4);e.l+=4;var n=e._R(2);e.l+=1;var i=e._R(1);e.l=a;if(i&7)t.level=i&7;if(i&16)t.hidden=true;if(i&32)t.hpt=n/20;return t}function mv(e,r,t){var a=ua(17+8*16);var n=(t[\"!rows\"]||[])[e]||{};a._W(4,e);a._W(4,0);var i=320;if(n.hpx)i=Fl(n.hpx)*20;else if(n.hpt)i=n.hpt*20;a._W(2,i);a._W(1,0);var s=0;if(n.level)s|=n.level;if(n.hidden)s|=16;if(n.hpx||n.hpt)s|=32;a._W(1,s);a._W(1,0);var f=0,o=a.l;a.l+=4;var l={r:e,c:0};for(var c=0;c<16;++c){if(r.s.c>c+1<<10||r.e.c<c<<10)continue;var h=-1,u=-1;for(var d=c<<10;d<c+1<<10;++d){l.c=d;var v=Array.isArray(t)?(t[l.r]||[])[l.c]:t[Ra(l)];if(v){if(h<0)h=d;u=d}}if(h<0)continue;++f;a._W(4,h);a._W(4,u)}var p=a.l;a.l=o;a._W(4,f);a.l=p;return a.length>a.l?a.slice(0,a.l):a}function bv(e,r,t,a){var n=mv(a,t,r);if(n.length>17||(r[\"!rows\"]||[])[a])pa(e,0,n)}var wv=hn;var kv=un;function Tv(){}function Av(e,r){var t={};var a=e[e.l];++e.l;t.above=!(a&64);t.left=!(a&128);e.l+=18;t.name=Qa(e,r-19);return t}function Ev(e,r,t){if(t==null)t=ua(84+4*e.length);var a=192;if(r){if(r.above)a&=~64;if(r.left)a&=~128}t._W(1,a);for(var n=1;n<3;++n)t._W(1,0);gn({auto:1},t);t._W(-4,-1);t._W(-4,-1);en(e,t);return t.slice(0,t.l)}function Cv(e){var r=Ka(e);return[r]}function yv(e,r,t){if(t==null)t=ua(8);return Ja(r,t)}function Sv(e){var r=qa(e);return[r]}function _v(e,r,t){if(t==null)t=ua(4);return Za(r,t)}function xv(e){var r=Ka(e);var t=e._R(1);return[r,t,\"b\"]}function Ov(e,r,t){if(t==null)t=ua(9);Ja(r,t);t._W(1,e.v?1:0);return t}function Rv(e){var r=qa(e);var t=e._R(1);return[r,t,\"b\"]}function Iv(e,r,t){if(t==null)t=ua(5);Za(r,t);t._W(1,e.v?1:0);return t}function Nv(e){var r=Ka(e);var t=e._R(1);return[r,t,\"e\"]}function Dv(e,r,t){if(t==null)t=ua(9);Ja(r,t);t._W(1,e.v);return t}function Fv(e){var r=qa(e);var t=e._R(1);return[r,t,\"e\"]}function Pv(e,r,t){if(t==null)t=ua(8);Za(r,t);t._W(1,e.v);t._W(2,0);t._W(1,0);return t}function Lv(e){var r=Ka(e);var t=e._R(4);return[r,t,\"s\"]}function Mv(e,r,t){if(t==null)t=ua(12);Ja(r,t);t._W(4,r.v);return t}function Uv(e){var r=qa(e);var t=e._R(4);return[r,t,\"s\"]}function Bv(e,r,t){if(t==null)t=ua(8);Za(r,t);t._W(4,r.v);return t}function Wv(e){var r=Ka(e);var t=dn(e);return[r,t,\"n\"]}function Hv(e,r,t){if(t==null)t=ua(16);Ja(r,t);vn(e.v,t);return t}function zv(e){var r=qa(e);var t=dn(e);return[r,t,\"n\"]}function Vv(e,r,t){if(t==null)t=ua(12);Za(r,t);vn(e.v,t);return t}function Gv(e){var r=Ka(e);var t=fn(e);return[r,t,\"n\"]}function jv(e,r,t){if(t==null)t=ua(12);Ja(r,t);on(e.v,t);return t}function Xv(e){var r=qa(e);var t=fn(e);return[r,t,\"n\"]}function $v(e,r,t){if(t==null)t=ua(8);Za(r,t);on(e.v,t);return t}function Yv(e){var r=Ka(e);var t=ja(e);return[r,t,\"is\"]}function Kv(e){var r=Ka(e);var t=Ha(e);return[r,t,\"str\"]}function Jv(e,r,t){if(t==null)t=ua(12+4*e.v.length);Ja(r,t);za(e.v,t);return t.length>t.l?t.slice(0,t.l):t}function qv(e){var r=qa(e);var t=Ha(e);return[r,t,\"str\"]}function Zv(e,r,t){if(t==null)t=ua(8+4*e.v.length);Za(r,t);za(e.v,t);return t.length>t.l?t.slice(0,t.l):t}function Qv(e,r,t){var a=e.l+r;var n=Ka(e);n.r=t[\"!row\"];var i=e._R(1);var s=[n,i,\"b\"];if(t.cellFormula){e.l+=2;var f=bd(e,a-e.l,t);s[3]=fd(f,null,n,t.supbooks,t)}else e.l=a;return s}function ep(e,r,t){var a=e.l+r;var n=Ka(e);n.r=t[\"!row\"];var i=e._R(1);var s=[n,i,\"e\"];if(t.cellFormula){e.l+=2;var f=bd(e,a-e.l,t);s[3]=fd(f,null,n,t.supbooks,t)}else e.l=a;return s}function rp(e,r,t){var a=e.l+r;var n=Ka(e);n.r=t[\"!row\"];var i=dn(e);var s=[n,i,\"n\"];if(t.cellFormula){e.l+=2;var f=bd(e,a-e.l,t);s[3]=fd(f,null,n,t.supbooks,t)}else e.l=a;return s}function tp(e,r,t){var a=e.l+r;var n=Ka(e);n.r=t[\"!row\"];var i=Ha(e);var s=[n,i,\"str\"];if(t.cellFormula){e.l+=2;var f=bd(e,a-e.l,t);s[3]=fd(f,null,n,t.supbooks,t)}else e.l=a;return s}var ap=hn;var np=un;function ip(e,r){if(r==null)r=ua(4);r._W(4,e);return r}function sp(e,r){var t=e.l+r;var a=hn(e,16);var n=rn(e);var i=Ha(e);var s=Ha(e);var f=Ha(e);e.l=t;var o={rfx:a,relId:n,loc:i,display:f};if(s)o.Tooltip=s;return o}function fp(e,r){var t=ua(50+4*(e[1].Target.length+(e[1].Tooltip||\"\").length));un({s:Oa(e[0]),e:Oa(e[0])},t);sn(\"rId\"+r,t);var a=e[1].Target.indexOf(\"#\");var n=a==-1?\"\":e[1].Target.slice(a+1);za(n||\"\",t);za(e[1].Tooltip||\"\",t);za(\"\",t);return t.slice(0,t.l)}function op(){}function lp(e,r,t){var a=e.l+r;var n=ln(e,16);var i=e._R(1);var s=[n];s[2]=i;if(t.cellFormula){var f=md(e,a-e.l,t);s[1]=f}else e.l=a;return s}function cp(e,r,t){var a=e.l+r;var n=hn(e,16);var i=[n];if(t.cellFormula){var s=kd(e,a-e.l,t);i[1]=s;e.l=a}else e.l=a;return i}function hp(e,r,t){if(t==null)t=ua(18);var a=Nd(e,r);t._W(-4,e);t._W(-4,e);t._W(4,(a.width||10)*256);t._W(4,0);var n=0;if(r.hidden)n|=1;if(typeof a.width==\"number\")n|=2;if(r.level)n|=r.level<<8;t._W(2,n);return t}var up=[\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];function dp(e){var r={};up.forEach(function(t){r[t]=dn(e,8)});return r}function vp(e,r){if(r==null)r=ua(6*8);Dd(e);up.forEach(function(t){vn(e[t],r)});return r}function pp(e){var r=e._R(2);e.l+=28;return{RTL:r&32}}function gp(e,r,t){if(t==null)t=ua(30);var a=924;if((((r||{}).Views||[])[0]||{}).RTL)a|=32;t._W(2,a);t._W(4,0);t._W(4,0);t._W(4,0);t._W(1,0);t._W(1,0);t._W(2,0);t._W(2,100);t._W(2,0);t._W(2,0);t._W(2,0);t._W(4,0);return t}function mp(e){var r=ua(24);r._W(4,4);r._W(4,1);un(e,r);return r}function bp(e,r){if(r==null)r=ua(16*4+2);r._W(2,e.password?ll(e.password):0);r._W(4,1);[[\"objects\",false],[\"scenarios\",false],[\"formatCells\",true],[\"formatColumns\",true],[\"formatRows\",true],[\"insertColumns\",true],[\"insertRows\",true],[\"insertHyperlinks\",true],[\"deleteColumns\",true],[\"deleteRows\",true],[\"selectLockedCells\",false],[\"sort\",true],[\"autoFilter\",true],[\"pivotTables\",true],[\"selectUnlockedCells\",false]].forEach(function(t){if(t[1])r._W(4,e[t[0]]!=null&&!e[t[0]]?1:0);else r._W(4,e[t[0]]!=null&&e[t[0]]?0:1)});return r}function wp(){}function kp(){}function Tp(e,r,t,a,n,i,s){if(!e)return e;var f=r||{};if(!a)a={\"!id\":{}};if(g!=null&&f.dense==null)f.dense=g;var o=f.dense?[]:{};var l;var c={s:{r:2e6,c:2e6},e:{r:0,c:0}};var h=[];var u=false,d=false;var v,p,m,b,w,k,T,A,E;var C=[];f.biff=12;f[\"!row\"]=0;var y=0,S=false;var _=[];var x={};var O=f.supbooks||n.supbooks||[[]];O.sharedf=x;O.arrayf=_;O.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name});if(!f.supbooks){f.supbooks=O;if(n.Names)for(var R=0;R<n.Names.length;++R)O[0][R+1]=n.Names[R]}var I=[],N=[];var D=false;gm[16]={n:\"BrtShortReal\",f:zv};var F,P;da(e,function M(e,r,g){if(d)return;switch(g){case 148:l=e;break;case 0:v=e;if(f.sheetRows&&f.sheetRows<=v.r)d=true;A=Ta(b=v.r);f[\"!row\"]=v.r;if(e.hidden||e.hpt||e.level!=null){if(e.hpt)e.hpx=Pl(e.hpt);N[e.r]=e}break;case 2:;case 3:;case 4:;case 5:;case 6:;case 7:;case 8:;case 9:;case 10:;case 11:;case 13:;case 14:;case 15:;case 16:;case 17:;case 18:;case 62:p={t:e[2]};switch(e[2]){case\"n\":p.v=e[1];break;case\"s\":T=xd[e[1]];p.v=T.t;p.r=T.r;break;case\"b\":p.v=e[1]?true:false;break;case\"e\":p.v=e[1];if(f.cellText!==false)p.w=Gn[p.v];break;case\"str\":p.t=\"s\";p.v=e[1];break;case\"is\":p.t=\"s\";p.v=e[1].t;break;}if(m=s.CellXf[e[0].iStyleRef])Pd(p,m.numFmtId,null,f,i,s);w=e[0].c==-1?w+1:e[0].c;if(f.dense){if(!o[b])o[b]=[];o[b][w]=p}else o[ya(w)+A]=p;if(f.cellFormula){S=false;for(y=0;y<_.length;++y){var R=_[y];if(v.r>=R[0].s.r&&v.r<=R[0].e.r)if(w>=R[0].s.c&&w<=R[0].e.c){p.F=Na(R[0]);S=true}}if(!S&&e.length>3)p.f=e[3]}if(c.s.r>v.r)c.s.r=v.r;if(c.s.c>w)c.s.c=w;if(c.e.r<v.r)c.e.r=v.r;if(c.e.c<w)c.e.c=w;if(f.cellDates&&m&&p.t==\"n\"&&Fe(X[m.numFmtId])){var L=q(p.v);if(L){p.t=\"d\";p.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u)}}if(F){if(F.type==\"XLDAPR\")p.D=true;F=void 0}if(P)P=void 0;break;case 1:;case 12:if(!f.sheetStubs||u)break;p={t:\"z\",v:void 0};w=e[0].c==-1?w+1:e[0].c;if(f.dense){if(!o[b])o[b]=[];o[b][w]=p}else o[ya(w)+A]=p;if(c.s.r>v.r)c.s.r=v.r;if(c.s.c>w)c.s.c=w;if(c.e.r<v.r)c.e.r=v.r;if(c.e.c<w)c.e.c=w;if(F){if(F.type==\"XLDAPR\")p.D=true;F=void 0}if(P)P=void 0;break;case 176:C.push(e);break;case 49:{F=((f.xlmeta||{}).Cell||[])[e-1]}break;case 494:var M=a[\"!id\"][e.relId];if(M){e.Target=M.Target;if(e.loc)e.Target+=\"#\"+e.loc;e.Rel=M}else if(e.relId==\"\"){e.Target=\"#\"+e.loc}for(b=e.rfx.s.r;b<=e.rfx.e.r;++b)for(w=e.rfx.s.c;w<=e.rfx.e.c;++w){if(f.dense){if(!o[b])o[b]=[];if(!o[b][w])o[b][w]={t:\"z\",v:undefined};o[b][w].l=e}else{k=Ra({c:w,r:b});if(!o[k])o[k]={t:\"z\",v:undefined};o[k].l=e}}break;case 426:if(!f.cellFormula)break;_.push(e);E=f.dense?o[b][w]:o[ya(w)+A];E.f=fd(e[1],c,{r:v.r,c:w},O,f);E.F=Na(e[0]);break;case 427:if(!f.cellFormula)break;x[Ra(e[0].s)]=e[1];E=f.dense?o[b][w]:o[ya(w)+A];E.f=fd(e[1],c,{r:v.r,c:w},O,f);break;case 60:if(!f.cellStyles)break;while(e.e>=e.s){I[e.e--]={width:e.w/256,hidden:!!(e.flags&1),level:e.level};if(!D){D=true;Rl(e.w/256)}Il(I[e.e+1])}break;case 161:o[\"!autofilter\"]={ref:Na(e)};break;case 476:o[\"!margins\"]=e;break;case 147:if(!n.Sheets[t])n.Sheets[t]={};if(e.name)n.Sheets[t].CodeName=e.name;if(e.above||e.left)o[\"!outline\"]={above:e.above,left:e.left};break;case 137:if(!n.Views)n.Views=[{}];if(!n.Views[0])n.Views[0]={};if(e.RTL)n.Views[0].RTL=true;break;case 485:break;case 64:;case 1053:break;case 151:break;case 152:;case 175:;case 644:;case 625:;case 562:;case 396:;case 1112:;case 1146:;case 471:;case 1050:;case 649:;case 1105:;case 589:;case 607:;case 564:;case 1055:;case 168:;case 174:;case 1180:;case 499:;case 507:;case 550:;case 171:;case 167:;case 1177:;case 169:;case 1181:;case 551:;case 552:;case 661:;case 639:;case 478:;case 537:;case 477:;case 536:;case 1103:;case 680:;case 1104:;case 1024:;case 663:;case 535:;case 678:;case 504:;case 1043:;case 428:;case 170:;case 3072:;case 50:;case 2070:;case 1045:break;case 35:u=true;break;case 36:u=false;break;case 37:h.push(g);u=true;break;case 38:h.pop();u=false;break;default:if(r.T){}else if(!u||f.WTF)throw new Error(\"Unexpected record 0x\"+g.toString(16));}},f);delete f.supbooks;delete f[\"!row\"];if(!o[\"!ref\"]&&(c.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0)))o[\"!ref\"]=Na(l||c);if(f.sheetRows&&o[\"!ref\"]){var L=Da(o[\"!ref\"]);if(f.sheetRows<=+L.e.r){L.e.r=f.sheetRows-1;if(L.e.r>c.e.r)L.e.r=c.e.r;if(L.e.r<L.s.r)L.s.r=L.e.r;if(L.e.c>c.e.c)L.e.c=c.e.c;if(L.e.c<L.s.c)L.s.c=L.e.c;o[\"!fullref\"]=o[\"!ref\"];o[\"!ref\"]=Na(L)}}if(C.length>0)o[\"!merges\"]=C;if(I.length>0)o[\"!cols\"]=I;if(N.length>0)o[\"!rows\"]=N;return o}function Ap(e,r,t,a,n,i,s){if(r.v===undefined)return false;var f=\"\";switch(r.t){case\"b\":f=r.v?\"1\":\"0\";break;case\"d\":r=br(r);r.z=r.z||X[14];r.v=fr(gr(r.v));r.t=\"n\";break;case\"n\":;case\"e\":f=\"\"+r.v;break;default:f=r.v;break;}var o={r:t,c:a};o.s=Fd(n.cellXfs,r,n);if(r.l)i[\"!links\"].push([Ra(o),r.l]);if(r.c)i[\"!comments\"].push([Ra(o),r.c]);switch(r.t){case\"s\":;case\"str\":if(n.bookSST){f=Id(n.Strings,r.v,n.revStrings);o.t=\"s\";o.v=f;if(s)pa(e,18,Bv(r,o));else pa(e,7,Mv(r,o))}else{o.t=\"str\";if(s)pa(e,17,Zv(r,o));else pa(e,6,Jv(r,o))}return true;case\"n\":if(r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3){if(s)pa(e,13,$v(r,o));else pa(e,2,jv(r,o))}else{if(s)pa(e,16,Vv(r,o));else pa(e,5,Hv(r,o))}return true;case\"b\":o.t=\"b\";if(s)pa(e,15,Iv(r,o));else pa(e,4,Ov(r,o));return true;case\"e\":o.t=\"e\";if(s)pa(e,14,Pv(r,o));else pa(e,3,Dv(r,o));return true;}if(s)pa(e,12,_v(r,o));else pa(e,1,yv(r,o));return true}function Ep(e,r,t,a){var n=Da(r[\"!ref\"]||\"A1\"),i,s=\"\",f=[];pa(e,145);var o=Array.isArray(r);var l=n.e.r;if(r[\"!rows\"])l=Math.max(n.e.r,r[\"!rows\"].length-1);for(var c=n.s.r;c<=l;++c){s=Ta(c);bv(e,r,n,c);var h=false;if(c<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){if(c===n.s.r)f[u]=ya(u);i=f[u]+s;var d=o?(r[c]||[])[u]:r[i];if(!d){h=false;continue}h=Ap(e,d,c,u,a,r,h)}}pa(e,146)}function Cp(e,r){if(!r||!r[\"!merges\"])return;pa(e,177,ip(r[\"!merges\"].length));r[\"!merges\"].forEach(function(r){pa(e,176,np(r))});pa(e,178)}function yp(e,r){if(!r||!r[\"!cols\"])return;pa(e,390);r[\"!cols\"].forEach(function(r,t){if(r)pa(e,60,hp(t,r))});pa(e,391)}function Sp(e,r){if(!r||!r[\"!ref\"])return;pa(e,648);pa(e,649,mp(Da(r[\"!ref\"])));pa(e,650)}function _p(e,r,t){r[\"!links\"].forEach(function(r){if(!r[1].Target)return;var a=ri(t,-1,r[1].Target.replace(/#.*$/,\"\"),qn.HLINK);pa(e,494,fp(r,a))});delete r[\"!links\"]}function xp(e,r,t,a){if(r[\"!comments\"].length>0){var n=ri(a,-1,\"../drawings/vmlDrawing\"+(t+1)+\".vml\",qn.VML);pa(e,551,sn(\"rId\"+n));r[\"!legacy\"]=n}}function Op(e,r,t,a){if(!r[\"!autofilter\"])return;var n=r[\"!autofilter\"];var i=typeof n.ref===\"string\"?n.ref:Na(n.ref);if(!t.Workbook)t.Workbook={Sheets:[]};if(!t.Workbook.Names)t.Workbook.Names=[];var s=t.Workbook.Names;var f=Ia(i);if(f.s.r==f.e.r){f.e.r=Ia(r[\"!ref\"]).e.r;i=Na(f)}for(var o=0;o<s.length;++o){var l=s[o];if(l.Name!=\"_xlnm._FilterDatabase\")continue;if(l.Sheet!=a)continue;l.Ref=\"'\"+t.SheetNames[a]+\"'!\"+i;break}if(o==s.length)s.push({Name:\"_xlnm._FilterDatabase\",Sheet:a,Ref:\"'\"+t.SheetNames[a]+\"'!\"+i});pa(e,161,un(Da(i)));pa(e,162)}function Rp(e,r,t){pa(e,133);{pa(e,137,gp(r,t));pa(e,138)}pa(e,134)}function Ip(){}function Np(e,r){if(!r[\"!protect\"])return;pa(e,535,bp(r[\"!protect\"]))}function Dp(e,r,t,a){var n=va();var i=t.SheetNames[e],s=t.Sheets[i]||{};var f=i;try{if(t&&t.Workbook)f=t.Workbook.Sheets[e].CodeName||f}catch(o){}var l=Da(s[\"!ref\"]||\"A1\");if(l.e.c>16383||l.e.r>1048575){if(r.WTF)throw new Error(\"Range \"+(s[\"!ref\"]||\"A1\")+\" exceeds format limit A1:XFD1048576\");l.e.c=Math.min(l.e.c,16383);l.e.r=Math.min(l.e.c,1048575)}s[\"!links\"]=[];s[\"!comments\"]=[];pa(n,129);if(t.vbaraw||s[\"!outline\"])pa(n,147,Ev(f,s[\"!outline\"]));pa(n,148,kv(l));Rp(n,s,t.Workbook);Ip(n,s);yp(n,s,e,r,t);Ep(n,s,e,r,t);Np(n,s);Op(n,s,t,e);Cp(n,s);_p(n,s,a);if(s[\"!margins\"])pa(n,476,vp(s[\"!margins\"]));if(!r||r.ignoreEC||r.ignoreEC==void 0)Sp(n,s);xp(n,s,e,a);pa(n,130);return n.end()}function Fp(e){var r=[];var t=e.match(/^<c:numCache>/);var a;(e.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/gm)||[]).forEach(function(e){var a=e.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);if(!a)return;r[+a[1]]=t?+a[2]:a[2]});var n=Yr((e.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/)||[\"\",\"General\"])[1]);(e.match(/<c:f>(.*?)<\\/c:f>/gm)||[]).forEach(function(e){a=e.replace(/<.*?>/g,\"\")});return[r,n,a]}function Pp(e,r,t,a,n,i){var s=i||{\"!type\":\"chart\"};if(!e)return i;var f=0,o=0,l=\"A\";var c={s:{r:2e6,c:2e6},e:{r:0,c:0}};(e.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm)||[]).forEach(function(e){var r=Fp(e);c.s.r=c.s.c=0;c.e.c=f;l=ya(f);r[0].forEach(function(e,t){s[l+Ta(t)]={t:\"n\",v:e,z:r[1]};o=t});if(c.e.r<o)c.e.r=o;++f});if(f>0)s[\"!ref\"]=Na(c);return s}function Lp(e,r,t,a,n){if(!e)return e;if(!a)a={\"!id\":{}};var i={\"!type\":\"chart\",\"!drawel\":null,\"!rel\":\"\"};var s;var f=e.match(jd);if(f)Jd(f[0],i,n,t);if(s=e.match(/drawing r:id=\"(.*?)\"/))i[\"!rel\"]=s[1];if(a[\"!id\"][i[\"!rel\"]])i[\"!drawel\"]=a[\"!id\"][i[\"!rel\"]];return i}function Mp(e,r,t,a){var n=[Mr,kt(\"chartsheet\",null,{xmlns:St[0],\"xmlns:r\":yt.r})];n[n.length]=kt(\"drawing\",null,{\"r:id\":\"rId1\"});ri(a,-1,\"../drawings/drawing\"+(e+1)+\".xml\",qn.DRAW);if(n.length>2){n[n.length]=\"</chartsheet>\";n[1]=n[1].replace(\"/>\",\">\")}return n.join(\"\")}function Up(e,r){e.l+=10;var t=Ha(e,r-10);return{name:t}}function Bp(e,r,t,a,n){if(!e)return e;if(!a)a={\"!id\":{}};var i={\"!type\":\"chart\",\"!drawel\":null,\"!rel\":\"\"};var s=[];var f=false;da(e,function o(e,a,l){switch(l){case 550:i[\"!rel\"]=e;break;case 651:if(!n.Sheets[t])n.Sheets[t]={};if(e.name)n.Sheets[t].CodeName=e.name;break;case 562:;case 652:;case 669:;case 679:;case 551:;case 552:;case 476:;case 3072:break;case 35:f=true;break;case 36:f=false;break;case 37:s.push(l);break;case 38:s.pop();break;default:if(a.T>0)s.push(l);else if(a.T<0)s.pop();else if(!f||r.WTF)throw new Error(\"Unexpected record 0x\"+l.toString(16));}},r);if(a[\"!id\"][i[\"!rel\"]])i[\"!drawel\"]=a[\"!id\"][i[\"!rel\"]];return i}function Wp(){var e=va();pa(e,129);pa(e,130);return e.end()}var Hp=[[\"allowRefreshQuery\",false,\"bool\"],[\"autoCompressPictures\",true,\"bool\"],[\"backupFile\",false,\"bool\"],[\"checkCompatibility\",false,\"bool\"],[\"CodeName\",\"\"],[\"date1904\",false,\"bool\"],[\"defaultThemeVersion\",0,\"int\"],[\"filterPrivacy\",false,\"bool\"],[\"hidePivotFieldList\",false,\"bool\"],[\"promptedSolutions\",false,\"bool\"],[\"publishItems\",false,\"bool\"],[\"refreshAllConnections\",false,\"bool\"],[\"saveExternalLinkValues\",true,\"bool\"],[\"showBorderUnselectedTables\",true,\"bool\"],[\"showInkAnnotation\",true,\"bool\"],[\"showObjects\",\"all\"],[\"showPivotChartFilter\",false,\"bool\"],[\"updateLinks\",\"userSet\"]];var zp=[[\"activeTab\",0,\"int\"],[\"autoFilterDateGrouping\",true,\"bool\"],[\"firstSheet\",0,\"int\"],[\"minimized\",false,\"bool\"],[\"showHorizontalScroll\",true,\"bool\"],[\"showSheetTabs\",true,\"bool\"],[\"showVerticalScroll\",true,\"bool\"],[\"tabRatio\",600,\"int\"],[\"visibility\",\"visible\"]];var Vp=[];var Gp=[[\"calcCompleted\",\"true\"],[\"calcMode\",\"auto\"],[\"calcOnSave\",\"true\"],[\"concurrentCalc\",\"true\"],[\"fullCalcOnLoad\",\"false\"],[\"fullPrecision\",\"true\"],[\"iterate\",\"false\"],[\"iterateCount\",\"100\"],[\"iterateDelta\",\"0.001\"],[\"refMode\",\"A1\"]];function jp(e,r){for(var t=0;t!=e.length;++t){var a=e[t];for(var n=0;n!=r.length;++n){var i=r[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case\"bool\":if(typeof a[i[0]]==\"string\")a[i[0]]=nt(a[i[0]]);break;case\"int\":if(typeof a[i[0]]==\"string\")a[i[0]]=parseInt(a[i[0]],10);break;}}}}function Xp(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case\"bool\":if(typeof e[a[0]]==\"string\")e[a[0]]=nt(e[a[0]]);break;case\"int\":if(typeof e[a[0]]==\"string\")e[a[0]]=parseInt(e[a[0]],10);break;}}}function $p(e){Xp(e.WBProps,Hp);Xp(e.CalcPr,Gp);jp(e.WBView,zp);jp(e.Sheets,Vp);Od.date1904=nt(e.WBProps.date1904)}function Yp(e){if(!e.Workbook)return\"false\";if(!e.Workbook.WBProps)return\"false\";return nt(e.Workbook.WBProps.date1904)?\"true\":\"false\"}var Kp=\"][*?/\\\\\".split(\"\");function Jp(e,r){if(e.length>31){if(r)return false;throw new Error(\"Sheet names cannot exceed 31 chars\")}var t=true;Kp.forEach(function(a){if(e.indexOf(a)==-1)return;if(!r)throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");t=false});return t}function qp(e,r,t){e.forEach(function(a,n){Jp(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error(\"Duplicate Sheet Name: \"+a);if(t){var s=r&&r[n]&&r[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error(\"Bad Code Name: Worksheet\"+s)}})}function Zp(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error(\"Invalid Workbook\");if(!e.SheetNames.length)throw new Error(\"Workbook is empty\");var r=e.Workbook&&e.Workbook.Sheets||[];qp(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Ld(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var Qp=/<\\w+:workbook/;function eg(e,r){if(!e)throw new Error(\"Could not find file\");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:\"\"};var a=false,n=\"xmlns\";var i={},s=0;e.replace(Hr,function f(o,l){var c=Gr(o);switch(jr(c[0])){case\"<?xml\":break;case\"<workbook\":if(o.match(Qp))n=\"xmlns\"+o.match(/<(\\w+):/)[1];t.xmlns=c[n];break;case\"</workbook>\":break;case\"<fileVersion\":delete c[0];t.AppVersion=c;break;case\"<fileVersion/>\":;case\"</fileVersion>\":break;case\"<fileSharing\":break;case\"<fileSharing/>\":break;case\"<workbookPr\":;case\"<workbookPr/>\":Hp.forEach(function(e){if(c[e[0]]==null)return;switch(e[2]){case\"bool\":t.WBProps[e[0]]=nt(c[e[0]]);break;case\"int\":t.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:t.WBProps[e[0]]=c[e[0]];}});if(c.codeName)t.WBProps.CodeName=lt(c.codeName);break;case\"</workbookPr>\":break;case\"<workbookProtection\":break;case\"<workbookProtection/>\":break;case\"<bookViews\":;case\"<bookViews>\":;case\"</bookViews>\":break;case\"<workbookView\":;case\"<workbookView/>\":delete c[0];t.WBView.push(c);break;case\"</workbookView>\":break;case\"<sheets\":;case\"<sheets>\":;case\"</sheets>\":break;case\"<sheet\":switch(c.state){case\"hidden\":c.Hidden=1;break;case\"veryHidden\":c.Hidden=2;break;default:c.Hidden=0;}delete c.state;c.name=Yr(lt(c.name));delete c[0];t.Sheets.push(c);break;case\"</sheet>\":break;case\"<functionGroups\":;case\"<functionGroups/>\":break;case\"<functionGroup\":break;case\"<externalReferences\":;case\"</externalReferences>\":;case\"<externalReferences>\":break;case\"<externalReference\":break;case\"<definedNames/>\":break;case\"<definedNames>\":;case\"<definedNames\":a=true;break;case\"</definedNames>\":a=false;break;case\"<definedName\":{i={};i.Name=lt(c.name);if(c.comment)i.Comment=c.comment;if(c.localSheetId)i.Sheet=+c.localSheetId;if(nt(c.hidden||\"0\"))i.Hidden=true;s=l+o.length}break;case\"</definedName>\":{i.Ref=Yr(lt(e.slice(s,l)));t.Names.push(i)}break;case\"<definedName/>\":break;case\"<calcPr\":delete c[0];t.CalcPr=c;break;case\"<calcPr/>\":delete c[0];t.CalcPr=c;break;case\"</calcPr>\":break;case\"<oleSize\":break;case\"<customWorkbookViews>\":;case\"</customWorkbookViews>\":;case\"<customWorkbookViews\":break;case\"<customWorkbookView\":;case\"</customWorkbookView>\":break;case\"<pivotCaches>\":;case\"</pivotCaches>\":;case\"<pivotCaches\":break;case\"<pivotCache\":break;case\"<smartTagPr\":;case\"<smartTagPr/>\":break;case\"<smartTagTypes\":;case\"<smartTagTypes>\":;case\"</smartTagTypes>\":break;case\"<smartTagType\":break;case\"<webPublishing\":;case\"<webPublishing/>\":break;case\"<fileRecoveryPr\":;case\"<fileRecoveryPr/>\":break;case\"<webPublishObjects>\":;case\"<webPublishObjects\":;case\"</webPublishObjects>\":break;case\"<webPublishObject\":break;case\"<extLst\":;case\"<extLst>\":;case\"</extLst>\":;case\"<extLst/>\":break;case\"<ext\":a=true;break;case\"</ext>\":a=false;break;case\"<ArchID\":break;case\"<AlternateContent\":;case\"<AlternateContent>\":a=true;break;case\"</AlternateContent>\":a=false;break;case\"<revisionPtr\":break;default:if(!a&&r.WTF)throw new Error(\"unrecognized \"+c[0]+\" in workbook\");}return o});if(St.indexOf(t.xmlns)===-1)throw new Error(\"Unknown Namespace: \"+t.xmlns);$p(t);return t}function rg(e){var r=[Mr];r[r.length]=kt(\"workbook\",null,{xmlns:St[0],\"xmlns:r\":yt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0;var a={codeName:\"ThisWorkbook\"};if(e.Workbook&&e.Workbook.WBProps){Hp.forEach(function(r){if(e.Workbook.WBProps[r[0]]==null)return;if(e.Workbook.WBProps[r[0]]==r[1])return;a[r[0]]=e.Workbook.WBProps[r[0]]});if(e.Workbook.WBProps.CodeName){a.codeName=e.Workbook.WBProps.CodeName;delete a.CodeName}}r[r.length]=kt(\"workbookPr\",null,a);var n=e.Workbook&&e.Workbook.Sheets||[];var i=0;if(n&&n[0]&&!!n[0].Hidden){r[r.length]=\"<bookViews>\";for(i=0;i!=e.SheetNames.length;++i){if(!n[i])break;if(!n[i].Hidden)break}if(i==e.SheetNames.length)i=0;r[r.length]='<workbookView firstSheet=\"'+i+'\" activeTab=\"'+i+'\"/>';r[r.length]=\"</bookViews>\"}r[r.length]=\"<sheets>\";for(i=0;i!=e.SheetNames.length;++i){var s={name:qr(e.SheetNames[i].slice(0,31))};s.sheetId=\"\"+(i+1);s[\"r:id\"]=\"rId\"+(i+1);if(n[i])switch(n[i].Hidden){case 1:s.state=\"hidden\";break;case 2:s.state=\"veryHidden\";break;}r[r.length]=kt(\"sheet\",null,s)}r[r.length]=\"</sheets>\";if(t){r[r.length]=\"<definedNames>\";if(e.Workbook&&e.Workbook.Names)e.Workbook.Names.forEach(function(e){var t={name:e.Name};if(e.Comment)t.comment=e.Comment;if(e.Sheet!=null)t.localSheetId=\"\"+e.Sheet;if(e.Hidden)t.hidden=\"1\";if(!e.Ref)return;r[r.length]=kt(\"definedName\",qr(e.Ref),t)});r[r.length]=\"</definedNames>\"}if(r.length>2){r[r.length]=\"</workbook>\";r[1]=r[1].replace(\"/>\",\">\")}return r.join(\"\")}function tg(e,r){var t={};t.Hidden=e._R(4);t.iTabID=e._R(4);t.strRelID=nn(e,r-8);t.name=Ha(e);return t}function ag(e,r){if(!r)r=ua(127);r._W(4,e.Hidden);r._W(4,e.iTabID);sn(e.strRelID,r);za(e.name.slice(0,31),r);return r.length>r.l?r.slice(0,r.l):r}function ng(e,r){var t={};var a=e._R(4);t.defaultThemeVersion=e._R(4);var n=r>8?Ha(e):\"\";if(n.length>0)t.CodeName=n;t.autoCompressPictures=!!(a&65536);t.backupFile=!!(a&64);t.checkCompatibility=!!(a&4096);t.date1904=!!(a&1);t.filterPrivacy=!!(a&8);t.hidePivotFieldList=!!(a&1024);t.promptedSolutions=!!(a&16);t.publishItems=!!(a&2048);t.refreshAllConnections=!!(a&262144);t.saveExternalLinkValues=!!(a&128);t.showBorderUnselectedTables=!!(a&4);t.showInkAnnotation=!!(a&32);t.showObjects=[\"all\",\"placeholders\",\"none\"][a>>13&3];t.showPivotChartFilter=!!(a&32768);t.updateLinks=[\"userSet\",\"never\",\"always\"][a>>8&3];return t}function ig(e,r){if(!r)r=ua(72);var t=0;if(e){if(e.filterPrivacy)t|=8}r._W(4,t);r._W(4,0);en(e&&e.CodeName||\"ThisWorkbook\",r);return r.slice(0,r.l)}function sg(e,r){var t={};e._R(4);t.ArchID=e._R(4);e.l+=r-8;return t}function fg(e,r,t){var a=e.l+r;e.l+=4;e.l+=1;var n=e._R(4);var i=an(e);var s=wd(e,0,t);var f=rn(e);e.l=a;var o={Name:i,Ptg:s};if(n<268435455)o.Sheet=n;if(f)o.Comment=f;return o}function og(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:\"\"};var a=[];var n=false;if(!r)r={};r.biff=12;var i=[];var s=[[]];s.SheetNames=[];s.XTI=[];gm[16]={n:\"BrtFRTArchID$\",f:sg};da(e,function f(e,o,l){switch(l){case 156:s.SheetNames.push(e.name);t.Sheets.push(e);break;case 153:t.WBProps=e;break;case 39:if(e.Sheet!=null)r.SID=e.Sheet;e.Ref=fd(e.Ptg,null,null,s,r);delete r.SID;delete e.Ptg;i.push(e);break;case 1036:break;case 357:;case 358:;case 355:;case 667:if(!s[0].length)s[0]=[l,e];else s.push([l,e]);s[s.length-1].XTI=[];break;case 362:if(s.length===0){s[0]=[];s[0].XTI=[]}s[s.length-1].XTI=s[s.length-1].XTI.concat(e);s.XTI=s.XTI.concat(e);break;case 361:break;case 2071:;case 158:;case 143:;case 664:;case 353:break;case 3072:;case 3073:;case 534:;case 677:;case 157:;case 610:;case 2050:;case 155:;case 548:;case 676:;case 128:;case 665:;case 2128:;case 2125:;case 549:;case 2053:;case 596:;case 2076:;case 2075:;case 2082:;case 397:;case 154:;case 1117:;case 553:;case 2091:\nbreak;case 35:a.push(l);n=true;break;case 36:a.pop();n=false;break;case 37:a.push(l);n=true;break;case 38:a.pop();n=false;break;case 16:break;default:if(o.T){}else if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error(\"Unexpected record 0x\"+l.toString(16));}},r);$p(t);t.Names=i;t.supbooks=s;return t}function lg(e,r){pa(e,143);for(var t=0;t!=r.SheetNames.length;++t){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0;var n={Hidden:a,iTabID:t+1,strRelID:\"rId\"+(t+1),name:r.SheetNames[t]};pa(e,156,ag(n))}pa(e,144)}function cg(r,t){if(!t)t=ua(127);for(var a=0;a!=4;++a)t._W(4,0);za(\"SheetJS\",t);za(e.version,t);za(e.version,t);za(\"7262\",t);return t.length>t.l?t.slice(0,t.l):t}function hg(e,r){if(!r)r=ua(29);r._W(-4,0);r._W(-4,460);r._W(4,28800);r._W(4,17600);r._W(4,500);r._W(4,e);r._W(4,e);var t=120;r._W(1,t);return r.length>r.l?r.slice(0,r.l):r}function ug(e,r){if(!r.Workbook||!r.Workbook.Sheets)return;var t=r.Workbook.Sheets;var a=0,n=-1,i=-1;for(;a<t.length;++a){if(!t[a]||!t[a].Hidden&&n==-1)n=a;else if(t[a].Hidden==1&&i==-1)i=a}if(i>n)return;pa(e,135);pa(e,158,hg(n));pa(e,136)}function dg(e,r){var t=va();pa(t,131);pa(t,128,cg());pa(t,153,ig(e.Workbook&&e.Workbook.WBProps||null));ug(t,e,r);lg(t,e,r);pa(t,132);return t.end()}function vg(e,r,t){if(r.slice(-4)===\".bin\")return og(e,t);return eg(e,t)}function pg(e,r,t,a,n,i,s,f){if(r.slice(-4)===\".bin\")return Tp(e,a,t,n,i,s,f);return Yd(e,a,t,n,i,s,f)}function gg(e,r,t,a,n,i,s,f){if(r.slice(-4)===\".bin\")return Bp(e,a,t,n,i,s,f);return Lp(e,a,t,n,i,s,f)}function mg(e,r,t,a,n,i,s,f){if(r.slice(-4)===\".bin\")return Ch(e,a,t,n,i,s,f);return yh(e,a,t,n,i,s,f)}function bg(e,r,t,a,n,i,s,f){if(r.slice(-4)===\".bin\")return Ah(e,a,t,n,i,s,f);return Eh(e,a,t,n,i,s,f)}function wg(e,r,t,a){if(r.slice(-4)===\".bin\")return lc(e,t,a);return Xl(e,t,a)}function kg(e,r,t){return Rc(e,t)}function Tg(e,r,t){if(r.slice(-4)===\".bin\")return Vo(e,t);return Bo(e,t)}function Ag(e,r,t){if(r.slice(-4)===\".bin\")return gh(e,t);return sh(e,t)}function Eg(e,r,t){if(r.slice(-4)===\".bin\")return Qc(e,r,t);return qc(e,r,t)}function Cg(e,r,t,a){if(t.slice(-4)===\".bin\")return rh(e,r,t,a);return eh(e,r,t,a)}function yg(e,r,t){if(r.slice(-4)===\".bin\")return $c(e,r,t);return Kc(e,r,t)}function Sg(e,r,t){return(r.slice(-4)===\".bin\"?dg:rg)(e,t)}function _g(e,r,t,a,n){return(r.slice(-4)===\".bin\"?Dp:pv)(e,t,a,n)}function xg(e,r,t,a,n){return(r.slice(-4)===\".bin\"?Wp:Mp)(e,t,a,n)}function Og(e,r,t){return(r.slice(-4)===\".bin\"?kc:$l)(e,t)}function Rg(e,r,t){return(r.slice(-4)===\".bin\"?Xo:Ho)(e,t)}function Ig(e,r,t){return(r.slice(-4)===\".bin\"?mh:fh)(e,t)}function Ng(e){return(e.slice(-4)===\".bin\"?Yc:Jc)()}var Dg=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;var Fg=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;function Pg(e,r){var t=e.split(/\\s+/);var a=[];if(!r)a[0]=t[0];if(t.length===1)return a;var n=e.match(Dg),i,s,f,o;if(n)for(o=0;o!=n.length;++o){i=n[o].match(Fg);if((s=i[1].indexOf(\":\"))===-1)a[i[1]]=i[2].slice(1,i[2].length-1);else{if(i[1].slice(0,6)===\"xmlns:\")f=\"xmlns\"+i[1].slice(6);else f=i[1].slice(s+1);a[f]=i[2].slice(1,i[2].length-1)}}return a}function Lg(e){var r=e.split(/\\s+/);var t={};if(r.length===1)return t;var a=e.match(Dg),n,i,s,f;if(a)for(f=0;f!=a.length;++f){n=a[f].match(Fg);if((i=n[1].indexOf(\":\"))===-1)t[n[1]]=n[2].slice(1,n[2].length-1);else{if(n[1].slice(0,6)===\"xmlns:\")s=\"xmlns\"+n[1].slice(6);else s=n[1].slice(i+1);t[s]=n[2].slice(1,n[2].length-1)}}return t}var Mg;function Ug(e,r){var t=Mg[e]||Yr(e);if(t===\"General\")return fe(r);return Be(t,r)}function Bg(e,r,t,a){var n=a;switch((t[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]){case\"boolean\":n=nt(a);break;case\"i2\":;case\"int\":n=parseInt(a,10);break;case\"r4\":;case\"float\":n=parseFloat(a);break;case\"date\":;case\"dateTime.tz\":n=gr(a);break;case\"i8\":;case\"string\":;case\"fixed\":;case\"uuid\":;case\"bin.base64\":break;default:throw new Error(\"bad custprop:\"+t[0]);}e[Yr(r)]=n}function Wg(e,r,t){if(e.t===\"z\")return;if(!t||t.cellText!==false)try{if(e.t===\"e\"){e.w=e.w||Gn[e.v]}else if(r===\"General\"){if(e.t===\"n\"){if((e.v|0)===e.v)e.w=e.v.toString(10);else e.w=se(e.v)}else e.w=fe(e.v)}else e.w=Ug(r||\"General\",e.v)}catch(a){if(t.WTF)throw a}try{var n=Mg[r]||r||\"General\";if(t.cellNF)e.z=n;if(t.cellDates&&e.t==\"n\"&&Fe(n)){var i=q(e.v);if(i){e.t=\"d\";e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)}}}catch(a){if(t.WTF)throw a}}function Hg(e,r,t){if(t.cellStyles){if(r.Interior){var a=r.Interior;if(a.Pattern)a.patternType=Ll[a.Pattern]||a.Pattern}}e[r.ID]=r}function zg(e,r,t,a,n,i,s,f,o,l){var c=\"General\",h=a.StyleID,u={};l=l||{};var d=[];var v=0;if(h===undefined&&f)h=f.StyleID;if(h===undefined&&s)h=s.StyleID;while(i[h]!==undefined){if(i[h].nf)c=i[h].nf;if(i[h].Interior)d.push(i[h].Interior);if(!i[h].Parent)break;h=i[h].Parent}switch(t.Type){case\"Boolean\":a.t=\"b\";a.v=nt(e);break;case\"String\":a.t=\"s\";a.r=tt(Yr(e));a.v=e.indexOf(\"<\")>-1?Yr(r||e).replace(/<.*?>/g,\"\"):a.r;break;case\"DateTime\":if(e.slice(-1)!=\"Z\")e+=\"Z\";a.v=(gr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3);if(a.v!==a.v)a.v=Yr(e);else if(a.v<60)a.v=a.v-1;if(!c||c==\"General\")c=\"yyyy-mm-dd\";case\"Number\":if(a.v===undefined)a.v=+e;if(!a.t)a.t=\"n\";break;case\"Error\":a.t=\"e\";a.v=jn[e];if(l.cellText!==false)a.w=e;break;default:if(e==\"\"&&r==\"\"){a.t=\"z\"}else{a.t=\"s\";a.v=tt(r||e)}break;}Wg(a,c,l);if(l.cellFormula!==false){if(a.Formula){var p=Yr(a.Formula);if(p.charCodeAt(0)==61)p=p.slice(1);a.f=Sh(p,n);delete a.Formula;if(a.ArrayRange==\"RC\")a.F=Sh(\"RC:RC\",n);else if(a.ArrayRange){a.F=Sh(a.ArrayRange,n);o.push([Da(a.F),a.F])}}else{for(v=0;v<o.length;++v)if(n.r>=o[v][0].s.r&&n.r<=o[v][0].e.r)if(n.c>=o[v][0].s.c&&n.c<=o[v][0].e.c)a.F=o[v][1]}}if(l.cellStyles){d.forEach(function(e){if(!u.patternType&&e.patternType)u.patternType=e.patternType});a.s=u}if(a.StyleID!==undefined)a.ixfe=a.StyleID}function Vg(e){e.t=e.v||\"\";e.t=e.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");e.v=e.w=e.ixfe=undefined}function Gg(e,r){var t=r||{};ze();var n=d(Et(e));if(t.type==\"binary\"||t.type==\"array\"||t.type==\"base64\"){if(typeof a!==\"undefined\")n=a.utils.decode(65001,c(n));else n=lt(n)}var i=n.slice(0,1024).toLowerCase(),s=false;i=i.replace(/\".*?\"/g,\"\");if((i.indexOf(\">\")&1023)>Math.min(i.indexOf(\",\")&1023,i.indexOf(\";\")&1023)){var f=br(t);f.type=\"string\";return So.to_workbook(n,f)}if(i.indexOf(\"<?xml\")==-1)[\"html\",\"table\",\"head\",\"meta\",\"script\",\"style\",\"div\"].forEach(function(e){if(i.indexOf(\"<\"+e)>=0)s=true});if(s)return Hm(n,t);Mg={\"General Number\":\"General\",\"General Date\":X[22],\"Long Date\":\"dddd, mmmm dd, yyyy\",\"Medium Date\":X[15],\"Short Date\":X[14],\"Long Time\":X[19],\"Medium Time\":X[18],\"Short Time\":X[20],Currency:'\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',Fixed:X[2],Standard:X[4],Percent:X[10],Scientific:X[11],\"Yes/No\":'\"Yes\";\"Yes\";\"No\";@',\"True/False\":'\"True\";\"True\";\"False\";@',\"On/Off\":'\"Yes\";\"Yes\";\"No\";@'};var o;var l=[],h;if(g!=null&&t.dense==null)t.dense=g;var u={},v=[],p=t.dense?[]:{},m=\"\";var b={},w={};var k=Pg('<Data ss:Type=\"String\">'),T=0;var A=0,E=0;var C={s:{r:2e6,c:2e6},e:{r:0,c:0}};var y={},S={};var _=\"\",x=0;var O=[];var R={},I={},N=0,D=[];var F=[],P={};var L=[],M,U=false;var B=[];var W=[],H={},z=0,V=0;var G={Sheets:[],WBProps:{date1904:false}},j={};Ct.lastIndex=0;n=n.replace(/<!--([\\s\\S]*?)-->/gm,\"\");var $=\"\";while(o=Ct.exec(n))switch(o[3]=($=o[3]).toLowerCase()){case\"data\":if($==\"data\"){if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else if(o[0].charAt(o[0].length-2)!==\"/\")l.push([o[3],true]);break}if(l[l.length-1][1])break;if(o[1]===\"/\")zg(n.slice(T,o.index),_,k,l[l.length-1][0]==\"comment\"?P:b,{c:A,r:E},y,L[A],w,B,t);else{_=\"\";k=Pg(o[0]);T=o.index+o[0].length}break;case\"cell\":if(o[1]===\"/\"){if(F.length>0)b.c=F;if((!t.sheetRows||t.sheetRows>E)&&b.v!==undefined){if(t.dense){if(!p[E])p[E]=[];p[E][A]=b}else p[ya(A)+Ta(E)]=b}if(b.HRef){b.l={Target:Yr(b.HRef)};if(b.HRefScreenTip)b.l.Tooltip=b.HRefScreenTip;delete b.HRef;delete b.HRefScreenTip}if(b.MergeAcross||b.MergeDown){z=A+(parseInt(b.MergeAcross,10)|0);V=E+(parseInt(b.MergeDown,10)|0);O.push({s:{c:A,r:E},e:{c:z,r:V}})}if(!t.sheetStubs){if(b.MergeAcross)A=z+1;else++A}else if(b.MergeAcross||b.MergeDown){for(var Y=A;Y<=z;++Y){for(var K=E;K<=V;++K){if(Y>A||K>E){if(t.dense){if(!p[K])p[K]=[];p[K][Y]={t:\"z\"}}else p[ya(Y)+Ta(K)]={t:\"z\"}}}}A=z+1}else++A}else{b=Lg(o[0]);if(b.Index)A=+b.Index-1;if(A<C.s.c)C.s.c=A;if(A>C.e.c)C.e.c=A;if(o[0].slice(-2)===\"/>\")++A;F=[]}break;case\"row\":if(o[1]===\"/\"||o[0].slice(-2)===\"/>\"){if(E<C.s.r)C.s.r=E;if(E>C.e.r)C.e.r=E;if(o[0].slice(-2)===\"/>\"){w=Pg(o[0]);if(w.Index)E=+w.Index-1}A=0;++E}else{w=Pg(o[0]);if(w.Index)E=+w.Index-1;H={};if(w.AutoFitHeight==\"0\"||w.Height){H.hpx=parseInt(w.Height,10);H.hpt=Fl(H.hpx);W[E]=H}if(w.Hidden==\"1\"){H.hidden=true;W[E]=H}}break;case\"worksheet\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"));v.push(m);if(C.s.r<=C.e.r&&C.s.c<=C.e.c){p[\"!ref\"]=Na(C);if(t.sheetRows&&t.sheetRows<=C.e.r){p[\"!fullref\"]=p[\"!ref\"];C.e.r=t.sheetRows-1;p[\"!ref\"]=Na(C)}}if(O.length)p[\"!merges\"]=O;if(L.length>0)p[\"!cols\"]=L;if(W.length>0)p[\"!rows\"]=W;u[m]=p}else{C={s:{r:2e6,c:2e6},e:{r:0,c:0}};E=A=0;l.push([o[3],false]);h=Pg(o[0]);m=Yr(h.Name);p=t.dense?[]:{};O=[];B=[];W=[];j={name:m,Hidden:0};G.Sheets.push(j)}break;case\"table\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else if(o[0].slice(-2)==\"/>\")break;else{l.push([o[3],false]);L=[];U=false}break;case\"style\":if(o[1]===\"/\")Hg(y,S,t);else S=Pg(o[0]);break;case\"numberformat\":S.nf=Yr(Pg(o[0]).Format||\"General\");if(Mg[S.nf])S.nf=Mg[S.nf];for(var J=0;J!=392;++J)if(X[J]==S.nf)break;if(J==392)for(J=57;J!=392;++J)if(X[J]==null){We(S.nf,J);break}break;case\"column\":if(l[l.length-1][0]!==\"table\")break;M=Pg(o[0]);if(M.Hidden){M.hidden=true;delete M.Hidden}if(M.Width)M.wpx=parseInt(M.Width,10);if(!U&&M.wpx>10){U=true;yl=Al;for(var q=0;q<L.length;++q)if(L[q])Il(L[q])}if(U)Il(M);L[M.Index-1||L.length]=M;for(var Z=0;Z<+M.Span;++Z)L[L.length]=br(M);break;case\"namedrange\":if(o[1]===\"/\")break;if(!G.Names)G.Names=[];var Q=Gr(o[0]);var ee={Name:Q.Name,Ref:Sh(Q.RefersTo.slice(1),{r:0,c:0})};if(G.Sheets.length>0)ee.Sheet=G.Sheets.length-1;G.Names.push(ee);break;case\"namedcell\":break;case\"b\":break;case\"i\":break;case\"u\":break;case\"s\":break;case\"em\":break;case\"h2\":break;case\"h3\":break;case\"sub\":break;case\"sup\":break;case\"span\":break;case\"alignment\":break;case\"borders\":break;case\"border\":break;case\"font\":if(o[0].slice(-2)===\"/>\")break;else if(o[1]===\"/\")_+=n.slice(x,o.index);else x=o.index+o[0].length;break;case\"interior\":if(!t.cellStyles)break;S.Interior=Pg(o[0]);break;case\"protection\":break;case\"author\":;case\"title\":;case\"description\":;case\"created\":;case\"keywords\":;case\"subject\":;case\"category\":;case\"company\":;case\"lastauthor\":;case\"lastsaved\":;case\"lastprinted\":;case\"version\":;case\"revision\":;case\"totaltime\":;case\"hyperlinkbase\":;case\"manager\":;case\"contentstatus\":;case\"identifier\":;case\"language\":;case\"appname\":if(o[0].slice(-2)===\"/>\")break;else if(o[1]===\"/\")Ci(R,$,n.slice(N,o.index));else N=o.index+o[0].length;break;case\"paragraphs\":break;case\"styles\":;case\"workbook\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else l.push([o[3],false]);break;case\"comment\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"));Vg(P);F.push(P)}else{l.push([o[3],false]);h=Pg(o[0]);P={a:h.Author}}break;case\"autofilter\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else if(o[0].charAt(o[0].length-2)!==\"/\"){var re=Pg(o[0]);p[\"!autofilter\"]={ref:Sh(re.Range).replace(/\\$/g,\"\")};l.push([o[3],true])}break;case\"name\":break;case\"datavalidation\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else{if(o[0].charAt(o[0].length-2)!==\"/\")l.push([o[3],true])}break;case\"pixelsperinch\":break;case\"componentoptions\":;case\"documentproperties\":;case\"customdocumentproperties\":;case\"officedocumentsettings\":;case\"pivottable\":;case\"pivotcache\":;case\"names\":;case\"mapinfo\":;case\"pagebreaks\":;case\"querytable\":;case\"sorting\":;case\"schema\":;case\"conditionalformatting\":;case\"smarttagtype\":;case\"smarttags\":;case\"excelworkbook\":;case\"workbookoptions\":;case\"worksheetoptions\":if(o[1]===\"/\"){if((h=l.pop())[0]!==o[3])throw new Error(\"Bad state: \"+h.join(\"|\"))}else if(o[0].charAt(o[0].length-2)!==\"/\")l.push([o[3],true]);break;case\"null\":break;default:if(l.length==0&&o[3]==\"document\")return Qm(n,t);if(l.length==0&&o[3]==\"uof\")return Qm(n,t);var te=true;switch(l[l.length-1][0]){case\"officedocumentsettings\":switch(o[3]){case\"allowpng\":break;case\"removepersonalinformation\":break;case\"downloadcomponents\":break;case\"locationofcomponents\":break;case\"colors\":break;case\"color\":break;case\"index\":break;case\"rgb\":break;case\"targetscreensize\":break;case\"readonlyrecommended\":break;default:te=false;}break;case\"componentoptions\":switch(o[3]){case\"toolbar\":break;case\"hideofficelogo\":break;case\"spreadsheetautofit\":break;case\"label\":break;case\"caption\":break;case\"maxheight\":break;case\"maxwidth\":break;case\"nextsheetnumber\":break;default:te=false;}break;case\"excelworkbook\":switch(o[3]){case\"date1904\":G.WBProps.date1904=true;break;case\"windowheight\":break;case\"windowwidth\":break;case\"windowtopx\":break;case\"windowtopy\":break;case\"tabratio\":break;case\"protectstructure\":break;case\"protectwindow\":break;case\"protectwindows\":break;case\"activesheet\":break;case\"displayinknotes\":break;case\"firstvisiblesheet\":break;case\"supbook\":break;case\"sheetname\":break;case\"sheetindex\":break;case\"sheetindexfirst\":break;case\"sheetindexlast\":break;case\"dll\":break;case\"acceptlabelsinformulas\":break;case\"donotsavelinkvalues\":break;case\"iteration\":break;case\"maxiterations\":break;case\"maxchange\":break;case\"path\":break;case\"xct\":break;case\"count\":break;case\"selectedsheets\":break;case\"calculation\":break;case\"uncalced\":break;case\"startupprompt\":break;case\"crn\":break;case\"externname\":break;case\"formula\":break;case\"colfirst\":break;case\"collast\":break;case\"wantadvise\":break;case\"boolean\":break;case\"error\":break;case\"text\":break;case\"ole\":break;case\"noautorecover\":break;case\"publishobjects\":break;case\"donotcalculatebeforesave\":break;case\"number\":break;case\"refmoder1c1\":break;case\"embedsavesmarttags\":break;default:te=false;}break;case\"workbookoptions\":switch(o[3]){case\"owcversion\":break;case\"height\":break;case\"width\":break;default:te=false;}break;case\"worksheetoptions\":switch(o[3]){case\"visible\":if(o[0].slice(-2)===\"/>\"){}else if(o[1]===\"/\")switch(n.slice(N,o.index)){case\"SheetHidden\":j.Hidden=1;break;case\"SheetVeryHidden\":j.Hidden=2;break;}else N=o.index+o[0].length;break;case\"header\":if(!p[\"!margins\"])Dd(p[\"!margins\"]={},\"xlml\");if(!isNaN(+Gr(o[0]).Margin))p[\"!margins\"].header=+Gr(o[0]).Margin;break;case\"footer\":if(!p[\"!margins\"])Dd(p[\"!margins\"]={},\"xlml\");if(!isNaN(+Gr(o[0]).Margin))p[\"!margins\"].footer=+Gr(o[0]).Margin;break;case\"pagemargins\":var ae=Gr(o[0]);if(!p[\"!margins\"])Dd(p[\"!margins\"]={},\"xlml\");if(!isNaN(+ae.Top))p[\"!margins\"].top=+ae.Top;if(!isNaN(+ae.Left))p[\"!margins\"].left=+ae.Left;if(!isNaN(+ae.Right))p[\"!margins\"].right=+ae.Right;if(!isNaN(+ae.Bottom))p[\"!margins\"].bottom=+ae.Bottom;break;case\"displayrighttoleft\":if(!G.Views)G.Views=[];if(!G.Views[0])G.Views[0]={};G.Views[0].RTL=true;break;case\"freezepanes\":break;case\"frozennosplit\":break;case\"splithorizontal\":;case\"splitvertical\":break;case\"donotdisplaygridlines\":break;case\"activerow\":break;case\"activecol\":break;case\"toprowbottompane\":break;case\"leftcolumnrightpane\":break;case\"unsynced\":break;case\"print\":break;case\"printerrors\":break;case\"panes\":break;case\"scale\":break;case\"pane\":break;case\"number\":break;case\"layout\":break;case\"pagesetup\":break;case\"selected\":break;case\"protectobjects\":break;case\"enableselection\":break;case\"protectscenarios\":break;case\"validprinterinfo\":break;case\"horizontalresolution\":break;case\"verticalresolution\":break;case\"numberofcopies\":break;case\"activepane\":break;case\"toprowvisible\":break;case\"leftcolumnvisible\":break;case\"fittopage\":break;case\"rangeselection\":break;case\"papersizeindex\":break;case\"pagelayoutzoom\":break;case\"pagebreakzoom\":break;case\"filteron\":break;case\"fitwidth\":break;case\"fitheight\":break;case\"commentslayout\":break;case\"zoom\":break;case\"lefttoright\":break;case\"gridlines\":break;case\"allowsort\":break;case\"allowfilter\":break;case\"allowinsertrows\":break;case\"allowdeleterows\":break;case\"allowinsertcols\":break;case\"allowdeletecols\":break;case\"allowinserthyperlinks\":break;case\"allowformatcells\":break;case\"allowsizecols\":break;case\"allowsizerows\":break;case\"nosummaryrowsbelowdetail\":if(!p[\"!outline\"])p[\"!outline\"]={};p[\"!outline\"].above=true;break;case\"tabcolorindex\":break;case\"donotdisplayheadings\":break;case\"showpagelayoutzoom\":break;case\"nosummarycolumnsrightdetail\":if(!p[\"!outline\"])p[\"!outline\"]={};p[\"!outline\"].left=true;break;case\"blackandwhite\":break;case\"donotdisplayzeros\":break;case\"displaypagebreak\":break;case\"rowcolheadings\":break;case\"donotdisplayoutline\":break;case\"noorientation\":break;case\"allowusepivottables\":break;case\"zeroheight\":break;case\"viewablerange\":break;case\"selection\":break;case\"protectcontents\":break;default:te=false;}break;case\"pivottable\":;case\"pivotcache\":switch(o[3]){case\"immediateitemsondrop\":break;case\"showpagemultipleitemlabel\":break;case\"compactrowindent\":break;case\"location\":break;case\"pivotfield\":break;case\"orientation\":break;case\"layoutform\":break;case\"layoutsubtotallocation\":break;case\"layoutcompactrow\":break;case\"position\":break;case\"pivotitem\":break;case\"datatype\":break;case\"datafield\":break;case\"sourcename\":break;case\"parentfield\":break;case\"ptlineitems\":break;case\"ptlineitem\":break;case\"countofsameitems\":break;case\"item\":break;case\"itemtype\":break;case\"ptsource\":break;case\"cacheindex\":break;case\"consolidationreference\":break;case\"filename\":break;case\"reference\":break;case\"nocolumngrand\":break;case\"norowgrand\":break;case\"blanklineafteritems\":break;case\"hidden\":break;case\"subtotal\":break;case\"basefield\":break;case\"mapchilditems\":break;case\"function\":break;case\"refreshonfileopen\":break;case\"printsettitles\":break;case\"mergelabels\":break;case\"defaultversion\":break;case\"refreshname\":break;case\"refreshdate\":break;case\"refreshdatecopy\":break;case\"versionlastrefresh\":break;case\"versionlastupdate\":break;case\"versionupdateablemin\":break;case\"versionrefreshablemin\":break;case\"calculation\":break;default:te=false;}break;case\"pagebreaks\":switch(o[3]){case\"colbreaks\":break;case\"colbreak\":break;case\"rowbreaks\":break;case\"rowbreak\":break;case\"colstart\":break;case\"colend\":break;case\"rowend\":break;default:te=false;}break;case\"autofilter\":switch(o[3]){case\"autofiltercolumn\":break;case\"autofiltercondition\":break;case\"autofilterand\":break;case\"autofilteror\":break;default:te=false;}break;case\"querytable\":switch(o[3]){case\"id\":break;case\"autoformatfont\":break;case\"autoformatpattern\":break;case\"querysource\":break;case\"querytype\":break;case\"enableredirections\":break;case\"refreshedinxl9\":break;case\"urlstring\":break;case\"htmltables\":break;case\"connection\":break;case\"commandtext\":break;case\"refreshinfo\":break;case\"notitles\":break;case\"nextid\":break;case\"columninfo\":break;case\"overwritecells\":break;case\"donotpromptforfile\":break;case\"textwizardsettings\":break;case\"source\":break;case\"number\":break;case\"decimal\":break;case\"thousandseparator\":break;case\"trailingminusnumbers\":break;case\"formatsettings\":break;case\"fieldtype\":break;case\"delimiters\":break;case\"tab\":break;case\"comma\":break;case\"autoformatname\":break;case\"versionlastedit\":break;case\"versionlastrefresh\":break;default:te=false;}break;case\"datavalidation\":switch(o[3]){case\"range\":break;case\"type\":break;case\"min\":break;case\"max\":break;case\"sort\":break;case\"descending\":break;case\"order\":break;case\"casesensitive\":break;case\"value\":break;case\"errorstyle\":break;case\"errormessage\":break;case\"errortitle\":break;case\"inputmessage\":break;case\"inputtitle\":break;case\"combohide\":break;case\"inputhide\":break;case\"condition\":break;case\"qualifier\":break;case\"useblank\":break;case\"value1\":break;case\"value2\":break;case\"format\":break;case\"cellrangelist\":break;default:te=false;}break;case\"sorting\":;case\"conditionalformatting\":switch(o[3]){case\"range\":break;case\"type\":break;case\"min\":break;case\"max\":break;case\"sort\":break;case\"descending\":break;case\"order\":break;case\"casesensitive\":break;case\"value\":break;case\"errorstyle\":break;case\"errormessage\":break;case\"errortitle\":break;case\"cellrangelist\":break;case\"inputmessage\":break;case\"inputtitle\":break;case\"combohide\":break;case\"inputhide\":break;case\"condition\":break;case\"qualifier\":break;case\"useblank\":break;case\"value1\":break;case\"value2\":break;case\"format\":break;default:te=false;}break;case\"mapinfo\":;case\"schema\":;case\"data\":switch(o[3]){case\"map\":break;case\"entry\":break;case\"range\":break;case\"xpath\":break;case\"field\":break;case\"xsdtype\":break;case\"filteron\":break;case\"aggregate\":break;case\"elementtype\":break;case\"attributetype\":break;case\"schema\":;case\"element\":;case\"complextype\":;case\"datatype\":;case\"all\":;case\"attribute\":;case\"extends\":break;case\"row\":break;default:te=false;}break;case\"smarttags\":break;default:te=false;break;}if(te)break;if(o[3].match(/!\\[CDATA/))break;if(!l[l.length-1][1])throw\"Unrecognized tag: \"+o[3]+\"|\"+l.join(\"|\");if(l[l.length-1][0]===\"customdocumentproperties\"){if(o[0].slice(-2)===\"/>\")break;else if(o[1]===\"/\")Bg(I,$,D,n.slice(N,o.index));else{D=o;N=o.index+o[0].length}break}if(t.WTF)throw\"Unrecognized tag: \"+o[3]+\"|\"+l.join(\"|\");}var ne={};if(!t.bookSheets&&!t.bookProps)ne.Sheets=u;ne.SheetNames=v;ne.Workbook=G;ne.SSF=br(X);ne.Props=R;ne.Custprops=I;return ne}function jg(e,r){Wb(r=r||{});switch(r.type||\"base64\"){case\"base64\":return Gg(k(e),r);case\"binary\":;case\"buffer\":;case\"file\":return Gg(e,r);case\"array\":return Gg(_(e),r);}}function Xg(e,r){var t=[];if(e.Props)t.push(yi(e.Props,r));if(e.Custprops)t.push(Si(e.Props,e.Custprops,r));return t.join(\"\")}function $g(){return\"\"}function Yg(e,r){var t=['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];r.cellXfs.forEach(function(e,r){var a=[];a.push(kt(\"NumberFormat\",null,{\"ss:Format\":qr(X[e.numFmtId])}));var n={\"ss:ID\":\"s\"+(21+r)};t.push(kt(\"Style\",a.join(\"\"),n))});return kt(\"Styles\",t.join(\"\"))}function Kg(e){return kt(\"NamedRange\",null,{\"ss:Name\":e.Name,\"ss:RefersTo\":\"=\"+xh(e.Ref,{r:0,c:0})})}function Jg(e){if(!((e||{}).Workbook||{}).Names)return\"\";var r=e.Workbook.Names;var t=[];for(var a=0;a<r.length;++a){var n=r[a];if(n.Sheet!=null)continue;if(n.Name.match(/^_xlfn\\./))continue;t.push(Kg(n))}return kt(\"Names\",t.join(\"\"))}function qg(e,r,t,a){if(!e)return\"\";if(!((a||{}).Workbook||{}).Names)return\"\";var n=a.Workbook.Names;var i=[];for(var s=0;s<n.length;++s){var f=n[s];if(f.Sheet!=t)continue;if(f.Name.match(/^_xlfn\\./))continue;i.push(Kg(f))}return i.join(\"\")}function Zg(e,r,t,a){if(!e)return\"\";var n=[];if(e[\"!margins\"]){n.push(\"<PageSetup>\");if(e[\"!margins\"].header)n.push(kt(\"Header\",null,{\"x:Margin\":e[\"!margins\"].header}));if(e[\"!margins\"].footer)n.push(kt(\"Footer\",null,{\"x:Margin\":e[\"!margins\"].footer}));n.push(kt(\"PageMargins\",null,{\"x:Bottom\":e[\"!margins\"].bottom||\"0.75\",\"x:Left\":e[\"!margins\"].left||\"0.7\",\"x:Right\":e[\"!margins\"].right||\"0.7\",\"x:Top\":e[\"!margins\"].top||\"0.75\"}));n.push(\"</PageSetup>\")}if(a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]){if(a.Workbook.Sheets[t].Hidden)n.push(kt(\"Visible\",a.Workbook.Sheets[t].Hidden==1?\"SheetHidden\":\"SheetVeryHidden\",{}));else{for(var i=0;i<t;++i)if(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden)break;if(i==t)n.push(\"<Selected/>\")}}if(((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL)n.push(\"<DisplayRightToLeft/>\");if(e[\"!protect\"]){n.push(bt(\"ProtectContents\",\"True\"));if(e[\"!protect\"].objects)n.push(bt(\"ProtectObjects\",\"True\"));if(e[\"!protect\"].scenarios)n.push(bt(\"ProtectScenarios\",\"True\"));if(e[\"!protect\"].selectLockedCells!=null&&!e[\"!protect\"].selectLockedCells)n.push(bt(\"EnableSelection\",\"NoSelection\"));else if(e[\"!protect\"].selectUnlockedCells!=null&&!e[\"!protect\"].selectUnlockedCells)n.push(bt(\"EnableSelection\",\"UnlockedCells\"));[[\"formatCells\",\"AllowFormatCells\"],[\"formatColumns\",\"AllowSizeCols\"],[\"formatRows\",\"AllowSizeRows\"],[\"insertColumns\",\"AllowInsertCols\"],[\"insertRows\",\"AllowInsertRows\"],[\"insertHyperlinks\",\"AllowInsertHyperlinks\"],[\"deleteColumns\",\"AllowDeleteCols\"],[\"deleteRows\",\"AllowDeleteRows\"],[\"sort\",\"AllowSort\"],[\"autoFilter\",\"AllowFilter\"],[\"pivotTables\",\"AllowUsePivotTables\"]].forEach(function(r){if(e[\"!protect\"][r[0]])n.push(\"<\"+r[1]+\"/>\")})}if(n.length==0)return\"\";return kt(\"WorksheetOptions\",n.join(\"\"),{xmlns:_t.x})}function Qg(e){return e.map(function(e){var r=at(e.t||\"\");var t=kt(\"ss:Data\",r,{xmlns:\"http://www.w3.org/TR/REC-html40\"});return kt(\"Comment\",t,{\"ss:Author\":e.a})}).join(\"\")}function em(e,r,t,a,n,i,s){if(!e||e.v==undefined&&e.f==undefined)return\"\";var f={};if(e.f)f[\"ss:Formula\"]=\"=\"+qr(xh(e.f,s));if(e.F&&e.F.slice(0,r.length)==r){var o=Oa(e.F.slice(r.length+1));f[\"ss:ArrayRange\"]=\"RC:R\"+(o.r==s.r?\"\":\"[\"+(o.r-s.r)+\"]\")+\"C\"+(o.c==s.c?\"\":\"[\"+(o.c-s.c)+\"]\")}if(e.l&&e.l.Target){f[\"ss:HRef\"]=qr(e.l.Target);if(e.l.Tooltip)f[\"x:HRefScreenTip\"]=qr(e.l.Tooltip)}if(t[\"!merges\"]){var l=t[\"!merges\"];for(var c=0;c!=l.length;++c){if(l[c].s.c!=s.c||l[c].s.r!=s.r)continue;if(l[c].e.c>l[c].s.c)f[\"ss:MergeAcross\"]=l[c].e.c-l[c].s.c;if(l[c].e.r>l[c].s.r)f[\"ss:MergeDown\"]=l[c].e.r-l[c].s.r}}var h=\"\",u=\"\";switch(e.t){case\"z\":if(!a.sheetStubs)return\"\";break;case\"n\":h=\"Number\";u=String(e.v);break;case\"b\":h=\"Boolean\";u=e.v?\"1\":\"0\";break;case\"e\":h=\"Error\";u=Gn[e.v];break;case\"d\":h=\"DateTime\";u=new Date(e.v).toISOString();if(e.z==null)e.z=e.z||X[14];break;case\"s\":h=\"String\";u=rt(e.v||\"\");break;}var d=Fd(a.cellXfs,e,a);f[\"ss:StyleID\"]=\"s\"+(21+d);f[\"ss:Index\"]=s.c+1;var v=e.v!=null?u:\"\";var p=e.t==\"z\"?\"\":'<Data ss:Type=\"'+h+'\">'+v+\"</Data>\";if((e.c||[]).length>0)p+=Qg(e.c);return kt(\"Cell\",p,f)}function rm(e,r){var t='<Row ss:Index=\"'+(e+1)+'\"';if(r){if(r.hpt&&!r.hpx)r.hpx=Pl(r.hpt);if(r.hpx)t+=' ss:AutoFitHeight=\"0\" ss:Height=\"'+r.hpx+'\"';if(r.hidden)t+=' ss:Hidden=\"1\"'}return t+\">\"}function tm(e,r,t,a){if(!e[\"!ref\"])return\"\";var n=Da(e[\"!ref\"]);var i=e[\"!merges\"]||[],s=0;var f=[];if(e[\"!cols\"])e[\"!cols\"].forEach(function(e,r){Il(e);var t=!!e.width;var a=Nd(r,e);var n={\"ss:Index\":r+1};if(t)n[\"ss:Width\"]=Sl(a.width);if(e.hidden)n[\"ss:Hidden\"]=\"1\";f.push(kt(\"Column\",null,n))});var o=Array.isArray(e);for(var l=n.s.r;l<=n.e.r;++l){var c=[rm(l,(e[\"!rows\"]||[])[l])];for(var h=n.s.c;h<=n.e.c;++h){var u=false;for(s=0;s!=i.length;++s){if(i[s].s.c>h)continue;if(i[s].s.r>l)continue;if(i[s].e.c<h)continue;if(i[s].e.r<l)continue;if(i[s].s.c!=h||i[s].s.r!=l)u=true;break}if(u)continue;var d={r:l,c:h};var v=Ra(d),p=o?(e[l]||[])[h]:e[v];c.push(em(p,v,e,r,t,a,d))}c.push(\"</Row>\");if(c.length>2)f.push(c.join(\"\"))}return f.join(\"\")}function am(e,r,t){var a=[];var n=t.SheetNames[e];var i=t.Sheets[n];var s=i?qg(i,r,e,t):\"\";if(s.length>0)a.push(\"<Names>\"+s+\"</Names>\");s=i?tm(i,r,e,t):\"\";if(s.length>0)a.push(\"<Table>\"+s+\"</Table>\");a.push(Zg(i,r,e,t));return a.join(\"\")}function nm(e,r){if(!r)r={};if(!e.SSF)e.SSF=br(X);if(e.SSF){ze();He(e.SSF);r.revssf=nr(e.SSF);r.revssf[e.SSF[65535]]=0;r.ssf=e.SSF;r.cellXfs=[];Fd(r.cellXfs,{},{revssf:{General:0}})}var t=[];t.push(Xg(e,r));t.push($g(e,r));t.push(\"\");t.push(\"\");for(var a=0;a<e.SheetNames.length;++a)t.push(kt(\"Worksheet\",am(a,r,e),{\"ss:Name\":qr(e.SheetNames[a])}));t[2]=Yg(e,r);t[3]=Jg(e,r);return Mr+kt(\"Workbook\",t.join(\"\"),{xmlns:_t.ss,\"xmlns:o\":_t.o,\"xmlns:x\":_t.x,\"xmlns:ss\":_t.ss,\"xmlns:dt\":_t.dt,\"xmlns:html\":_t.html})}function im(e){var r={};var t=e.content;t.l=28;r.AnsiUserType=t._R(0,\"lpstr-ansi\");r.AnsiClipboardFormat=kn(t);if(t.length-t.l<=4)return r;var a=t._R(4);if(a==0||a>40)return r;t.l-=4;r.Reserved1=t._R(0,\"lpstr-ansi\");if(t.length-t.l<=4)return r;a=t._R(4);if(a!==1907505652)return r;r.UnicodeClipboardFormat=Tn(t);a=t._R(4);if(a==0||a>40)return r;t.l-=4;r.Reserved2=t._R(0,\"lpwstr\")}var sm=[60,1084,2066,2165,2175];function fm(e,r,t,a,n){var i=a;var s=[];var f=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&f.length>0)switch(e){case 9:;case 521:;case 1033:;case 2057:;case 47:;case 405:;case 225:;case 406:;case 312:;case 404:;case 10:break;case 133:break;default:n.enc.insitu(f);}s.push(f);t.l+=i;var o=Qt(t,t.l),l=mm[o];var c=0;while(l!=null&&sm.indexOf(o)>-1){i=Qt(t,t.l+2);c=t.l+4;if(o==2066)c+=4;else if(o==2165||o==2175){c+=12}f=t.slice(c,t.l+4+i);s.push(f);t.l+=4+i;l=mm[o=Qt(t,t.l)]}var h=R(s);ca(h,0);var u=0;h.lens=[];for(var d=0;d<s.length;++d){h.lens.push(u);u+=s[d].length}if(h.length<a)throw\"XLS Record 0x\"+e.toString(16)+\" Truncated: \"+h.length+\" < \"+a;return r.f(h,h.length,n)}function om(e,r,t){if(e.t===\"z\")return;if(!e.XF)return;var a=0;try{a=e.z||e.XF.numFmtId||0;if(r.cellNF)e.z=X[a]}catch(n){if(r.WTF)throw n}if(!r||r.cellText!==false)try{if(e.t===\"e\"){e.w=e.w||Gn[e.v]}else if(a===0||a==\"General\"){if(e.t===\"n\"){if((e.v|0)===e.v)e.w=e.v.toString(10);else e.w=se(e.v)}else e.w=fe(e.v)}else e.w=Be(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(n){if(r.WTF)throw n}if(r.cellDates&&a&&e.t==\"n\"&&Fe(X[a]||String(a))){var i=q(e.v);if(i){e.t=\"d\";e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)}}}function lm(e,r,t){return{v:e,ixfe:r,t:t}}function cm(e,r){var t={opts:{}};var a={};if(g!=null&&r.dense==null)r.dense=g;var n=r.dense?[]:{};var i={};var s={};var f=null;var l=[];var c=\"\";var h={};var u,d=\"\",v,p,m,b;var w={};var k=[];var T;var A;var E=[];var C=[];var y={Sheets:[],WBProps:{date1904:false},Views:[{}]},S={};var _=function ve(e){if(e<8)return Vn[e];if(e<64)return C[e-8]||Vn[e];return Vn[e]};var x=function pe(e,r,t){var a=r.XF.data;if(!a||!a.patternType||!t||!t.cellStyles)return;r.s={};r.s.patternType=a.patternType;var n;if(n=bl(_(a.icvFore))){r.s.fgColor={rgb:n}}if(n=bl(_(a.icvBack))){r.s.bgColor={rgb:n}}};var O=function ge(e,r,t){if(B>1)return;if(t.sheetRows&&e.r>=t.sheetRows)return;if(t.cellStyles&&r.XF&&r.XF.data)x(e,r,t);delete r.ixfe;delete r.XF;u=e;d=Ra(e);if(!s||!s.s||!s.e)s={s:{r:0,c:0},e:{r:0,c:0}};if(e.r<s.s.r)s.s.r=e.r;if(e.c<s.s.c)s.s.c=e.c;if(e.r+1>s.e.r)s.e.r=e.r+1;if(e.c+1>s.e.c)s.e.c=e.c+1;if(t.cellFormula&&r.f){for(var a=0;a<k.length;++a){if(k[a][0].s.c>e.c||k[a][0].s.r>e.r)continue;if(k[a][0].e.c<e.c||k[a][0].e.r<e.r)continue;r.F=Na(k[a][0]);if(k[a][0].s.c!=e.c||k[a][0].s.r!=e.r)delete r.f;if(r.f)r.f=\"\"+fd(k[a][1],s,e,M,R);break}}{if(t.dense){if(!n[e.r])n[e.r]=[];n[e.r][e.c]=r}else n[d]=r}};var R={enc:false,sbcch:0,snames:[],sharedf:w,arrayf:k,rrtabid:[],lastuser:\"\",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};if(r.password)R.password=r.password;var I;var N=[];var D=[];var F=[],P=[];var L=false;var M=[];M.SheetNames=R.snames;M.sharedf=R.sharedf;M.arrayf=R.arrayf;M.names=[];M.XTI=[];var U=0;var B=0;var W=0,H=[];var z=[];var V;R.codepage=1200;o(1200);var G=false;while(e.l<e.length-1){var j=e.l;var $=e._R(2);if($===0&&U===10)break;var Y=e.l===e.length?0:e._R(2);var K=mm[$];if(K&&K.f){if(r.bookSheets){if(U===133&&$!==133)break}U=$;if(K.r===2||K.r==12){var J=e._R(2);Y-=2;if(!R.enc&&J!==$&&((J&255)<<8|J>>8)!==$)throw new Error(\"rt mismatch: \"+J+\"!=\"+$);if(K.r==12){e.l+=10;Y-=10}}var q={};if($===10)q=K.f(e,Y,R);else q=fm($,K,e,Y,R);if(B==0&&[9,521,1033,2057].indexOf(U)===-1)continue;switch($){case 34:t.opts.Date1904=y.WBProps.date1904=q;break;case 134:t.opts.WriteProtect=true;break;case 47:if(!R.enc)e.l=0;R.enc=q;if(!r.password)throw new Error(\"File is password-protected\");if(q.valid==null)throw new Error(\"Encryption scheme unsupported\");if(!q.valid)throw new Error(\"Password is incorrect\");break;case 92:R.lastuser=q;break;case 66:var Z=Number(q);switch(Z){case 21010:Z=1200;break;case 32768:Z=1e4;break;case 32769:Z=1252;break;}o(R.codepage=Z);G=true;break;case 317:R.rrtabid=q;break;case 25:R.winlocked=q;break;case 439:t.opts[\"RefreshAll\"]=q;break;case 12:t.opts[\"CalcCount\"]=q;break;case 16:t.opts[\"CalcDelta\"]=q;break;case 17:\nt.opts[\"CalcIter\"]=q;break;case 13:t.opts[\"CalcMode\"]=q;break;case 14:t.opts[\"CalcPrecision\"]=q;break;case 95:t.opts[\"CalcSaveRecalc\"]=q;break;case 15:R.CalcRefMode=q;break;case 2211:t.opts.FullCalc=q;break;case 129:if(q.fDialog)n[\"!type\"]=\"dialog\";if(!q.fBelow)(n[\"!outline\"]||(n[\"!outline\"]={})).above=true;if(!q.fRight)(n[\"!outline\"]||(n[\"!outline\"]={})).left=true;break;case 224:E.push(q);break;case 430:M.push([q]);M[M.length-1].XTI=[];break;case 35:;case 547:M[M.length-1].push(q);break;case 24:;case 536:V={Name:q.Name,Ref:fd(q.rgce,s,null,M,R)};if(q.itab>0)V.Sheet=q.itab-1;M.names.push(V);if(!M[0]){M[0]=[];M[0].XTI=[]}M[M.length-1].push(q);if(q.Name==\"_xlnm._FilterDatabase\"&&q.itab>0)if(q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]==\"PtgArea3d\")z[q.itab-1]={ref:Na(q.rgce[0][0][1][2])};break;case 22:R.ExternCount=q;break;case 23:if(M.length==0){M[0]=[];M[0].XTI=[]}M[M.length-1].XTI=M[M.length-1].XTI.concat(q);M.XTI=M.XTI.concat(q);break;case 2196:if(R.biff<8)break;if(V!=null)V.Comment=q[1];break;case 18:n[\"!protect\"]=q;break;case 19:if(q!==0&&R.WTF)console.error(\"Password verifier: \"+q);break;case 133:{i[q.pos]=q;R.snames.push(q.name)}break;case 10:{if(--B)break;if(s.e){if(s.e.r>0&&s.e.c>0){s.e.r--;s.e.c--;n[\"!ref\"]=Na(s);if(r.sheetRows&&r.sheetRows<=s.e.r){var Q=s.e.r;s.e.r=r.sheetRows-1;n[\"!fullref\"]=n[\"!ref\"];n[\"!ref\"]=Na(s);s.e.r=Q}s.e.r++;s.e.c++}if(N.length>0)n[\"!merges\"]=N;if(D.length>0)n[\"!objects\"]=D;if(F.length>0)n[\"!cols\"]=F;if(P.length>0)n[\"!rows\"]=P;y.Sheets.push(S)}if(c===\"\")h=n;else a[c]=n;n=r.dense?[]:{}}break;case 9:;case 521:;case 1033:;case 2057:{if(R.biff===8)R.biff={9:2,521:3,1033:4}[$]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8;R.biffguess=q.BIFFVer==0;if(q.BIFFVer==0&&q.dt==4096){R.biff=5;G=true;o(R.codepage=28591)}if(R.biff==8&&q.BIFFVer==0&&q.dt==16)R.biff=2;if(B++)break;n=r.dense?[]:{};if(R.biff<8&&!G){G=true;o(R.codepage=r.codepage||1252)}if(R.biff<5||q.BIFFVer==0&&q.dt==4096){if(c===\"\")c=\"Sheet1\";s={s:{r:0,c:0},e:{r:0,c:0}};var ee={pos:e.l-Y,name:c};i[ee.pos]=ee;R.snames.push(c)}else c=(i[j]||{name:\"\"}).name;if(q.dt==32)n[\"!type\"]=\"chart\";if(q.dt==64)n[\"!type\"]=\"macro\";N=[];D=[];R.arrayf=k=[];F=[];P=[];L=false;S={Hidden:(i[j]||{hs:0}).hs,name:c}}break;case 515:;case 3:;case 2:{if(n[\"!type\"]==\"chart\")if(r.dense?(n[q.r]||[])[q.c]:n[Ra({c:q.c,r:q.r})])++q.c;T={ixfe:q.ixfe,XF:E[q.ixfe]||{},v:q.val,t:\"n\"};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r)}break;case 5:;case 517:{T={ixfe:q.ixfe,XF:E[q.ixfe],v:q.val,t:q.t};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r)}break;case 638:{T={ixfe:q.ixfe,XF:E[q.ixfe],v:q.rknum,t:\"n\"};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r)}break;case 189:{for(var re=q.c;re<=q.C;++re){var te=q.rkrec[re-q.c][0];T={ixfe:te,XF:E[te],v:q.rkrec[re-q.c][1],t:\"n\"};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:re,r:q.r},T,r)}}break;case 6:;case 518:;case 1030:{if(q.val==\"String\"){f=q;break}T=lm(q.val,q.cell.ixfe,q.tt);T.XF=E[T.ixfe];if(r.cellFormula){var ae=q.formula;if(ae&&ae[0]&&ae[0][0]&&ae[0][0][0]==\"PtgExp\"){var ne=ae[0][0][1][0],ie=ae[0][0][1][1];var se=Ra({r:ne,c:ie});if(w[se])T.f=\"\"+fd(q.formula,s,q.cell,M,R);else T.F=((r.dense?(n[ne]||[])[ie]:n[se])||{}).F}else T.f=\"\"+fd(q.formula,s,q.cell,M,R)}if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O(q.cell,T,r);f=q}break;case 7:;case 519:{if(f){f.val=q;T=lm(q,f.cell.ixfe,\"s\");T.XF=E[T.ixfe];if(r.cellFormula){T.f=\"\"+fd(f.formula,s,f.cell,M,R)}if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O(f.cell,T,r);f=null}else throw new Error(\"String record expects Formula\")}break;case 33:;case 545:{k.push(q);var fe=Ra(q[0].s);v=r.dense?(n[q[0].s.r]||[])[q[0].s.c]:n[fe];if(r.cellFormula&&v){if(!f)break;if(!fe||!v)break;v.f=\"\"+fd(q[1],s,q[0],M,R);v.F=Na(q[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!f)break;w[Ra(f.cell)]=q[0];v=r.dense?(n[f.cell.r]||[])[f.cell.c]:n[Ra(f.cell)];(v||{}).f=\"\"+fd(q[0],s,u,M,R)}}break;case 253:T=lm(l[q.isst].t,q.ixfe,\"s\");if(l[q.isst].h)T.h=l[q.isst].h;T.XF=E[T.ixfe];if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r);break;case 513:if(r.sheetStubs){T={ixfe:q.ixfe,XF:E[q.ixfe],t:\"z\"};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r)}break;case 190:if(r.sheetStubs){for(var oe=q.c;oe<=q.C;++oe){var le=q.ixfe[oe-q.c];T={ixfe:le,XF:E[le],t:\"z\"};if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:oe,r:q.r},T,r)}}break;case 214:;case 516:;case 4:T=lm(q.val,q.ixfe,\"s\");T.XF=E[T.ixfe];if(W>0)T.z=H[T.ixfe>>8&63];om(T,r,t.opts.Date1904);O({c:q.c,r:q.r},T,r);break;case 0:;case 512:{if(B===1)s=q}break;case 252:{l=q}break;case 1054:{if(R.biff==4){H[W++]=q[1];for(var ce=0;ce<W+163;++ce)if(X[ce]==q[1])break;if(ce>=163)We(q[1],W+163)}else We(q[1],q[0])}break;case 30:{H[W++]=q;for(var he=0;he<W+163;++he)if(X[he]==q)break;if(he>=163)We(q,W+163)}break;case 229:N=N.concat(q);break;case 93:D[q.cmo[0]]=R.lastobj=q;break;case 438:R.lastobj.TxO=q;break;case 127:R.lastobj.ImData=q;break;case 440:{for(b=q[0].s.r;b<=q[0].e.r;++b)for(m=q[0].s.c;m<=q[0].e.c;++m){v=r.dense?(n[b]||[])[m]:n[Ra({c:m,r:b})];if(v)v.l=q[1]}}break;case 2048:{for(b=q[0].s.r;b<=q[0].e.r;++b)for(m=q[0].s.c;m<=q[0].e.c;++m){v=r.dense?(n[b]||[])[m]:n[Ra({c:m,r:b})];if(v&&v.l)v.l.Tooltip=q[1]}}break;case 28:{if(R.biff<=5&&R.biff>=2)break;v=r.dense?(n[q[0].r]||[])[q[0].c]:n[Ra(q[0])];var ue=D[q[2]];if(!v){if(r.dense){if(!n[q[0].r])n[q[0].r]=[];v=n[q[0].r][q[0].c]={t:\"z\"}}else{v=n[Ra(q[0])]={t:\"z\"}}s.e.r=Math.max(s.e.r,q[0].r);s.s.r=Math.min(s.s.r,q[0].r);s.e.c=Math.max(s.e.c,q[0].c);s.s.c=Math.min(s.s.c,q[0].c)}if(!v.c)v.c=[];p={a:q[1],t:ue.TxO.t};v.c.push(p)}break;case 2173:Bc(E[q.ixfe],q.ext);break;case 125:{if(!R.cellStyles)break;while(q.e>=q.s){F[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)};if(!L){L=true;Rl(q.w/256)}Il(F[q.e+1])}}break;case 520:{var de={};if(q.level!=null){P[q.r]=de;de.level=q.level}if(q.hidden){P[q.r]=de;de.hidden=true}if(q.hpt){P[q.r]=de;de.hpt=q.hpt;de.hpx=Pl(q.hpt)}}break;case 38:;case 39:;case 40:;case 41:if(!n[\"!margins\"])Dd(n[\"!margins\"]={});n[\"!margins\"][{38:\"left\",39:\"right\",40:\"top\",41:\"bottom\"}[$]]=q;break;case 161:if(!n[\"!margins\"])Dd(n[\"!margins\"]={});n[\"!margins\"].header=q.header;n[\"!margins\"].footer=q.footer;break;case 574:if(q.RTL)y.Views[0].RTL=true;break;case 146:C=q;break;case 2198:I=q;break;case 140:A=q;break;case 442:{if(!c)y.WBProps.CodeName=q||\"ThisWorkbook\";else S.CodeName=q||S.name}break;}}else{if(!K)console.error(\"Missing Info for XLS Record 0x\"+$.toString(16));e.l+=Y}}t.SheetNames=rr(i).sort(function(e,r){return Number(e)-Number(r)}).map(function(e){return i[e].name});if(!r.bookSheets)t.Sheets=a;if(!t.SheetNames.length&&h[\"!ref\"]){t.SheetNames.push(\"Sheet1\");if(t.Sheets)t.Sheets[\"Sheet1\"]=h}else t.Preamble=h;if(t.Sheets)z.forEach(function(e,r){t.Sheets[t.SheetNames[r]][\"!autofilter\"]=e});t.Strings=l;t.SSF=br(X);if(R.enc)t.Encryption=R.enc;if(I)t.Themes=I;t.Metadata={};if(A!==undefined)t.Metadata.Country=A;if(M.names.length>0)y.Names=M.names;t.Workbook=y;return t}var hm={SI:\"e0859ff2f94f6810ab9108002b27b3d9\",DSI:\"02d5cdd59c2e1b10939708002b2cf9ae\",UDI:\"05d5cdd59c2e1b10939708002b2cf9ae\"};function um(e,r,t){var a=Ke.find(e,\"/!DocumentSummaryInformation\");if(a&&a.size>0)try{var n=$i(a,Mn,hm.DSI);for(var i in n)r[i]=n[i]}catch(s){if(t.WTF)throw s}var f=Ke.find(e,\"/!SummaryInformation\");if(f&&f.size>0)try{var o=$i(f,Un,hm.SI);for(var l in o)if(r[l]==null)r[l]=o[l]}catch(s){if(t.WTF)throw s}if(r.HeadingPairs&&r.TitlesOfParts){gi(r.HeadingPairs,r.TitlesOfParts,r,t);delete r.HeadingPairs;delete r.TitlesOfParts}}function dm(e,r){var t=[],a=[],n=[];var i=0,s;var f=tr(Mn,\"n\");var o=tr(Un,\"n\");if(e.Props){s=rr(e.Props);for(i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(f,s[i])?t:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Props[s[i]]])}if(e.Custprops){s=rr(e.Custprops);for(i=0;i<s.length;++i)if(!Object.prototype.hasOwnProperty.call(e.Props||{},s[i]))(Object.prototype.hasOwnProperty.call(f,s[i])?t:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Custprops[s[i]]])}var l=[];for(i=0;i<n.length;++i){if(Gi.indexOf(n[i][0])>-1||pi.indexOf(n[i][0])>-1)continue;if(n[i][1]==null)continue;l.push(n[i])}if(a.length)Ke.utils.cfb_add(r,\"/\u0005SummaryInformation\",Yi(a,hm.SI,o,Un));if(t.length||l.length)Ke.utils.cfb_add(r,\"/\u0005DocumentSummaryInformation\",Yi(t,hm.DSI,f,Mn,l.length?l:null,hm.UDI))}function vm(e,r){if(!r)r={};Wb(r);l();if(r.codepage)s(r.codepage);var t,a;if(e.FullPaths){if(Ke.find(e,\"/encryption\"))throw new Error(\"File is password-protected\");t=Ke.find(e,\"!CompObj\");a=Ke.find(e,\"/Workbook\")||Ke.find(e,\"/Book\")}else{switch(r.type){case\"base64\":e=y(k(e));break;case\"binary\":e=y(e);break;case\"buffer\":break;case\"array\":if(!Array.isArray(e))e=Array.prototype.slice.call(e);break;}ca(e,0);a={content:e}}var n;var i;if(t)im(t);if(r.bookProps&&!r.bookSheets)n={};else{var f=T?\"buffer\":\"array\";if(a&&a.content)n=cm(a.content,r);else if((i=Ke.find(e,\"PerfectOffice_MAIN\"))&&i.content)n=xo.to_workbook(i.content,(r.type=f,r));else if((i=Ke.find(e,\"NativeContent_MAIN\"))&&i.content)n=xo.to_workbook(i.content,(r.type=f,r));else if((i=Ke.find(e,\"MN0\"))&&i.content)throw new Error(\"Unsupported Works 4 for Mac file\");else throw new Error(\"Cannot find Workbook stream\");if(r.bookVBA&&e.FullPaths&&Ke.find(e,\"/_VBA_PROJECT_CUR/VBA/dir\"))n.vbaraw=wh(e)}var o={};if(e.FullPaths)um(e,o,r);n.Props=n.Custprops=o;if(r.bookFiles)n.cfb=e;return n}function pm(e,r){var t=r||{};var a=Ke.utils.cfb_new({root:\"R\"});var n=\"/Workbook\";switch(t.bookType||\"xls\"){case\"xls\":t.bookType=\"biff8\";case\"xla\":if(!t.bookType)t.bookType=\"xla\";case\"biff8\":n=\"/Workbook\";t.biff=8;break;case\"biff5\":n=\"/Book\";t.biff=5;break;default:throw new Error(\"invalid type \"+t.bookType+\" for XLS CFB\");}Ke.utils.cfb_add(a,n,Lm(e,t));if(t.biff==8&&(e.Props||e.Custprops))dm(e,a);if(t.biff==8&&e.vbaraw)kh(a,Ke.read(e.vbaraw,{type:typeof e.vbaraw==\"string\"?\"binary\":\"buffer\"}));return a}var gm={0:{f:gv},1:{f:Cv},2:{f:Gv},3:{f:Nv},4:{f:xv},5:{f:Wv},6:{f:Kv},7:{f:Lv},8:{f:tp},9:{f:rp},10:{f:Qv},11:{f:ep},12:{f:Sv},13:{f:Xv},14:{f:Fv},15:{f:Rv},16:{f:zv},17:{f:qv},18:{f:Uv},19:{f:ja},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fg},40:{},42:{},43:{f:Jl},44:{f:Yl},45:{f:ec},46:{f:ic},47:{f:tc},48:{},49:{f:Ba},50:{},51:{f:zc},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ao},62:{f:Yv},63:{f:Zc},64:{f:wp},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ha,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pp},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Av},148:{f:wv,p:16},151:{f:op},152:{},153:{f:ng},154:{},155:{},156:{f:tg},157:{},158:{},159:{T:1,f:zo},160:{T:-1},161:{T:1,f:hn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ap},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wc},336:{T:-1},337:{f:jc,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nn},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ff},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:lp},427:{f:cp},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dp},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Tv},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sp},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nn},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vh},633:{T:1},634:{T:-1},635:{T:1,f:uh},636:{T:-1},637:{f:$a},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Up},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kp},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:\"\"}};var mm={6:{f:vd},10:{f:Ki},12:{f:es},13:{f:es},14:{f:Zi},15:{f:Zi},16:{f:dn},17:{f:Zi},18:{f:Zi},19:{f:es},20:{f:Of},21:{f:Of},23:{f:Ff},24:{f:Df},25:{f:Zi},26:{},27:{},28:{f:Hf},29:{},34:{f:Zi},35:{f:If},38:{f:dn},39:{f:dn},40:{f:dn},41:{f:dn},42:{f:Zi},43:{f:Zi},47:{f:pl},49:{f:sf},51:{f:es},60:{},61:{f:ef},64:{f:Zi},65:{f:nf},66:{f:es},77:{},80:{},81:{},82:{},85:{f:es},89:{},90:{},91:{},92:{f:zs},93:{f:Gf},94:{},95:{f:Zi},96:{},97:{},99:{f:Zi},125:{f:ao},128:{f:Ef},129:{f:Gs},130:{f:es},131:{f:Zi},132:{f:Zi},133:{f:js},134:{},140:{f:Zf},141:{f:es},144:{},146:{f:ro},151:{},152:{},153:{},154:{},155:{},156:{f:es},157:{},158:{},160:{f:lo},161:{f:io},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:bf},190:{f:wf},193:{f:Ki},197:{},198:{},199:{},200:{},201:{},202:{f:Zi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:es},220:{},221:{f:Zi},222:{},224:{f:Tf},225:{f:Hs},226:{f:Ki},227:{},229:{f:zf},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$s},253:{f:of},255:{f:Ks},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ts},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zi},353:{f:Ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Rf},431:{f:Zi},432:{},433:{},434:{},437:{},438:{f:$f},439:{f:Zi},440:{f:Yf},441:{},442:{f:ls},443:{},444:{f:es},445:{},446:{},448:{f:Ki},449:{f:Zs,r:2},450:{f:Ki},512:{f:pf},513:{f:oo},515:{f:_f},516:{f:cf},517:{f:yf},519:{f:co},520:{f:Js},523:{},545:{f:Uf},549:{f:Qs},566:{},574:{f:tf},638:{f:mf},659:{},1048:{},1054:{f:uf},1084:{},1212:{f:Mf},2048:{f:Jf},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bs},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:to,r:12},2173:{f:Uc,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Lf,r:12},2197:{},2198:{f:Nc,r:12},2199:{},2200:{},2201:{},2202:{f:Bf,r:12},2203:{f:Ki},2204:{},2205:{},2206:{},2207:{},2211:{f:qs},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:es},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:so},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eo},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:pf},1:{},2:{f:go},3:{f:vo},4:{f:uo},5:{f:yf},7:{f:bo},8:{},9:{f:Bs},11:{},22:{f:es},30:{f:vf},31:{},32:{},33:{f:Uf},36:{},37:{f:Qs},50:{f:wo},62:{},52:{},67:{},68:{f:es},69:{},86:{},126:{},127:{f:ho},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ko},223:{},234:{},354:{},421:{},518:{f:vd},521:{f:Bs},536:{f:Df},547:{f:If},561:{},579:{},1030:{f:vd},1033:{f:Bs},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function bm(e,r,t,a){var n=r;if(isNaN(n))return;var i=a||(t||[]).length||0;var s=e.next(4);s._W(2,n);s._W(2,i);if(i>0&&Jt(t))e.push(t)}function wm(e,r,t,a){var n=a||(t||[]).length||0;if(n<=8224)return bm(e,r,t,n);var i=r;if(isNaN(i))return;var s=t.parts||[],f=0;var o=0,l=0;while(l+(s[f]||8224)<=8224){l+=s[f]||8224;f++}var c=e.next(4);c._W(2,i);c._W(2,l);e.push(t.slice(o,o+l));o+=l;while(o<n){c=e.next(4);c._W(2,60);l=0;while(l+(s[f]||8224)<=8224){l+=s[f]||8224;f++}c._W(2,l);e.push(t.slice(o,o+l));o+=l}}function km(e,r,t){if(!e)e=ua(7);e._W(2,r);e._W(2,t);e._W(2,0);e._W(1,0);return e}function Tm(e,r,t,a){var n=ua(9);km(n,e,r);ns(t,a||\"b\",n);return n}function Am(e,r,t){var a=ua(8+2*t.length);km(a,e,r);a._W(1,t.length);a._W(t.length,t,\"sbcs\");return a.l<a.length?a.slice(0,a.l):a}function Em(e,r,t,a){if(r.v!=null)switch(r.t){case\"d\":;case\"n\":var n=r.t==\"d\"?fr(gr(r.v)):r.v;if(n==(n|0)&&n>=0&&n<65536)bm(e,2,mo(t,a,n));else bm(e,3,po(t,a,n));return;case\"b\":;case\"e\":bm(e,5,Tm(t,a,r.v,r.t));return;case\"s\":;case\"str\":bm(e,4,Am(t,a,(r.v||\"\").slice(0,255)));return;}bm(e,1,km(null,t,a))}function Cm(e,r,t,a){var n=Array.isArray(r);var i=Da(r[\"!ref\"]||\"A1\"),s,f=\"\",o=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error(\"Range \"+(r[\"!ref\"]||\"A1\")+\" exceeds format limit A1:IV16384\");i.e.c=Math.min(i.e.c,255);i.e.r=Math.min(i.e.c,16383);s=Na(i)}for(var l=i.s.r;l<=i.e.r;++l){f=Ta(l);for(var c=i.s.c;c<=i.e.c;++c){if(l===i.s.r)o[c]=ya(c);s=o[c]+f;var h=n?(r[l]||[])[c]:r[s];if(!h)continue;Em(e,h,l,c,a)}}}function ym(e,r){var t=r||{};if(g!=null&&t.dense==null)t.dense=g;var a=va();var n=0;for(var i=0;i<e.SheetNames.length;++i)if(e.SheetNames[i]==t.sheet)n=i;if(n==0&&!!t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error(\"Sheet not found: \"+t.sheet);bm(a,t.biff==4?1033:t.biff==3?521:9,Ws(e,16,t));Cm(a,e.Sheets[e.SheetNames[n]],n,t,e);bm(a,10);return a.end()}function Sm(e,r,t){bm(e,49,ff({sz:12,color:{theme:1},name:\"Arial\",family:2,scheme:\"minor\"},t))}function _m(e,r,t){if(!r)return;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)if(r[n]!=null)bm(e,1054,df(n,r[n],t))})}function xm(e,r){var t=ua(19);t._W(4,2151);t._W(4,0);t._W(4,0);t._W(2,3);t._W(1,1);t._W(4,0);bm(e,2151,t);t=ua(39);t._W(4,2152);t._W(4,0);t._W(4,0);t._W(2,3);t._W(1,0);t._W(4,0);t._W(2,1);t._W(4,4);t._W(2,0);Rs(Da(r[\"!ref\"]||\"A1\"),t);t._W(4,4);bm(e,2152,t)}function Om(e,r){for(var t=0;t<16;++t)bm(e,224,Af({numFmtId:0,style:true},0,r));r.cellXfs.forEach(function(t){bm(e,224,Af(t,0,r))})}function Rm(e,r){for(var t=0;t<r[\"!links\"].length;++t){var a=r[\"!links\"][t];bm(e,440,Kf(a));if(a[1].Tooltip)bm(e,2048,qf(a))}delete r[\"!links\"]}function Im(e,r){if(!r)return;var t=0;r.forEach(function(r,a){if(++t<=256&&r){bm(e,125,no(Nd(a,r),a))}})}function Nm(e,r,t,a,n){var i=16+Fd(n.cellXfs,r,n);if(r.v==null&&!r.bf){bm(e,513,Es(t,a,i));return}if(r.bf)bm(e,6,pd(r,t,a,n,i));else switch(r.t){case\"d\":;case\"n\":var s=r.t==\"d\"?fr(gr(r.v)):r.v;bm(e,515,xf(t,a,s,i,n));break;case\"b\":;case\"e\":bm(e,517,Sf(t,a,r.v,i,n,r.t));break;case\"s\":;case\"str\":if(n.bookSST){var f=Id(n.Strings,r.v,n.revStrings);bm(e,253,lf(t,a,f,i,n))}else bm(e,516,hf(t,a,(r.v||\"\").slice(0,255),i,n));break;default:bm(e,513,Es(t,a,i));}}function Dm(e,r,t){var a=va();var n=t.SheetNames[e],i=t.Sheets[n]||{};var s=(t||{}).Workbook||{};var f=(s.Sheets||[])[e]||{};var o=Array.isArray(i);var l=r.biff==8;var c,h=\"\",u=[];var d=Da(i[\"!ref\"]||\"A1\");var v=l?65536:16384;if(d.e.c>255||d.e.r>=v){if(r.WTF)throw new Error(\"Range \"+(i[\"!ref\"]||\"A1\")+\" exceeds format limit A1:IV16384\");d.e.c=Math.min(d.e.c,255);d.e.r=Math.min(d.e.c,v-1)}bm(a,2057,Ws(t,16,r));bm(a,13,rs(1));bm(a,12,rs(100));bm(a,15,Qi(true));bm(a,17,Qi(false));bm(a,16,vn(.001));bm(a,95,Qi(true));bm(a,42,Qi(false));bm(a,43,Qi(false));bm(a,130,rs(1));bm(a,128,Cf([0,0]));bm(a,131,Qi(false));bm(a,132,Qi(false));if(l)Im(a,i[\"!cols\"]);bm(a,512,gf(d,r));if(l)i[\"!links\"]=[];for(var p=d.s.r;p<=d.e.r;++p){h=Ta(p);for(var g=d.s.c;g<=d.e.c;++g){if(p===d.s.r)u[g]=ya(g);c=u[g]+h;var m=o?(i[p]||[])[g]:i[c];if(!m)continue;Nm(a,m,p,g,r);if(l&&m.l)i[\"!links\"].push([c,m.l])}}var b=f.CodeName||f.name||n;if(l)bm(a,574,af((s.Views||[])[0]));if(l&&(i[\"!merges\"]||[]).length)bm(a,229,Vf(i[\"!merges\"]));if(l)Rm(a,i);bm(a,442,hs(b,r));if(l)xm(a,i);bm(a,10);return a.end()}function Fm(e,r,t){var a=va();var n=(e||{}).Workbook||{};var i=n.Sheets||[];var s=n.WBProps||{};var f=t.biff==8,o=t.biff==5;bm(a,2057,Ws(e,5,t));if(t.bookType==\"xla\")bm(a,135);bm(a,225,f?rs(1200):null);bm(a,193,Ji(2));if(o)bm(a,191);if(o)bm(a,192);bm(a,226);bm(a,92,Vs(\"SheetJS\",t));bm(a,66,rs(f?1200:1252));if(f)bm(a,353,rs(0));if(f)bm(a,448);bm(a,317,fo(e.SheetNames.length));if(f&&e.vbaraw)bm(a,211);if(f&&e.vbaraw){var l=s.CodeName||\"ThisWorkbook\";bm(a,442,hs(l,t))}bm(a,156,rs(17));bm(a,25,Qi(false));bm(a,18,Qi(false));bm(a,19,rs(0));if(f)bm(a,431,Qi(false));if(f)bm(a,444,rs(0));bm(a,61,rf(t));bm(a,64,Qi(false));bm(a,141,rs(0));bm(a,34,Qi(Yp(e)==\"true\"));bm(a,14,Qi(true));if(f)bm(a,439,Qi(false));bm(a,218,rs(0));Sm(a,e,t);_m(a,e.SSF,t);Om(a,t);if(f)bm(a,352,Qi(false));var c=a.end();var h=va();if(f)bm(h,140,Qf());if(f&&t.Strings)wm(h,252,Ys(t.Strings,t));bm(h,10);var u=h.end();var d=va();var v=0,p=0;for(p=0;p<e.SheetNames.length;++p)v+=(f?12:11)+(f?2:1)*e.SheetNames[p].length;var g=c.length+v+u.length;for(p=0;p<e.SheetNames.length;++p){var m=i[p]||{};bm(d,133,Xs({pos:g,hs:m.Hidden||0,dt:0,name:e.SheetNames[p]},t));g+=r[p].length}var b=d.end();if(v!=b.length)throw new Error(\"BS8 \"+v+\" != \"+b.length);var w=[];if(c.length)w.push(c);if(b.length)w.push(b);if(u.length)w.push(u);return R(w)}function Pm(e,r){var t=r||{};var a=[];if(e&&!e.SSF){e.SSF=br(X)}if(e&&e.SSF){ze();He(e.SSF);t.revssf=nr(e.SSF);t.revssf[e.SSF[65535]]=0;t.ssf=e.SSF}t.Strings=[];t.Strings.Count=0;t.Strings.Unique=0;Hb(t);t.cellXfs=[];Fd(t.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};for(var n=0;n<e.SheetNames.length;++n)a[a.length]=Dm(n,t,e);a.unshift(Fm(e,a,t));return R(a)}function Lm(e,r){for(var t=0;t<=e.SheetNames.length;++t){var a=e.Sheets[e.SheetNames[t]];if(!a||!a[\"!ref\"])continue;var n=Ia(a[\"!ref\"]);if(n.e.c>255){if(typeof console!=\"undefined\"&&console.error)console.error(\"Worksheet '\"+e.SheetNames[t]+\"' extends beyond column IV (255).  Data may be lost.\")}}var i=r||{};switch(i.biff||2){case 8:;case 5:return Pm(e,r);case 4:;case 3:;case 2:return ym(e,r);}throw new Error(\"invalid type \"+i.bookType+\" for BIFF\")}function Mm(e,r){var t=r||{};if(g!=null&&t.dense==null)t.dense=g;var a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,\"\");var n=e.match(/<table/i);if(!n)throw new Error(\"Invalid HTML: could not find <table>\");var i=e.match(/<\\/table/i);var s=n.index,f=i&&i.index||e.length;var o=Er(e.slice(s,f),/(:?<tr[^>]*>)/i,\"<tr>\");var l=-1,c=0,h=0,u=0;var d={s:{r:1e7,c:1e7},e:{r:0,c:0}};var v=[];for(s=0;s<o.length;++s){var p=o[s].trim();var m=p.slice(0,3).toLowerCase();if(m==\"<tr\"){++l;if(t.sheetRows&&t.sheetRows<=l){--l;break}c=0;continue}if(m!=\"<td\"&&m!=\"<th\")continue;var b=p.split(/<\\/t[dh]>/i);for(f=0;f<b.length;++f){var w=b[f].trim();if(!w.match(/<t[dh]/i))continue;var k=w,T=0;while(k.charAt(0)==\"<\"&&(T=k.indexOf(\">\"))>-1)k=k.slice(T+1);for(var A=0;A<v.length;++A){var E=v[A];if(E.s.c==c&&E.s.r<l&&l<=E.e.r){c=E.e.c+1;A=-1}}var C=Gr(w.slice(0,w.indexOf(\">\")));u=C.colspan?+C.colspan:1;if((h=+C.rowspan)>1||u>1)v.push({s:{r:l,c:c},e:{r:l+(h||1)-1,c:c+u-1}});var y=C.t||C[\"data-t\"]||\"\";if(!k.length){c+=u;continue}k=ut(k);if(d.s.r>l)d.s.r=l;if(d.e.r<l)d.e.r=l;if(d.s.c>c)d.s.c=c;if(d.e.c<c)d.e.c=c;if(!k.length){c+=u;continue}var S={t:\"s\",v:k};if(t.raw||!k.trim().length||y==\"s\"){}else if(k===\"TRUE\")S={t:\"b\",v:true};else if(k===\"FALSE\")S={t:\"b\",v:false};else if(!isNaN(kr(k)))S={t:\"n\",v:kr(k)};else if(!isNaN(Ar(k).getDate())){S={t:\"d\",v:gr(k)};if(!t.cellDates)S={t:\"n\",v:fr(S.v)};S.z=t.dateNF||X[14]}if(t.dense){if(!a[l])a[l]=[];a[l][c]=S}else a[Ra({r:l,c:c})]=S;c+=u}}a[\"!ref\"]=Na(d);if(v.length)a[\"!merges\"]=v;return a}function Um(e,r,t,a){var n=e[\"!merges\"]||[];var i=[];for(var s=r.s.c;s<=r.e.c;++s){var f=0,o=0;for(var l=0;l<n.length;++l){if(n[l].s.r>t||n[l].s.c>s)continue;if(n[l].e.r<t||n[l].e.c<s)continue;if(n[l].s.r<t||n[l].s.c<s){f=-1;break}f=n[l].e.r-n[l].s.r+1;o=n[l].e.c-n[l].s.c+1;break}if(f<0)continue;var c=Ra({r:t,c:s});var h=a.dense?(e[t]||[])[s]:e[c];var u=h&&h.v!=null&&(h.h||et(h.w||(Pa(h),h.w)||\"\"))||\"\";var d={};if(f>1)d.rowspan=f;if(o>1)d.colspan=o;if(a.editable)u='<span contenteditable=\"true\">'+u+\"</span>\";else if(h){d[\"data-t\"]=h&&h.t||\"z\";if(h.v!=null)d[\"data-v\"]=h.v;if(h.z!=null)d[\"data-z\"]=h.z;if(h.l&&(h.l.Target||\"#\").charAt(0)!=\"#\")u='<a href=\"'+h.l.Target+'\">'+u+\"</a>\"}d.id=(a.id||\"sjs\")+\"-\"+c;i.push(kt(\"td\",u,d))}var v=\"<tr>\";return v+i.join(\"\")+\"</tr>\"}var Bm='<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';var Wm=\"</body></html>\";function Hm(e,r){var t=e.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);if(!t||t.length==0)throw new Error(\"Invalid HTML: could not find <table>\");if(t.length==1)return La(Mm(t[0],r),r);var a=Nw();t.forEach(function(e,t){Dw(a,Mm(e,r),\"Sheet\"+(t+1))});return a}function zm(e,r,t){var a=[];return a.join(\"\")+\"<table\"+(t&&t.id?' id=\"'+t.id+'\"':\"\")+\">\"}function Vm(e,r){var t=r||{};var a=t.header!=null?t.header:Bm;var n=t.footer!=null?t.footer:Wm;var i=[a];var s=Ia(e[\"!ref\"]);t.dense=Array.isArray(e);i.push(zm(e,s,t));for(var f=s.s.r;f<=s.e.r;++f)i.push(Um(e,s,f,t));i.push(\"</table>\"+n);return i.join(\"\")}function Gm(e,r,t){var a=t||{};if(g!=null)a.dense=g;var n=0,i=0;if(a.origin!=null){if(typeof a.origin==\"number\")n=a.origin;else{var s=typeof a.origin==\"string\"?Oa(a.origin):a.origin;n=s.r;i=s.c}}var f=r.getElementsByTagName(\"tr\");\nvar o=Math.min(a.sheetRows||1e7,f.length);var l={s:{r:0,c:0},e:{r:n,c:i}};if(e[\"!ref\"]){var c=Ia(e[\"!ref\"]);l.s.r=Math.min(l.s.r,c.s.r);l.s.c=Math.min(l.s.c,c.s.c);l.e.r=Math.max(l.e.r,c.e.r);l.e.c=Math.max(l.e.c,c.e.c);if(n==-1)l.e.r=n=c.e.r+1}var h=[],u=0;var d=e[\"!rows\"]||(e[\"!rows\"]=[]);var v=0,p=0,m=0,b=0,w=0,k=0;if(!e[\"!cols\"])e[\"!cols\"]=[];for(;v<f.length&&p<o;++v){var T=f[v];if($m(T)){if(a.display)continue;d[p]={hidden:true}}var A=T.children;for(m=b=0;m<A.length;++m){var E=A[m];if(a.display&&$m(E))continue;var C=E.hasAttribute(\"data-v\")?E.getAttribute(\"data-v\"):E.hasAttribute(\"v\")?E.getAttribute(\"v\"):ut(E.innerHTML);var y=E.getAttribute(\"data-z\")||E.getAttribute(\"z\");for(u=0;u<h.length;++u){var S=h[u];if(S.s.c==b+i&&S.s.r<p+n&&p+n<=S.e.r){b=S.e.c+1-i;u=-1}}k=+E.getAttribute(\"colspan\")||1;if((w=+E.getAttribute(\"rowspan\")||1)>1||k>1)h.push({s:{r:p+n,c:b+i},e:{r:p+n+(w||1)-1,c:b+i+(k||1)-1}});var _={t:\"s\",v:C};var x=E.getAttribute(\"data-t\")||E.getAttribute(\"t\")||\"\";if(C!=null){if(C.length==0)_.t=x||\"z\";else if(a.raw||C.trim().length==0||x==\"s\"){}else if(C===\"TRUE\")_={t:\"b\",v:true};else if(C===\"FALSE\")_={t:\"b\",v:false};else if(!isNaN(kr(C)))_={t:\"n\",v:kr(C)};else if(!isNaN(Ar(C).getDate())){_={t:\"d\",v:gr(C)};if(!a.cellDates)_={t:\"n\",v:fr(_.v)};_.z=a.dateNF||X[14]}}if(_.z===undefined&&y!=null)_.z=y;var O=\"\",R=E.getElementsByTagName(\"A\");if(R&&R.length)for(var I=0;I<R.length;++I)if(R[I].hasAttribute(\"href\")){O=R[I].getAttribute(\"href\");if(O.charAt(0)!=\"#\")break}if(O&&O.charAt(0)!=\"#\")_.l={Target:O};if(a.dense){if(!e[p+n])e[p+n]=[];e[p+n][b+i]=_}else e[Ra({c:b+i,r:p+n})]=_;if(l.e.c<b+i)l.e.c=b+i;b+=k}++p}if(h.length)e[\"!merges\"]=(e[\"!merges\"]||[]).concat(h);l.e.r=Math.max(l.e.r,p-1+n);e[\"!ref\"]=Na(l);if(p>=o)e[\"!fullref\"]=Na((l.e.r=f.length-v+p-1+n,l));return e}function jm(e,r){var t=r||{};var a=t.dense?[]:{};return Gm(a,e,r)}function Xm(e,r){return La(jm(e,r),r)}function $m(e){var r=\"\";var t=Ym(e);if(t)r=t(e).getPropertyValue(\"display\");if(!r)r=e.style&&e.style.display;return r===\"none\"}function Ym(e){if(e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle===\"function\")return e.ownerDocument.defaultView.getComputedStyle;if(typeof getComputedStyle===\"function\")return getComputedStyle;return null}function Km(e){var r=e.replace(/[\\t\\r\\n]/g,\" \").trim().replace(/ +/g,\" \").replace(/<text:s\\/>/g,\" \").replace(/<text:s text:c=\"(\\d+)\"\\/>/g,function(e,r){return Array(parseInt(r,10)+1).join(\" \")}).replace(/<text:tab[^>]*\\/>/g,\"\\t\").replace(/<text:line-break\\/>/g,\"\\n\");var t=Yr(r.replace(/<[^>]*>/g,\"\"));return[t]}var Jm={day:[\"d\",\"dd\"],month:[\"m\",\"mm\"],year:[\"y\",\"yy\"],hours:[\"h\",\"hh\"],minutes:[\"m\",\"mm\"],seconds:[\"s\",\"ss\"],\"am-pm\":[\"A/P\",\"AM/PM\"],\"day-of-week\":[\"ddd\",\"dddd\"],era:[\"e\",\"ee\"],quarter:[\"\\\\Qm\",'m\\\\\"th quarter\"']};function qm(e,r){var t=r||{};if(g!=null&&t.dense==null)t.dense=g;var a=Et(e);var n=[],i;var s;var f={name:\"\"},o=\"\",l=0;var c;var h;var u={},d=[];var v=t.dense?[]:{};var p,m;var b={value:\"\"};var w=\"\",k=0,T;var A=[];var E=-1,C=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}};var S=0;var _={};var x=[],O={},R=0,I=0;var N=[],D=1,F=1;var P=[];var L={Names:[]};var M={};var U=[\"\",\"\"];var B=[],W={};var H=\"\",z=0;var V=false,G=false;var j=0;Ct.lastIndex=0;a=a.replace(/<!--([\\s\\S]*?)-->/gm,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");while(p=Ct.exec(a))switch(p[3]=p[3].replace(/_.*$/,\"\")){case\"table\":;case\"\":if(p[1]===\"/\"){if(y.e.c>=y.s.c&&y.e.r>=y.s.r)v[\"!ref\"]=Na(y);else v[\"!ref\"]=\"A1:A1\";if(t.sheetRows>0&&t.sheetRows<=y.e.r){v[\"!fullref\"]=v[\"!ref\"];y.e.r=t.sheetRows-1;v[\"!ref\"]=Na(y)}if(x.length)v[\"!merges\"]=x;if(N.length)v[\"!rows\"]=N;c.name=c[\"\"]||c.name;if(typeof JSON!==\"undefined\")JSON.stringify(c);d.push(c.name);u[c.name]=v;G=false}else if(p[0].charAt(p[0].length-2)!==\"/\"){c=Gr(p[0],false);E=C=-1;y.s.r=y.s.c=1e7;y.e.r=y.e.c=0;v=t.dense?[]:{};x=[];N=[];G=true}break;case\"table-row-group\":if(p[1]===\"/\")--S;else++S;break;case\"table-row\":;case\"\":if(p[1]===\"/\"){E+=D;D=1;break}h=Gr(p[0],false);if(h[\"\"])E=h[\"\"]-1;else if(E==-1)E=0;D=+h[\"number-rows-repeated\"]||1;if(D<10)for(j=0;j<D;++j)if(S>0)N[E+j]={level:S};C=-1;break;case\"covered-table-cell\":if(p[1]!==\"/\")++C;if(t.sheetStubs){if(t.dense){if(!v[E])v[E]=[];v[E][C]={t:\"z\"}}else v[Ra({r:E,c:C})]={t:\"z\"}}w=\"\";A=[];break;case\"table-cell\":;case\"\":if(p[0].charAt(p[0].length-2)===\"/\"){++C;b=Gr(p[0],false);F=parseInt(b[\"number-columns-repeated\"]||\"1\",10);m={t:\"z\",v:null};if(b.formula&&t.cellFormula!=false)m.f=Cd(Yr(b.formula));if((b[\"\"]||b[\"value-type\"])==\"string\"){m.t=\"s\";m.v=Yr(b[\"string-value\"]||\"\");if(t.dense){if(!v[E])v[E]=[];v[E][C]=m}else{v[Ra({r:E,c:C})]=m}}C+=F-1}else if(p[1]!==\"/\"){++C;w=\"\";k=0;A=[];F=1;var X=D?E+D-1:E;if(C>y.e.c)y.e.c=C;if(C<y.s.c)y.s.c=C;if(E<y.s.r)y.s.r=E;if(X>y.e.r)y.e.r=X;b=Gr(p[0],false);B=[];W={};m={t:b[\"\"]||b[\"value-type\"],v:null};if(t.cellFormula){if(b.formula)b.formula=Yr(b.formula);if(b[\"number-matrix-columns-spanned\"]&&b[\"number-matrix-rows-spanned\"]){R=parseInt(b[\"number-matrix-rows-spanned\"],10)||0;I=parseInt(b[\"number-matrix-columns-spanned\"],10)||0;O={s:{r:E,c:C},e:{r:E+R-1,c:C+I-1}};m.F=Na(O);P.push([O,m.F])}if(b.formula)m.f=Cd(b.formula);else for(j=0;j<P.length;++j)if(E>=P[j][0].s.r&&E<=P[j][0].e.r)if(C>=P[j][0].s.c&&C<=P[j][0].e.c)m.F=P[j][1]}if(b[\"number-columns-spanned\"]||b[\"number-rows-spanned\"]){R=parseInt(b[\"number-rows-spanned\"],10)||0;I=parseInt(b[\"number-columns-spanned\"],10)||0;O={s:{r:E,c:C},e:{r:E+R-1,c:C+I-1}};x.push(O)}if(b[\"number-columns-repeated\"])F=parseInt(b[\"number-columns-repeated\"],10);switch(m.t){case\"boolean\":m.t=\"b\";m.v=nt(b[\"boolean-value\"]);break;case\"float\":m.t=\"n\";m.v=parseFloat(b.value);break;case\"percentage\":m.t=\"n\";m.v=parseFloat(b.value);break;case\"currency\":m.t=\"n\";m.v=parseFloat(b.value);break;case\"date\":m.t=\"d\";m.v=gr(b[\"date-value\"]);if(!t.cellDates){m.t=\"n\";m.v=fr(m.v)}m.z=\"m/d/yy\";break;case\"time\":m.t=\"n\";m.v=ur(b[\"time-value\"])/86400;if(t.cellDates){m.t=\"d\";m.v=hr(m.v)}m.z=\"HH:MM:SS\";break;case\"number\":m.t=\"n\";m.v=parseFloat(b[\"\"]);break;default:if(m.t===\"string\"||m.t===\"text\"||!m.t){m.t=\"s\";if(b[\"string-value\"]!=null){w=Yr(b[\"string-value\"]);A=[]}}else throw new Error(\"Unsupported value type \"+m.t);}}else{V=false;if(m.t===\"s\"){m.v=w||\"\";if(A.length)m.R=A;V=k==0}if(M.Target)m.l=M;if(B.length>0){m.c=B;B=[]}if(w&&t.cellText!==false)m.w=w;if(V){m.t=\"z\";delete m.v}if(!V||t.sheetStubs){if(!(t.sheetRows&&t.sheetRows<=E)){for(var $=0;$<D;++$){F=parseInt(b[\"number-columns-repeated\"]||\"1\",10);if(t.dense){if(!v[E+$])v[E+$]=[];v[E+$][C]=$==0?m:br(m);while(--F>0)v[E+$][C+F]=br(m)}else{v[Ra({r:E+$,c:C})]=m;while(--F>0)v[Ra({r:E+$,c:C+F})]=br(m)}if(y.e.c<=C)y.e.c=C}}}F=parseInt(b[\"number-columns-repeated\"]||\"1\",10);C+=F-1;F=0;m={};w=\"\";A=[]}M={};break;case\"document\":;case\"document-content\":;case\"\":;case\"spreadsheet\":;case\"\":;case\"scripts\":;case\"styles\":;case\"font-face-decls\":;case\"master-styles\":if(p[1]===\"/\"){if((i=n.pop())[0]!==p[3])throw\"Bad state: \"+i}else if(p[0].charAt(p[0].length-2)!==\"/\")n.push([p[3],true]);break;case\"annotation\":if(p[1]===\"/\"){if((i=n.pop())[0]!==p[3])throw\"Bad state: \"+i;W.t=w;if(A.length)W.R=A;W.a=H;B.push(W)}else if(p[0].charAt(p[0].length-2)!==\"/\"){n.push([p[3],false])}H=\"\";z=0;w=\"\";k=0;A=[];break;case\"creator\":if(p[1]===\"/\"){H=a.slice(z,p.index)}else z=p.index+p[0].length;break;case\"meta\":;case\"\":;case\"settings\":;case\"config-item-set\":;case\"config-item-map-indexed\":;case\"config-item-map-entry\":;case\"config-item-map-named\":;case\"shapes\":;case\"frame\":;case\"text-box\":;case\"image\":;case\"data-pilot-tables\":;case\"list-style\":;case\"form\":;case\"dde-links\":;case\"event-listeners\":;case\"chart\":if(p[1]===\"/\"){if((i=n.pop())[0]!==p[3])throw\"Bad state: \"+i}else if(p[0].charAt(p[0].length-2)!==\"/\")n.push([p[3],false]);w=\"\";k=0;A=[];break;case\"scientific-number\":break;case\"currency-symbol\":break;case\"currency-style\":break;case\"number-style\":;case\"percentage-style\":;case\"date-style\":;case\"time-style\":if(p[1]===\"/\"){_[f.name]=o;if((i=n.pop())[0]!==p[3])throw\"Bad state: \"+i}else if(p[0].charAt(p[0].length-2)!==\"/\"){o=\"\";f=Gr(p[0],false);n.push([p[3],true])}break;case\"script\":break;case\"libraries\":break;case\"automatic-styles\":break;case\"default-style\":;case\"page-layout\":break;case\"style\":break;case\"map\":break;case\"font-face\":break;case\"paragraph-properties\":break;case\"table-properties\":break;case\"table-column-properties\":break;case\"table-row-properties\":break;case\"table-cell-properties\":break;case\"number\":switch(n[n.length-1][0]){case\"time-style\":;case\"date-style\":s=Gr(p[0],false);o+=Jm[p[3]][s.style===\"long\"?1:0];break;}break;case\"fraction\":break;case\"day\":;case\"month\":;case\"year\":;case\"era\":;case\"day-of-week\":;case\"week-of-year\":;case\"quarter\":;case\"hours\":;case\"minutes\":;case\"seconds\":;case\"am-pm\":switch(n[n.length-1][0]){case\"time-style\":;case\"date-style\":s=Gr(p[0],false);o+=Jm[p[3]][s.style===\"long\"?1:0];break;}break;case\"boolean-style\":break;case\"boolean\":break;case\"text-style\":break;case\"text\":if(p[0].slice(-2)===\"/>\")break;else if(p[1]===\"/\")switch(n[n.length-1][0]){case\"number-style\":;case\"date-style\":;case\"time-style\":o+=a.slice(l,p.index);break;}else l=p.index+p[0].length;break;case\"named-range\":s=Gr(p[0],false);U=Sd(s[\"cell-range-address\"]);var Y={Name:s.name,Ref:U[0]+\"!\"+U[1]};if(G)Y.Sheet=d.length;L.Names.push(Y);break;case\"text-content\":break;case\"text-properties\":break;case\"embedded-text\":break;case\"body\":;case\"\":break;case\"forms\":break;case\"table-column\":break;case\"table-header-rows\":break;case\"table-rows\":break;case\"table-column-group\":break;case\"table-header-columns\":break;case\"table-columns\":break;case\"null-date\":break;case\"graphic-properties\":break;case\"calculation-settings\":break;case\"named-expressions\":break;case\"label-range\":break;case\"label-ranges\":break;case\"named-expression\":break;case\"sort\":break;case\"sort-by\":break;case\"sort-groups\":break;case\"tab\":break;case\"line-break\":break;case\"span\":break;case\"p\":;case\"\":if([\"master-styles\"].indexOf(n[n.length-1][0])>-1)break;if(p[1]===\"/\"&&(!b||!b[\"string-value\"])){var K=Km(a.slice(k,p.index),T);w=(w.length>0?w+\"\\n\":\"\")+K[0]}else{T=Gr(p[0],false);k=p.index+p[0].length}break;case\"s\":break;case\"database-range\":if(p[1]===\"/\")break;try{U=Sd(Gr(p[0])[\"target-range-address\"]);u[U[0]][\"!autofilter\"]={ref:U[1]}}catch(J){}break;case\"date\":break;case\"object\":break;case\"title\":;case\"\":break;case\"desc\":break;case\"binary-data\":break;case\"table-source\":break;case\"scenario\":break;case\"iteration\":break;case\"content-validations\":break;case\"content-validation\":break;case\"help-message\":break;case\"error-message\":break;case\"database-ranges\":break;case\"filter\":break;case\"filter-and\":break;case\"filter-or\":break;case\"filter-condition\":break;case\"list-level-style-bullet\":break;case\"list-level-style-number\":break;case\"list-level-properties\":break;case\"sender-firstname\":;case\"sender-lastname\":;case\"sender-initials\":;case\"sender-title\":;case\"sender-position\":;case\"sender-email\":;case\"sender-phone-private\":;case\"sender-fax\":;case\"sender-company\":;case\"sender-phone-work\":;case\"sender-street\":;case\"sender-city\":;case\"sender-postal-code\":;case\"sender-country\":;case\"sender-state-or-province\":;case\"author-name\":;case\"author-initials\":;case\"chapter\":;case\"file-name\":;case\"template-name\":;case\"sheet-name\":break;case\"event-listener\":break;case\"initial-creator\":;case\"creation-date\":;case\"print-date\":;case\"generator\":;case\"document-statistic\":;case\"user-defined\":;case\"editing-duration\":;case\"editing-cycles\":break;case\"config-item\":break;case\"page-number\":break;case\"page-count\":break;case\"time\":break;case\"cell-range-source\":break;case\"detective\":break;case\"operation\":break;case\"highlighted-range\":break;case\"data-pilot-table\":;case\"source-cell-range\":;case\"source-service\":;case\"data-pilot-field\":;case\"data-pilot-level\":;case\"data-pilot-subtotals\":;case\"data-pilot-subtotal\":;case\"data-pilot-members\":;case\"data-pilot-member\":;case\"data-pilot-display-info\":;case\"data-pilot-sort-info\":;case\"data-pilot-layout-info\":;case\"data-pilot-field-reference\":;case\"data-pilot-groups\":;case\"data-pilot-group\":;case\"data-pilot-group-member\":break;case\"rect\":break;case\"dde-connection-decls\":;case\"dde-connection-decl\":;case\"dde-link\":;case\"dde-source\":break;case\"properties\":break;case\"property\":break;case\"a\":if(p[1]!==\"/\"){M=Gr(p[0],false);if(!M.href)break;M.Target=Yr(M.href);delete M.href;if(M.Target.charAt(0)==\"#\"&&M.Target.indexOf(\".\")>-1){U=Sd(M.Target.slice(1));M.Target=\"#\"+U[0]+\"!\"+U[1]}else if(M.Target.match(/^\\.\\.[\\\\\\/]/))M.Target=M.Target.slice(3)}break;case\"table-protection\":break;case\"data-pilot-grand-total\":break;case\"office-document-common-attrs\":break;default:switch(p[2]){case\"dc:\":;case\"calcext:\":;case\"loext:\":;case\"ooo:\":;case\"chartooo:\":;case\"draw:\":;case\"style:\":;case\"chart:\":;case\"form:\":;case\"uof:\":;case\":\":;case\":\":break;default:if(t.WTF)throw new Error(p);};}var q={Sheets:u,SheetNames:d,Workbook:L};if(t.bookSheets)delete q.Sheets;return q}function Zm(e,r){r=r||{};if(_r(e,\"META-INF/manifest.xml\"))ai(Or(e,\"META-INF/manifest.xml\"),r);var t=Rr(e,\"content.xml\");if(!t)throw new Error(\"Missing content.xml in ODS / UOF file\");var a=qm(lt(t),r);if(_r(e,\"meta.xml\"))a.Props=hi(Or(e,\"meta.xml\"));return a}function Qm(e,r){return qm(e,r)}var eb=function(){var e=[\"<office:master-styles>\",'<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">',\"<style:header/>\",'<style:header-left style:display=\"false\"/>',\"<style:footer/>\",'<style:footer-left style:display=\"false\"/>',\"</style:master-page>\",\"</office:master-styles>\"].join(\"\");var r=\"<office:document-styles \"+wt({\"xmlns:office\":\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\"xmlns:table\":\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\"xmlns:style\":\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\"xmlns:text\":\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\"xmlns:draw\":\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\"xmlns:fo\":\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"xmlns:dc\":\"http://purl.org/dc/elements/1.1/\",\"xmlns:number\":\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\"xmlns:svg\":\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\"xmlns:of\":\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\"office:version\":\"1.2\"})+\">\"+e+\"</office:document-styles>\";return function t(){return Mr+r}}();var rb=function(){var e=function(e){return qr(e).replace(/  +/g,function(e){return'<text:s text:c=\"'+e.length+'\"/>'}).replace(/\\t/g,\"<text:tab/>\").replace(/\\n/g,\"</text:p><text:p>\").replace(/^ /,\"<text:s/>\").replace(/ $/,\"<text:s/>\")};var r=\"          <table:table-cell />\\n\";var t=\"          <table:covered-table-cell/>\\n\";var a=function(a,n,i){var s=[];s.push('      <table:table table:name=\"'+qr(n.SheetNames[i])+'\" table:style-name=\"ta1\">\\n');var f=0,o=0,l=Ia(a[\"!ref\"]||\"A1\");var c=a[\"!merges\"]||[],h=0;var u=Array.isArray(a);if(a[\"!cols\"]){for(o=0;o<=l.e.c;++o)s.push(\"        <table:table-column\"+(a[\"!cols\"][o]?' table:style-name=\"co'+a[\"!cols\"][o].ods+'\"':\"\")+\"></table:table-column>\\n\")}var d=\"\",v=a[\"!rows\"]||[];for(f=0;f<l.s.r;++f){d=v[f]?' table:style-name=\"ro'+v[f].ods+'\"':\"\";s.push(\"        <table:table-row\"+d+\"></table:table-row>\\n\")}for(;f<=l.e.r;++f){d=v[f]?' table:style-name=\"ro'+v[f].ods+'\"':\"\";s.push(\"        <table:table-row\"+d+\">\\n\");for(o=0;o<l.s.c;++o)s.push(r);for(;o<=l.e.c;++o){var p=false,g={},m=\"\";for(h=0;h!=c.length;++h){if(c[h].s.c>o)continue;if(c[h].s.r>f)continue;if(c[h].e.c<o)continue;if(c[h].e.r<f)continue;if(c[h].s.c!=o||c[h].s.r!=f)p=true;g[\"table:number-columns-spanned\"]=c[h].e.c-c[h].s.c+1;g[\"table:number-rows-spanned\"]=c[h].e.r-c[h].s.r+1;break}if(p){s.push(t);continue}var b=Ra({r:f,c:o}),w=u?(a[f]||[])[o]:a[b];if(w&&w.f){g[\"table:formula\"]=qr(yd(w.f));if(w.F){if(w.F.slice(0,b.length)==b){var k=Ia(w.F);g[\"table:number-matrix-columns-spanned\"]=k.e.c-k.s.c+1;g[\"table:number-matrix-rows-spanned\"]=k.e.r-k.s.r+1}}}if(!w){s.push(r);continue}switch(w.t){case\"b\":m=w.v?\"TRUE\":\"FALSE\";g[\"office:value-type\"]=\"boolean\";g[\"office:boolean-value\"]=w.v?\"true\":\"false\";break;case\"n\":m=w.w||String(w.v||0);g[\"office:value-type\"]=\"float\";g[\"office:value\"]=w.v||0;break;case\"s\":;case\"str\":m=w.v==null?\"\":w.v;g[\"office:value-type\"]=\"string\";break;case\"d\":m=w.w||gr(w.v).toISOString();g[\"office:value-type\"]=\"date\";g[\"office:date-value\"]=gr(w.v).toISOString();g[\"table:style-name\"]=\"ce1\";break;default:s.push(r);continue;}var T=e(m);if(w.l&&w.l.Target){var A=w.l.Target;A=A.charAt(0)==\"#\"?\"#\"+_d(A.slice(1)):A;if(A.charAt(0)!=\"#\"&&!A.match(/^\\w+:/))A=\"../\"+A;T=kt(\"text:a\",T,{\"xlink:href\":A.replace(/&/g,\"&amp;\")})}s.push(\"          \"+kt(\"table:table-cell\",kt(\"text:p\",T,{}),g)+\"\\n\")}s.push(\"        </table:table-row>\\n\")}s.push(\"      </table:table>\\n\");return s.join(\"\")};var n=function(e,r){e.push(\" <office:automatic-styles>\\n\");e.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');e.push('   <number:month number:style=\"long\"/>\\n');e.push(\"   <number:text>/</number:text>\\n\");e.push('   <number:day number:style=\"long\"/>\\n');e.push(\"   <number:text>/</number:text>\\n\");e.push(\"   <number:year/>\\n\");e.push(\"  </number:date-style>\\n\");var t=0;r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(r){if(!r)return;if(r[\"!cols\"]){for(var a=0;a<r[\"!cols\"].length;++a)if(r[\"!cols\"][a]){var n=r[\"!cols\"][a];if(n.width==null&&n.wpx==null&&n.wch==null)continue;Il(n);n.ods=t;var i=r[\"!cols\"][a].wpx+\"px\";e.push('  <style:style style:name=\"co'+t+'\" style:family=\"table-column\">\\n');e.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"'+i+'\"/>\\n');e.push(\"  </style:style>\\n\");++t}}});var a=0;r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(r){if(!r)return;if(r[\"!rows\"]){for(var t=0;t<r[\"!rows\"].length;++t)if(r[\"!rows\"][t]){r[\"!rows\"][t].ods=a;var n=r[\"!rows\"][t].hpx+\"px\";e.push('  <style:style style:name=\"ro'+a+'\" style:family=\"table-row\">\\n');e.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"'+n+'\"/>\\n');e.push(\"  </style:style>\\n\");++a}}});e.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');e.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');e.push(\"  </style:style>\\n\");e.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');e.push(\" </office:automatic-styles>\\n\")};return function i(e,r){var t=[Mr];var i=wt({\"xmlns:office\":\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\"xmlns:table\":\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\"xmlns:style\":\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\"xmlns:text\":\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\"xmlns:draw\":\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\"xmlns:fo\":\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",\"xmlns:dc\":\"http://purl.org/dc/elements/1.1/\",\"xmlns:meta\":\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\"xmlns:number\":\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\"xmlns:presentation\":\"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\"xmlns:svg\":\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\"xmlns:chart\":\"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\"xmlns:dr3d\":\"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\"xmlns:math\":\"http://www.w3.org/1998/Math/MathML\",\"xmlns:form\":\"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\"xmlns:script\":\"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\"xmlns:ooo\":\"http://openoffice.org/2004/office\",\"xmlns:ooow\":\"http://openoffice.org/2004/writer\",\"xmlns:oooc\":\"http://openoffice.org/2004/calc\",\"xmlns:dom\":\"http://www.w3.org/2001/xml-events\",\"xmlns:xforms\":\"http://www.w3.org/2002/xforms\",\"xmlns:xsd\":\"http://www.w3.org/2001/XMLSchema\",\"xmlns:xsi\":\"http://www.w3.org/2001/XMLSchema-instance\",\"xmlns:sheet\":\"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\"xmlns:rpt\":\"http://openoffice.org/2005/report\",\"xmlns:of\":\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\"xmlns:xhtml\":\"http://www.w3.org/1999/xhtml\",\"xmlns:grddl\":\"http://www.w3.org/2003/g/data-view#\",\"xmlns:tableooo\":\"http://openoffice.org/2009/table\",\"xmlns:drawooo\":\"http://openoffice.org/2010/draw\",\"xmlns:calcext\":\"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\"xmlns:loext\":\"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\"xmlns:field\":\"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\"xmlns:formx\":\"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\"xmlns:css3t\":\"http://www.w3.org/TR/css3-text/\",\"office:version\":\"1.2\"});var s=wt({\"xmlns:config\":\"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\"office:mimetype\":\"application/vnd.oasis.opendocument.spreadsheet\"});if(r.bookType==\"fods\"){t.push(\"<office:document\"+i+s+\">\\n\");t.push(oi().replace(/office:document-meta/g,\"office:meta\"))}else t.push(\"<office:document-content\"+i+\">\\n\");n(t,e);t.push(\"  <office:body>\\n\");t.push(\"    <office:spreadsheet>\\n\");for(var f=0;f!=e.SheetNames.length;++f)t.push(a(e.Sheets[e.SheetNames[f]],e,f,r));t.push(\"    </office:spreadsheet>\\n\");t.push(\"  </office:body>\\n\");if(r.bookType==\"fods\")t.push(\"</office:document>\");else t.push(\"</office:document-content>\");return t.join(\"\")}}();function tb(e,r){if(r.bookType==\"fods\")return rb(e,r);var t=Fr();var a=\"\";var n=[];var i=[];a=\"mimetype\";Dr(t,a,\"application/vnd.oasis.opendocument.spreadsheet\");a=\"content.xml\";Dr(t,a,rb(e,r));n.push([a,\"text/xml\"]);i.push([a,\"ContentFile\"]);a=\"styles.xml\";Dr(t,a,eb(e,r));n.push([a,\"text/xml\"]);i.push([a,\"StylesFile\"]);a=\"meta.xml\";Dr(t,a,Mr+oi());n.push([a,\"text/xml\"]);i.push([a,\"MetadataFile\"]);a=\"manifest.rdf\";Dr(t,a,fi(i));n.push([a,\"application/rdf+xml\"]);a=\"META-INF/manifest.xml\";Dr(t,a,ni(n));return t}function ab(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function nb(e){return typeof TextDecoder!=\"undefined\"?(new TextDecoder).decode(e):lt(_(e))}function ib(e){return typeof TextEncoder!=\"undefined\"?(new TextEncoder).encode(e):y(ct(e))}function sb(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var a=0;a<r.length;++a)if(e[t+a]!=r[a])continue e;return true}return false}function fb(e){var r=e.reduce(function(e,r){return e+r.length},0);var t=new Uint8Array(r);var a=0;e.forEach(function(e){t.set(e,a);a+=e.length});return t}function ob(e){e-=e>>1&1431655765;e=(e&858993459)+(e>>2&858993459);return(e+(e>>4)&252645135)*16843009>>>24}function lb(e,r){var t=(e[r+15]&127)<<7|e[r+14]>>1;var a=e[r+14]&1;for(var n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function cb(e,r,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20;var n=t/Math.pow(10,a-6176);e[r+15]|=a>>7;e[r+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=n&255;e[r+15]|=t>=0?0:128}function hb(e,r){var t=r?r[0]:0;var a=e[t]&127;e:if(e[t++]>=128){a|=(e[t]&127)<<7;if(e[t++]<128)break e;a|=(e[t]&127)<<14;if(e[t++]<128)break e;a|=(e[t]&127)<<21;if(e[t++]<128)break e;a+=(e[t]&127)*Math.pow(2,28);++t;if(e[t++]<128)break e;a+=(e[t]&127)*Math.pow(2,35);++t;if(e[t++]<128)break e;a+=(e[t]&127)*Math.pow(2,42);++t;if(e[t++]<128)break e}if(r)r[0]=t;return a}function ub(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){r[t-1]|=128;r[t]=e>>7&127;++t;if(e<=16383)break e;r[t-1]|=128;r[t]=e>>14&127;++t;if(e<=2097151)break e;r[t-1]|=128;r[t]=e>>21&127;++t;if(e<=268435455)break e;r[t-1]|=128;r[t]=e/256>>>21&127;++t;if(e<=34359738367)break e;r[t-1]|=128;r[t]=e/65536>>>21&127;++t;if(e<=4398046511103)break e;r[t-1]|=128;r[t]=e/16777216>>>21&127;++t}return r.slice(0,t)}function db(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){t|=(e[r]&127)<<7;if(e[r++]<128)break e;t|=(e[r]&127)<<14;if(e[r++]<128)break e;t|=(e[r]&127)<<21;if(e[r++]<128)break e;t|=(e[r]&127)<<28}return t}function vb(e){var r=[],t=[0];while(t[0]<e.length){var a=t[0];var n=hb(e,t);var i=n&7;n=Math.floor(n/8);var s=0;var f;if(n==0)break;switch(i){case 0:{var o=t[0];while(e[t[0]++]>=128);f=e.slice(o,t[0])}break;case 5:s=4;f=e.slice(t[0],t[0]+s);t[0]+=s;break;case 1:s=8;f=e.slice(t[0],t[0]+s);t[0]+=s;break;case 2:s=hb(e,t);f=e.slice(t[0],t[0]+s);t[0]+=s;break;case 3:;case 4:;default:throw new Error(\"PB Type \".concat(i,\" for Field \").concat(n,\" at offset \").concat(a));}var l={data:f,type:i};if(r[n]==null)r[n]=[l];else r[n].push(l)}return r}function pb(e){var r=[];e.forEach(function(e,t){e.forEach(function(e){if(!e.data)return;r.push(ub(t*8+e.type));if(e.type==2)r.push(ub(e.data.length));r.push(e.data)})});return fb(r)}function gb(e,r){return(e==null?void 0:e.map(function(e){return r(e.data)}))||[]}function mb(e){var r;var t=[],a=[0];while(a[0]<e.length){var n=hb(e,a);var i=vb(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:db(i[1][0].data),messages:[]};i[2].forEach(function(r){var t=vb(r.data);var n=db(t[3][0].data);s.messages.push({meta:t,data:e.slice(a[0],a[0]+n)});a[0]+=n});if((r=i[3])==null?void 0:r[0])s.merge=db(i[3][0].data)>>>0>0;t.push(s)}return t}function bb(e){var r=[];e.forEach(function(e){var t=[];t[1]=[{data:ub(e.id),type:0}];t[2]=[];if(e.merge!=null)t[3]=[{data:ub(+!!e.merge),type:0}];var a=[];e.messages.forEach(function(e){a.push(e.data);e.meta[3]=[{type:0,data:ub(e.data.length)}];t[2].push({data:pb(e.meta),type:2})});var n=pb(t);r.push(ub(n.length));r.push(n);a.forEach(function(e){return r.push(e)})});return fb(r)}function wb(e,r){if(e!=0)throw new Error(\"Unexpected Snappy chunk type \".concat(e));var t=[0];var a=hb(r,t);var n=[];while(t[0]<r.length){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var f=s-59;s=r[t[0]];if(f>1)s|=r[t[0]+1]<<8;if(f>2)s|=r[t[0]+2]<<16;if(f>3)s|=r[t[0]+3]<<24;s>>>=0;s++;t[0]+=f}n.push(r.slice(t[0],t[0]+s));t[0]+=s;continue}else{var o=0,l=0;if(i==1){l=(r[t[0]]>>2&7)+4;o=(r[t[0]++]&224)<<3;o|=r[t[0]++]}else{l=(r[t[0]++]>>2)+1;if(i==2){o=r[t[0]]|r[t[0]+1]<<8;t[0]+=2}else{o=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0;t[0]+=4}}n=[fb(n)];if(o==0)throw new Error(\"Invalid offset 0\");if(o>n[0].length)throw new Error(\"Invalid offset beyond length\");if(l>=o){n.push(n[0].slice(-o));l-=o;while(l>=n[n.length-1].length){n.push(n[n.length-1]);l-=n[n.length-1].length}}n.push(n[0].slice(-o,-o+l))}}var c=fb(n);if(c.length!=a)throw new Error(\"Unexpected length: \".concat(c.length,\" != \").concat(a));return c}function kb(e){var r=[];var t=0;while(t<e.length){var a=e[t++];var n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3;r.push(wb(a,e.slice(t,t+n)));t+=n}if(t!==e.length)throw new Error(\"data is not a valid framed stream!\");return fb(r)}function Tb(e){var r=[];var t=0;while(t<e.length){var a=Math.min(e.length-t,268435455);var n=new Uint8Array(4);r.push(n);var i=ub(a);var s=i.length;r.push(i);if(a<=60){s++;r.push(new Uint8Array([a-1<<2]))}else if(a<=256){s+=2;r.push(new Uint8Array([240,a-1&255]))}else if(a<=65536){s+=3;r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))}else if(a<=16777216){s+=4;r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))}else if(a<=4294967296){s+=5;r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))}r.push(e.slice(t,t+a));s+=a;n[0]=0;n[1]=s&255;n[2]=s>>8&255;n[3]=s>>16&255;t+=a}return fb(r)}function Ab(e,r,t,a){var n=ab(e);var i=n.getUint32(4,true);var s=(a>1?12:8)+ob(i&(a>1?3470:398))*4;var f=-1,o=-1,l=NaN,c=new Date(2001,0,1);if(i&512){f=n.getUint32(s,true);s+=4}s+=ob(i&(a>1?12288:4096))*4;if(i&16){o=n.getUint32(s,true);s+=4}if(i&32){l=n.getFloat64(s,true);s+=8}if(i&64){c.setTime(c.getTime()+n.getFloat64(s,true)*1e3);s+=8}var h;switch(e[2]){case 0:break;case 2:h={t:\"n\",v:l};break;case 3:h={t:\"s\",v:r[o]};break;case 5:h={t:\"d\",v:c};break;case 6:h={t:\"b\",v:l>0};break;case 7:h={t:\"n\",v:l/86400};break;case 8:h={t:\"e\",v:0};break;case 9:{if(f>-1)h={t:\"s\",v:t[f]};else if(o>-1)h={t:\"s\",v:r[o]};else if(!isNaN(l))h={t:\"n\",v:l};else throw new Error(\"Unsupported cell type \".concat(e.slice(0,4)))}break;default:throw new Error(\"Unsupported cell type \".concat(e.slice(0,4)));}return h}function Eb(e,r,t){var a=ab(e);var n=a.getUint32(8,true);var i=12;var s=-1,f=-1,o=NaN,l=NaN,c=new Date(2001,0,1);if(n&1){o=lb(e,i);i+=16}if(n&2){l=a.getFloat64(i,true);i+=8}if(n&4){c.setTime(c.getTime()+a.getFloat64(i,true)*1e3);i+=8}if(n&8){f=a.getUint32(i,true);i+=4}if(n&16){s=a.getUint32(i,true);i+=4}var h;switch(e[1]){case 0:break;case 2:h={t:\"n\",v:o};break;case 3:h={t:\"s\",v:r[f]};break;case 5:h={t:\"d\",v:c};break;case 6:h={t:\"b\",v:l>0};break;case 7:h={t:\"n\",v:l/86400};break;case 8:h={t:\"e\",v:0};break;case 9:{if(s>-1)h={t:\"s\",v:t[s]};else throw new Error(\"Unsupported cell type \".concat(e[1],\" : \").concat(n&31,\" : \").concat(e.slice(0,4)))}break;case 10:h={t:\"n\",v:o};break;default:throw new Error(\"Unsupported cell type \".concat(e[1],\" : \").concat(n&31,\" : \").concat(e.slice(0,4)));}return h}function Cb(e,r){var t=new Uint8Array(32),a=ab(t),n=12,i=0;t[0]=5;switch(e.t){case\"n\":t[1]=2;cb(t,n,e.v);i|=1;n+=16;break;case\"b\":t[1]=6;a.setFloat64(n,e.v?1:0,true);i|=2;n+=8;break;case\"s\":if(r.indexOf(e.v)==-1)throw new Error(\"Value \".concat(e.v,\" missing from SST!\"));t[1]=3;a.setUint32(n,r.indexOf(e.v),true);i|=8;n+=4;break;default:throw\"unsupported cell type \"+e.t;}a.setUint32(8,i,true);return t.slice(0,n)}function yb(e,r){var t=new Uint8Array(32),a=ab(t),n=12,i=0;t[0]=3;switch(e.t){case\"n\":t[2]=2;a.setFloat64(n,e.v,true);i|=32;n+=8;break;case\"b\":t[2]=6;a.setFloat64(n,e.v?1:0,true);i|=32;n+=8;break;case\"s\":if(r.indexOf(e.v)==-1)throw new Error(\"Value \".concat(e.v,\" missing from SST!\"));t[2]=3;a.setUint32(n,r.indexOf(e.v),true);i|=16;n+=4;break;default:throw\"unsupported cell type \"+e.t;}a.setUint32(4,i,true);return t.slice(0,n)}function Sb(e,r,t){switch(e[0]){case 0:;case 1:;case 2:;case 3:return Ab(e,r,t,e[0]);case 5:return Eb(e,r,t);default:throw new Error(\"Unsupported payload version \".concat(e[0]));}}function _b(e){var r=vb(e);return hb(r[1][0].data)}function xb(e){var r=[];r[1]=[{type:0,data:ub(e)}];return pb(r)}function Ob(e,r){var t=vb(r.data);var a=db(t[1][0].data);var n=t[3];var i=[];(n||[]).forEach(function(r){var t=vb(r.data);var n=db(t[1][0].data)>>>0;switch(a){case 1:i[n]=nb(t[3][0].data);break;case 8:{var s=e[_b(t[9][0].data)][0];var f=vb(s.data);var o=e[_b(f[1][0].data)][0];var l=db(o.meta[1][0].data);if(l!=2001)throw new Error(\"2000 unexpected reference to \".concat(l));var c=vb(o.data);i[n]=c[3].map(function(e){return nb(e.data)}).join(\"\")}break;}});return i}function Rb(e,r){var t,a,n,i,s,f,o,l,c,h,u,d,v,p;var g=vb(e);var m=db(g[1][0].data)>>>0;var b=db(g[2][0].data)>>>0;var w=((a=(t=g[8])==null?void 0:t[0])==null?void 0:a.data)&&db(g[8][0].data)>0||false;var k,T;if(((i=(n=g[7])==null?void 0:n[0])==null?void 0:i.data)&&r!=0){k=(f=(s=g[7])==null?void 0:s[0])==null?void 0:f.data;T=(l=(o=g[6])==null?void 0:o[0])==null?void 0:l.data}else if(((h=(c=g[4])==null?void 0:c[0])==null?void 0:h.data)&&r!=1){k=(d=(u=g[4])==null?void 0:u[0])==null?void 0:d.data;T=(p=(v=g[3])==null?void 0:v[0])==null?void 0:p.data}else throw\"NUMBERS Tile missing \".concat(r,\" cell storage\");var A=w?4:1;var E=ab(k);var C=[];for(var y=0;y<k.length/2;++y){var S=E.getUint16(y*2,true);if(S<65535)C.push([y,S])}if(C.length!=b)throw\"Expected \".concat(b,\" cells, found \").concat(C.length);var _=[];for(y=0;y<C.length-1;++y)_[C[y][0]]=T.subarray(C[y][1]*A,C[y+1][1]*A);if(C.length>=1)_[C[C.length-1][0]]=T.subarray(C[C.length-1][1]*A);return{R:m,cells:_}}function Ib(e,r){var t;var a=vb(r.data);var n=((t=a==null?void 0:a[7])==null?void 0:t[0])?db(a[7][0].data)>>>0>0?1:0:-1;var i=gb(a[5],function(e){return Rb(e,n)});return{nrows:db(a[4][0].data)>>>0,data:i.reduce(function(e,r){if(!e[r.R])e[r.R]=[];r.cells.forEach(function(t,a){if(e[r.R][a])throw new Error(\"Duplicate cell r=\".concat(r.R,\" c=\").concat(a));e[r.R][a]=t});return e},[])}}function Nb(e,r,t){var a;var n=vb(r.data);var i={s:{r:0,c:0},e:{r:0,c:0}};i.e.r=(db(n[6][0].data)>>>0)-1;if(i.e.r<0)throw new Error(\"Invalid row varint \".concat(n[6][0].data));i.e.c=(db(n[7][0].data)>>>0)-1;if(i.e.c<0)throw new Error(\"Invalid col varint \".concat(n[7][0].data));t[\"!ref\"]=Na(i);var s=vb(n[4][0].data);var f=Ob(e,e[_b(s[4][0].data)][0]);\nvar o=((a=s[17])==null?void 0:a[0])?Ob(e,e[_b(s[17][0].data)][0]):[];var l=vb(s[3][0].data);var c=0;l[1].forEach(function(r){var a=vb(r.data);var n=e[_b(a[2][0].data)][0];var i=db(n.meta[1][0].data);if(i!=6002)throw new Error(\"6001 unexpected reference to \".concat(i));var s=Ib(e,n);s.data.forEach(function(e,r){e.forEach(function(e,a){var n=Ra({r:c+r,c:a});var i=Sb(e,f,o);if(i)t[n]=i})});c+=s.nrows})}function Db(e,r){var t=vb(r.data);var a={\"!ref\":\"A1\"};var n=e[_b(t[2][0].data)];var i=db(n[0].meta[1][0].data);if(i!=6001)throw new Error(\"6000 unexpected reference to \".concat(i));Nb(e,n[0],a);return a}function Fb(e,r){var t;var a=vb(r.data);var n={name:((t=a[1])==null?void 0:t[0])?nb(a[1][0].data):\"\",sheets:[]};var i=gb(a[2],_b);i.forEach(function(r){e[r].forEach(function(r){var t=db(r.meta[1][0].data);if(t==6e3)n.sheets.push(Db(e,r))})});return n}function Pb(e,r){var t=Nw();var a=vb(r.data);var n=gb(a[1],_b);n.forEach(function(r){e[r].forEach(function(r){var a=db(r.meta[1][0].data);if(a==2){var n=Fb(e,r);n.sheets.forEach(function(e,r){Dw(t,e,r==0?n.name:n.name+\"_\"+r,true)})}})});if(t.SheetNames.length==0)throw new Error(\"Empty NUMBERS file\");return t}function Lb(e){var r,t,a,n;var i={},s=[];e.FullPaths.forEach(function(e){if(e.match(/\\.iwpv2/))throw new Error(\"Unsupported password protection\")});e.FileIndex.forEach(function(e){if(!e.name.match(/\\.iwa$/))return;var r;try{r=kb(e.content)}catch(t){return console.log(\"?? \"+e.content.length+\" \"+(t.message||t))}var a;try{a=mb(r)}catch(t){return console.log(\"## \"+(t.message||t))}a.forEach(function(e){i[e.id]=e.messages;s.push(e.id)})});if(!s.length)throw new Error(\"File has no messages\");var f=((n=(a=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&db(i[1][0].meta[1][0].data)==1&&i[1][0];if(!f)s.forEach(function(e){i[e].forEach(function(e){var r=db(e.meta[1][0].data)>>>0;if(r==1){if(!f)f=e;else throw new Error(\"Document has multiple roots\")}})});if(!f)throw new Error(\"Cannot find Document root\");return Pb(i,f)}function Mb(e,r,t){var a,n,i,s;if(!((a=e[6])==null?void 0:a[0])||!((n=e[7])==null?void 0:n[0]))throw\"Mutation only works on post-BNC storages!\";var f=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&db(e[8][0].data)>0||false;if(f)throw\"Math only works with normal offsets\";var o=0;var l=ab(e[7][0].data),c=0,h=[];var u=ab(e[4][0].data),d=0,v=[];for(var p=0;p<r.length;++p){if(r[p]==null){l.setUint16(p*2,65535,true);u.setUint16(p*2,65535);continue}l.setUint16(p*2,c,true);u.setUint16(p*2,d,true);var g,m;switch(typeof r[p]){case\"string\":g=Cb({t:\"s\",v:r[p]},t);m=yb({t:\"s\",v:r[p]},t);break;case\"number\":g=Cb({t:\"n\",v:r[p]},t);m=yb({t:\"n\",v:r[p]},t);break;case\"boolean\":g=Cb({t:\"b\",v:r[p]},t);m=yb({t:\"b\",v:r[p]},t);break;default:throw new Error(\"Unsupported value \"+r[p]);}h.push(g);c+=g.length;v.push(m);d+=m.length;++o}e[2][0].data=ub(o);for(;p<e[7][0].data.length/2;++p){l.setUint16(p*2,65535,true);u.setUint16(p*2,65535,true)}e[6][0].data=fb(h);e[3][0].data=fb(v);return o}function Ub(e,r){if(!r||!r.numbers)throw new Error(\"Must pass a `numbers` option -- check the README\");var t=e.Sheets[e.SheetNames[0]];if(e.SheetNames.length>1)console.error(\"The Numbers writer currently writes only the first table\");var a=Ia(t[\"!ref\"]);a.s.r=a.s.c=0;var n=false;if(a.e.c>9){n=true;a.e.c=9}if(a.e.r>49){n=true;a.e.r=49}if(n)console.error(\"The Numbers writer is currently limited to \".concat(Na(a)));var i=Aw(t,{range:a,header:1});var s=[\"~Sh33tJ5~\"];i.forEach(function(e){return e.forEach(function(e){if(typeof e==\"string\")s.push(e)})});var f={};var o=[];var l=Ke.read(r.numbers,{type:\"base64\"});l.FileIndex.map(function(e,r){return[e,l.FullPaths[r]]}).forEach(function(e){var r=e[0],t=e[1];if(r.type!=2)return;if(!r.name.match(/\\.iwa/))return;var a=r.content;var n=kb(a);var i=mb(n);i.forEach(function(e){o.push(e.id);f[e.id]={deps:[],location:t,type:db(e.messages[0].meta[1][0].data)}})});o.sort(function(e,r){return e-r});var c=o.filter(function(e){return e>1}).map(function(e){return[e,ub(e)]});l.FileIndex.map(function(e,r){return[e,l.FullPaths[r]]}).forEach(function(e){var r=e[0],t=e[1];if(!r.name.match(/\\.iwa/))return;var a=mb(kb(r.content));a.forEach(function(e){e.messages.forEach(function(r){c.forEach(function(r){if(e.messages.some(function(e){return db(e.meta[1][0].data)!=11006&&sb(e.data,r[1])})){f[r[0]].deps.push(e.id)}})})})});function h(){for(var e=927262;e<2e6;++e)if(!f[e])return e;throw new Error(\"Too many messages\")}var u=Ke.find(l,f[1].location);var d=mb(kb(u.content));var v;for(var p=0;p<d.length;++p){var g=d[p];if(g.id==1)v=g}var m=_b(vb(v.messages[0].data)[1][0].data);u=Ke.find(l,f[m].location);d=mb(kb(u.content));for(p=0;p<d.length;++p){g=d[p];if(g.id==m)v=g}m=_b(vb(v.messages[0].data)[2][0].data);u=Ke.find(l,f[m].location);d=mb(kb(u.content));for(p=0;p<d.length;++p){g=d[p];if(g.id==m)v=g}m=_b(vb(v.messages[0].data)[2][0].data);u=Ke.find(l,f[m].location);d=mb(kb(u.content));for(p=0;p<d.length;++p){g=d[p];if(g.id==m)v=g}var b=vb(v.messages[0].data);{b[6][0].data=ub(a.e.r+1);b[7][0].data=ub(a.e.c+1);var w=_b(b[46][0].data);var k=Ke.find(l,f[w].location);var T=mb(kb(k.content));{for(var A=0;A<T.length;++A){if(T[A].id==w)break}if(T[A].id!=w)throw\"Bad ColumnRowUIDMapArchive\";var E=vb(T[A].messages[0].data);E[1]=[];E[2]=[],E[3]=[];for(var C=0;C<=a.e.c;++C){var y=[];y[1]=y[2]=[{type:0,data:ub(C+420690)}];E[1].push({type:2,data:pb(y)});E[2].push({type:0,data:ub(C)});E[3].push({type:0,data:ub(C)})}E[4]=[];E[5]=[],E[6]=[];for(var S=0;S<=a.e.r;++S){y=[];y[1]=y[2]=[{type:0,data:ub(S+726270)}];E[4].push({type:2,data:pb(y)});E[5].push({type:0,data:ub(S)});E[6].push({type:0,data:ub(S)})}T[A].messages[0].data=pb(E)}k.content=Tb(bb(T));k.size=k.content.length;delete b[46];var _=vb(b[4][0].data);{_[7][0].data=ub(a.e.r+1);var x=vb(_[1][0].data);var O=_b(x[2][0].data);k=Ke.find(l,f[O].location);T=mb(kb(k.content));{if(T[0].id!=O)throw\"Bad HeaderStorageBucket\";var R=vb(T[0].messages[0].data);for(S=0;S<i.length;++S){var I=vb(R[2][0].data);I[1][0].data=ub(S);I[4][0].data=ub(i[S].length);R[2][S]={type:R[2][0].type,data:pb(I)}}T[0].messages[0].data=pb(R)}k.content=Tb(bb(T));k.size=k.content.length;var N=_b(_[2][0].data);k=Ke.find(l,f[N].location);T=mb(kb(k.content));{if(T[0].id!=N)throw\"Bad HeaderStorageBucket\";R=vb(T[0].messages[0].data);for(C=0;C<=a.e.c;++C){I=vb(R[2][0].data);I[1][0].data=ub(C);I[4][0].data=ub(a.e.r+1);R[2][C]={type:R[2][0].type,data:pb(I)}}T[0].messages[0].data=pb(R)}k.content=Tb(bb(T));k.size=k.content.length;var D=_b(_[4][0].data);(function(){var e=Ke.find(l,f[D].location);var r=mb(kb(e.content));var t;for(var a=0;a<r.length;++a){var n=r[a];if(n.id==D)t=n}var i=vb(t.messages[0].data);{i[3]=[];var o=[];s.forEach(function(e,r){o[1]=[{type:0,data:ub(r)}];o[2]=[{type:0,data:ub(1)}];o[3]=[{type:2,data:ib(e)}];i[3].push({type:2,data:pb(o)})})}t.messages[0].data=pb(i);var c=bb(r);var h=Tb(c);e.content=h;e.size=e.content.length})();var F=vb(_[3][0].data);{var P=F[1][0];delete F[2];var L=vb(P.data);{var M=_b(L[2][0].data);(function(){var e=Ke.find(l,f[M].location);var r=mb(kb(e.content));var t;for(var n=0;n<r.length;++n){var o=r[n];if(o.id==M)t=o}var c=vb(t.messages[0].data);{delete c[6];delete F[7];var h=new Uint8Array(c[5][0].data);c[5]=[];var u=0;for(var d=0;d<=a.e.r;++d){var v=vb(h);u+=Mb(v,i[d],s);v[1][0].data=ub(d);c[5].push({data:pb(v),type:2})}c[1]=[{type:0,data:ub(a.e.c+1)}];c[2]=[{type:0,data:ub(a.e.r+1)}];c[3]=[{type:0,data:ub(u)}];c[4]=[{type:0,data:ub(a.e.r+1)}]}t.messages[0].data=pb(c);var p=bb(r);var g=Tb(p);e.content=g;e.size=e.content.length})()}P.data=pb(L)}_[3][0].data=pb(F)}b[4][0].data=pb(_)}v.messages[0].data=pb(b);var U=bb(d);var B=Tb(U);u.content=B;u.size=u.content.length;return l}function Bb(e){return function r(t){for(var a=0;a!=e.length;++a){var n=e[a];if(t[n[0]]===undefined)t[n[0]]=n[1];if(n[2]===\"n\")t[n[0]]=Number(t[n[0]])}}}function Wb(e){Bb([[\"cellNF\",false],[\"cellHTML\",true],[\"cellFormula\",true],[\"cellStyles\",false],[\"cellText\",true],[\"cellDates\",false],[\"sheetStubs\",false],[\"sheetRows\",0,\"n\"],[\"bookDeps\",false],[\"bookSheets\",false],[\"bookProps\",false],[\"bookFiles\",false],[\"bookVBA\",false],[\"password\",\"\"],[\"WTF\",false]])(e)}function Hb(e){Bb([[\"cellDates\",false],[\"bookSST\",false],[\"bookType\",\"xlsx\"],[\"compression\",false],[\"WTF\",false]])(e)}function zb(e){if(qn.WS.indexOf(e)>-1)return\"sheet\";if(qn.CS&&e==qn.CS)return\"chart\";if(qn.DS&&e==qn.DS)return\"dialog\";if(qn.MS&&e==qn.MS)return\"macro\";return e&&e.length?e:\"sheet\"}function Vb(e,r){if(!e)return 0;try{e=r.map(function a(r){if(!r.id)r.id=r.strRelID;return[r.name,e[\"!id\"][r.id].Target,zb(e[\"!id\"][r.id].Type)]})}catch(t){return null}return!e||e.length===0?null:e}function Gb(e,r,t,a,n,i,s,f,o,l,c,h){try{i[a]=Qn(Rr(e,t,true),r);var u=Or(e,r);var d;switch(f){case\"sheet\":d=pg(u,r,n,o,i[a],l,c,h);break;case\"chart\":d=gg(u,r,n,o,i[a],l,c,h);if(!d||!d[\"!drawel\"])break;var v=Lr(d[\"!drawel\"].Target,r);var p=Zn(v);var g=th(Rr(e,v,true),Qn(Rr(e,p,true),v));var m=Lr(g,v);var b=Zn(m);d=Pp(Rr(e,m,true),m,o,Qn(Rr(e,b,true),m),l,d);break;case\"macro\":d=mg(u,r,n,o,i[a],l,c,h);break;case\"dialog\":d=bg(u,r,n,o,i[a],l,c,h);break;default:throw new Error(\"Unrecognized sheet type \"+f);}s[a]=d;var w=[];if(i&&i[a])rr(i[a]).forEach(function(t){var n=\"\";if(i[a][t].Type==qn.CMNT){n=Lr(i[a][t].Target,r);var s=Ag(Or(e,n,true),n,o);if(!s||!s.length)return;ih(d,s,false)}if(i[a][t].Type==qn.TCMNT){n=Lr(i[a][t].Target,r);w=w.concat(oh(Or(e,n,true),o))}});if(w&&w.length)ih(d,w,true,o.people||[])}catch(k){if(o.WTF)throw k}}function jb(e){return e.charAt(0)==\"/\"?e.slice(1):e}function Xb(e,r){ze();r=r||{};Wb(r);if(_r(e,\"META-INF/manifest.xml\"))return Zm(e,r);if(_r(e,\"objectdata.xml\"))return Zm(e,r);if(_r(e,\"Index/Document.iwa\")){if(typeof Uint8Array==\"undefined\")throw new Error(\"NUMBERS file parsing requires Uint8Array support\");if(typeof Lb!=\"undefined\"){if(e.FileIndex)return Lb(e);var t=Ke.utils.cfb_new();Nr(e).forEach(function(r){Dr(t,r,Ir(e,r))});return Lb(t)}throw new Error(\"Unsupported NUMBERS file\")}if(!_r(e,\"[Content_Types].xml\")){if(_r(e,\"index.xml.gz\"))throw new Error(\"Unsupported NUMBERS 08 file\");if(_r(e,\"index.xml\"))throw new Error(\"Unsupported NUMBERS 09 file\");throw new Error(\"Unsupported ZIP file\")}var a=Nr(e);var n=Kn(Rr(e,\"[Content_Types].xml\"));var i=false;var s,f;if(n.workbooks.length===0){f=\"xl/workbook.xml\";if(Or(e,f,true))n.workbooks.push(f)}if(n.workbooks.length===0){f=\"xl/workbook.bin\";if(!Or(e,f,true))throw new Error(\"Could not find workbook\");n.workbooks.push(f);i=true}if(n.workbooks[0].slice(-3)==\"bin\")i=true;var o={};var l={};if(!r.bookSheets&&!r.bookProps){xd=[];if(n.sst)try{xd=Tg(Or(e,jb(n.sst)),n.sst,r)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n.themes.length)o=kg(Rr(e,n.themes[0].replace(/^\\//,\"\"),true)||\"\",n.themes[0],r);if(n.style)l=wg(Or(e,jb(n.style)),n.style,o,r)}n.links.map(function(t){try{var a=Qn(Rr(e,Zn(jb(t))),t);return Cg(Or(e,jb(t)),a,t,r)}catch(n){}});var h=vg(Or(e,jb(n.workbooks[0])),n.workbooks[0],r);var u={},d=\"\";if(n.coreprops.length){d=Or(e,jb(n.coreprops[0]),true);if(d)u=hi(d);if(n.extprops.length!==0){d=Or(e,jb(n.extprops[0]),true);if(d)mi(d,u,r)}}var v={};if(!r.bookSheets||r.bookProps){if(n.custprops.length!==0){d=Rr(e,jb(n.custprops[0]),true);if(d)v=ki(d,r)}}var p={};if(r.bookSheets||r.bookProps){if(h.Sheets)s=h.Sheets.map(function I(e){return e.name});else if(u.Worksheets&&u.SheetNames.length>0)s=u.SheetNames;if(r.bookProps){p.Props=u;p.Custprops=v}if(r.bookSheets&&typeof s!==\"undefined\")p.SheetNames=s;if(r.bookSheets?p.SheetNames:r.bookProps)return p}s={};var g={};if(r.bookDeps&&n.calcchain)g=Eg(Or(e,jb(n.calcchain)),n.calcchain,r);var m=0;var b={};var w,k;{var T=h.Sheets;u.Worksheets=T.length;u.SheetNames=[];for(var A=0;A!=T.length;++A){u.SheetNames[A]=T[A].name}}var E=i?\"bin\":\"xml\";var C=n.workbooks[0].lastIndexOf(\"/\");var y=(n.workbooks[0].slice(0,C+1)+\"_rels/\"+n.workbooks[0].slice(C+1)+\".rels\").replace(/^\\//,\"\");if(!_r(e,y))y=\"xl/_rels/workbook.\"+E+\".rels\";var S=Qn(Rr(e,y,true),y.replace(/_rels.*/,\"s5s\"));if((n.metadata||[]).length>=1){r.xlmeta=yg(Or(e,jb(n.metadata[0])),n.metadata[0],r)}if((n.people||[]).length>=1){r.people=ch(Or(e,jb(n.people[0])),r)}if(S)S=Vb(S,h.Sheets);var _=Or(e,\"xl/worksheets/sheet.xml\",true)?1:0;e:for(m=0;m!=u.Worksheets;++m){var x=\"sheet\";if(S&&S[m]){w=\"xl/\"+S[m][1].replace(/[\\/]?xl\\//,\"\");if(!_r(e,w))w=S[m][1];if(!_r(e,w))w=y.replace(/_rels\\/.*$/,\"\")+S[m][1];x=S[m][2]}else{w=\"xl/worksheets/sheet\"+(m+1-_)+\".\"+E;w=w.replace(/sheet0\\./,\"sheet.\")}k=w.replace(/^(.*)(\\/)([^\\/]*)$/,\"$1/_rels/$3.rels\");if(r&&r.sheets!=null)switch(typeof r.sheets){case\"number\":if(m!=r.sheets)continue e;break;case\"string\":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){var O=false;for(var R=0;R!=r.sheets.length;++R){if(typeof r.sheets[R]==\"number\"&&r.sheets[R]==m)O=1;if(typeof r.sheets[R]==\"string\"&&r.sheets[R].toLowerCase()==u.SheetNames[m].toLowerCase())O=1}if(!O)continue e};}Gb(e,w,k,u.SheetNames[m],m,b,s,x,r,h,o,l)}p={Directory:n,Workbook:h,Props:u,Custprops:v,Deps:g,Sheets:s,SheetNames:u.SheetNames,Strings:xd,Styles:l,Themes:o,SSF:br(X)};if(r&&r.bookFiles){if(e.files){p.keys=a;p.files=e.files}else{p.keys=[];p.files={};e.FullPaths.forEach(function(r,t){r=r.replace(/^Root Entry[\\/]/,\"\");p.keys.push(r);p.files[r]=e.FileIndex[t]})}}if(r&&r.bookVBA){if(n.vba.length>0)p.vbaraw=Or(e,jb(n.vba[0]),true);else if(n.defaults&&n.defaults.bin===bh)p.vbaraw=Or(e,\"xl/vbaProject.bin\",true)}return p}function $b(e,r){var t=r||{};var a=\"Workbook\",n=Ke.find(e,a);try{a=\"/!DataSpaces/Version\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);Ko(n.content);a=\"/!DataSpaces/DataSpaceMap\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);var i=qo(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!==\"StrongEncryptionDataSpace\"||i[0].comps[0].v!==\"EncryptedPackage\")throw new Error(\"ECMA-376 Encrypted file bad \"+a);a=\"/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);var s=Zo(n.content);if(s.length!=1||s[0]!=\"StrongEncryptionTransform\")throw new Error(\"ECMA-376 Encrypted file bad \"+a);a=\"/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);el(n.content)}catch(f){}a=\"/EncryptionInfo\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);var o=al(n.content);a=\"/EncryptedPackage\";n=Ke.find(e,a);if(!n||!n.content)throw new Error(\"ECMA-376 Encrypted file missing \"+a);if(o[0]==4&&typeof decrypt_agile!==\"undefined\")return decrypt_agile(o[1],n.content,t.password||\"\",t);if(o[0]==2&&typeof decrypt_std76!==\"undefined\")return decrypt_std76(o[1],n.content,t.password||\"\",t);throw new Error(\"File is password-protected\")}function Yb(e,r){if(r.bookType==\"ods\")return tb(e,r);if(r.bookType==\"numbers\")return Ub(e,r);if(r.bookType==\"xlsb\")return Kb(e,r);return Jb(e,r)}function Kb(e,r){ah=1024;if(e&&!e.SSF){e.SSF=br(X)}if(e&&e.SSF){ze();He(e.SSF);r.revssf=nr(e.SSF);r.revssf[e.SSF[65535]]=0;r.ssf=e.SSF}r.rels={};r.wbrels={};r.Strings=[];r.Strings.Count=0;r.Strings.Unique=0;if(Rd)r.revStrings=new Map;else{r.revStrings={};r.revStrings.foo=[];delete r.revStrings.foo}var t=r.bookType==\"xlsb\"?\"bin\":\"xml\";var a=Th.indexOf(r.bookType)>-1;var n=Yn();Hb(r=r||{});var i=Fr();var s=\"\",f=0;r.cellXfs=[];Fd(r.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};s=\"docProps/core.xml\";Dr(i,s,di(e.Props,r));n.coreprops.push(s);ri(r.rels,2,s,qn.CORE_PROPS);s=\"docProps/app.xml\";if(e.Props&&e.Props.SheetNames){}else if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{var o=[];for(var l=0;l<e.SheetNames.length;++l)if((e.Workbook.Sheets[l]||{}).Hidden!=2)o.push(e.SheetNames[l]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length;Dr(i,s,bi(e.Props,r));n.extprops.push(s);ri(r.rels,3,s,qn.EXT_PROPS);if(e.Custprops!==e.Props&&rr(e.Custprops||{}).length>0){s=\"docProps/custom.xml\";Dr(i,s,Ti(e.Custprops,r));n.custprops.push(s);ri(r.rels,4,s,qn.CUST_PROPS)}for(f=1;f<=e.SheetNames.length;++f){var c={\"!id\":{}};var h=e.Sheets[e.SheetNames[f-1]];var u=(h||{})[\"!type\"]||\"sheet\";switch(u){case\"chart\":;default:s=\"xl/worksheets/sheet\"+f+\".\"+t;Dr(i,s,_g(f-1,s,r,e,c));n.sheets.push(s);ri(r.wbrels,-1,\"worksheets/sheet\"+f+\".\"+t,qn.WS[0]);}if(h){var d=h[\"!comments\"];var v=false;var p=\"\";if(d&&d.length>0){p=\"xl/comments\"+f+\".\"+t;Dr(i,p,Ig(d,p,r));n.comments.push(p);ri(c,-1,\"../comments\"+f+\".\"+t,qn.CMNT);v=true}if(h[\"!legacy\"]){if(v)Dr(i,\"xl/drawings/vmlDrawing\"+f+\".vml\",nh(f,h[\"!comments\"]))}delete h[\"!comments\"];delete h[\"!legacy\"]}if(c[\"!id\"].rId1)Dr(i,Zn(s),ei(c))}if(r.Strings!=null&&r.Strings.length>0){s=\"xl/sharedStrings.\"+t;Dr(i,s,Rg(r.Strings,s,r));n.strs.push(s);ri(r.wbrels,-1,\"sharedStrings.\"+t,qn.SST)}s=\"xl/workbook.\"+t;Dr(i,s,Sg(e,s,r));n.workbooks.push(s);ri(r.rels,1,s,qn.WB);s=\"xl/theme/theme1.xml\";Dr(i,s,Ic(e.Themes,r));n.themes.push(s);ri(r.wbrels,-1,\"theme/theme1.xml\",qn.THEME);s=\"xl/styles.\"+t;Dr(i,s,Og(e,s,r));n.styles.push(s);ri(r.wbrels,-1,\"styles.\"+t,qn.STY);if(e.vbaraw&&a){s=\"xl/vbaProject.bin\";Dr(i,s,e.vbaraw);n.vba.push(s);ri(r.wbrels,-1,\"vbaProject.bin\",qn.VBA)}s=\"xl/metadata.\"+t;Dr(i,s,Ng(s));n.metadata.push(s);ri(r.wbrels,-1,\"metadata.\"+t,qn.XLMETA);Dr(i,\"[Content_Types].xml\",Jn(n,r));Dr(i,\"_rels/.rels\",ei(r.rels));Dr(i,\"xl/_rels/workbook.\"+t+\".rels\",ei(r.wbrels));delete r.revssf;delete r.ssf;return i}function Jb(e,r){ah=1024;if(e&&!e.SSF){e.SSF=br(X)}if(e&&e.SSF){ze();He(e.SSF);r.revssf=nr(e.SSF);r.revssf[e.SSF[65535]]=0;r.ssf=e.SSF}r.rels={};r.wbrels={};r.Strings=[];r.Strings.Count=0;r.Strings.Unique=0;if(Rd)r.revStrings=new Map;else{r.revStrings={};r.revStrings.foo=[];delete r.revStrings.foo}var t=\"xml\";var a=Th.indexOf(r.bookType)>-1;var n=Yn();Hb(r=r||{});var i=Fr();var s=\"\",f=0;r.cellXfs=[];Fd(r.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};s=\"docProps/core.xml\";Dr(i,s,di(e.Props,r));n.coreprops.push(s);ri(r.rels,2,s,qn.CORE_PROPS);s=\"docProps/app.xml\";if(e.Props&&e.Props.SheetNames){}else if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{var o=[];for(var l=0;l<e.SheetNames.length;++l)if((e.Workbook.Sheets[l]||{}).Hidden!=2)o.push(e.SheetNames[l]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length;Dr(i,s,bi(e.Props,r));n.extprops.push(s);ri(r.rels,3,s,qn.EXT_PROPS);if(e.Custprops!==e.Props&&rr(e.Custprops||{}).length>0){s=\"docProps/custom.xml\";Dr(i,s,Ti(e.Custprops,r));n.custprops.push(s);ri(r.rels,4,s,qn.CUST_PROPS)}var c=[\"SheetJ5\"];r.tcid=0;for(f=1;f<=e.SheetNames.length;++f){var h={\"!id\":{}};var u=e.Sheets[e.SheetNames[f-1]];var d=(u||{})[\"!type\"]||\"sheet\";switch(d){case\"chart\":;default:s=\"xl/worksheets/sheet\"+f+\".\"+t;Dr(i,s,pv(f-1,r,e,h));n.sheets.push(s);ri(r.wbrels,-1,\"worksheets/sheet\"+f+\".\"+t,qn.WS[0]);}if(u){var v=u[\"!comments\"];var p=false;var g=\"\";if(v&&v.length>0){var m=false;v.forEach(function(e){e[1].forEach(function(e){if(e.T==true)m=true})});if(m){g=\"xl/threadedComments/threadedComment\"+f+\".\"+t;Dr(i,g,lh(v,c,r));n.threadedcomments.push(g);ri(h,-1,\"../threadedComments/threadedComment\"+f+\".\"+t,qn.TCMNT)}g=\"xl/comments\"+f+\".\"+t;Dr(i,g,fh(v,r));n.comments.push(g);ri(h,-1,\"../comments\"+f+\".\"+t,qn.CMNT);p=true}if(u[\"!legacy\"]){if(p)Dr(i,\"xl/drawings/vmlDrawing\"+f+\".vml\",nh(f,u[\"!comments\"]))}delete u[\"!comments\"];delete u[\"!legacy\"]}if(h[\"!id\"].rId1)Dr(i,Zn(s),ei(h))}if(r.Strings!=null&&r.Strings.length>0){s=\"xl/sharedStrings.\"+t;Dr(i,s,Ho(r.Strings,r));n.strs.push(s);ri(r.wbrels,-1,\"sharedStrings.\"+t,qn.SST)}s=\"xl/workbook.\"+t;Dr(i,s,rg(e,r));n.workbooks.push(s);ri(r.rels,1,s,qn.WB);s=\"xl/theme/theme1.xml\";Dr(i,s,Ic(e.Themes,r));n.themes.push(s);ri(r.wbrels,-1,\"theme/theme1.xml\",qn.THEME);s=\"xl/styles.\"+t;Dr(i,s,$l(e,r));n.styles.push(s);ri(r.wbrels,-1,\"styles.\"+t,qn.STY);if(e.vbaraw&&a){s=\"xl/vbaProject.bin\";Dr(i,s,e.vbaraw);n.vba.push(s);ri(r.wbrels,-1,\"vbaProject.bin\",qn.VBA)}s=\"xl/metadata.\"+t;Dr(i,s,Jc());n.metadata.push(s);ri(r.wbrels,-1,\"metadata.\"+t,qn.XLMETA);if(c.length>1){s=\"xl/persons/person.xml\";Dr(i,s,hh(c,r));n.people.push(s);ri(r.wbrels,-1,\"persons/person.xml\",qn.PEOPLE)}Dr(i,\"[Content_Types].xml\",Jn(n,r));Dr(i,\"_rels/.rels\",ei(r.rels));Dr(i,\"xl/_rels/workbook.\"+t+\".rels\",ei(r.wbrels));delete r.revssf;delete r.ssf;return i}function qb(e,r){var t=\"\";switch((r||{}).type||\"base64\"){case\"buffer\":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case\"base64\":t=k(e.slice(0,12));break;case\"binary\":t=e;break;case\"array\":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error(\"Unrecognized type \"+(r&&r.type||\"undefined\"));}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Zb(e,r){if(Ke.find(e,\"EncryptedPackage\"))return $b(e,r);return vm(e,r)}function Qb(e,r){var t,a=e;var n=r||{};if(!n.type)n.type=T&&Buffer.isBuffer(e)?\"buffer\":\"base64\";t=Pr(a,n);return Xb(t,n)}function ew(e,r){var t=0;e:while(t<e.length)switch(e.charCodeAt(t)){case 10:;case 13:;case 32:++t;break;case 60:return jg(e.slice(t),r);default:break e;}return So.to_workbook(e,r)}function rw(e,r){var t=\"\",a=qb(e,r);switch(r.type){case\"base64\":t=k(e);break;case\"binary\":t=e;break;case\"buffer\":t=e.toString(\"binary\");break;case\"array\":t=mr(e);break;default:throw new Error(\"Unrecognized type \"+r.type);}if(a[0]==239&&a[1]==187&&a[2]==191)t=lt(t);r.type=\"binary\";return ew(t,r)}function tw(e,r){var t=e;if(r.type==\"base64\")t=k(t);t=a.utils.decode(1200,t.slice(2),\"str\");r.type=\"binary\";return ew(t,r)}function aw(e){return!e.match(/[^\\x00-\\x7F]/)?e:ct(e)}function nw(e,r,t,a){if(a){t.type=\"string\";return So.to_workbook(e,t)}return So.to_workbook(r,t)}function iw(e,r){l();var t=r||{};if(typeof ArrayBuffer!==\"undefined\"&&e instanceof ArrayBuffer)return iw(new Uint8Array(e),(t=br(t),t.type=\"array\",t));if(typeof Uint8Array!==\"undefined\"&&e instanceof Uint8Array&&!t.type)t.type=typeof Deno!==\"undefined\"?\"buffer\":\"array\";var a=e,n=[0,0,0,0],i=false;if(t.cellStyles){t.cellNF=true;t.sheetStubs=true}Od={};if(t.dateNF)Od.dateNF=t.dateNF;if(!t.type)t.type=T&&Buffer.isBuffer(e)?\"buffer\":\"base64\";if(t.type==\"file\"){t.type=T?\"buffer\":\"binary\";a=er(e);if(typeof Uint8Array!==\"undefined\"&&!T)t.type=\"array\"}if(t.type==\"string\"){i=true;t.type=\"binary\";t.codepage=65001;a=aw(e)}if(t.type==\"array\"&&typeof Uint8Array!==\"undefined\"&&e instanceof Uint8Array&&typeof ArrayBuffer!==\"undefined\"){var s=new ArrayBuffer(3),f=new Uint8Array(s);f.foo=\"bar\";if(!f.foo){t=br(t);t.type=\"array\";return iw(O(a),t)}}switch((n=qb(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Zb(Ke.read(a,t),t);break;case 9:if(n[1]<=8)return vm(a,t);break;case 60:return jg(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error(\"TIFF Image File is not a spreadsheet\");if(n[1]===68)return _o(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return Co.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Qb(a,t):nw(e,a,t,i);case 239:return n[3]===60?jg(a,t):nw(e,a,t,i);case 255:if(n[1]===254){return tw(a,t)}else if(n[1]===0&&n[2]===2&&n[3]===0)return xo.to_workbook(a,t);break;case 0:if(n[1]===0){if(n[2]>=2&&n[3]===0)return xo.to_workbook(a,t);if(n[2]===0&&(n[3]===8||n[3]===9))return xo.to_workbook(a,t)}break;case 3:;case 131:;case 139:;case 140:return Ao.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return gl.to_workbook(a,t);break;case 10:;case 13:;case 32:return rw(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error(\"PNG Image File is not a spreadsheet\");break;}if(To.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31)return Ao.to_workbook(a,t);return nw(e,a,t,i)}function sw(e,r){var t=r||{};t.type=\"file\";return iw(e,t)}function fw(e,r){switch(r.type){case\"base64\":;case\"binary\":break;case\"buffer\":;case\"array\":r.type=\"\";break;case\"file\":return Qe(r.file,Ke.write(e,{type:T?\"buffer\":\"\"}));case\"string\":throw new Error(\"'string' output type invalid for '\"+r.bookType+\"' files\");default:throw new Error(\"Unrecognized type \"+r.type);}return Ke.write(e,r)}function ow(e,r){var t=br(r||{});var a=Yb(e,t);return cw(a,t)}function lw(e,r){var t=br(r||{});var a=Jb(e,t);return cw(a,t)}function cw(e,r){var t={};var a=T?\"nodebuffer\":typeof Uint8Array!==\"undefined\"?\"array\":\"string\";if(r.compression)t.compression=\"DEFLATE\";if(r.password)t.type=a;else switch(r.type){case\"base64\":t.type=\"base64\";break;case\"binary\":t.type=\"string\";break;case\"string\":throw new Error(\"'string' output type invalid for '\"+r.bookType+\"' files\");case\"buffer\":;case\"file\":t.type=a;break;default:throw new Error(\"Unrecognized type \"+r.type);}var n=e.FullPaths?Ke.write(e,{fileType:\"zip\",type:{nodebuffer:\"buffer\",string:\"binary\"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno!==\"undefined\"){if(typeof n==\"string\"){if(r.type==\"binary\"||r.type==\"base64\")return n;n=new Uint8Array(S(n))}}if(r.password&&typeof encrypt_agile!==\"undefined\")return fw(encrypt_agile(n,r.password),r);if(r.type===\"file\")return Qe(r.file,n);return r.type==\"string\"?lt(n):n}function hw(e,r){var t=r||{};var a=pm(e,t);return fw(a,t)}function uw(e,r,t){if(!t)t=\"\";var a=t+e;switch(r.type){case\"base64\":return w(ct(a));case\"binary\":return ct(a);case\"string\":return e;case\"file\":return Qe(r.file,a,\"utf8\");case\"buffer\":{if(T)return A(a,\"utf8\");else if(typeof TextEncoder!==\"undefined\")return(new TextEncoder).encode(a);else return uw(a,{type:\"binary\"}).split(\"\").map(function(e){return e.charCodeAt(0)})};}throw new Error(\"Unrecognized type \"+r.type)}function dw(e,r){switch(r.type){case\"base64\":return w(e);case\"binary\":return e;case\"string\":return e;case\"file\":return Qe(r.file,e,\"binary\");case\"buffer\":{if(T)return A(e,\"binary\");else return e.split(\"\").map(function(e){return e.charCodeAt(0)})};}throw new Error(\"Unrecognized type \"+r.type)}function vw(e,r){switch(r.type){case\"string\":;case\"base64\":;case\"binary\":var t=\"\";for(var a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return r.type==\"base64\"?w(t):r.type==\"string\"?lt(t):t;case\"file\":return Qe(r.file,e);case\"buffer\":return e;default:throw new Error(\"Unrecognized type \"+r.type);}}function pw(e,r){l();Zp(e);var t=br(r||{});if(t.cellStyles){t.cellNF=true;t.sheetStubs=true}if(t.type==\"array\"){t.type=\"binary\";var a=pw(e,t);t.type=\"array\";return S(a)}return lw(e,t)}function gw(e,r){l();Zp(e);var t=br(r||{});if(t.cellStyles){t.cellNF=true;t.sheetStubs=true}if(t.type==\"array\"){t.type=\"binary\";var a=gw(e,t);t.type=\"array\";return S(a)}var n=0;if(t.sheet){if(typeof t.sheet==\"number\")n=t.sheet;else n=e.SheetNames.indexOf(t.sheet);if(!e.SheetNames[n])throw new Error(\"Sheet not found: \"+t.sheet+\" : \"+typeof t.sheet)}switch(t.bookType||\"xlsb\"){case\"xml\":;case\"xlml\":return uw(nm(e,t),t);case\"slk\":;case\"sylk\":return uw(Eo.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"htm\":;case\"html\":return uw(Vm(e.Sheets[e.SheetNames[n]],t),t);case\"txt\":return dw(Sw(e.Sheets[e.SheetNames[n]],t),t);case\"csv\":return uw(yw(e.Sheets[e.SheetNames[n]],t),t,\"\\ufeff\");case\"dif\":return uw(Co.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"dbf\":return vw(Ao.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"prn\":return uw(So.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"rtf\":return uw(gl.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"eth\":return uw(yo.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case\"fods\":return uw(tb(e,t),t);case\"wk1\":return vw(xo.sheet_to_wk1(e.Sheets[e.SheetNames[n]],t),t);case\"wk3\":return vw(xo.book_to_wk3(e,t),t);case\"biff2\":if(!t.biff)t.biff=2;case\"biff3\":if(!t.biff)t.biff=3;case\"biff4\":if(!t.biff)t.biff=4;return vw(Lm(e,t),t);case\"biff5\":if(!t.biff)t.biff=5;case\"biff8\":;case\"xla\":;case\"xls\":if(!t.biff)t.biff=8;return hw(e,t);case\"xlsx\":;case\"xlsm\":;case\"xlam\":;case\"xlsb\":;case\"numbers\":;case\"ods\":return ow(e,t);default:throw new Error(\"Unrecognized bookType |\"+t.bookType+\"|\");}}function mw(e){if(e.bookType)return;var r={xls:\"biff8\",htm:\"html\",slk:\"sylk\",socialcalc:\"eth\",Sh33tJS:\"WTF\"};var t=e.file.slice(e.file.lastIndexOf(\".\")).toLowerCase();if(t.match(/^\\.[a-z]+$/))e.bookType=t.slice(1);e.bookType=r[e.bookType]||e.bookType}function bw(e,r,t){var a=t||{};a.type=\"file\";a.file=r;mw(a);return gw(e,a)}function ww(e,r,t){var a=t||{};a.type=\"file\";a.file=r;mw(a);return pw(e,a)}function kw(e,r,t,a){var n=t||{};n.type=\"file\";n.file=e;mw(n);n.type=\"buffer\";var i=a;if(!(i instanceof Function))i=t;return Je.writeFile(e,gw(r,n),i)}function Tw(e,r,t,a,n,i,s,f){var o=Ta(t);var l=f.defval,c=f.raw||!Object.prototype.hasOwnProperty.call(f,\"raw\");var h=true;var u=n===1?[]:{};if(n!==1){if(Object.defineProperty)try{Object.defineProperty(u,\"__rowNum__\",{value:t,enumerable:false})}catch(d){u.__rowNum__=t}else u.__rowNum__=t}if(!s||e[t])for(var v=r.s.c;v<=r.e.c;++v){var p=s?e[t][v]:e[a[v]+o];if(p===undefined||p.t===undefined){if(l===undefined)continue;if(i[v]!=null){u[i[v]]=l}continue}var g=p.v;switch(p.t){case\"z\":if(g==null)break;continue;case\"e\":g=g==0?null:void 0;break;case\"s\":;case\"d\":;case\"b\":;case\"n\":break;default:throw new Error(\"unrecognized type \"+p.t);}if(i[v]!=null){if(g==null){if(p.t==\"e\"&&g===null)u[i[v]]=null;else if(l!==undefined)u[i[v]]=l;else if(c&&g===null)u[i[v]]=null;else continue}else{u[i[v]]=c&&(p.t!==\"n\"||p.t===\"n\"&&f.rawNumbers!==false)?g:Pa(p,g,f)}if(g!=null)h=false}}return{row:u,isempty:h}}function Aw(e,r){if(e==null||e[\"!ref\"]==null)return[];var t={t:\"n\",v:0},a=0,n=1,i=[],s=0,f=\"\";var o={s:{r:0,c:0},e:{r:0,c:0}};var l=r||{};var c=l.range!=null?l.range:e[\"!ref\"];if(l.header===1)a=1;else if(l.header===\"A\")a=2;else if(Array.isArray(l.header))a=3;else if(l.header==null)a=0;switch(typeof c){case\"string\":o=Da(c);break;case\"number\":o=Da(e[\"!ref\"]);o.s.r=c;break;default:o=c;}if(a>0)n=0;var h=Ta(o.s.r);var u=[];var d=[];var v=0,p=0;var g=Array.isArray(e);var m=o.s.r,b=0;var w={};if(g&&!e[m])e[m]=[];var k=l.skipHidden&&e[\"!cols\"]||[];var T=l.skipHidden&&e[\"!rows\"]||[];for(b=o.s.c;b<=o.e.c;++b){if((k[b]||{}).hidden)continue;u[b]=ya(b);t=g?e[m][b]:e[u[b]+h];switch(a){case 1:i[b]=b-o.s.c;break;case 2:i[b]=u[b];break;case 3:i[b]=l.header[b-o.s.c];break;default:if(t==null)t={w:\"__EMPTY\",t:\"s\"};f=s=Pa(t,null,l);p=w[s]||0;if(!p)w[s]=1;else{do{f=s+\"_\"+p++}while(w[f]);w[s]=p;w[f]=1}i[b]=f;}}for(m=o.s.r+n;m<=o.e.r;++m){if((T[m]||{}).hidden)continue;var A=Tw(e,o,m,u,a,i,g,l);if(A.isempty===false||(a===1?l.blankrows!==false:!!l.blankrows))d[v++]=A.row}d.length=v;return d}var Ew=/\"/g;function Cw(e,r,t,a,n,i,s,f){var o=true;var l=[],c=\"\",h=Ta(t);for(var u=r.s.c;u<=r.e.c;++u){if(!a[u])continue;var d=f.dense?(e[t]||[])[u]:e[a[u]+h];if(d==null)c=\"\";else if(d.v!=null){o=false;c=\"\"+(f.rawNumbers&&d.t==\"n\"?d.v:Pa(d,null,f));for(var v=0,p=0;v!==c.length;++v)if((p=c.charCodeAt(v))===n||p===i||p===34||f.forceQuotes){c='\"'+c.replace(Ew,'\"\"')+'\"';break}if(c==\"ID\")c='\"ID\"'}else if(d.f!=null&&!d.F){o=false;c=\"=\"+d.f;if(c.indexOf(\",\")>=0)c='\"'+c.replace(Ew,'\"\"')+'\"'}else c=\"\";l.push(c)}if(f.blankrows===false&&o)return null;return l.join(s)}function yw(e,r){var t=[];var a=r==null?{}:r;if(e==null||e[\"!ref\"]==null)return\"\";var n=Da(e[\"!ref\"]);var i=a.FS!==undefined?a.FS:\",\",s=i.charCodeAt(0);var f=a.RS!==undefined?a.RS:\"\\n\",o=f.charCodeAt(0);var l=new RegExp((i==\"|\"?\"\\\\|\":i)+\"+$\");var c=\"\",h=[];a.dense=Array.isArray(e);var u=a.skipHidden&&e[\"!cols\"]||[];var d=a.skipHidden&&e[\"!rows\"]||[];for(var v=n.s.c;v<=n.e.c;++v)if(!(u[v]||{}).hidden)h[v]=ya(v);var p=0;for(var g=n.s.r;g<=n.e.r;++g){if((d[g]||{}).hidden)continue;c=Cw(e,n,g,h,s,o,i,a);if(c==null){continue}if(a.strip)c=c.replace(l,\"\");if(c||a.blankrows!==false)t.push((p++?f:\"\")+c)}delete a.dense;return t.join(\"\")}function Sw(e,r){if(!r)r={};r.FS=\"\\t\";r.RS=\"\\n\";var t=yw(e,r);if(typeof a==\"undefined\"||r.type==\"string\")return t;var n=a.utils.encode(1200,t,\"str\");return String.fromCharCode(255)+String.fromCharCode(254)+n}function _w(e){var r=\"\",t,a=\"\";if(e==null||e[\"!ref\"]==null)return[];var n=Da(e[\"!ref\"]),i=\"\",s=[],f;\nvar o=[];var l=Array.isArray(e);for(f=n.s.c;f<=n.e.c;++f)s[f]=ya(f);for(var c=n.s.r;c<=n.e.r;++c){i=Ta(c);for(f=n.s.c;f<=n.e.c;++f){r=s[f]+i;t=l?(e[c]||[])[f]:e[r];a=\"\";if(t===undefined)continue;else if(t.F!=null){r=t.F;if(!t.f)continue;a=t.f;if(r.indexOf(\":\")==-1)r=r+\":\"+r}if(t.f!=null)a=t.f;else if(t.t==\"z\")continue;else if(t.t==\"n\"&&t.v!=null)a=\"\"+t.v;else if(t.t==\"b\")a=t.v?\"TRUE\":\"FALSE\";else if(t.w!==undefined)a=\"'\"+t.w;else if(t.v===undefined)continue;else if(t.t==\"s\")a=\"'\"+t.v;else a=\"\"+t.v;o[o.length]=r+\"=\"+a}}return o}function xw(e,r,t){var a=t||{};var n=+!a.skipHeader;var i=e||{};var s=0,f=0;if(i&&a.origin!=null){if(typeof a.origin==\"number\")s=a.origin;else{var o=typeof a.origin==\"string\"?Oa(a.origin):a.origin;s=o.r;f=o.c}}var l;var c={s:{c:0,r:0},e:{c:f,r:s+r.length-1+n}};if(i[\"!ref\"]){var h=Da(i[\"!ref\"]);c.e.c=Math.max(c.e.c,h.e.c);c.e.r=Math.max(c.e.r,h.e.r);if(s==-1){s=h.e.r+1;c.e.r=s+r.length-1+n}}else{if(s==-1){s=0;c.e.r=r.length-1+n}}var u=a.header||[],d=0;r.forEach(function(e,r){rr(e).forEach(function(t){if((d=u.indexOf(t))==-1)u[d=u.length]=t;var o=e[t];var c=\"z\";var h=\"\";var v=Ra({c:f+d,r:s+r+n});l=Rw(i,v);if(o&&typeof o===\"object\"&&!(o instanceof Date)){i[v]=o}else{if(typeof o==\"number\")c=\"n\";else if(typeof o==\"boolean\")c=\"b\";else if(typeof o==\"string\")c=\"s\";else if(o instanceof Date){c=\"d\";if(!a.cellDates){c=\"n\";o=fr(o)}h=a.dateNF||X[14]}else if(o===null&&a.nullError){c=\"e\";o=0}if(!l)i[v]=l={t:c,v:o};else{l.t=c;l.v=o;delete l.w;delete l.R;if(h)l.z=h}if(h)l.z=h}})});c.e.c=Math.max(c.e.c,f+u.length-1);var v=Ta(s);if(n)for(d=0;d<u.length;++d)i[ya(d+f)+v]={t:\"s\",v:u[d]};i[\"!ref\"]=Na(c);return i}function Ow(e,r){return xw(null,e,r)}function Rw(e,r,t){if(typeof r==\"string\"){if(Array.isArray(e)){var a=Oa(r);if(!e[a.r])e[a.r]=[];return e[a.r][a.c]||(e[a.r][a.c]={t:\"z\"})}return e[r]||(e[r]={t:\"z\"})}if(typeof r!=\"number\")return Rw(e,Ra(r));return Rw(e,Ra({r:r,c:t||0}))}function Iw(e,r){if(typeof r==\"number\"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error(\"Cannot find sheet # \"+r)}else if(typeof r==\"string\"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error(\"Cannot find sheet name |\"+r+\"|\")}else throw new Error(\"Cannot find sheet |\"+r+\"|\")}function Nw(){return{SheetNames:[],Sheets:{}}}function Dw(e,r,t,a){var n=1;if(!t)for(;n<=65535;++n,t=undefined)if(e.SheetNames.indexOf(t=\"Sheet\"+n)==-1)break;if(!t||e.SheetNames.length>=65535)throw new Error(\"Too many worksheets\");if(a&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||t;for(++n;n<=65535;++n)if(e.SheetNames.indexOf(t=s+n)==-1)break}Jp(t);if(e.SheetNames.indexOf(t)>=0)throw new Error(\"Worksheet with name |\"+t+\"| already exists!\");e.SheetNames.push(t);e.Sheets[t]=r;return t}function Fw(e,r,t){if(!e.Workbook)e.Workbook={};if(!e.Workbook.Sheets)e.Workbook.Sheets=[];var a=Iw(e,r);if(!e.Workbook.Sheets[a])e.Workbook.Sheets[a]={};switch(t){case 0:;case 1:;case 2:break;default:throw new Error(\"Bad sheet visibility setting \"+t);}e.Workbook.Sheets[a].Hidden=t}function Pw(e,r){e.z=r;return e}function Lw(e,r,t){if(!r){delete e.l}else{e.l={Target:r};if(t)e.l.Tooltip=t}return e}function Mw(e,r,t){return Lw(e,\"#\"+r,t)}function Uw(e,r,t){if(!e.c)e.c=[];e.c.push({t:r,a:t||\"SheetJS\"})}function Bw(e,r,t,a){var n=typeof r!=\"string\"?r:Da(r);var i=typeof r==\"string\"?r:Na(r);for(var s=n.s.r;s<=n.e.r;++s)for(var f=n.s.c;f<=n.e.c;++f){var o=Rw(e,s,f);o.t=\"n\";o.F=i;delete o.v;if(s==n.s.r&&f==n.s.c){o.f=t;if(a)o.D=true}}return e}var Ww={encode_col:ya,encode_row:Ta,encode_cell:Ra,encode_range:Na,decode_col:Ca,decode_row:ka,split_cell:xa,decode_cell:Oa,decode_range:Ia,format_cell:Pa,sheet_add_aoa:Ma,sheet_add_json:xw,sheet_add_dom:Gm,aoa_to_sheet:Ua,json_to_sheet:Ow,table_to_sheet:jm,table_to_book:Xm,sheet_to_csv:yw,sheet_to_txt:Sw,sheet_to_json:Aw,sheet_to_html:Vm,sheet_to_formulae:_w,sheet_to_row_object_array:Aw,sheet_get_cell:Rw,book_new:Nw,book_append_sheet:Dw,book_set_sheet_visibility:Fw,cell_set_number_format:Pw,cell_set_hyperlink:Lw,cell_set_internal_link:Mw,cell_add_comment:Uw,sheet_set_array_formula:Bw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var Hw;function zw(e){Hw=e}function Vw(e,r){var t=Hw();var a=r==null?{}:r;if(e==null||e[\"!ref\"]==null){t.push(null);return t}var n=Da(e[\"!ref\"]);var i=a.FS!==undefined?a.FS:\",\",s=i.charCodeAt(0);var f=a.RS!==undefined?a.RS:\"\\n\",o=f.charCodeAt(0);var l=new RegExp((i==\"|\"?\"\\\\|\":i)+\"+$\");var c=\"\",h=[];a.dense=Array.isArray(e);var u=a.skipHidden&&e[\"!cols\"]||[];var d=a.skipHidden&&e[\"!rows\"]||[];for(var v=n.s.c;v<=n.e.c;++v)if(!(u[v]||{}).hidden)h[v]=ya(v);var p=n.s.r;var g=false,m=0;t._read=function(){if(!g){g=true;return t.push(\"\\ufeff\")}while(p<=n.e.r){++p;if((d[p-1]||{}).hidden)continue;c=Cw(e,n,p-1,h,s,o,i,a);if(c!=null){if(a.strip)c=c.replace(l,\"\");if(c||a.blankrows!==false)return t.push((m++?f:\"\")+c)}}return t.push(null)};return t}function Gw(e,r){var t=Hw();var a=r||{};var n=a.header!=null?a.header:Bm;var i=a.footer!=null?a.footer:Wm;t.push(n);var s=Ia(e[\"!ref\"]);a.dense=Array.isArray(e);t.push(zm(e,s,a));var f=s.s.r;var o=false;t._read=function(){if(f>s.e.r){if(!o){o=true;t.push(\"</table>\"+i)}return t.push(null)}while(f<=s.e.r){t.push(Um(e,s,f,a));++f;break}};return t}function jw(e,r){var t=Hw({objectMode:true});if(e==null||e[\"!ref\"]==null){t.push(null);return t}var a={t:\"n\",v:0},n=0,i=1,s=[],f=0,o=\"\";var l={s:{r:0,c:0},e:{r:0,c:0}};var c=r||{};var h=c.range!=null?c.range:e[\"!ref\"];if(c.header===1)n=1;else if(c.header===\"A\")n=2;else if(Array.isArray(c.header))n=3;switch(typeof h){case\"string\":l=Da(h);break;case\"number\":l=Da(e[\"!ref\"]);l.s.r=h;break;default:l=h;}if(n>0)i=0;var u=Ta(l.s.r);var d=[];var v=0;var p=Array.isArray(e);var g=l.s.r,m=0;var b={};if(p&&!e[g])e[g]=[];var w=c.skipHidden&&e[\"!cols\"]||[];var k=c.skipHidden&&e[\"!rows\"]||[];for(m=l.s.c;m<=l.e.c;++m){if((w[m]||{}).hidden)continue;d[m]=ya(m);a=p?e[g][m]:e[d[m]+u];switch(n){case 1:s[m]=m-l.s.c;break;case 2:s[m]=d[m];break;case 3:s[m]=c.header[m-l.s.c];break;default:if(a==null)a={w:\"__EMPTY\",t:\"s\"};o=f=Pa(a,null,c);v=b[f]||0;if(!v)b[f]=1;else{do{o=f+\"_\"+v++}while(b[o]);b[f]=v;b[o]=1}s[m]=o;}}g=l.s.r+i;t._read=function(){while(g<=l.e.r){if((k[g-1]||{}).hidden)continue;var r=Tw(e,l,g,d,n,s,p,c);++g;if(r.isempty===false||(n===1?c.blankrows!==false:!!c.blankrows)){t.push(r.row);return}}return t.push(null)};return t}var Xw={to_json:jw,to_html:Gw,to_csv:Vw,set_readable:zw};if(typeof vm!==\"undefined\")e.parse_xlscfb=vm;e.parse_zip=Xb;e.read=iw;e.readFile=sw;e.readFileSync=sw;e.write=gw;e.writeFile=bw;e.writeFileSync=bw;e.writeFileAsync=kw;e.utils=Ww;e.writeXLSX=pw;e.writeFileXLSX=ww;e.SSF=Ve;if(typeof Xw!==\"undefined\")e.stream=Xw;if(typeof Ke!==\"undefined\")e.CFB=Ke;if(typeof require!==\"undefined\"){var $w=undefined;if(($w||{}).Readable)zw($w.Readable)}}if(typeof exports!==\"undefined\")make_xlsx_lib(exports);else if(typeof module!==\"undefined\"&&module.exports)make_xlsx_lib(module.exports);else if(typeof define===\"function\"&&define.amd)define(\"xlsx\",function(){if(!XLSX.version)make_xlsx_lib(XLSX);return XLSX});else make_xlsx_lib(XLSX);if(typeof window!==\"undefined\"&&!window.XLSX)try{window.XLSX=XLSX}catch(e){}",
		"MANAGED_RECIPE/thirdparty/jszip-wrapper.js": "sap.ui.define([   //Added by srikanth\r\n    \"PRDH/thirdparty/jszip.min\"\r\n], function () {\r\n    \"use strict\";\r\n    return window.JSZip;   \r\n});",
		"MANAGED_RECIPE/Component.js": "sap.ui.define([\n\t\"sap/ui/core/UIComponent\",\n\t\"sap/ui/Device\",\n\t\"MANAGED_RECIPE/model/models\"\n], function(UIComponent, Device, models) {\n\t\"use strict\";\n\n\treturn UIComponent.extend(\"MANAGED_RECIPE.Component\", {\n\n\t\tmetadata: {\n\t\t\tmanifest: \"json\"\n\t\t},\n\n\t\t/**\n\t\t * The component is initialized by UI5 automatically during the startup of the app and calls the init method once.\n\t\t * @public\n\t\t * @override\n\t\t */\n\t\tinit: function() {\n\t\t\t// call the base component's init function\n\t\t\tUIComponent.prototype.init.apply(this, arguments);\n\n\t\t\tthis.getRouter().initialize();\n\t\t\t\n\t\t\tjQuery.sap.includeScript(\n                jQuery.sap.getModulePath(\"MANAGED_RECIPE\") + \"/thirdparty/xlsx.full.min.js\"\n            );\n\t\t\t\n\t\t\t// set the device model\n\t\t\tthis.setModel(models.createDeviceModel(), \"device\");\n\t\t}\n\t});\n});",
		"MANAGED_RECIPE/Formatter/formatter.js": "jQuery.sap.declare(\"MANAGED_RECIPE.Formatter.formatter\");\n\nMANAGED_RECIPE.Formatter.formatter = {\n\t\t\n\t// *-------------------------------------\n\t//\t\tDashboard Formater\n\t// *------------------------------------\n\tfnDateFormater: function(sDate) {\n\t\tif (!sDate) {\n\t\t\treturn \"\";\n\t\t}\n\t\t// Ensure it's a valid Date object\n\t\tvar oDate = new Date(sDate);\n\t\t// Handle invalid or timezone-shifted dates\n\t\tif (isNaN(oDate.getTime())) {\n\t\t\treturn sDate; // fallback\n\t\t}\n\t\tvar oDateFormat = sap.ui.core.format.DateFormat.getDateTimeInstance({\n\t\t\tpattern: \"dd.MM.yyyy\",\n\t\t\tUTC: true // prevent timezone offset\n\t\t});\n\t\treturn oDateFormat.format(oDate);\n\t},\n\t\n\tformatLevelText: function(sLevel) {\n\t\tif (!sLevel) {\n\t\t\treturn \"\";\n\t\t}\n\t\t// Check if value starts with \"L\" followed by a number\n\t\tif (sLevel.startsWith(\"L\")) {\n\t\t\treturn \"Level \" + sLevel.substring(1);\n\t\t}\n\n\t\t// Fallback if not in expected format\n\t\treturn sLevel;\n\t},\n\n\tfnGetSateForOperaTbl: function(sVornr, oEditableModelData, sField) {\n\t\ttry {\n\t\t\tvar oEditableModel = this.getView().getModel(\"JM_EditableModel\");\n\t\t\tif (!oEditableModel) return \"nonEdit\";\n\n\t\t\tvar sPath = \"/\" + sVornr + \"/\" + sField;\n\t\t\tvar sValue = oEditableModel.getProperty(sPath);\n\n\t\t\t// Return \"Edit\" or \"NonEdit\" based on the value\n\t\t\tif (sValue === \"Edit\" || sValue === \"nonEdit\" || sValue === \"Error\") {\n\t\t\t\treturn sValue;\n\t\t\t}\n\t\t\treturn \"NonEdit\"; // default fallback\n\t\t} catch (e) {}\n\t},\n\tfnEditableState: function(sVornr, oEditableModelData, sField) {\n\t\ttry {\n\t\t\tvar oEditableModel = this.getView().getModel(\"JM_EditableModel\");\n\t\t\tif (!oEditableModel) return \"nonEdit\";\n\n\t\t\tvar sPath = \"/\" + sVornr + \"/\" + sField;\n\t\t\tvar sValue = oEditableModel.getProperty(sPath);\n\n\t\t\tvar state = (sValue === \"Edit\" || sValue === \"Error\" || sValue === \"nonError\") ? true : false;\n\t\t\treturn state;\n\n\t\t} catch (e) {}\n\t},\n\n\tfnZerosValue: function(value) {\n\t\tif (parseFloat(value) === 0) {\n\t\t\treturn \"\"; // return empty string for 0 values\n\t\t} else {\n\t\t\treturn value; // else return original value\n\t\t}\n\t},\n\tfnDBformatODataTime: function(oTime) {\n\t\tif (!oTime || typeof oTime.ms !== \"number\") return \"\";\n\n\t\tvar oDate = new Date(null);\n\t\toDate.setMilliseconds(oTime.ms);\n\n\t\tvar oFormat = sap.ui.core.format.DateFormat.getTimeInstance({\n\t\t\tpattern: \"HH:mm:ss\"\n\t\t});\n\t\treturn oFormat.format(oDate);\n\t},\n\tfnDBgetStatusIcon: function(sStatus) {\n\n\t\tif (sStatus === \"Completed\" || sStatus === \"Complete\") {\n\t\t\treturn \"Image/CompletedStatus.svg\";\n\t\t} else if (sStatus === \"Requested / Inprogress\") { //|| sStatus === \"00\" || sStatus === \"\" || sStatus === \"01\" || sStatus === \"04\") { \n\t\t\t// return \"Image/InprogressStatus.svg\"; \n\t\t\treturn \"Image/Drafted.svg\";\n\t\t} else if (sStatus === \"Saved as draft\") {\n\t\t\treturn \"Image/SaveAsDraft.svg\";\n\t\t} else if (sStatus === \"Rejected\" || sStatus === \"Reject\") {\n\t\t\treturn \"Image/RejectStatus.svg\";\n\t\t} else if (sStatus === \"Sendback\") {\n\t\t\treturn \"Image/sendbackTable.svg\";\n\t\t}\n\t},\n\tfnDBgetLevelStatusIcon: function(sStatus) {\n\n\t\tif (sStatus === \"Completed\" || sStatus === \"Complete\") {\n\t\t\treturn \"Image/CompletedDot.svg\";\n\t\t} else if (sStatus === \"Requested / Inprogress\") {\n\t\t\treturn \"Image/InprogressDot.svg\";\n\t\t} else if (sStatus === \"Saved as draft\") {\n\t\t\treturn \"Image/draftDot.svg\";\n\t\t} else if (sStatus === \"Rejected\" || sStatus === \"Reject\") {\n\t\t\treturn \"Image/RejectedDot.svg\";\n\t\t} else if (sStatus === \"Sendback\") {\n\t\t\treturn \"Image/senbackDot.svg\";\n\t\t} else if (sStatus === \"Initiated\") {\n\t\t\treturn \"Image/InitiatedDot.svg\";\n\t\t}\n\t},\n\tgetStatusClass: function(status) {\n\t\tswitch (status) {\n\t\t\tcase \"Completed\":\n\t\t\t\treturn \"cl_CompletedStatus\";\n\t\t\tcase \"Requested / Inprogress\":\n\t\t\t\treturn \"cl_statusInprogress\";\n\t\t\tcase \"Rejected\":\n\t\t\t\treturn \"cl_Rejectstatus\";\n\t\t\tcase \"Complete\":\n\t\t\t\treturn \"cl_CompletedStatus\";\n\t\t\tcase \"Saved as draft\":\n\t\t\t\treturn \"cl_draftstatus\";\n\t\t\tcase \"Reject\":\n\t\t\t\treturn \"cl_Rejectstatus\";\n\t\t\tcase \"Sendback\":\n\t\t\t\treturn \"cl_sendBack\";\n\t\t\tcase \"Initiated\":\n\t\t\t\treturn \"cl_initiated\";\n\t\t\tdefault:\n\t\t\t\treturn \"statusDefault\";\n\t\t}\n\t},\n\tgetRowHighlightClass: function(status) {\n\t\tswitch (status) {\n\t\t\tcase \"Completed\":\n\t\t\t\treturn \"rowGreen\";\n\t\t\tcase \"Requested / Inprogress\":\n\t\t\t\treturn \"rowRed\";\n\t\t\tcase \"Pending\":\n\t\t\t\treturn \"rowOrange\";\n\t\t\tdefault:\n\t\t\t\treturn \"rowDefault\";\n\t\t}\n\t},\n\tfnremoveLeadingZeros: function(value) {\n\t\tif (!value) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn value.toString().replace(/^0+/, '');\n\t},\n\tformatStatusValue: function(sDdtext) {\n\t\t// Show only the description (Ddtext) in the ComboBox input\n\t\treturn sDdtext || \"\";\n\t},\n\n\tisRXVisible: function() {\n\t\treturn this.AppId === \"RX\";\n\t}.bind(this),\n\n\tfnConverStatusToIcon: function (sStatus) {\n    var sBasePath = this.getView()\n        .getModel(\"JM_ImageModel\")\n        .getProperty(\"/path\");\n\n    if (sStatus === \"C\") {\n        return sBasePath + \"NodesGrn.svg\";\n    }\n\n    if (sStatus === \"I\" || sStatus === \"D\" || sStatus === \"S\" || sStatus === \"01\" || sStatus === \"04\") {\n        return sBasePath + \"NodesOrg.svg\";\n    }\n\n    if (sStatus === \"R\" || sStatus === \"6\") {\n        return sBasePath + \"NodesRed.svg\";\n    }\n\n    return \"\";\n},\n\t\n\tfnConverStatustoTooltip:function(sStatus){\n\t\tif (sStatus === \"I\" ) {\n\t\t\treturn \"In-progress\";\n\t\t}else if (sStatus === \"D\" ) {\n\t\t\treturn \"Draft\";\n\t\t}else if (sStatus === \"S\" ) {\n\t\t\treturn \"Send Back\";\n\t\t}else if (sStatus === \"C\" ) {\n\t\t\treturn \"Completed\";\n\t\t}else if (sStatus === \"R\" ) {\n\t\t\treturn \"Rejected\";\n\t\t}\n\t},\n\tfnRemoveLeaddingZeros: function(value) {\n\t\tif (!value) return \"\";\n\t\treturn value.replace(/^0+/, \"\");\n\t}\n\n};",
		"MANAGED_RECIPE/view/reci_initiator.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\"\n\tcontrollerName=\"MANAGED_RECIPE.controller.reci_initiator\" xmlns:html=\"http://www.w3.org/1999/xhtml\">\n\t<App>\n\t\t<pages>\n\t\t\t<Page showHeader=\"true\" title=\"Application\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"false\">\n\t\t\t\t<customHeader>\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'NavBack.svg'}\" tooltip=\"{i18n>navBack}\" width=\"1.5rem\" press=\"fnNavBack\"\n\t\t\t\t\t\t\tclass=\"cl_pv_removeImgFocus sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Title id=\"id_title\" text=\"{i18n>title}\" class=\"cl_header_title\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<!--added by srikanth-->\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Agent} - {JM_UserModel>/0/Uname}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</customHeader>\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\n\t\t\t\t<content>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<HBox id=\"id_roadmap\" class=\"cl_init_roadmap sapUiSmallMarginBeginEnd sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'SearchR.svg'}\" tooltip=\"{i18n>Search}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label id=\"id_roadMap_search\" text=\"{i18n>Search}\" visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_textStyle_roadMap\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_Vline_roadMap\"></HBox>\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'KeyData.svg'}\" tooltip=\"{i18n>Keydata}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label id=\"id_roadMap_keydata\" text=\"{i18n>Keydata}\" visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_textStyle_roadMap\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_Vline_roadMap\"></HBox>\n\t\t\t\t\t\t\t<VBox id=\"id_initiator\" width=\"20%\"></VBox>\n\t\t\t\t\t\t\t<HBox visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_Vline_roadMap\"></HBox>\n\t\t\t\t\t\t\t<VBox id=\"id_reviewer\" width=\"20%\"></VBox>\n\t\t\t\t\t\t\t<HBox visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_Vline_roadMap\"></HBox>\n\t\t\t\t\t\t\t<VBox id=\"id_approver\" width=\"20%\"></VBox>\n\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBegin cl_init_scrollStyle\">\n\t\t\t\t\t\t\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\" class=\"sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RecipeHeader}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Material}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeydataModel>/Matnr}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialDesc}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeydataModel>/Maktx}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_KeydataModel>/Werks}\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeydataModel>/Plnnr}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/ReciDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GroupCounter}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" value=\"{JM_KeydataModel>/Plnal}\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<OverflowToolbar class=\"cl_init_toolbar\">\n\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>Operations}\" class=\"cl_primaryButton sapUiTinyMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Operations.svg'}\"\n\t\t\t\t\t\t\t\t\t\tpress=\"fnNavOperation\" width=\"7rem\"/>\n\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>Material}\" class=\"cl_primaryButton\" press=\"fnNavProductionVersion\" icon=\"{= ${JM_ImageModel>/path} + 'Materials.svg'}\"\n\t\t\t\t\t\t\t\t\t\twidth=\"6rem\"/>\n\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>CollapseAll}\" id=\"id_ExpandCollapse\" class=\"cl_primaryButton sapUiTinyMarginEnd\" press=\"fnCollpaseExpandAll\"/>\n\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox id=\"ID_RECI_ASSIGN_HEADER\" class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Assignment}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_RECI_ASSIGN\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\"></Image>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" id=\"ID_RECI_ASSIGN_GRID\">\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Status}\" id=\"ID_RECI_STATU_TXT\" required=\"true\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Statu}\" showValueHelp=\"true\" valueHelpRequest=\"fnNewF4press\" liveChange=\"fnLiveChange\" id=\"ID_RECI_STATU\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" maxLength=\"3\" editable=\"{= !${JM_ContextModel>/Ind} || ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"ID_RECI_STATU_DES\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Usage}\" id=\"ID_RECI_VERWE_TXT\" required=\"true\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"23%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Verwe}\" id=\"ID_RECI_VERWE\" valueHelpRequest=\"fnNewF4press\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" maxLength=\"3\" editable=\"{= !${JM_ContextModel>/Ind} || ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"77%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_VERWE_DES\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\" maxLength=\"3\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PlannerGroup}\" id=\"ID_RECI_VAGRP_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Vagrp}\" id=\"ID_RECI_VAGRP\" valueHelpRequest=\"fnNewF4press\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" maxLength=\"3\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"ID_RECI_VAGRP_DES\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ResourceNetwork}\" id=\"ID_RECI_NNAME_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Nname}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" id=\"ID_RECI_NNAME\" valueHelpRequest=\"fnNewF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" class=\"cl_inputField\" showValueHelp=\"true\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" id=\"ID_RECI_CQR_HEADER\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChargeQuantityRange}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_RECI_CQR\" width=\"16px\" tooltip=\"collapse\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\"></Image>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid id=\"ID_RECI_CQR_GRID\" class=\"cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>From}\" id=\"ID_RECI_LOSVN_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_LOSVN\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" value=\"{JM_InitiatorModel>/Losvn}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnQuanDataElementValidation\" type=\"Number\" class=\"cl_inputField\" maxLength=\"13\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>To}\" id=\"ID_RECI_LOSBS_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_LOSBS\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" value=\"{JM_InitiatorModel>/Losbs}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnQuanDataElementValidation\" type=\"Number\" class=\"cl_inputField\" maxLength=\"13\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>TaskListUnit}\" id=\"ID_RECI_PLNME_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"25%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Plnme}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" id=\"ID_RECI_PLNME\" valueHelpRequest=\"fnNewF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" showValueHelp=\"true\" class=\"cl_inputField\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"75%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" class=\"cl_inputDescField\" id=\"ID_RECI_PLNME_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" id=\"ID_RECI_DEFAULT_HEADER\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>defaultValuesOpPhasesSecRes}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_RECI_DEFAULT\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\"></Image>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid id=\"ID_RECI_DEFAULT_GRID\" class=\"cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BaseQuantity}\" id=\"ID_RECI_BMSCH_TXT\" required=\"true\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_BMSCH\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" value=\"{JM_InitiatorModel>/Bmsch}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnQuanDataElementValidation\" type=\"Number\" class=\"cl_inputField\" maxLength=\"13\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OpUnit}\" id=\"ID_RECI_MEINH_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"25%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_InitiatorModel>/Meinh}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" showValueHelp=\"true\" id=\"ID_RECI_MEINH\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnNewF4press\" liveChange=\"fnLiveChange\" class=\"cl_inputField\" maxLength=\"2\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"75%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"ID_RECI_MEINH_DES\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<HBox justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"45%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChargeQuantity}\" id=\"ID_RECI_UMREZ_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_UMREZ\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" value=\"{JM_InitiatorModel>/Umrez}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnNumberFieldValidation\" type=\"Number\" class=\"cl_inputField\" maxLength=\"5\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"10%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Equalto}\" id=\"ID_RECI_UMREN_TXT\" class=\"sapUiMediumMarginTop sapUiTinyMarginBegin cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"45%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OperationQuantity}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_RECI_UMREN\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T'}\" value=\"{JM_InitiatorModel>/Umren}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnNumberFieldValidation\" type=\"Number\" class=\"cl_inputField\" maxLength=\"5\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L6 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginBottom sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" id=\"ID_RECI_CP_HEADER\" width=\"100%\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeParameter}\" class=\"sapUiSmallMargin cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_RECI_CP\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\"></Image>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid id=\"ID_RECI_CP_GRID\" class=\"cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeRule}\" id=\"ID_RECI_CHRULE_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Select id=\"ID_RECI_CHRULE\" class=\"cl_comboBox cl_combobox\" selectedKey=\"{JM_InitiatorModel>/Chrule}\" change=\"fnSelectedLivechange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\titems=\"{JM_ChangeRule>/}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"{JM_ChangeRule>key}\" text=\"{JM_ChangeRule>value}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.reci_attachment_comments\" type=\"XML\"/>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</VBox>\n\t\t\t\t</content>\n\t\t\t\t<footer>\n\t\t\t\t\t<OverflowToolbar>\n\t\t\t\t\t\t<Label text=\"{i18n>PageTips}\" class=\"cl_pageTip sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Pagetips.svg'}\" width=\"0.9rem\" class=\"sapUiTinyMarginBegin\" tooltip=\"Page Tip\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<Button text=\"{i18n>Changelog}\" width=\"7.5rem\" visible=\"{= (${JM_KeyData>/AppId} === 'RX') || (${JM_ContextModel>/Appid} === 'RX') }\"\n\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"Continue\" press=\"fnChangelog\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>Reject}\" visible=\"{JM_FooterBtnModel>/Reject}\" width=\"5.5rem\" icon=\"{= ${JM_ImageModel>/path} + 'RejectW.svg'}\"\n\t\t\t\t\t\t\tclass=\"cl_primaryButton sapUiSmallMarginEnd\" tooltip=\"Continue\" press=\"fnReject\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>Sendback}\" visible=\"{JM_FooterBtnModel>/sendBack}\" width=\"7rem\" icon=\"{= ${JM_ImageModel>/path} + 'SendbackW.svg'}\"\n\t\t\t\t\t\t\tclass=\"cl_primaryButton sapUiSmallMarginEnd\" tooltip=\"Continue\" press=\"fnSendBackDialog\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>SaveasDraft}\" visible=\"{JM_FooterBtnModel>/Draft}\" id=\"id_saveDraft\" width=\"7.8rem\"\n\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"Continue\" press=\"fnDraft\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>CheckDuplicate}\" visible=\"{JM_FooterBtnModel>/CheckDup}\" width=\"9rem\" icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\"\n\t\t\t\t\t\t\tclass=\"cl_primaryButton sapUiTinyMarginEnd\" tooltip=\"Continue\" press=\"fnCheckDuplicate\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>Submit}\" id=\"id_submit\" width=\"5.5rem\" visible=\"{JM_FooterBtnModel>/submit}\"\n\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Submit.svg'}\" class=\"cl_primaryButton cl_submitIconWidth sapUiSmallMarginEnd\" tooltip=\"Continue\"\n\t\t\t\t\t\t\tpress=\"fnsaveRecipe\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</footer>\n\t\t\t</Page>\n\t\t</pages>\n\t</App>\n</mvc:View>",
		"MANAGED_RECIPE/view/App.view.xml": "<mvc:View controllerName=\"MANAGED_RECIPE.controller.App\" xmlns:html=\"http://www.w3.org/1999/xhtml\" xmlns:mvc=\"sap.ui.core.mvc\"\n\tdisplayBlock=\"true\" xmlns=\"sap.m\">\n\t<App id= \"id_app\">\n\t\t<pages>\n\t\t\t<Page title=\"{i18n>title}\">\n\t\t\t\t<content></content>\n\t\t\t</Page>\n\t\t</pages>\n\t</App>\n</mvc:View>",
		"MANAGED_RECIPE/view/pv_detail.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" controllerName=\"MANAGED_RECIPE.controller.pv_detail\"\r\n\txmlns:html=\"http://www.w3.org/1999/xhtml\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page showHeader=\"true\" title=\"{i18n>ProductionVersion}\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"false\">\r\n\t\t\t\t<customHeader>\r\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\r\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'NavBack.svg'}\" alt=\"{i18n>NavBack}\" width=\"1.5rem\" press=\"fnNavBack\"\r\n\t\t\t\t\t\t\tclass=\"cl_pv_removeImgFocus sapUiSmallMarginBegin\"/>\r\n\t\t\t\t\t\t<Title id=\"id_title\" text=\"{i18n>PVCreation}\" class=\"cl_header_title\"/>\r\n\t\t\t\t\t\t<ToolbarSpacer/>\r\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Agent} - {JM_UserModel>/0/Uname}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\r\n\t\t\t\t\t</OverflowToolbar>\r\n\t\t\t\t</customHeader>\r\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBegin cl_pv_scrollStyle\">\r\n\t\t\t\t\t\t\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\" class=\"sapUiTinyMarginTop\">\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PVTitle}\" id=\"ID_PV_SUBHEADING\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_WERKS\" editable=\"false\" value=\"{JM_KeydataModel>/Werks}\" showValueHelp=\"true\" liveChange=\"fnLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialNumber}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_MATNR\" editable=\"false\" value=\"{JM_KeydataModel>/Matnr}\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Description}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_MAKTX\" editable=\"false\" value=\"{JM_KeydataModel>/Maktx}\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PVersion}\" tooltip=\"{i18n>ProducVersion}\" required=\"true\" class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_VERID\" value=\"{JM_ProductionModel>/Verid}\" type=\"Number\" showValueHelp=\"true\" liveChange=\"fnLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_KeydataModel>/AppId} !== 'RX' &amp;&amp; ${JM_ContextModel>/Ind} !== 'T' &amp;&amp; ${JM_ContextModel>/Level} !== 'R' &amp;&amp; ${JM_ContextModel>/Level} !== 'A' }\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>pvDesp}\" tooltip=\"{i18n>ProdVersDesp}\" required=\"true\" class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_TEXT1\" value=\"{JM_ProductionModel>/Text1}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" liveChange=\"fnLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"100%\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ProducVersion}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_MKSP_TXT\" text=\"{i18n>Lock}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ComboBox id=\"ID_PV_MKSP\" width=\"100%\" enabled=\"true\" class=\"cl_combobox\" selectedKey=\"{JM_ProductionModel>/Mksp}\" selectionChange=\"fnComboBoxLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"0\" text=\"{i18n>Notlocked}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"1\" text=\"{i18n>LockedUsage}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"2\" text=\"{i18n>LockedSourcing}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ComboBox>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_BSTMI_TXT\" text=\"{i18n>FromLot}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_BSTMI\" type=\"Number\" value=\"{JM_ProductionModel>/Bstmi}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_BSTMA_TXT\" text=\"{i18n>ToLot}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_BSTMA\" type=\"Number\" value=\"{JM_ProductionModel>/Bstma}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" class=\"cl_inputField\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_ADATU_TXT\" text=\"{i18n>ValidFrom}\" class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker id=\"ID_PV_ADATU\" value=\"{ path: 'JM_ProductionModel>/Adatu',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_ProductionModel>Adatu',formatter: '.formatter.fnDateFormater' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_KeydataModel>/AppId} !== 'RX' &amp;&amp; ${JM_ContextModel>/Ind} !== 'T' }\" change=\"fnDateLiveChange\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_BDATU_TXT\" text=\"{i18n>ValidTo}\" class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker id=\"ID_PV_BDATU\" value=\"{ path: 'JM_ProductionModel>/Bdatu',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" class=\"cl_inputField\" change=\"fnDateLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_KeydataModel>/AppId} !== 'RX' &amp;&amp; ${JM_ContextModel>/Ind} !== 'T' }\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PlantData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\r\n\t\t\t\t\t\t\t\t\t\t<HBox alignContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"38%\" justifyContent=\"Center\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>DetailedPlanning}\" class=\"cl_inputLabel sapUiSmallMarginTop sapUiSmallMarginEnd\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"62%\" class=\"sapUiSmallMarginBegin\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_PLNTY_TXT\" text=\"{i18n>TaskListType}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!--<Input id=\"ID_PV_PLNTY\" class=\"cl_inputField\"></Input>-->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ComboBox id=\"ID_PV_PLNTY\" editable=\"true\" enabled=\"false\" width=\"100%\" class=\"cl_combobox\" selectedKey=\"2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectionChange=\"fnComboBoxLiveChange\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"*\" text=\"{i18n>Wildcard}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"0\" text=\"{i18n>StandardNetwork}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"2\" text=\"{i18n>MasterRecipe}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"3\" text=\"{i18n>RoughCutPlanning}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"A\" text=\"{i18n>GeneralMaintTaskList}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"E\" text=\"{i18n>EquipmentTaskList}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"F\" text=\"{i18n>ReferenceTemplateRouting}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"M\" text=\"{i18n>ReferenceRateRouting}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"N\" text=\"{i18n>Routing}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"P\" text=\"{i18n>PlanningRouting}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"Q\" text=\"{i18n>InspectionPlan}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"R\" text=\"{i18n>RateRouting}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"S\" text=\"{i18n>ReferenceOperationSet}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"T\" text=\"{i18n>TaskListForFuncLoc}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"V\" text=\"{i18n>ShopFloorRouting}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</ComboBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L2 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_PLNNR_TXT\" text=\"{i18n>Group}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_PLNNR\" value=\"{JM_ProductionModel>/Plnnr}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" editable=\"false\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_ALNAL_TXT\" text=\"{i18n>GroupCounter}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_ALNAL\" value=\"{JM_ProductionModel>/Alnal}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" editable=\"false\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginTop\">\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"20%\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<HBox id=\"ID_PVIND\" class=\"cl_indicator\" visible=\"false\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_PVIND_BTN\" class=\"cl_Indicator\"></Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BOMData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_STLAL_TXT\" text=\"{i18n>AlternativeBOM}\" required=\"true\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_STLAL\" value=\"{JM_ProductionModel>/Stlal}\" class=\"cl_inputField\" type=\"Number\" showValueHelp=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_KeydataModel>/AppId} !== 'RX' &amp;&amp; ${JM_ContextModel>/Ind} !== 'T' &amp;&amp; ${JM_ContextModel>/Level} !== 'R' &amp;&amp; ${JM_ContextModel>/Level} !== 'A' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_STLAN_TXT\" text=\"{i18n>BOMUsage}\" required=\"true\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_STLAN\" value=\"{JM_ProductionModel>/Stlan}\" class=\"cl_inputField\" type=\"Number\" showValueHelp=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_KeydataModel>/AppId} !== 'RX' &amp;&amp; ${JM_ContextModel>/Ind} !== 'T' &amp;&amp; ${JM_ContextModel>/Level} !== 'R' &amp;&amp; ${JM_ContextModel>/Level} !== 'A' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_CSPLT_TXT\" text=\"{i18n>ApportionmentStructure}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_CSPLT\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" value=\"{JM_ProductionModel>/Csplt}\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\" liveChange=\"fnLiveChange\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox alignContent=\"End\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Label class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t<HBox justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox id=\"ID_BOMIND\" class=\"cl_indicator\" visible=\"false\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_BOMIND_BTN\" class=\"cl_Indicator\"></Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label class=\"cl_inputLabel\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\" class=\"cl_kd_marginEnd\" alignItems=\"End\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>BOM}\" icon=\"{= ${JM_ImageModel>/path} + 'BOM.svg'}\" tooltip=\"{i18n>GOTOBOM}\" press=\"fnNavBom\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_primaryButton sapUiSizeCompact\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<OverflowToolbar class=\"sapUiSmallMarginTop cl_cont_toolbar\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialComponentAssign}\" class=\"sapUiSmallMarginBegin cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\r\n\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_OPERATION_BTN\" class=\"sapUiSizeCompact cl_IconNavBTN sapUiTinyMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Copy.svg'}\"\r\n\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{i18n>CreateAssignment}\" press=\"fnOperationDetails\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_OPDELETE_BTN\" class=\"sapUiSizeCompact sapUiTinyMarginEnd cl_IconNavBTN\" icon=\"{= ${JM_ImageModel>/path} + 'Delete.svg'}\"\r\n\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{i18n>Delete}\" press=\"fnDeleteFrag\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L8 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</OverflowToolbar>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Table id=\"idMaterialComTable\" rows=\"{JM_ProductionModel>/NavPV_MaterialCompData}\" selectionMode=\"Multi\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_Tbl sapUiSmallMarginBottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:noData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Nodatafound.gif'}\" tooltip=\"{i18n>NoDatafound}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NoDatafound}\" class=\"cl_noDataText\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:noData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:columns>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Component}\" tooltip=\"{i18n>Component}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Idnrk}\" tooltip=\"{JM_ProductionModel>Idnrk}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Activity}\" tooltip=\"{i18n>ActivityOperation}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Vornr}\" tooltip=\"{JM_ProductionModel>Vornr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>IndPhase}\" tooltip=\"{i18n>IndicatorPhase}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ProductionModel>Phflg}\" class=\"cl_opr_checkbx\" editable=\"false\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SupOperation}\" tooltip=\"{i18n>SuperiorOperation}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Pvznr}\" tooltip=\"{JM_ProductionModel>Pvznr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OperationDescription}\" tooltip=\"{i18n>OperationShortText}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Ltxa1}\" tooltip=\"{JM_ProductionModel>Ltxa1}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Quantity}\" tooltip=\"{i18n>Quantity}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Menge}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>UOM}\" width=\"2rem\" tooltip=\"{i18n>UnitMeasure}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Meins}\" tooltip=\"{JM_ProductionModel>Meins}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Backflush}\" width=\"4rem\" tooltip=\"{i18n>Backflush}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ProductionModel>Rgekz}\" class=\"cl_opr_checkbx\" editable=\"false\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"9rem\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemDescription}\" tooltip=\"{i18n>MaterialDescription}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Maktx}\" tooltip=\"{JM_ProductionModel>Maktx}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemNumber}\" tooltip=\"{i18n>ItemNumber}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Posnr}\" tooltip=\"{JM_ProductionModel>Posnr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemCategory}\" tooltip=\"{i18n>ItemCategory}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Postp}\" tooltip=\"{JM_ProductionModel>Postp}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Material}\" tooltip=\"{i18n>Material}\" class=\"cl_table_headerTxt\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_ProductionModel>Matnr}\" tooltip=\"{JM_ProductionModel>Matnr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:columns>\r\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Table>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" id=\"ID_PERMAN_HEADER\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RepetitiveManufacturing}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_PERMAN\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" alt=\"{i18n>Collapse}\" press=\"fnExpandCollapse\"></Image>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" id=\"ID_PERMAN_GRID\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_MDV01_TXT\" text=\"{i18n>ProductionLine}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_MDV01\" value=\"{JM_ProductionModel>/Mdv01}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_MDV02_TXT\" text=\"{i18n>PlanningID}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_MDV02\" value=\"{JM_ProductionModel>/Mdv02}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\" liveChange=\"fnLiveChange\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_PNGUID_TXT\" text=\"{i18n>LineNetwork}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_PNGUID\" value=\"{JM_ProductionModel>/Pnguid}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_SERKZ_TXT\" text=\"{i18n>Remallowed}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox id=\"ID_PV_SERKZ\" select=\"fnCheckBoxLiveChange\" selected=\"{JM_ProductionModel>/Serkz}\" class=\"cl_opr_checkbx\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!--<Input id=\"ID_PV_SERKZ\" value=\"{JM_ProductionModel>/Serkz}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>-->\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\r\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" id=\"ID_OTHERDATA_HEADER\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OtherData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_OTHERDATA\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\"></Image>\r\n\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\" id=\"ID_OTHERDATA_GRID\">\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_MATKO_TXT\" text=\"{i18n>OtherHeaderMaterial}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_MATKO\" class=\"cl_inputField\" value=\"{JM_ProductionModel>/Matko}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_VERTO_TXT\" text=\"{i18n>DistributionKey}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_VERTO\" value=\"{JM_ProductionModel>/Verto}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\" liveChange=\"fnLiveChange\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_ELPRO_TXT\" text=\"{i18n>IssueStorageLocation}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_ELPRO\" value=\"{JM_ProductionModel>/Elpro}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_EWM_LGNUM_TXT\" text=\"{i18n>WarehouseNumber}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_EWM_LGNUM\" value=\"{JM_ProductionModel>/EwmLgnum}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_ALORT_TXT\" text=\"{i18n>ReceivingLocation}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_ALORT\" value=\"{JM_ProductionModel>/Alort}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_UCMAT_TXT\" text=\"{i18n>OBReferenceMaterial}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_UCMAT\" value=\"{JM_ProductionModel>/Ucmat}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_EWM_LGPLA_TXT\" text=\"{i18n>DestinationBin}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_EWM_LGPLA\" value=\"{JM_ProductionModel>/EwmLgpla}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\" liveChange=\"fnLiveChange\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_TSA_PRVBE_TXT\" text=\"{i18n>TargetPSA}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_TSA_PRVBE\" value=\"{JM_ProductionModel>/TsaPrvbe}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label id=\"ID_PV_PRVBE_TXT\" text=\"{i18n>DefaultSupplyArea}\" class=\"cl_inputLabel\"></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_PV_PRVBE\" value=\"{JM_ProductionModel>/Prvbe}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\r\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t\t\t\t<layoutData>\r\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\r\n\t\t\t\t\t\t\t\t\t</layoutData>\r\n\t\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t</grid:Grid>\r\n\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t</VBox>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<OverflowToolbar>\r\n\t\t\t\t\t\t<Label text=\"{i18n>PageTips}\" class=\"cl_pageTip sapUiSmallMarginBegin\"/>\r\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Pagetips.svg'}\" alt=\"{i18n>PageTips}\" width=\"0.9rem\" class=\"sapUiTinyMarginBegin\"/>\r\n\t\t\t\t\t\t<ToolbarSpacer/>\r\n\t\t\t\t\t\t<Button text=\"{i18n>Cancel}\" id=\"ID_CANCEL_BTN\" width=\"5rem\" icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\"\r\n\t\t\t\t\t\t\tclass=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"{i18n>Cancel}\" press=\"fnclose\"/>\r\n\t\t\t\t\t\t<Button text=\"{i18n>Changelog}\" width=\"7.8rem\" icon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\"\r\n\t\t\t\t\t\t\tclass=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"{i18n>Changelog}\" press=\"fnChangelog\"\r\n\t\t\t\t\t\t\tvisible=\"{= ${JM_KeydataModel>/AppId} === 'RX' }\"/>\r\n\t\t\t\t\t\t<Button text=\"{i18n>SaveBack}\" width=\"9rem\" icon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" class=\"cl_primaryButton sapUiSmallMarginEnd\"\r\n\t\t\t\t\t\t\ttooltip=\"{i18n>SaveBack}\" press=\"fnSaveBack\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\r\n\t\t\t\t\t</OverflowToolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"MANAGED_RECIPE/view/reci_search.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" controllerName=\"MANAGED_RECIPE.controller.reci_search\"\n\txmlns:html=\"http://www.w3.org/1999/xhtml\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<App>\n\t\t<pages>\n\t\t\t<Page showHeader=\"true\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"true\">\n\t\t\t\t<!--Header Bar-->\n\t\t\t\t<customHeader>\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\n\t\t\t\t\t\t<Title text=\"{i18n>searchTitle}\" class=\"sapUiSmallMarginBegin cl_header_title\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Uname} - {JM_UserModel>/0/Sysid}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</customHeader>\n\t\t\t\t<!-- Fragment for Navigation Bar-->\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\n\t\t\t\t<content>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<!--Road Map Box-->\n\t\t\t\t\t\t<HBox visible=\"{JM_Visible>/visible}\" id=\"id_roadmap\" justifyContent=\"SpaceBetween\"\n\t\t\t\t\t\t\tclass=\"cl_roadmap sapUiSmallMarginBeginEnd sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\" id=\"id_roadmapHighlighter\" class=\"cl_Highlightborder_roadMap\">\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'SearchR.svg'}\" tooltip=\"{i18n>Search}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Search}\" visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_HighlightText_roadMap\"/>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'KeyData.svg'}\" tooltip=\"{i18n>Keydata}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Keydata}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Recipe.svg'}\" tooltip=\"{i18n>RecipeDetails}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RecipeDetails}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Reviewer.svg'}\" tooltip=\"{i18n>Reviewer}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Reviewer}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\n\t\t\t\t\t\t\t<VBox width=\"20%\">\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Approver.svg'}\" tooltip=\"{i18n>Approver}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Approver}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\n\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t<!--Search Screen container-->\n\t\t\t\t\t\t<VBox id=\"id_search_container\" class=\"sapUiSmallMarginBeginEnd\">\n\t\t\t\t\t\t\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\">\n\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/visible}\" height=\"auto\" class=\"sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_search_grid\">\n\t\t\t\t\t\t\t\t\t\t<OverflowToolbar class=\"cl_toolbarBorderBottomRemove\">\n\t\t\t\t\t\t\t\t\t\t\t<HBox class=\"cl_subheading\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{i18n>Search}\" visible=\"{JMVisible>/visible}\" class=\"cl_subHeader sapUiTinyMarginBegin sapUiTinyMarginEnd\"/>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox class=\"cl_subheading \">\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{i18n>SearchVarient}\" visible=\"{JMVisible>/visible}\" class=\" cl_subHeader sapUiTinyMarginBegin sapUiTinyMarginEnd\"/>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<Select id=\"id_combo\" class=\"cl_s_selectVarient cl_combobox\" width=\"16.5rem\" selectedKey=\"{i18n>SelectedKey}\" change=\"fnVarinatSelect\"\n\t\t\t\t\t\t\t\t\t\t\t\titems=\"{JMListVariant>/}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"{JMListVariant>VariantName}\" text=\"{JMListVariant>VariantName}\"/>\n\t\t\t\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'SaveVariant.svg'}\" tooltip=\"{i18n>AddandDltVarient}\" press=\"fnOpenVariant\" width=\"1.6rem\"/>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Material}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<Input liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\" id=\"SID_RECI_MATNR\" class=\"cl_inputField\" showValueHelp=\"true\" maxLength=\"18\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialDesc}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_inputField\" id=\"SID_RECI_MATNR_DES\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"26%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\" id=\"SID_RECI_WERKS\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"73%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"SID_RECI_WERKS_DES\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\" id=\"SID_RECI_PLNNR\" class=\"cl_inputField\" maxLength=\"9\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"65%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" id=\"SID_RECI_PLNNR_DES\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<OverflowToolbar class=\"cl_toolbarBorderBottomRemove\">\n\t\t\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t\t\t<RadioButtonGroup select=\"fnRadioChange\" columns=\"2\" id=\"idRBGroup\" class=\"cl_s_radiobutton sapUiSmallMarginBegin\">\n\t\t\t\t\t\t\t\t\t\t\t\t<RadioButton enabled=\"{viewModel>/isEditable}\" text=\"{i18n>AND}\" id=\"id_and\" class=\"cl_s_radiobutton\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<RadioButton enabled=\"{viewModel>/isEditable}\" text=\"{i18n>OR}\" id=\"id_or\" class=\"cl_s_radiobutton\"/>\n\t\t\t\t\t\t\t\t\t\t\t</RadioButtonGroup>\n\t\t\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>ClearAll}\" tooltip=\"{i18n>ClearAll}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\" press=\"fnClearAllfields\"\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\" width=\"5.7rem\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>Search}\" tooltip=\"{i18n>Search}\" class=\"cl_primaryButton\" press=\"fnSearch\"\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Search.svg'}\" width=\"5rem\"/>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox id=\"id_searchTableBox\" class=\"sapUiTinyMarginTop cl_border\">\n\t\t\t\t\t\t\t\t\t<OverflowToolbar class=\"cl_toolbarBorderBottomRemove sapUiSmallMarginBegin sapUiTinyMarginTopBottom sapUiSmallMarginEnd\">\n\t\t\t\t\t\t\t\t\t\t<Image width=\"1.6rem\" src=\"{= ${JM_ImageModel>/path} + 'ColumnFilter.svg'}\" tooltip=\"{i18n>TableFilter}\" press=\"fnTableFilter\"/>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ResultList}\" class=\"sapUiTinyMarginBegin cl_search_tableHeaderTxt\"></Label>\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>/total}\" class=\"sapUiTinyMarginBegin cl_search_tableCntTxt\"></Label>\n\t\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t\t<!--<Input width=\"13rem\" liveChange=\"fnSearchTable\" placeholder=\"\" class=\"cl_inputField\"/>-->\n\t\t\t\t\t\t\t\t\t\t<Toolbar visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_s_customSearchWrapper sapUiSizeCompact\" width=\"12rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'SearchInputIcon.svg'}\" tooltip=\"{i18n>SearchHere}\" class=\"searchIcon\" width=\"18px\" height=\"18px\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"Id_SearchHere\" liveChange=\"fnSearchTable\" change=\"onsearchByFilter\" placeholder=\"{i18n>SearchHere}\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_s_inputNoBorderSearchField cl_inputField\"/>\n\t\t\t\t\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t\t\t\t\t\t<MenuButton text=\"{i18n>CreateNew}\" icon=\"{= ${JM_ImageModel>/path} + 'Createnew.svg'}\" width=\"9rem\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"sapUiSmallMarginBegin cl_createNew\">\n\t\t\t\t\t\t\t\t\t\t\t<menu>\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu class=\"cl_createnewMenu\" itemSelected=\"fnMenu\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MenuItem text=\"{i18n>Create}\" class=\"cl_textmenu\" key=\"RECI_CREATE\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MenuItem text=\"{i18n>Change}\" class=\"cl_textmenu\" key=\"RECI_CHANGE\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</Menu>\n\t\t\t\t\t\t\t\t\t\t\t</menu>\n\t\t\t\t\t\t\t\t\t\t</MenuButton>\n\t\t\t\t\t\t\t\t\t\t<Image width=\"1.6rem\" src=\"{= ${JM_ImageModel>/path} + 'DownloadSearch.svg'}\" tooltip=\"{i18n>DownloadData}\" press=\"fnDownloadTable\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_removeFocus sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t\t\t\t\t<Image width=\"0.8rem\" visible=\"{JM_Visible>/visible}\" tooltip=\"{i18n>Expand}\" class=\"sapUiSmallMarginBegin cl_search_expandCollpase\"\n\t\t\t\t\t\t\t\t\t\t\tpress=\"fnExpand\" src=\"{= ${JM_ImageModel>/path} + 'Zoom.svg'}\"/>\n\t\t\t\t\t\t\t\t\t\t<Image width=\"1rem\" visible=\"{= !${JM_Visible>/visible} }\" tooltip=\"{i18n>Collapse}\" class=\"sapUiSmallMarginBegin cl_search_expandCollpase\"\n\t\t\t\t\t\t\t\t\t\t\tpress=\"fnCollapse\" src=\"{= ${JM_ImageModel>/path} + 'CollapseIcon.svg'}\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t\t<uitable:Table id=\"id_search_table\" rows=\"{JM_Recidetails>/records}\" visibleRowCount=\"{JM_Visible>/rowCount}\" selectionMode=\"Single\"\n\t\t\t\t\t\t\t\t\t\tselectionBehavior=\"Row\" visibleRowCountMode=\"Interactive\" class=\"cl_opr_Tbl sapUiSmallMarginBeginEnd sapUiSmallMarginBottom\"\n\t\t\t\t\t\t\t\t\t\trowSelectionChange=\"fnSelectBomRow\">\n\t\t\t\t\t\t\t\t\t\t<uitable:noData>\n\t\t\t\t\t\t\t\t\t\t\t<VBox alignItems=\"Center\" justifyContent=\"Center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Nodatafound.gif'}\" tooltip=\"{i18n>NoDatafound}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>NoDatafound}\" class=\"cl_noDataText\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t</uitable:noData>\n\t\t\t\t\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Matnr\" sortProperty=\"Matnr\" tooltip=\"{i18n>Material}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Material}\" tooltip=\"{i18n>Material}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Image src=\"{ path: 'JM_Recidetails>Status', formatter: '.formatter.fnConverStatusToIcon' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_Recidetails>Status', formatter: '.formatter.fnConverStatustoTooltip' }\"></Image>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Matnr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"10%\" filterProperty=\"Maktx\" sortProperty=\"Maktx\" tooltip=\"{i18n>MaterialDesc}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialDes}\" tooltip=\"{i18n>MaterialDesc}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Maktx}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Plnnr\" sortProperty=\"Plnnr\" tooltip=\"{i18n>Group}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\" tooltip=\"{i18n>Group}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Plnnr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Plnty\" sortProperty=\"Plnty\" tooltip=\"{i18n>TaskListType}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>TLType}\" tooltip=\"{i18n>TaskListType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Plnty}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Plnal\" sortProperty=\"Plnal\" tooltip=\"{i18n>GroupCounter}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GrC}\" tooltip=\"{i18n>GroupCounter}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Plnal}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Zkriz\" sortProperty=\"Zkriz\" tooltip=\"{i18n>Counter}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Counter}\" tooltip=\"{i18n>Counter}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Zkriz}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\" filterProperty=\"Verid\" sortProperty=\"Verid\" tooltip=\"{i18n>ProductionVersion}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ProdVersion}\" tooltip=\"{i18n>ProductionVersion}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Verid}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Stlal\" sortProperty=\"Stlal\" tooltip=\"{i18n>AlternativeBOM}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AltBOM}\" tooltip=\"{i18n>AlternativeBOM}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Stlal}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Stlan\" sortProperty=\"Stlan\" tooltip=\"{i18n>Usage}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Usage}\" tooltip=\"{i18n>Usage}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Stlan}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Aennr\" sortProperty=\"Aennr\" tooltip=\"{i18n>Change}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Change}\" tooltip=\"{i18n>Change}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Aennr}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Aennr\" sortProperty=\"Annam\" tooltip=\"{i18n>User}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>User}\" tooltip=\"{i18n>User}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Annam}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Werks\" sortProperty=\"Werks\" tooltip=\"{i18n>Plant}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" tooltip=\"{i18n>Plant}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Werks}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Statu\" sortProperty=\"Statu\" tooltip=\"{i18n>Status}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Status}\" tooltip=\"{i18n>Status}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Statu}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Plnme\" sortProperty=\"Plnme\" tooltip=\"{i18n>UnitofMeasures}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>UOM}\" tooltip=\"{i18n>UnitofMeasures}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{JM_Recidetails>Plnme}\" class=\"sapUiTinyMarginBegin cl_table_label\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</VBox>\n\t\t\t\t</content>\n\t\t\t</Page>\n\t\t</pages>\n\t</App>\n</mvc:View>",
		"MANAGED_RECIPE/view/reci_keydata.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" controllerName=\"MANAGED_RECIPE.controller.reci_keydata\"\r\n\txmlns:html=\"http://www.w3.org/1999/xhtml\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page showHeader=\"true\" title=\"Application\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"false\">\r\n\t\t\t\t<!--Header Bar-->\r\n\t\t\t\t<customHeader>\r\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\r\n\t\t\t\t\t\t<Title id=\"id_title\" text=\"{}\" class=\"sapUiSmallMarginBegin cl_header_title\"/>\r\n\t\t\t\t\t\t<ToolbarSpacer/>\r\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Agent} - {JM_UserModel>/0/Uname}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\r\n\t\t\t\t\t</OverflowToolbar>\r\n\t\t\t\t</customHeader>\r\n\t\t\t\t<!-- Fragment for Navigation Bar-->\r\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<VBox>\r\n\t\t\t\t\t\t<!--Road Map Box-->\r\n\t\t\t\t\t\t<HBox id = \"id_roadmap\" class=\"cl_roadmap sapUiSmallMarginBeginEnd sapUiTinyMarginTop\">\r\n\t\t\t\t\t\t\t<VBox width=\"20%\">\r\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Image   src=\"{= ${JM_ImageModel>/path} + 'SearchR.svg'}\"  tooltip=\"{i18n>Search}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\r\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Search}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\r\n\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\r\n\t\t\t\t\t\t\t<VBox width=\"20%\">\r\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\" id = \"id_roadmapHighlighter\" class=\"cl_Highlightborder_roadMap\">\r\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'KeyData.svg'}\"  tooltip=\"{i18n>Keydata}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\r\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Keydata}\" class=\"cl_HighlightText_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\r\n\t\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\r\n\t\t\t\t\t\t\t<VBox width=\"20%\">\r\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'Recipe.svg'}\"  tooltip=\"{i18n>RecipeDetails}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\r\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RecipeDetails}\" visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_textStyle_roadMap\"/>\r\n\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\r\n\t\t\t\t\t\t\t<VBox width=\"20%\">\r\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'Reviewer.svg'}\"  tooltip=\"{i18n>Reviewer}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\r\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Reviewer}\" class=\"cl_textStyle_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"/>\r\n\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t\t<HBox class=\"cl_Vline_roadMap\" visible=\"{RoadMapUI>/labelVisible}\"></HBox>\r\n\t\t\t\t\t\t\t<VBox width=\"20%\">\r\n\t\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'Approver.svg'}\"  tooltip=\"{i18n>Approver}\" class=\"cl_ImageTopAlign_roadMap sapUiTinyMarginEnd\"></Image>\r\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Approver}\" visible=\"{RoadMapUI>/labelVisible}\" class=\"cl_textStyle_roadMap\"/>\r\n\t\t\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t\t</HBox>\r\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBegin sapUiSmallMarginEnd\">\r\n\t\t\t\t\t\t\t<!-- Key Data Fragment -->\r\n\t\t\t\t\t\t\t<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.reci_keydata\" type=\"XML\"/>\r\n\t\t\t\t\t\t</VBox>\r\n\t\t\t\t\t</VBox>\r\n\t\t\t\t\t<HBox class=\"cl_imageContainer\" alignContent=\"Center\">\r\n\t\t\t\t\t\t<!-- Key data Image-->\r\n\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'keydataFrame.svg'}\"  tooltip=\"{i18n>Keydata}\" class=\"cl_fitImage\"/>\r\n\t\t\t\t\t</HBox>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<OverflowToolbar>\r\n\t\t\t\t\t\t<Label text=\"{i18n>PageTips}\" class=\"cl_pageTip sapUiSmallMarginBegin\"/>\r\n\t\t\t\t\t\t<Image  src=\"{= ${JM_ImageModel>/path} + 'Pagetips.svg'}\"  width=\"0.9rem\" class=\"sapUiTinyMarginBegin\" tooltip=\"{i18n>PageTips}\"/>\r\n\t\t\t\t\t\t<ToolbarSpacer/>\r\n\t\t\t\t\t\t<Button text=\"Cancel\" width=\"5rem\"  icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\"  class=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"Continue\" press=\"fnCancel\"/>\r\n\t\t\t\t\t\t<Button text=\"Continue\" width=\"6rem\"  icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\"  class=\"cl_primaryButton sapUiSmallMarginEnd\" tooltip=\"Continue\"\r\n\t\t\t\t\t\t\tpress=\"fnContinue\"/>\r\n\t\t\t\t\t</OverflowToolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"MANAGED_RECIPE/view/reci_operations.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" controllerName=\"MANAGED_RECIPE.controller.reci_operations\"\n\txmlns:html=\"http://www.w3.org/1999/xhtml\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\">\n\t<App>\n\t\t<pages>\n\t\t\t<Page showHeader=\"true\" title=\"Application\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"false\">\n\t\t\t\t<customHeader>\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'NavBack.svg'}\" tooltip=\"{i18n>navBack}\" width=\"1.5rem\" press=\"fnBackConfirmation\"\n\t\t\t\t\t\t\tclass=\"cl_pv_removeImgFocus sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Title id=\"id_title\" text=\"{}\" class=\"cl_header_title\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<!--added by srikanth-->\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Agent} - {JM_UserModel>/0/Uname}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</customHeader>\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\n\t\t\t\t<content>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBeginEnd sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t<grid:Grid class=\"cl_search_grid\">\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_KeydataModel>/Werks}\" class=\"cl_inputField\" editable=\"false\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/WerksDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RecipeGroup}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"23%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input showValueHelp=\"true\" value=\"{JM_KeydataModel>/Plnnr}\" editable=\"false\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"77%\">\n\t\t\t\t\t\t\t\t\t\t\t<Input width=\"100%\" value=\"{JM_KeydataModel>/ReciDes}\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GroupCounter}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox width=\"35%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t<Input editable=\"false\" value=\"{JM_KeydataModel>/Plnal}\" class=\"cl_inputField\" maxLength=\"4\"></Input>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t<VBox class=\"cl_reci_dupDialog_tableBox sapUiSmallMarginTop\">\n\t\t\t\t\t\t\t\t<OverflowToolbar class=\"sapUiSmallMarginBeginEnd sapUiSmallMarginTop cl_init_toolbar\">\n\t\t\t\t\t\t\t\t\t<Image press=\"fnCustomTable\" width=\"1.6rem\" src=\"{= ${JM_ImageModel>/path} + 'ColumnFilter.svg'}\" tooltip=\"{i18n>TableFilter}\"/>\n\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ResultList}\" class=\"sapUiTinyMarginBegin cl_search_tableHeaderTxt\"></Label>\n\t\t\t\t\t\t\t\t\t<Label text=\"{}\" class=\"sapUiTinyMarginBegin cl_search_tableCntTxt\"></Label>\n\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t<Button id=\"id_DeselectAll\" text=\"{i18n>DeselectAll}\" class=\"cl_opr_DeselectBtn sapUiSizeCompact\" press=\"fnDeselectAll\"/>\n\t\t\t\t\t\t\t\t\t<Input width=\"13rem\" liveChange=\"fnFilterDBTable\" change=\"fnFilterDBTable\" submit=\"fnNextTable\" placeholder=\"{i18n>SearchHere}\"\n\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField sapUiTinyMarginEnd\"/>\n\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>Operations}\" class=\"cl_primaryButton sapUiTinyMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Operations.svg'}\"\n\t\t\t\t\t\t\t\t\t\tpress=\"fnOperationDialog\" width=\"7rem\"/>\n\t\t\t\t\t\t\t\t\t<Button class=\"cl_item_Add_Dialog sapUiSizeCompact sapUiTinyMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Plus.svg'}\"\n\t\t\t\t\t\t\t\t\t\ttooltip=\"{i18n>addRow}\" press=\"fnAddRow\"/>\n\t\t\t\t\t\t\t\t\t<Button class=\"cl_item_Delete_Dialog sapUiSizeCompact\" icon=\"{= ${JM_ImageModel>/path} + 'Delete.svg'}\" tooltip=\"{i18n>deleteRow}\"\n\t\t\t\t\t\t\t\t\t\tpress=\"fnDeleteRow\"/>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t<uitable:Table id=\"id_OperationTable\" rows=\"{JM_ReciOperations>/Operations}\" visibleRowCount=\"10\" fixedColumnCount=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"cl_opr_Tbl sapUiSmallMarginBeginEnd sapUiTinyMarginBottom sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vornr\" sortProperty=\"Vornr\" tooltip=\"{i18n>Operations}\" width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Operation}\" tooltip=\"{i18n>Operations}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vornr}\" class=\"cl_opr_tableInput\" maxLength=\"4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vornr' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vornr' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Phflg\" sortProperty=\"Phflg\" tooltip=\"{i18n>Phase}\" width=\"3.4rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Phase}\" tooltip=\"{i18n>Phase}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperations>Phflg}\" class=\"cl_opr_checkbx\" select=\"fnPhaseSelect\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Phflg' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Phflg' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Pvznr\" sortProperty=\"Pvznr\" tooltip=\"{i18n>SupOperation}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SupOperation}\" tooltip=\"{i18n>SupOperation}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Pvznr}\" maxLength=\"4\" type=\"Number\" id=\"PVZNR\" submit=\"fnSupOperation\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnSupOperationLiveChange\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Pvznr' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Pvznr' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Phseq\" sortProperty=\"Phseq\" tooltip=\"{i18n>Destination}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Destination}\" tooltip=\"{i18n>Destination}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Phseq}\" id=\"ID_OPER_PHSEQ\" liveChange=\"fnDestinationLiveChange\" valueHelpRequest=\"fnF4press\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" submit=\"fnDestinationSubmit\" class=\"cl_opr_tableInput\" maxLength=\"2\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Phseq' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Phseq' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Arbpl\" sortProperty=\"Arbpl\" tooltip=\"{i18n>Resource}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Resource}\" tooltip=\"{i18n>Resource}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Arbpl}\" id=\"ID_OPER_ARBPL\" liveChange=\"fnResourceLiveChange\" submit=\"fnResourceSubmit\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" showValueHelp=\"true\" class=\"cl_opr_tableInput\" maxLength=\"8\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Arbpl' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Arbpl' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Steus\" sortProperty=\"Steus\" tooltip=\"{i18n>ControlKey}\" width=\"6rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ControlKey}\" tooltip=\"{i18n>ControlKey}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Steus}\" valueHelpOnly=\"true\" showValueHelp=\"true\" valueHelpRequest=\"fnF4press\" maxLength=\"4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>ControlKey}\" id=\"ID_OPER_STEUS\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Steus' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Steus' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Txtkz\" sortProperty=\"Txtkz\" tooltip=\"{i18n>LongText}\" visible=\"{JMColumnVis>/LongText}\" width=\"4rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>LngTxt}\" tooltip=\"{i18n>LongText}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperations>Txtkz}\" editable=\"false\" class=\"cl_opr_checkbx\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Ktsch\" sortProperty=\"Ktsch\" tooltip=\"{i18n>StdKeyText}\" visible=\"{JMColumnVis>/StandardKeyText}\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"10rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>StandardKeyText}\" tooltip=\"{i18n>StdKeyText}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Ktsch}\" id=\"ID_OPER_KTSCH\" valueHelpRequest=\"fnF4press\" liveChange=\"fnStdKeyTextLiveChange\" maxLength=\"7\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Ktsch' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Ktsch' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Ltxa1\" sortProperty=\"Ltxa1\" tooltip=\"{i18n>Description}\" visible=\"{JMColumnVis>/Description}\" width=\"10rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Description}\" tooltip=\"{i18n>Description}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Ltxa1}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Description}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Ltxa1' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Ltxa1' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Txtsp\" sortProperty=\"Txtsp\" tooltip=\"{i18n>Language}\" visible=\"{JMColumnVis>/Language}\" width=\"6rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Language}\" tooltip=\"{i18n>Language}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Txtsp}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Language}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Ckselkz\" sortProperty=\"Ckselkz\" tooltip=\"{i18n>RelevangytoCostingIndicator}\"\n\t\t\t\t\t\t\t\t\t\t\tvisible=\"{JMColumnVis>/RelevancyToCostingIndicator}\" width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>RelevangytoCostingIndicator}\" tooltip=\"{i18n>RelevangytoCostingIndicator}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Ckselkz}\" id=\"ID_OPER_CKSELKZ\" valueHelpRequest=\"fnF4press\" valueHelpOnly=\"true\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Ckselkz' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Ckselkz' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Klakz\" sortProperty=\"Klakz\" tooltip=\"{i18n>Classification}\" visible=\"{JMColumnVis>/Classification}\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Classif}\" tooltip=\"{i18n>Classification}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperations>Klakz}\" class=\"cl_opr_checkbx\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Bezkz\" sortProperty=\"Bezkz\" tooltip=\"{i18n>ObjectDevelops}\" visible=\"{JMColumnVis>/ObjectDeps}\" width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ObjectDeps}\" tooltip=\"{i18n>ObjectDevelops}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperations>Bezkz}\" class=\"cl_opr_checkbx\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Bmsch\" sortProperty=\"Bmsch\" tooltip=\"{i18n>BaseQuantity}\" visible=\"{JMColumnVis>/BaseQty}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BaseQty}\" tooltip=\"{i18n>BaseQuantity}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Bmsch}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>BaseQty}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnQuanDataElementValidation\" maxLength=\"13\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Bmsch' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Bmsch' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Meinh\" sortProperty=\"Meinh\" tooltip=\"{i18n>OperationUnit}\" visible=\"{JMColumnVis>/OperationUnit}\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>OperationUnit}\" tooltip=\"{i18n>OperationUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Meinh}\" id=\"ID_OPER_MEINH\" valueHelpRequest=\"fnF4press\" liveChange=\"fnOpeartionUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>OperationUnit}\" maxLength=\"3\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Meinh' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Meinh' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--1st Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw01\" sortProperty=\"Vgw01\" tooltip=\"{i18n>1stStandardValue}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>1stStdValue}\" tooltip=\"{i18n>1stStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw01}\" class=\"cl_opr_tableInput\" liveChange=\"fnQuanDataElementValidation\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>StandardValueKey}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw01' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw01' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge01\" sortProperty=\"Vge01\" tooltip=\"{i18n>1stStandardUnit}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>1stStdUnit}\" tooltip=\"{i18n>1stStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge01}\" id=\"ID_OPER_VGE01\" maxLength=\"3\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>StandardValue1}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge01' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge01' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar01\" sortProperty=\"Lar01\" tooltip=\"{i18n>ActivityType}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar01}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Lar01}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar01' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar01' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--2nd Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw02\" sortProperty=\"Vgw02\" tooltip=\"{i18n>2ndStandardValue}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>2ndStdValue}\" tooltip=\"{i18n>2ndStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw02}\" liveChange=\"fnQuanDataElementValidation\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vgw02}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw02' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw02' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge02\" sortProperty=\"Vge02\" tooltip=\"{i18n>2ndStandardUnit}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>2ndStdUnit}\" tooltip=\"{i18n>2ndStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge02}\" id=\"ID_OPER_VGE02\" maxLength=\"3\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Vge02}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge02' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge02' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar02\" sortProperty=\"Lar02\" tooltip=\"{i18n>ActivityType}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar02}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Lar02}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar02' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar02' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--3rd Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw03\" sortProperty=\"Vgw03\" tooltip=\"{i18n>3rdStandardValue}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>3rdStdValue}\" tooltip=\"{i18n>3rdStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw03}\" liveChange=\"fnQuanDataElementValidation\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vgw03}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw03' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw03' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge03\" sortProperty=\"Vge03\" tooltip=\"{i18n>3rdStandardUnit}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>3rdStdUnit}\" tooltip=\"{i18n>3rdStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge03}\" id=\"ID_OPER_VGE03\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vge03}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge03' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge03' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar03\" sortProperty=\"Lar03\" tooltip=\"{i18n>ActivityType}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar03}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Lar03}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar03' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar03' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--4th Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw04\" sortProperty=\"Vgw04\" tooltip=\"{i18n>4thStandardValue}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>4thStdValue}\" tooltip=\"{i18n>4thStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw04}\" liveChange=\"fnQuanDataElementValidation\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vgw04}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw04' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw04' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge04\" sortProperty=\"Vge04\" tooltip=\"Std Value Unit\" visible=\"{JMColumnVis>/StandardValue1}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>4thStdUnit}\" tooltip=\"{i18n>3rdStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge04}\" id=\"ID_OPER_VGE04\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vge04}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge04' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge04' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar04\" sortProperty=\"Lar04\" tooltip=\"{i18n>ActivityType}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar04}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Lar04}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar04' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar04' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--5th Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw05\" sortProperty=\"Vgw05\" tooltip=\"{i18n>5thStandardValue}\" visible=\"{JMColumnVis>/StandardValueKey}\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>5thStdValue}\" tooltip=\"{i18n>5thStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw05}\" liveChange=\"fnQuanDataElementValidation\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vgw05}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw05' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw05' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge05\" sortProperty=\"Vge05\" tooltip=\"{i18n>5thStandardUnit}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>5thStdUnit}\" tooltip=\"{i18n>5thStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge05}\" id=\"ID_OPER_VGE05\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vge05}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge05' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge05' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar05\" sortProperty=\"Lar05\" tooltip=\"{i18n>ActivityType}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar05}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>StandardValue2}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar05' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar05' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<!--6th Stad Value Seation-->\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vgw06\" sortProperty=\"Vgw06\" tooltip=\"{i18n>6thStandardValue}\" visible=\"{JMColumnVis>/StandardValueKey}\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>6thStdValue}\" tooltip=\"{i18n>6thStandardValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vgw06}\" liveChange=\"fnQuanDataElementValidation\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vgw06}\" maxLength=\"12\" type=\"Number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vgw06' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vgw06' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Vge06\" sortProperty=\"Vge06\" tooltip=\"{i18n>6thStandardUnit}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>6thStdUnit}\" tooltip=\"{i18n>6thStandardUnit}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Vge06}\" id=\"ID_OPER_VGE06\" valueHelpRequest=\"fnF4press\" showValueHelp=\"true\" class=\"cl_opr_tableInput\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_ReciOperations>Vge06}\" liveChange=\"fnActivtystdUnitLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Vge06' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Vge06' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Lar06\" sortProperty=\"Lar06\" tooltip=\"Activity Type\" visible=\"{JMColumnVis>/StandardValue2}\" width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ActivityType}\" tooltip=\"{i18n>ActivityType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_ReciOperations>Lar06}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>Lar06}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Lar06' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Lar06' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Werks\" sortProperty=\"Werks\" tooltip=\"Plant\" width=\"4rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" tooltip=\"{i18n>Plant}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_opr_tableInput\" value=\"{JM_ReciOperations>Werks}\" tooltip=\"{JM_ReciOperations>Werks}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Felx\" sortProperty=\"Felx\" tooltip=\"{i18n>FlexDuration}\" width=\"8rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>FlexDuration}\" tooltip=\"{i18n>FlexDuration}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_ReciOperations>Ddehn}\" class=\"cl_opr_checkbx\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{ parts : [{path : 'JM_ReciOperations>Vornr'}, { path: 'JM_EditableModel>' }, { value: 'Ddehn' }], formatter: '.formatter.fnEditableState' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<customData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:CustomData key=\"flag\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{ parts: [ { path: 'JM_ReciOperations>Vornr' }, { path: 'JM_EditableModel>' }, { value: 'Ddehn' } ], formatter: '.formatter.fnGetSateForOperaTbl' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twriteToDom=\"true\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</customData>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Aennr\" sortProperty=\"Aennr\" tooltip=\"{i18n>ChangeNumber}\" width=\"8rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeNumber}\" tooltip=\"{i18n>ChangeNumber}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input class=\"cl_opr_tableInput\" value=\"{JM_ReciOperations>Aennr}\" tooltip=\"{JM_ReciOperations>/Aennr}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Datuv\" sortProperty=\"Datuv\" tooltip=\"{i18n>ValidFrom}\" visible=\"{JMColumnVis>/ValidFrom}\" width=\"5.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidFrom}\" tooltip=\"{i18n>ValidFrom}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_ReciOperations>Datuv',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput cl_customDatePicker\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!--<Input value=\"{JM_ReciOperations>Datuv}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>ValidTo}\"/>-->\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t<uitable:Column filterProperty=\"Datub\" sortProperty=\"Datub\" tooltip=\"{i18n>ValidTo}\" visible=\"{JMColumnVis>/ValidTo}\" width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidTo}\" tooltip=\"{i18n>ValidTo}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_tableFieldnonEdit\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_ReciOperations>Datub',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" class=\"cl_bom_tableInput cl_tbl_errInput cl_customDatePicker\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!--<Input value=\"{JM_ReciOperations>Datub}\" class=\"cl_opr_tableInput\" tooltip=\"{JM_ReciOperations>ValidTo}\"/>-->\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</VBox>\n\t\t\t\t</content>\n\t\t\t\t<footer>\n\t\t\t\t\t<OverflowToolbar >\n\t\t\t\t\t\t<Label text=\"Page Tips\" class=\"cl_pageTip sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Pagetips.svg'}\" width=\"0.9rem\" class=\"sapUiTinyMarginBegin\" tooltip=\"Page Tip\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<Button text=\"Change log\" width=\"7.8rem\" id=\"changelog\"\n\t\t\t\t\t\t\tvisible=\"{= (${JM_KeyData>/AppId} === 'RX') || (${JM_ContextModel>/Appid} === 'RX') }\" icon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\"\n\t\t\t\t\t\t\tclass=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"Continue\" press=\"fnChangelog\"/>\n\t\t\t\t\t\t<Button text=\"Cancel\" width=\"5rem\" icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\ttooltip=\"Continue\" press=\"fnCancelback\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\n\t\t\t\t\t\t<Button text=\"Save and Back\" width=\"9.5rem\" icon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" class=\"cl_primaryButton sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\ttooltip=\"Continue\" press=\"fnsaveOperation\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\n\t\t\t\t\t\t<Button text=\"Close\" width=\"5rem\" icon=\"{= ${JM_ImageModel>/path} + 'Continue.svg'}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\ttooltip=\"Continue\" press=\"fnback\" visible=\"{= ${JM_ContextModel>/Ind} === 'T' }\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</footer>\n\t\t\t</Page>\n\t\t</pages>\n\t</App>\n</mvc:View>",
		"MANAGED_RECIPE/view/bom_detail.view.xml": "<mvc:View xmlns:core=\"sap.ui.core\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" controllerName=\"MANAGED_RECIPE.controller.bom_detail\"\n\txmlns:html=\"http://www.w3.org/1999/xhtml\" xmlns:grid=\"sap.ui.layout\" xmlns:uitable=\"sap.ui.table\" xmlns:fi=\"sap.ui.unified\">\n\t<App>\n\t\t<pages>\n\t\t\t<Page showHeader=\"true\" title=\"{i18n>BOM}\" class=\"cl_pageBg sapUiSizeCompact\" enableScrolling=\"false\">\n\t\t\t\t<customHeader>\n\t\t\t\t\t<OverflowToolbar class=\"cl_header_toolbar\">\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'NavBack.svg'}\" alt=\"{i18n>NavBack}\" width=\"1.5rem\" press=\"fnNavBack\"\n\t\t\t\t\t\t\tclass=\"cl_pv_removeImgFocus sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Title id=\"id_title\" text=\"{i18n>RecipeBOM}\" class=\"cl_header_title\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<Label text=\"{JM_UserModel>/0/Agent} - {JM_UserModel>/0/Uname}\" class=\"cl_userid_font sapUiSmallMarginEnd\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</customHeader>\n\t\t\t\t<!--<core:Fragment fragmentName=\"MANAGED_RECIPE.Fragment.NavigationBar\" type=\"XML\"/>-->\n\t\t\t\t<content>\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMarginBegin cl_pv_scrollStyle\">\n\t\t\t\t\t\t\t<grid:Grid hSpacing=\"0\" defaultSpan=\"L12 M12 S12\" class=\"sapUiTinyMarginTop\">\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\" visible=\"{JM_Visible>/visible}\">\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" justifyContent=\"SpaceBetween\" alignItems=\"Center\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BasicData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Collapse.svg'}\" id=\"ID_OTHERDATA\" width=\"16px\" tooltip=\"{i18n>Collapse}\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_ImageTopAlign_roadMap cl_pv_removeImgFocus sapUiTinyMarginBeginEnd\" press=\"fnExpandCollapse\" alt=\"{i18n>Collapse}\"></Image>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\"cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\"cl_subheading\" visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>InitialData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>MaterialNumber}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_MATNR\" value=\"{JM_KeydataModel>/Matnr}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox >\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"Material Description\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_MAKTX\" value=\"{JM_KeydataModel>/Maktx}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Plant}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_WERKS\" value=\"{JM_KeydataModel>/Werks}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_WERKS_DES\" value=\"{JM_KeydataModel>/WerksDes}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"Usage\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"25%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STLAN\" value=\"{JM_PVContextModel>/Stlan}\" type=\"Number\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"75%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STLAN_DES\" value=\"{JM_LocalDescriptionModel>/STLAN/desc}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<HBox width=\"100%\" visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AlternativeBOM}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STLAL\" value=\"{JM_PVContextModel>/Stlal}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"50%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BOMGroup}\" id=\"ID_BOM_EXSTL_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_EXSTL\" value=\"{JM_BOMModel>/Exstl}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>TechType}\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"25%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_TETYP\" value=\"{JM_BOMModel>/Tetyp}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"75%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_TETYP_DES\" value=\"{JM_LocalDescriptionModel>/TETYP/desc}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BOMText}\" id=\"ID_BOM_ZTEXT_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ZTEXT\" value=\"{JM_BOMModel>/Ztext}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AltText}\" id=\"ID_BOM_STKTX_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STKTX\" value=\"{JM_BOMModel>/Stktx}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\"sapUiTinyMarginTop cl_subheading\" visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>QtyLongText}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BaseQuantity}\" id=\"ID_BOM_BMENG_TXT\" required=\"true\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_BMENG\" value=\"{JM_BOMModel>/Bmeng}\" type=\"Number\" showValueHelp=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubmit=\"fngetComponent\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_BMEIN\" value=\"{JM_BOMModel>/Bmein}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>BOMStatus}\" id=\"ID_BOM_STLST_TXT\" required=\"true\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STLST\" value=\"{JM_BOMModel>/Stlst}\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4press\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AuthGroup}\" id=\"ID_BOM_STLBE_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_STLBE\" value=\"{JM_BOMModel>/Stlbe}\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" class=\"cl_inputField\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidFrom}\" id=\"ID_BOM_ADATU_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker id=\"ID_BOM_ADATU\" value=\"{ path: 'JM_BOMModel>/Datuv',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" change=\"fnDateRangevalidation\" class=\"cl_inputField cl_customDatePicker\" editable=\"false\"/>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>FromLot}\" id=\"ID_BOM_LOSVN_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LOSVN\" type=\"Number\" value=\"{JM_BOMModel>/Losvn}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ToLot}\" id=\"ID_BOM_LOSBS_TXT\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LOSBS\" type=\"Number\" value=\"{JM_BOMModel>/Losbs}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>LotSizeUnit}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"40%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LOSME\" value=\"{JM_BOMModel>/Losme}\" editable=\"false\" class=\"cl_inputField\" liveChange=\"fnLiveChange\" showValueHelp=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<HBox height=\"1.7rem\" class=\"sapUiTinyMarginTop cl_subheading\" visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>AdditionalData}\" class=\"sapUiTinyMarginBegin cl_subheadingFont\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>LabOffice}\" id=\"ID_BOM_LABOR_TXT\" class=\"cl_inputLabel\"/>\n\t\t\t\t\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"30%\" class=\"cl_inputFieldGap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LABOR\" showValueHelp=\"true\" value=\"{JM_BOMModel>/Labor}\" type=\"Number\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_inputField\" liveChange=\"fnLiveChange\" valueHelpRequest=\"fnF4press\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"70%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_LABOR_DES\" value=\"{JM_LocalDescriptionModel>/LABOR/desc}\" width=\"100%\" class=\"cl_inputDescField\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t<VBox visible=\"{JM_Visible>/BasicVisible}\">\n\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SizDimensions}\" class=\"cl_inputLabel\"></Label>\n\t\t\t\t\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_GROES\" class=\"cl_inputField\" value=\"{JM_BOMModel>/Groes}\" liveChange=\"fnLiveChange\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L3 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t<VBox height=\"auto\" class=\"sapUiTinyMarginEnd\">\n\t\t\t\t\t\t\t\t\t<!--<HBox class=\"cl_pannelHead\" width=\"100%\" justifyContent=\"SpaceBetween\">-->\n\t\t\t\t\t\t\t\t\t<HBox class=\"cl_pannelHead\" width=\"100%\" justifyContent=\"SpaceBetween\">\n\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>GeneralData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>\n\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L7 M7 S12\"/>\n\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t<grid:Grid class=\" cl_kd_grid\">\n\t\t\t\t\t\t\t\t\t\t<OverflowToolbar class=\"cl_init_toolbar\">\n\t\t\t\t\t\t\t\t\t\t\t<!--<Label text=\"{i18n>GeneralData}\" class=\"sapUiSmallMarginBeginEnd cl_pannelTitleFont\"/>-->\n\t\t\t\t\t\t\t\t\t\t\t<Button id=\"id_downloadTemp\" text=\"Download Template\" tooltip=\"Download Template\" icon=\"{= ${JM_ImageModel>/path} + 'download1.svg'}\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_primaryButton cl_uploadBtnMargin sapUiTinyMarginEnd \" press=\"fndownload\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Input id=\"id_fileNameInput\" placeholder=\"Select a file\" class=\"cl_fileUploader cl_UploadFileInput sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnUpload\" showValueHelp=\"true\" valueHelpOnly=\"true\" width=\"10rem\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t<fi:FileUploader id=\"FileUploaderId\" change=\"fnFileSelect\" uploadOnChange=\"false\" fileType=\"doc,docx,xls,xlsx,wdsl,msg,eml,zip,htm,pdf\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_fileupload\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Button text=\"Upload file\" tooltip=\"{i18n>Upload_label}\" id=\"id_upload\" icon=\"{= ${JM_ImageModel>/path} + 'upload.svg'}\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_primaryButton cl_uploadBtnMargin\" press=\"fnExcelUpload\" enabled=\"{= ${JM_ContextLocalModel>/Ind} !== 'T'}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t\t\t\t\t\t<Button text=\"{i18n>DeselectAll}\" class=\"cl_opr_DeselectBtn cl_imagePos sapUiSizeCompact sapUiTinyMarginBeginEnd\" press=\"fnDeselectAll\"\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"ID_DESELECT_BTN\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{i18n>DeselectAll}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_ADD_BTN\" class=\"cl_item_Add_Dialog sapUiSizeCompact sapUiTinyMarginEnd\" icon=\"{= ${JM_ImageModel>/path} + 'Plus.svg'}\"\n\t\t\t\t\t\t\t\t\t\t\t\tvisible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{i18n>Add}\" press=\"fnAddRow\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Button id=\"ID_DELETE_BTN\" class=\"cl_item_Delete_Dialog sapUiSizeCompact sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"{= ${JM_ImageModel>/path} + 'Delete.svg'}\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" tooltip=\"{i18n>Delete}\" press=\"fnDeleteFrag\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Image width=\"1.6rem\" src=\"{= ${JM_ImageModel>/path} + 'DownloadSearch.svg'}\" tooltip=\"{i18n>DownloadData}\" press=\"fnDownloadExcel\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_removeFocus sapUiTinyMarginEnd\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Image id=\"id_ExpandButton\" width=\"0.8rem\" visible=\"{JM_Visible>/visible}\" class=\" cl_search_expandCollpase sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\t\t\t\t\t\tpress=\"fnExpand\" src=\"{= ${JM_ImageModel>/path} + 'Zoom.svg'}\" alt=\"{i18n>Expand}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<Image width=\"1rem\" visible=\"{= !${JM_Visible>/visible} }\" class=\"sapUiTinyMarginEnd cl_search_expandCollpase\" press=\"fnCollapse\"\n\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"{= ${JM_ImageModel>/path} + 'CollapseIcon.svg'}\" alt=\"{i18n>Collapse}\"/>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t<uitable:Table id=\"id_bomTable\" rows=\"{JM_BOMTable>/BOMList}\" visibleRowCount=\"{JM_Visible>/rowCount}\" enableColumnReordering=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tselectionBehavior=\"Row\" fixedColumnCount=\"2\" class=\"cl_opr_Tbl\" rowSelectionChange=\"fnRowSelectionChange\" selectionMode=\"Multi\">\n\t\t\t\t\t\t\t\t\t\t\t\t<uitable:columns>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"3rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Item}\" tooltip=\"{i18n>Item}\" class=\"cl_table_headerTxt\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link text=\"{JM_BOMTable>Posnr}\" tooltip=\"{JM_BOMTable>Posnr}\" class=\"cl_HdrTableItemtext sapUiTinyMarginBegin\" press=\"fnItemDetails\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"4rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ICt}\" tooltip=\"{i18n>ItemCategory}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!--editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"-->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Postp}\" valueState=\"{JM_BOMTable>POSTP}\" valueStateText=\"{JM_BOMTable>POSTP_TXT}\" tooltip=\"{JM_BOMTable>Postp}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"ID_BOM_POSTP\" class=\"cl_bom_tableInput cl_tbl_errInput \" showValueHelp=\"true\" liveChange=\"fnLiveChange\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4TableInput\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"8rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Component}\" tooltip=\"{i18n>Component}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Idnrk}\" valueState=\"{JM_BOMTable>IDNRK}\" valueStateText=\"{JM_BOMTable>IDNRK_TXT}\" tooltip=\"{JM_BOMTable>Idnrk}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" liveChange=\"fnLiveChange\" showValueHelp=\"true\" id=\"ID_BOM_IDNRK\" submit=\"fnSubmitComponent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueHelpRequest=\"fnF4TableInput\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"10rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ComponentDesc}\" tooltip=\"{i18n>ComponentDescription}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_IDNRK_DES\" value=\"{JM_BOMTable>Ktext}\" tooltip=\"{JM_BOMTable>Ktext}\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput\" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Quantity}\" tooltip=\"{i18n>Quantity}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_MENGE\" value=\"{JM_BOMTable>Menge}\" valueState=\"{JM_BOMTable>MENGE}\" valueStateText=\"{JM_BOMTable>MENGE_TXT}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\" liveChange=\"fnLiveChange\" width=\"90%\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"Number\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>UOM}\" tooltip=\"{i18n>UnitMeasure}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_MEINS\" value=\"{JM_BOMTable>Meins}\" valueState=\"{JM_BOMTable>MEINS}\" valueStateText=\"{JM_BOMTable>MEINS_TXT}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{JM_BOMTable>MEINS}\" showValueHelp=\"true\" valueHelpRequest=\"fnF4TableInput\" class=\"cl_bom_tableInput cl_tbl_errInput \"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" valueHelpOnly=\"true\" editable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"2.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Asm}\" tooltip=\"{i18n>AssemblyIndicator}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>Stlkz}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"2.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SIs}\" tooltip=\"{i18n>SubItemIndicator}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>Upskz}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidFrom}\" tooltip=\"{i18n>ValidFrom}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Datuv',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput cl_customDatePicker\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Datuv',formatter: '.formatter.fnDateFormater' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ValidTo}\" tooltip=\"{i18n>ValidTo}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker value=\"{ path: 'JM_BOMTable>Datub',formatter: '.formatter.fnDateFormater' }\" displayFormat=\"dd.MM.yyyy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalueFormat=\"yyyy-MM-ddTHH:mm:ss\" placeholder=\" \" change=\"fnDateRangevalidation\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput cl_customDatePicker\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"{ path: 'JM_BOMTable>Datub',formatter: '.formatter.fnDateFormater' }\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeNo}\" tooltip=\"{i18n>ChangeNumber}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AENNR\" value=\"{JM_BOMTable>Aennr}\" tooltip=\"{JM_BOMTable>Aennr}\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"3rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>PhantomItem}\" tooltip=\"{i18n>PhantomItemIndicator}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>Dumps}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SortString}\" tooltip=\"{i18n>SortString}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_SORTF\" value=\"{JM_BOMTable>Sortf}\" tooltip=\"{JM_BOMTable>Sortf}\" class=\"cl_bom_tableInput cl_tbl_errInput \"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\teditable=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"8rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"Prod. Stroage loc.\" id=\"ID_BOM_LGORT_LBL\" tooltip=\"{i18n>sort_str}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Lgort}\" valueState=\"{JM_BOMTable>LGORT}\" valueStateText=\"{JM_BOMTable>LGORT_TXT}\" tooltip=\"{JM_BOMTable>Lgort}\" class=\"cl_bom_tableInput cl_tbl_errInput\" maxLength=\"4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowValueHelp=\"true\" valueHelpRequest=\"fnf4prodStlocpress\" valueHelpOnly=\"true\" editable=\"{= ${JM_ContextModel>/MsgType} !== 'T' }\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"8rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"Co product\" tooltip=\"{i18n>sort_str}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select id=\"id_variants\" class=\"cl_Hdr_tableInput cl_coproductSelct\" valueState=\"{JM_BOMTable>KZKUP}\" valueStateText=\"{JM_BOMTable>KZKUP_TXT}\" width=\"100%\" selectedKey=\"{JM_BOMTable>key}\" change=\"fncoProductSelect\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- Static items -->\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"\" text=\"\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"Y\" text=\"Yes\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<core:Item key=\"N\" text=\"No\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"6rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ItemID}\" tooltip=\"{i18n>ItemID}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_IDENT\" value=\"{JM_BOMTable>Ident}\" tooltip=\"{JM_BOMTable>Ident}\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ChangeNoTo}\" tooltip=\"{i18n>ToChangeNumber}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_AENRA\" value=\"{JM_BOMTable>Aenra}\" tooltip=\"{JM_BOMTable>Aenra}\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>Group}\" tooltip=\"{i18n>AltItemGroup}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_ALPGR\" value=\"{JM_BOMTable>Alpgr}\" tooltip=\"{JM_BOMTable>Alpgr}\" editable=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"cl_bom_tableInput cl_tbl_errInput \" liveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"2.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>FixedQuantity}\" tooltip=\"{i18n>FixedQuantity}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>Fmeng}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"2.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>LongText}\" tooltip=\"{i18n>LongTextExists}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>Ltxpo}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"2.5rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SegmentedMaintained}\" tooltip=\"{i18n>SegmentedMaintained}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckBox selected=\"{JM_BOMTable>SgtCmkz}\" class=\"cl_opr_checkbx\" editable=\"false\"></CheckBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>SegValue}\" tooltip=\"{i18n>SegmentValue}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input id=\"ID_BOM_SGT_CATV\" value=\"{JM_BOMTable>SgtCatv}\" tooltip=\"{JM_BOMTable>Verti}\" class=\"cl_bom_tableInput cl_tbl_errInput \"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\" editable=\"false\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:Column width=\"7rem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"{i18n>ObjectType}\" tooltip=\"{i18n>ObjectType}\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<VBox class=\"cl_item_tablenoneditBg\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input value=\"{JM_BOMTable>Obtsp}\" tooltip=\"{JM_BOMTable>Obtsp}\" editable=\"false\" class=\"cl_bom_tableInput cl_tbl_errInput \"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tliveChange=\"fnLiveChange\"></Input>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</uitable:Column>\n\t\t\t\t\t\t\t\t\t\t\t\t</uitable:columns>\n\t\t\t\t\t\t\t\t\t\t\t</uitable:Table>\n\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t<grid:GridData span=\"L12 M12 S12\"/>\n\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t</grid:Grid>\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t</VBox>\n\t\t\t\t</content>\n\t\t\t\t<footer>\n\t\t\t\t\t<OverflowToolbar>\n\t\t\t\t\t\t<Label text=\"{i18n>PageTips}\" class=\"cl_pageTip sapUiSmallMarginBegin\"/>\n\t\t\t\t\t\t<Image src=\"{= ${JM_ImageModel>/path} + 'Pagetips.svg'}\" width=\"0.9rem\" class=\"sapUiTinyMarginBegin\" tooltip=\"{i18n>PageTips}\"\n\t\t\t\t\t\t\talt=\"{i18n>PageTips}\"/>\n\t\t\t\t\t\t<ToolbarSpacer/>\n\t\t\t\t\t\t<Button text=\"{i18n>Cancel}\" width=\"5rem\" icon=\"{= ${JM_ImageModel>/path} + 'Cancel.svg'}\" class=\"cl_secondaryButton sapUiTinyMarginEnd\"\n\t\t\t\t\t\t\ttooltip=\"{i18n>Cancel}\" press=\"fnBomclose\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>Changelog}\" width=\"7.8rem\" icon=\"{= ${JM_ImageModel>/path} + 'Clearall.svg'}\"\n\t\t\t\t\t\t\tclass=\"cl_secondaryButton sapUiTinyMarginEnd\" tooltip=\"{i18n>Changelog}\" press=\"fnChangelog\"\n\t\t\t\t\t\t\tvisible=\"{= ${JM_KeydataModel>/AppId} === 'RX' }\"/>\n\t\t\t\t\t\t<Button text=\"{i18n>SaveBack}\" width=\"9rem\" icon=\"{= ${JM_ImageModel>/path} + 'Save.svg'}\" class=\"cl_primaryButton sapUiSmallMarginEnd\"\n\t\t\t\t\t\t\ttooltip=\"{i18n>SaveBack}\" press=\"fnSaveBack\" visible=\"{= ${JM_ContextModel>/Ind} !== 'T' }\"/>\n\t\t\t\t\t</OverflowToolbar>\n\t\t\t\t</footer>\n\t\t\t</Page>\n\t\t</pages>\n\t</App>\n</mvc:View>"
	}
});